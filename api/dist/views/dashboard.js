import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "hono/jsx/jsx-runtime";
import { formatTorontoDate } from '../utils/datetime';
// biome-ignore lint/correctness/noUnusedImports: StatusIcon is reserved for header icons
import { StatusBadge } from './components';
import { Layout } from './layout';
const money = (cents) => `$${(cents / 100).toFixed(2)}`;
const shortDate = (input) => {
    return formatTorontoDate(input, { month: 'short', day: 'numeric' }) || input;
};
const shortTime = (input) => {
    const [hourText = '', minuteText = ''] = input.split(':');
    const hour = Number(hourText);
    const minute = Number(minuteText);
    if (Number.isNaN(hour) || Number.isNaN(minute))
        return input;
    const period = hour >= 12 ? 'PM' : 'AM';
    const clockHour = hour % 12 || 12;
    return `${clockHour}:${String(minute).padStart(2, '0')} ${period}`;
};
export const Dashboard = ({ stats, upcomingJobs, recentBookings, recentMessages }) => {
    const statCards = [
        { label: 'Jobs Today', value: stats.todayJobs },
        { label: 'Jobs This Week', value: stats.weekJobs },
        { label: 'Total Customers', value: stats.totalCustomers },
        { label: 'Active Territories', value: stats.activeTerritories },
        { label: 'Active Providers', value: stats.activeProviders },
        { label: 'Pending Invoices', value: stats.pendingInvoices },
    ];
    return (_jsxs(Layout, { title: "Dashboard", children: [_jsxs("div", { class: "page-header", children: [_jsx("h2", { children: "Dashboard" }), _jsx("div", { class: "page-header-actions", children: _jsx("a", { href: "/admin/jobs/new", class: "uk-btn uk-btn-primary uk-btn-sm", "hx-get": "/admin/jobs/new", "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: "+ New Job" }) })] }), _jsx("div", { class: "p-4 md:p-8", children: _jsxs("div", { class: "grid gap-4 md:gap-6", children: [_jsx("div", { class: "grid grid-cols-2 gap-2.5 md:gap-4 xl:grid-cols-3", children: statCards.map((card) => (_jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("p", { class: "text-2xl md:text-3xl font-semibold leading-none", children: card.value }), _jsx("p", { class: "text-xs md:text-sm text-muted-foreground mt-1.5 md:mt-2", children: card.label })] }, card.label))) }), _jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Upcoming Jobs" }), upcomingJobs.length === 0 ? (_jsx("p", { class: "text-sm text-muted-foreground", children: "No upcoming jobs in the next 7 days." })) : (_jsxs(_Fragment, { children: [_jsx("div", { class: "grid gap-2.5 md:hidden", children: upcomingJobs.map((job) => (_jsxs("article", { class: "rounded-md border border-border p-3", children: [_jsxs("div", { class: "flex items-start justify-between gap-3", children: [_jsx("a", { href: `/admin/jobs/${job.id}`, class: "uk-link font-medium leading-tight min-w-0 flex-1 break-words", "hx-get": `/admin/jobs/${job.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: job.customer_name }), _jsx("span", { class: "shrink-0", children: _jsx(StatusBadge, { status: job.status }) })] }), _jsxs("p", { class: "text-xs text-muted-foreground mt-1.5", children: [shortDate(job.scheduled_date), " at ", shortTime(job.scheduled_start_time)] })] }, job.id))) }), _jsx("div", { class: "uk-overflow-auto hidden md:block", children: _jsxs("table", { class: "uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm", children: [_jsx("thead", { children: _jsxs("tr", { children: [_jsx("th", { class: "text-left", children: "Customer" }), _jsx("th", { class: "text-left", children: "Service" }), _jsx("th", { class: "text-left", children: "Date" }), _jsx("th", { class: "text-left", children: "Time" }), _jsx("th", { class: "text-left", children: "Status" })] }) }), _jsx("tbody", { children: upcomingJobs.map((job) => (_jsxs("tr", { children: [_jsx("td", { children: _jsx("a", { href: `/admin/jobs/${job.id}`, class: "uk-link font-medium", "hx-get": `/admin/jobs/${job.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: job.customer_name }) }), _jsx("td", { children: job.service_name || 'Custom Service' }), _jsx("td", { children: shortDate(job.scheduled_date) }), _jsx("td", { children: job.scheduled_start_time }), _jsx("td", { children: _jsx(StatusBadge, { status: job.status }) })] }, job.id))) })] }) })] }))] }), _jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Recent Bookings" }), recentBookings.length === 0 ? (_jsx("p", { class: "text-sm text-muted-foreground", children: "No recent bookings." })) : (_jsxs(_Fragment, { children: [_jsx("div", { class: "grid gap-2.5 md:hidden", children: recentBookings.map((job) => (_jsxs("article", { class: "rounded-md border border-border p-3", children: [_jsxs("div", { class: "flex items-start justify-between gap-3", children: [_jsx("a", { href: `/admin/jobs/${job.id}`, class: "uk-link font-medium leading-tight min-w-0 flex-1 break-words", "hx-get": `/admin/jobs/${job.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: job.customer_name }), _jsx("span", { class: "shrink-0", children: _jsx(StatusBadge, { status: job.status }) })] }), _jsx("p", { class: "text-xs text-muted-foreground mt-1 truncate", children: job.service_name || 'Custom Service' }), _jsxs("div", { class: "flex items-center justify-between mt-1.5 text-xs text-muted-foreground", children: [_jsxs("span", { children: ["Booked ", shortDate(job.created_at)] }), _jsx("span", { class: "font-medium text-foreground shrink-0 ml-2", children: money(job.total_price_cents) })] })] }, job.id))) }), _jsx("div", { class: "uk-overflow-auto hidden md:block", children: _jsxs("table", { class: "uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm", children: [_jsx("thead", { children: _jsxs("tr", { children: [_jsx("th", { class: "text-left", children: "Customer" }), _jsx("th", { class: "text-left", children: "Service" }), _jsx("th", { class: "text-left", children: "Territory" }), _jsx("th", { class: "text-left", children: "Status" }), _jsx("th", { class: "text-left", children: "Booked" }), _jsx("th", { class: "text-left", children: "Total" })] }) }), _jsx("tbody", { children: recentBookings.map((job) => (_jsxs("tr", { children: [_jsx("td", { children: _jsx("a", { href: `/admin/jobs/${job.id}`, class: "uk-link font-medium", "hx-get": `/admin/jobs/${job.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: job.customer_name }) }), _jsx("td", { children: job.service_name || 'Custom Service' }), _jsx("td", { children: job.territory_name || '-' }), _jsx("td", { children: _jsx(StatusBadge, { status: job.status }) }), _jsx("td", { children: shortDate(job.created_at) }), _jsx("td", { children: money(job.total_price_cents) })] }, job.id))) })] }) })] }))] }), _jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Recent Messages" }), recentMessages.length === 0 ? (_jsx("p", { class: "text-sm text-muted-foreground", children: "No recent messages." })) : (_jsxs(_Fragment, { children: [_jsx("div", { class: "grid gap-2.5 md:hidden", children: recentMessages.map((msg) => (_jsxs("article", { class: "rounded-md border border-border p-3", children: [_jsxs("div", { class: "flex items-start justify-between gap-3", children: [_jsx("a", { href: `/admin/inbox/${msg.id}`, class: `uk-link leading-tight min-w-0 flex-1 break-words ${msg.is_read === 0 ? 'font-semibold' : 'font-medium'}`, "hx-get": `/admin/inbox/${msg.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: (msg.first_name && msg.last_name) ? `${msg.first_name} ${msg.last_name}` : msg.email || 'Unknown' }), _jsx("span", { class: `shrink-0 ${msg.is_read === 0 ? 'uk-label' : 'uk-label uk-label-primary'}`, children: msg.is_read === 0 ? 'Unread' : 'Read' })] }), _jsx("p", { class: "text-sm mt-1 truncate min-w-0", children: msg.subject }), _jsx("p", { class: "text-xs text-muted-foreground mt-1.5", children: shortDate(msg.created_at) })] }, msg.id))) }), _jsx("div", { class: "uk-overflow-auto hidden md:block", children: _jsxs("table", { class: "uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm", children: [_jsx("thead", { children: _jsxs("tr", { children: [_jsx("th", { class: "text-left", children: "From" }), _jsx("th", { class: "text-left", children: "Subject" }), _jsx("th", { class: "text-left", children: "Date" }), _jsx("th", { class: "text-left", children: "Status" })] }) }), _jsx("tbody", { children: recentMessages.map((msg) => (_jsxs("tr", { class: msg.is_read === 0 ? 'font-semibold' : '', children: [_jsx("td", { children: _jsx("a", { href: `/admin/inbox/${msg.id}`, class: "uk-link font-medium", "hx-get": `/admin/inbox/${msg.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: (msg.first_name && msg.last_name) ? `${msg.first_name} ${msg.last_name}` : msg.email || 'Unknown' }) }), _jsx("td", { class: "truncate max-w-xs", children: msg.subject }), _jsx("td", { children: shortDate(msg.created_at) }), _jsx("td", { children: _jsx("span", { class: msg.is_read === 0 ? 'uk-label' : 'uk-label uk-label-primary', children: msg.is_read === 0 ? 'Unread' : 'Read' }) })] }, msg.id))) })] }) })] }))] })] }) })] }));
};
//# sourceMappingURL=dashboard.js.map