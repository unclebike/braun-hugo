import { jsx as _jsx, jsxs as _jsxs } from "hono/jsx/jsx-runtime";
import { StatusIcon } from './components';
import { Layout } from './layout';
const formatRuleDetails = (rule) => {
    if (rule.rule_type === 'time_of_day')
        return `${rule.start_time || '-'} to ${rule.end_time || '-'}`;
    if (rule.rule_type === 'day_of_week')
        return rule.days_of_week || '-';
    if (rule.rule_type === 'lead_time')
        return `${rule.min_hours_ahead ?? 0}h - ${rule.max_hours_ahead ?? 'any'}h ahead`;
    if (rule.rule_type === 'territory')
        return rule.territory_name || '-';
    return '-';
};
export const ServiceDetailPage = ({ service, categories, modifiers, priceRules, requiredSkills, allSkills, territories }) => {
    return (_jsxs(Layout, { title: service.name || 'Service', children: [_jsxs("div", { class: "page-header", children: [_jsx("div", { class: "page-header-info", children: _jsxs("div", { class: "flex items-center gap-2", children: [_jsx("h2", { children: service.name || 'Service' }), _jsx(StatusIcon, { status: service.is_active ? 'active' : 'inactive' })] }) }), _jsx("div", { class: "page-header-actions", children: _jsx("a", { href: "/admin/services", class: "uk-btn uk-btn-default uk-btn-sm", "hx-get": "/admin/services", "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: "Back" }) })] }), _jsx("div", { class: "p-8", children: _jsxs("div", { class: "grid gap-6", style: "max-width: 800px;", children: [_jsx("div", { class: "uk-card uk-card-body", children: _jsx("section", { children: _jsxs("form", { class: "autosave", "hx-post": `/admin/services/${service.id}`, "hx-target": "#page-content", "hx-select": "#page-content", "hx-swap": "none", "hx-trigger": "input delay:500ms, change", "hx-sync": "this:queue last", children: [_jsx("input", { type: "hidden", name: "_section", value: "basic" }), _jsxs("div", { class: "flex items-center justify-between mb-4", children: [_jsx("h3", { class: "text-base font-semibold", children: "Basic Info" }), _jsx("span", { class: "save-indicator" })] }), _jsxs("div", { class: "grid gap-x-4 gap-y-3 grid-cols-2", children: [_jsxs("div", { class: "grid gap-1 col-span-2", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "service-name", children: "Service Name" }), _jsx("input", { id: "service-name", name: "name", class: "uk-input rounded-xl border-2 font-bold h-10 sm:h-11 text-xs sm:text-sm px-2 sm:px-3", value: service.name })] }), _jsxs("div", { class: "grid gap-1 col-span-2", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "service-description", children: "Internal Description" }), _jsx("textarea", { id: "service-description", name: "description", class: "uk-textarea rounded-xl border-2 font-medium text-xs sm:text-sm px-2 sm:px-3", rows: 2, children: service.description || '' })] }), _jsxs("div", { class: "grid gap-1 col-span-2", children: [_jsxs("div", { class: "flex items-center justify-between mb-0.5", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "service-category", children: "Category" }), _jsx("a", { href: "/admin/categories", class: "text-[8px] sm:text-[9px] uppercase tracking-widest font-black uk-link", "hx-get": "/admin/categories", "hx-target": "#page-content", "hx-select": "#page-content", "hx-push-url": "true", children: "Groups" })] }), _jsxs("select", { id: "service-category", name: "category_id", class: "uk-select rounded-xl border-2 font-bold h-10 sm:h-11 text-xs sm:text-sm px-2 sm:px-3", children: [_jsx("option", { value: "", children: "No Category" }), categories.map((cat) => (_jsx("option", { value: cat.id, selected: service.category_id === cat.id, children: cat.name }, cat.id)))] })] }), _jsxs("div", { class: "grid gap-1", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "service-price", children: "Base Price" }), _jsxs("div", { class: "relative", children: [_jsx("span", { class: "absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 text-xs font-bold text-muted-foreground", children: "$" }), _jsx("input", { id: "service-price", name: "base_price", type: "number", min: 0, step: 0.01, class: "uk-input rounded-xl border-2 font-bold h-10 sm:h-11 pl-6 sm:pl-8 pr-2 text-xs sm:text-sm", value: (service.base_price_cents / 100).toFixed(2) })] })] }), _jsxs("div", { class: "grid gap-1", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "service-duration", children: "Est. Duration" }), _jsxs("div", { class: "relative", children: [_jsx("input", { id: "service-duration", name: "base_duration_minutes", type: "number", min: 1, class: "uk-input rounded-xl border-2 font-bold h-10 sm:h-11 pr-8 sm:pr-12 pl-2 text-xs sm:text-sm", value: service.base_duration_minutes }), _jsx("span", { class: "absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 text-[8px] sm:text-[10px] font-black text-muted-foreground uppercase", children: "Min" })] })] }), _jsxs("div", { class: "grid gap-1 col-span-2 sm:col-span-1", children: [_jsx("label", { class: "text-[9px] sm:text-[10px] font-black uppercase tracking-wider text-muted-foreground ml-1", for: "assign-method", children: "Assignment Logic" }), _jsxs("select", { id: "assign-method", name: "auto_assign_method", class: "uk-select rounded-xl border-2 font-bold h-10 sm:h-11 text-xs sm:text-sm px-2 sm:px-3", children: [_jsx("option", { value: "balanced", selected: service.auto_assign_method === 'balanced', children: "Balanced" }), _jsx("option", { value: "prioritized", selected: service.auto_assign_method === 'prioritized', children: "Prioritized" }), _jsx("option", { value: "drive_time", selected: service.auto_assign_method === 'drive_time', children: "Drive Time" })] })] }), _jsxs("div", { class: "flex flex-col justify-end gap-2 pb-0.5", children: [_jsxs("label", { class: "uk-form-label flex items-center gap-2 cursor-pointer text-[10px] sm:text-xs font-bold uppercase tracking-tight", children: [_jsx("input", { type: "checkbox", name: "auto_assign_enabled", checked: Boolean(service.auto_assign_enabled), class: "uk-toggle-switch uk-toggle-switch-primary" }), "Auto-assign"] }), _jsxs("label", { class: "uk-form-label flex items-center gap-2 cursor-pointer text-[10px] sm:text-xs font-bold uppercase tracking-tight", children: [_jsx("input", { type: "checkbox", name: "is_active", checked: Boolean(service.is_active), class: "uk-toggle-switch uk-toggle-switch-primary" }), "Active"] })] })] })] }) }) }), _jsx("div", { class: "uk-card uk-card-body", children: _jsxs("section", { children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Modifiers" }), _jsx("div", { class: "uk-overflow-auto mb-4", children: _jsxs("table", { class: "uk-table uk-table-divider uk-table-hover uk-table-sm text-sm", children: [_jsx("thead", { children: _jsxs("tr", { children: [_jsx("th", { class: "text-left", children: "Name" }), _jsx("th", { class: "text-left", children: "Price" }), _jsx("th", { class: "text-left", children: "Duration" }), _jsx("th", { class: "text-left", children: "Required" }), _jsx("th", { class: "text-left", children: "Action" })] }) }), _jsxs("tbody", { children: [modifiers.map((mod) => (_jsxs("tr", { children: [_jsx("td", { children: mod.name }), _jsxs("td", { children: ["$", (mod.price_adjustment_cents / 100).toFixed(2)] }), _jsxs("td", { children: [mod.duration_adjustment_minutes, " min"] }), _jsx("td", { children: mod.is_required ? 'Yes' : 'No' }), _jsx("td", { children: _jsx("button", { type: "button", class: "delete-btn", "hx-post": `/admin/services/${service.id}/modifiers/${mod.id}/delete`, "data-confirm": "arm", "hx-target": "#page-content", "hx-select": "#page-content", children: "Delete" }) })] }, mod.id))), modifiers.length === 0 && (_jsx("tr", { children: _jsx("td", { colspan: 5, class: "text-muted-foreground", children: "No modifiers yet." }) }))] })] }) }), _jsxs("form", { "hx-post": `/admin/services/${service.id}/modifiers`, "hx-target": "#page-content", "hx-select": "#page-content", children: [_jsxs("div", { class: "grid gap-3 sm:grid-cols-2", children: [_jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "mod-name", children: "Name" }), _jsx("input", { id: "mod-name", name: "name", class: "uk-input", required: true })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "mod-required", children: "Required" }), _jsxs("label", { class: "flex items-center gap-2 text-sm", children: [_jsx("input", { id: "mod-required", name: "is_required", type: "checkbox", class: "uk-checkbox" }), "Required"] })] }), _jsxs("div", { class: "grid gap-2 sm:col-span-2", children: [_jsx("label", { class: "uk-form-label", for: "mod-description", children: "Description" }), _jsx("input", { id: "mod-description", name: "description", class: "uk-input" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "mod-price", children: "Price Adjustment ($)" }), _jsx("input", { id: "mod-price", name: "price_adjustment", type: "number", step: 0.01, class: "uk-input", value: "0" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "mod-duration", children: "Duration adjustment (minutes)" }), _jsx("input", { id: "mod-duration", name: "duration_adjustment_minutes", type: "number", class: "uk-input", value: "0" })] })] }), _jsx("div", { class: "mt-4", children: _jsx("button", { type: "submit", class: "uk-btn uk-btn-default", children: "Add Modifier" }) })] })] }) }), _jsx("div", { class: "uk-card uk-card-body", children: _jsxs("section", { children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Price Rules" }), _jsx("div", { class: "uk-overflow-auto mb-4", children: _jsxs("table", { class: "uk-table uk-table-divider uk-table-hover uk-table-sm text-sm", children: [_jsx("thead", { children: _jsxs("tr", { children: [_jsx("th", { class: "text-left", children: "Type" }), _jsx("th", { class: "text-left", children: "Adjustment" }), _jsx("th", { class: "text-left", children: "Details" }), _jsx("th", { class: "text-left", children: "Action" })] }) }), _jsxs("tbody", { children: [priceRules.map((rule) => (_jsxs("tr", { children: [_jsx("td", { children: rule.rule_type }), _jsxs("td", { children: [rule.direction, " ", rule.adjustment_type === 'percentage' ? `${rule.adjustment_value}%` : `$${(rule.adjustment_value / 100).toFixed(2)}`] }), _jsx("td", { children: formatRuleDetails(rule) }), _jsx("td", { children: _jsx("button", { type: "button", class: "delete-btn", "hx-post": `/admin/services/${service.id}/rules/${rule.id}/delete`, "data-confirm": "arm", "hx-target": "#page-content", "hx-select": "#page-content", children: "Delete" }) })] }, rule.id))), priceRules.length === 0 && (_jsx("tr", { children: _jsx("td", { colspan: 4, class: "text-muted-foreground", children: "No price rules yet." }) }))] })] }) }), _jsxs("form", { "hx-post": `/admin/services/${service.id}/rules`, "hx-target": "#page-content", "hx-select": "#page-content", children: [_jsxs("div", { class: "grid gap-3 sm:grid-cols-2", children: [_jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "rule-type", children: "Rule Type" }), _jsxs("select", { id: "rule-type", name: "rule_type", class: "uk-select", children: [_jsx("option", { value: "time_of_day", children: "Time of Day" }), _jsx("option", { value: "day_of_week", children: "Day of Week" }), _jsx("option", { value: "lead_time", children: "Lead Time" }), _jsx("option", { value: "territory", children: "Territory" })] })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "adjustment-type", children: "Adjustment Type" }), _jsxs("select", { id: "adjustment-type", name: "adjustment_type", class: "uk-select", children: [_jsx("option", { value: "flat", children: "Flat" }), _jsx("option", { value: "percentage", children: "Percentage" })] })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "adjustment-value", children: "Adjustment Value ($ or %)" }), _jsx("input", { id: "adjustment-value", name: "adjustment_value", type: "number", step: 0.01, class: "uk-input", value: "0" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "direction", children: "Direction" }), _jsxs("select", { id: "direction", name: "direction", class: "uk-select", children: [_jsx("option", { value: "surcharge", children: "Surcharge" }), _jsx("option", { value: "discount", children: "Discount" })] })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "days-of-week", children: "Days of Week (csv)" }), _jsx("input", { id: "days-of-week", name: "days_of_week", class: "uk-input", placeholder: "1,2,3" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "rule-territory", children: "Territory" }), _jsxs("select", { id: "rule-territory", name: "territory_id", class: "uk-select", children: [_jsx("option", { value: "", children: "Any territory" }), territories.map((t) => (_jsx("option", { value: t.id, children: t.name }, t.id)))] })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "start-time", children: "Start Time" }), _jsx("input", { id: "start-time", name: "start_time", type: "time", class: "uk-input" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "end-time", children: "End Time" }), _jsx("input", { id: "end-time", name: "end_time", type: "time", class: "uk-input" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "min-hours", children: "Min Hours Ahead" }), _jsx("input", { id: "min-hours", name: "min_hours_ahead", type: "number", min: 0, class: "uk-input" })] }), _jsxs("div", { class: "grid gap-2", children: [_jsx("label", { class: "uk-form-label", for: "max-hours", children: "Max Hours Ahead" }), _jsx("input", { id: "max-hours", name: "max_hours_ahead", type: "number", min: 0, class: "uk-input" })] })] }), _jsx("div", { class: "mt-4", children: _jsx("button", { type: "submit", class: "uk-btn uk-btn-default", children: "Add Price Rule" }) })] })] }) }), _jsx("div", { class: "uk-card uk-card-body", children: _jsxs("section", { children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "Required Skills" }), _jsxs("div", { class: "flex flex-wrap gap-2 mb-4", children: [requiredSkills.map((skill) => {
                                                const keep = requiredSkills.filter((s) => s.id !== skill.id);
                                                return (_jsxs("form", { "hx-post": `/admin/services/${service.id}/skills`, "hx-target": "#page-content", "hx-select": "#page-content", class: "flex items-center gap-1", children: [keep.map((s) => _jsx("input", { type: "hidden", name: "skill_ids", value: s.id }, s.id)), _jsx("span", { class: "uk-label", children: skill.name }), _jsx("button", { type: "submit", class: "uk-btn uk-btn-default uk-btn-sm", children: "x" })] }, skill.id));
                                            }), requiredSkills.length === 0 && _jsx("span", { class: "text-sm text-muted-foreground", children: "No required skills." })] }), _jsxs("form", { "hx-post": `/admin/services/${service.id}/skills`, "hx-target": "#page-content", "hx-select": "#page-content", class: "flex items-end gap-3", children: [requiredSkills.map((skill) => _jsx("input", { type: "hidden", name: "skill_ids", value: skill.id }, skill.id)), _jsxs("div", { class: "grid gap-2 flex-1", children: [_jsx("label", { class: "uk-form-label", for: "skill-id", children: "Add Skill" }), _jsxs("select", { id: "skill-id", name: "skill_ids", class: "uk-select", children: [_jsx("option", { value: "", children: "Select skill..." }), allSkills.map((skill) => _jsx("option", { value: skill.id, children: skill.name }, skill.id))] })] }), _jsx("button", { type: "submit", class: "uk-btn uk-btn-default", children: "Add" })] })] }) }), _jsx("div", { class: "uk-card uk-card-body danger-card", children: _jsxs("section", { children: [_jsx("h3", { class: "text-base font-semibold mb-3", children: "Delete" }), _jsx("button", { type: "button", class: "delete-btn", "hx-post": `/admin/services/${service.id}/delete`, "data-confirm": "arm", "hx-target": "#page-content", children: "Delete Service" })] }) })] }) })] }));
};
//# sourceMappingURL=service-detail.js.map