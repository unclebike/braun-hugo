import { jsx as _jsx, jsxs as _jsxs } from "hono/jsx/jsx-runtime";
import { Layout } from './layout';
const segmentCount = (len) => len <= 160 ? 1 : Math.ceil(len / 153);
export const SmsSettingsPage = ({ config, templates, stats }) => (_jsxs(Layout, { title: "SMS Settings", children: [_jsx("div", { class: "page-header", children: _jsx("h2", { children: "SMS Settings" }) }), _jsx("div", { class: "p-4 md:p-8", children: _jsxs("div", { class: "grid gap-4 md:gap-6", style: "max-width: 800px;", children: [_jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-3", children: "Twilio Configuration" }), _jsxs("form", { "hx-post": "/admin/sms-settings", "hx-target": "#page-content", "hx-select": "#page-content", class: "grid gap-3", children: [_jsxs("div", { class: "grid gap-1", children: [_jsx("label", { class: "text-sm font-medium", for: "twilio-sid", children: "Account SID" }), _jsx("input", { type: "text", name: "account_sid", id: "twilio-sid", class: "uk-input", value: config?.accountSid || '', placeholder: "ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx", autocomplete: "off", autocapitalize: "off", spellcheck: "false" })] }), _jsxs("div", { class: "grid gap-1", children: [_jsx("label", { class: "text-sm font-medium", for: "twilio-token", children: "Auth Token" }), _jsx("input", { type: "password", name: "auth_token", id: "twilio-token", class: "uk-input", value: config?.authToken || '', placeholder: "Your Twilio auth token", autocomplete: "off", autocapitalize: "off", spellcheck: "false" })] }), _jsxs("div", { class: "grid gap-1", children: [_jsx("label", { class: "text-sm font-medium", for: "twilio-phone", children: "Phone Number (E.164)" }), _jsx("input", { type: "tel", name: "phone_number", id: "twilio-phone", class: "uk-input", value: config?.phoneNumber || '', placeholder: "+18005551234", autocomplete: "tel", inputmode: "tel" })] }), _jsxs("div", { class: "flex items-center gap-2", children: [_jsx("input", { type: "checkbox", name: "enabled", id: "twilio-enabled", value: "1", checked: !!config?.enabled, class: "uk-checkbox" }), _jsx("label", { for: "twilio-enabled", class: "text-sm", children: "Enable SMS sending" })] }), _jsx("div", { children: _jsx("button", { type: "submit", class: "uk-btn uk-btn-primary uk-btn-sm", children: "Save Twilio Config" }) })] })] }), stats && (_jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-4", children: "SMS Usage" }), _jsxs("div", { class: "grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm", children: [_jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Total" }), _jsx("span", { class: "font-semibold text-lg", children: stats.total || 0 })] }), _jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Sent" }), _jsx("span", { class: "font-semibold text-lg", children: stats.sent || 0 })] }), _jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Received" }), _jsx("span", { class: "font-semibold text-lg", children: stats.received || 0 })] }), _jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Failed" }), _jsx("span", { class: "font-semibold text-lg", style: "color:var(--destructive,#dc2626);", children: stats.failed || 0 })] })] }), stats.total_segments > 0 && (_jsxs("p", { class: "text-xs text-muted-foreground mt-2", children: ["Total segments: ", stats.total_segments, " (each segment \u2248 $0.0079 USD)"] }))] })), _jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-2", children: "Message Templates" }), _jsxs("p", { class: "text-sm text-muted-foreground mb-3", children: ["Available variables: ", '{{first_name}} {{last_name}} {{service_name}} {{date}} {{time}} {{provider_name}} {{total}}'] }), _jsx("div", { class: "grid gap-3", children: templates.map((tpl) => (_jsxs("form", { "hx-post": `/admin/sms-templates/${tpl.id}`, "hx-swap": "none", class: "grid gap-2", style: "border-bottom:1px solid var(--border);padding-bottom:12px;", children: [_jsxs("div", { class: "flex items-start justify-between gap-2", children: [_jsx("label", { class: "text-sm font-medium leading-tight", for: `tpl-body-${tpl.id}`, children: tpl.label }), _jsxs("div", { class: "flex items-center gap-1.5 shrink-0", children: [_jsx("input", { type: "checkbox", name: "is_active", value: "1", checked: !!tpl.is_active, class: "uk-checkbox" }), _jsx("span", { class: "text-[11px] text-muted-foreground", children: tpl.event_type })] })] }), _jsx("textarea", { name: "body_template", id: `tpl-body-${tpl.id}`, class: "uk-textarea text-sm", rows: 3, autocapitalize: "off", spellcheck: "false", style: "font-family:monospace;resize:vertical;", oninput: `var c=this.value.length;var s=c<=160?1:Math.ceil(c/153);this.closest('form').querySelector('.tpl-chars').textContent=c+' chars Â· '+s+' segment'+(s>1?'s':'');`, children: tpl.body_template }), _jsxs("div", { class: "flex items-center justify-between", children: [_jsxs("span", { class: "tpl-chars text-[11px] text-muted-foreground", children: [tpl.body_template.length, " chars \u00B7 ", segmentCount(tpl.body_template.length), " segment", segmentCount(tpl.body_template.length) > 1 ? 's' : ''] }), _jsx("button", { type: "submit", class: "uk-btn uk-btn-default uk-btn-sm", children: "Save" })] })] }))) })] }), _jsxs("div", { class: "uk-card uk-card-body", children: [_jsx("h3", { class: "text-base font-semibold mb-2", children: "Webhook URLs" }), _jsx("p", { class: "text-sm text-muted-foreground mb-2", children: "Configure these in your Twilio phone number settings:" }), _jsxs("div", { class: "grid gap-2 text-sm", children: [_jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Inbound SMS Webhook:" }), _jsx("code", { class: "block mt-1 break-all", style: "font-size:12px;", children: "https://api.unclebike.xyz/webhooks/twilio/inbound" })] }), _jsxs("div", { children: [_jsx("span", { class: "text-muted-foreground block", children: "Status Callback:" }), _jsx("code", { class: "block mt-1 break-all", style: "font-size:12px;", children: "https://api.unclebike.xyz/webhooks/twilio/status" })] })] })] })] }) })] }));
//# sourceMappingURL=sms-settings.js.map