{
  "version": 3,
  "sources": ["../src/services/twilio.ts", "../node_modules/hono/dist/compose.js", "../node_modules/hono/dist/http-exception.js", "../node_modules/hono/dist/request/constants.js", "../node_modules/hono/dist/utils/body.js", "../node_modules/hono/dist/utils/url.js", "../node_modules/hono/dist/request.js", "../node_modules/hono/dist/utils/html.js", "../node_modules/hono/dist/context.js", "../node_modules/hono/dist/router.js", "../node_modules/hono/dist/utils/constants.js", "../node_modules/hono/dist/hono-base.js", "../node_modules/hono/dist/router/reg-exp-router/matcher.js", "../node_modules/hono/dist/router/reg-exp-router/node.js", "../node_modules/hono/dist/router/reg-exp-router/trie.js", "../node_modules/hono/dist/router/reg-exp-router/router.js", "../node_modules/hono/dist/router/smart-router/router.js", "../node_modules/hono/dist/router/trie-router/node.js", "../node_modules/hono/dist/router/trie-router/router.js", "../node_modules/hono/dist/hono.js", "../node_modules/hono/dist/middleware/cors/index.js", "../node_modules/hono/dist/helper/factory/index.js", "../src/middleware/auth.ts", "../src/geo/service-area.ts", "../src/routes/admin.ts", "../src/utils/line-items.ts", "../node_modules/hono/dist/helper/html/index.js", "../node_modules/hono/dist/jsx/constants.js", "../node_modules/hono/dist/jsx/dom/utils.js", "../node_modules/hono/dist/jsx/dom/context.js", "../node_modules/hono/dist/jsx/context.js", "../node_modules/hono/dist/jsx/intrinsic-element/common.js", "../node_modules/hono/dist/jsx/intrinsic-element/components.js", "../node_modules/hono/dist/jsx/children.js", "../node_modules/hono/dist/jsx/utils.js", "../node_modules/hono/dist/jsx/base.js", "../node_modules/hono/dist/jsx/jsx-dev-runtime.js", "../src/views/layout.tsx", "../src/views/components.tsx", "../src/views/branding.tsx", "../src/utils/datetime.ts", "../src/views/message-detail.tsx", "../src/views/dashboard.tsx", "../src/views/job-detail.tsx", "../src/views/job-wizard.tsx", "../src/views/provider-detail.tsx", "../src/views/service-detail.tsx", "../src/views/territory-detail.tsx", "../src/views/sms-settings.tsx", "../node_modules/hono/dist/jsx/dom/intrinsic-element/components.js", "../node_modules/hono/dist/jsx/dom/render.js", "../node_modules/hono/dist/jsx/hooks/index.js", "../node_modules/hono/dist/jsx/dom/hooks/index.js", "../node_modules/hono/dist/jsx/dom/jsx-dev-runtime.js", "../node_modules/hono/dist/jsx/dom/components.js", "../node_modules/hono/dist/jsx/streaming.js", "../node_modules/hono/dist/jsx/components.js", "../src/views/push-settings.tsx", "../src/views/invoice-detail.tsx", "../src/services/notifications.ts", "../src/scheduling/pricing.ts", "../src/routes/bookings.ts", "../src/routes/categories.ts", "../src/routes/coupons.ts", "../src/routes/customers.ts", "../src/routes/invoices.ts", "../src/routes/jobs.ts", "../src/routes/modifiers.ts", "../src/routes/recurring-bookings.ts", "../node_modules/hono/dist/utils/cookie.js", "../node_modules/hono/dist/helper/cookie/index.js", "../node_modules/hono/dist/utils/buffer.js", "../node_modules/hono/dist/validator/validator.js", "../node_modules/@hono/zod-validator/src/index.ts", "../node_modules/zod/v3/external.js", "../node_modules/zod/v3/helpers/util.js", "../node_modules/zod/v3/ZodError.js", "../node_modules/zod/v3/locales/en.js", "../node_modules/zod/v3/errors.js", "../node_modules/zod/v3/helpers/parseUtil.js", "../node_modules/zod/v3/helpers/errorUtil.js", "../node_modules/zod/v3/types.js", "../src/scheduling/timeslots.ts", "../src/routes/scheduling.ts", "../src/routes/services.ts", "../src/routes/skills.ts", "../src/routes/team.ts", "../src/routes/territories.ts", "../src/routes/transactions.ts", "../src/routes/messages.ts", "../src/routes/webhooks.ts", "../src/routes/twilio-webhooks.ts", "../src/widget/embed.ts", "../src/index.ts"],
  "sourceRoot": "dist",
  "sourcesContent": ["/**\n * Twilio SMS service for Cloudflare Workers.\n * Uses fetch-based REST API calls (no Node SDK needed).\n *\n * Twilio credentials are stored in the settings table (key: 'twilio_config')\n * as JSON: { accountSid, authToken, phoneNumber, enabled }\n *\n * All phone numbers stored/compared in E.164 format: +1XXXXXXXXXX\n */\n\n// \u2500\u2500\u2500 Types \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface TwilioConfig {\n  accountSid: string;\n  authToken: string;\n  phoneNumber: string;  // E.164 format\n  enabled: boolean;\n}\n\nexport interface SendSmsResult {\n  success: boolean;\n  twilioSid?: string;\n  error?: string;\n  errorCode?: string;\n}\n\nexport interface TwilioWebhookBody {\n  MessageSid: string;\n  AccountSid: string;\n  From: string;\n  To: string;\n  Body: string;\n  NumSegments: string;\n  NumMedia: string;\n  MessageStatus?: string;\n  ErrorCode?: string;\n  ErrorMessage?: string;\n  SmsStatus?: string;\n}\n\nexport interface TemplateVars {\n  first_name?: string;\n  last_name?: string;\n  service_name?: string;\n  date?: string;\n  time?: string;\n  provider_name?: string;\n  total?: string;\n  [key: string]: string | undefined;\n}\n\n// \u2500\u2500\u2500 Config \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport async function getTwilioConfig(db: D1Database): Promise<TwilioConfig | null> {\n  try {\n    const row = await db.prepare(\"SELECT value FROM settings WHERE key = 'twilio_config'\").first<{ value: string }>();\n    if (!row) return null;\n    const config = JSON.parse(row.value) as TwilioConfig;\n    if (!config.accountSid || !config.authToken || !config.phoneNumber) return null;\n    return config;\n  } catch {\n    return null;\n  }\n}\n\nexport async function isTwilioEnabled(db: D1Database): Promise<boolean> {\n  const config = await getTwilioConfig(db);\n  return !!config?.enabled;\n}\n\n// \u2500\u2500\u2500 Phone Normalization \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Normalize a phone number to E.164 format (+1XXXXXXXXXX) for North America.\n * Strips all non-digit characters, handles common formats:\n *   (613) 555-1234 \u2192 +16135551234\n *   613-555-1234   \u2192 +16135551234\n *   1-613-555-1234 \u2192 +16135551234\n *   +16135551234   \u2192 +16135551234\n *   6135551234     \u2192 +16135551234\n *\n * Returns null if the number can't be normalized to a valid NANP number.\n */\nexport function normalizePhoneE164(raw: string | null | undefined): string | null {\n  if (!raw) return null;\n\n  // Strip everything except digits and leading +\n  const stripped = raw.replace(/[^\\d+]/g, '');\n  const digits = stripped.replace(/\\+/g, '');\n\n  // Already has country code\n  if (digits.length === 11 && digits.startsWith('1')) {\n    return `+${digits}`;\n  }\n\n  // 10-digit NANP number \u2014 prepend country code\n  if (digits.length === 10) {\n    return `+1${digits}`;\n  }\n\n  // Already E.164 with +\n  if (stripped.startsWith('+1') && digits.length === 11) {\n    return `+${digits}`;\n  }\n\n  return null; // Can't normalize\n}\n\n/**\n * Validate that a string is a valid E.164 phone number (North America).\n */\nexport function isValidE164(phone: string): boolean {\n  return /^\\+1\\d{10}$/.test(phone);\n}\n\n// \u2500\u2500\u2500 Template Rendering \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Render a template string with {{variable}} substitution.\n * Unknown variables are replaced with empty string.\n */\nexport function renderTemplate(template: string, vars: TemplateVars): string {\n  return template.replace(/\\{\\{(\\w+)\\}\\}/g, (_match, key: string) => {\n    return vars[key] ?? '';\n  });\n}\n\n/**\n * Count SMS segments. GSM-7 = 160 chars/segment, UCS-2 = 70 chars/segment.\n * Multipart: GSM-7 = 153 chars/segment, UCS-2 = 67 chars/segment.\n */\nexport function countSegments(text: string): number {\n  const isGsm7 = /^[\\x20-\\x7e\\r\\n]*$/.test(text);\n\n  const charLimit = isGsm7 ? 160 : 70;\n  const multipartLimit = isGsm7 ? 153 : 67;\n\n  if (text.length <= charLimit) return 1;\n  return Math.ceil(text.length / multipartLimit);\n}\n\n// \u2500\u2500\u2500 Send SMS \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Send an SMS via Twilio REST API.\n * Returns the Twilio MessageSid on success.\n */\nexport async function sendSms(\n  config: TwilioConfig,\n  to: string,\n  body: string,\n  statusCallbackUrl?: string\n): Promise<SendSmsResult> {\n  if (!config.enabled) {\n    return { success: false, error: 'Twilio is not enabled' };\n  }\n\n  if (!isValidE164(to)) {\n    return { success: false, error: `Invalid phone number: ${to}` };\n  }\n\n  const endpoint = `https://api.twilio.com/2010-04-01/Accounts/${config.accountSid}/Messages.json`;\n  const params = new URLSearchParams({\n    To: to,\n    From: config.phoneNumber,\n    Body: body,\n  });\n\n  if (statusCallbackUrl) {\n    params.set('StatusCallback', statusCallbackUrl);\n  }\n\n  const token = btoa(`${config.accountSid}:${config.authToken}`);\n\n  try {\n    const response = await fetch(endpoint, {\n      method: 'POST',\n      headers: {\n        Authorization: `Basic ${token}`,\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: params,\n    });\n\n    const result = await response.json() as Record<string, unknown>;\n\n    if (!response.ok) {\n      return {\n        success: false,\n        error: (result.message as string) || `HTTP ${response.status}`,\n        errorCode: String(result.code || ''),\n      };\n    }\n\n    return {\n      success: true,\n      twilioSid: result.sid as string,\n    };\n  } catch (err) {\n    return {\n      success: false,\n      error: err instanceof Error ? err.message : 'Unknown error sending SMS',\n    };\n  }\n}\n\n// \u2500\u2500\u2500 Log SMS \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface SmsLogEntry {\n  id?: string;\n  customerId?: string | null;\n  jobId?: string | null;\n  messageId?: string | null;\n  direction: 'outbound' | 'inbound';\n  phoneTo: string;\n  phoneFrom: string;\n  body: string;\n  templateEvent?: string | null;\n  twilioSid?: string | null;\n  status: string;\n  errorCode?: string | null;\n  errorMessage?: string | null;\n  segments?: number;\n}\n\nexport interface EnsureSmsInboxMessageParams {\n  db: D1Database;\n  phoneE164: string;\n  customerId?: string | null;\n  jobId?: string | null;\n  firstName?: string | null;\n  lastName?: string | null;\n  email?: string | null;\n}\n\nexport async function ensureSmsInboxMessage(params: EnsureSmsInboxMessageParams): Promise<string> {\n  const { db, phoneE164, customerId, jobId, firstName, lastName, email } = params;\n\n  const existingByJob = jobId\n    ? await db.prepare(\n      `SELECT id FROM messages\n       WHERE source = 'sms'\n         AND json_extract(metadata, '$.job_id') = ?\n       ORDER BY updated_at DESC\n       LIMIT 1`\n    ).bind(jobId).first<{ id: string }>()\n    : null;\n\n  if (existingByJob?.id) return existingByJob.id;\n\n  const existingByPhone = await db.prepare(\n    `SELECT id, json_extract(metadata, '$.job_id') as existing_job_id\n     FROM messages\n     WHERE source = 'sms' AND phone = ?\n     ORDER BY updated_at DESC\n     LIMIT 1`\n  ).bind(phoneE164).first<{ id: string; existing_job_id: string | null }>();\n\n  if (existingByPhone?.id) {\n    const existingJobId = existingByPhone.existing_job_id || null;\n    const canReuseByPhone =\n      (jobId && existingJobId === jobId) ||\n      (!jobId && !existingJobId);\n\n    if (!canReuseByPhone) {\n      const id = crypto.randomUUID();\n      await db.prepare(\n        `INSERT INTO messages\n         (id, source, status, first_name, last_name, email, phone, reason, subject, body, metadata, is_read, created_at, updated_at)\n         VALUES (?, 'sms', 'new', ?, ?, ?, ?, 'sms', ?, ?, ?, 0, datetime('now'), datetime('now'))`\n      ).bind(\n        id,\n        firstName || null,\n        lastName || null,\n        email || null,\n        phoneE164,\n        `SMS thread - ${phoneE164}`,\n        '',\n        JSON.stringify({ type: 'sms_thread', phone_e164: phoneE164, customer_id: customerId || null, job_id: jobId || null }),\n      ).run();\n      return id;\n    }\n\n    await db.prepare(\n      `UPDATE messages\n       SET metadata = ?, updated_at = datetime('now')\n       WHERE id = ?`\n    ).bind(\n      JSON.stringify({ type: 'sms_thread', phone_e164: phoneE164, customer_id: customerId || null, job_id: jobId || null }),\n      existingByPhone.id,\n    ).run();\n    return existingByPhone.id;\n  }\n\n  const id = crypto.randomUUID();\n  await db.prepare(\n    `INSERT INTO messages\n     (id, source, status, first_name, last_name, email, phone, reason, subject, body, metadata, is_read, created_at, updated_at)\n     VALUES (?, 'sms', 'new', ?, ?, ?, ?, 'sms', ?, ?, ?, 0, datetime('now'), datetime('now'))`\n  ).bind(\n    id,\n    firstName || null,\n    lastName || null,\n    email || null,\n    phoneE164,\n    `SMS thread - ${phoneE164}`,\n    '',\n    JSON.stringify({ type: 'sms_thread', phone_e164: phoneE164, customer_id: customerId || null, job_id: jobId || null }),\n  ).run();\n\n  return id;\n}\n\nexport async function touchSmsInboxMessage(db: D1Database, messageId: string, previewText: string): Promise<void> {\n  await db.prepare(\n    `UPDATE messages\n     SET status = 'new',\n         is_read = 0,\n         read_at = NULL,\n         body = ?,\n         updated_at = datetime('now')\n     WHERE id = ?`\n  ).bind(previewText, messageId).run();\n}\n\nexport async function logSms(db: D1Database, entry: SmsLogEntry): Promise<string> {\n  const id = entry.id || crypto.randomUUID();\n  await db.prepare(\n    `INSERT INTO sms_log\n     (id, customer_id, job_id, message_id, direction, phone_to, phone_from, body, template_event, twilio_sid, status, error_code, error_message, segments, created_at, updated_at)\n     VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n  ).bind(\n    id,\n    entry.customerId || null,\n    entry.jobId || null,\n    entry.messageId || null,\n    entry.direction,\n    entry.phoneTo,\n    entry.phoneFrom,\n    entry.body,\n    entry.templateEvent || null,\n    entry.twilioSid || null,\n    entry.status,\n    entry.errorCode || null,\n    entry.errorMessage || null,\n    entry.segments || 1\n  ).run();\n  return id;\n}\n\nexport async function updateSmsStatus(\n  db: D1Database,\n  twilioSid: string,\n  status: string,\n  errorCode?: string,\n  errorMessage?: string\n): Promise<void> {\n  await db.prepare(\n    `UPDATE sms_log SET status = ?, error_code = ?, error_message = ?, updated_at = datetime('now') WHERE twilio_sid = ?`\n  ).bind(status, errorCode || null, errorMessage || null, twilioSid).run();\n}\n\n// \u2500\u2500\u2500 Webhook Validation \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Validate that an incoming webhook request is actually from Twilio.\n * Uses HMAC-SHA1 signature verification with auth token as key.\n *\n * For Cloudflare Workers: uses Web Crypto API (no node:crypto).\n *\n * @param authToken - Twilio auth token (HMAC key)\n * @param signature - Value of X-Twilio-Signature header\n * @param url - The full URL Twilio is hitting (must match exactly what Twilio has configured)\n * @param params - The POST body parameters as key-value pairs\n */\nexport async function validateTwilioSignature(\n  authToken: string,\n  signature: string,\n  url: string,\n  params: Record<string, string>\n): Promise<boolean> {\n  // Build the data string: URL + sorted params concatenated\n  let data = url;\n  const sortedKeys = Object.keys(params).sort();\n  for (const key of sortedKeys) {\n    data += key + params[key];\n  }\n\n  const encoder = new TextEncoder();\n  const key = await crypto.subtle.importKey(\n    'raw',\n    encoder.encode(authToken),\n    { name: 'HMAC', hash: 'SHA-1' },\n    false,\n    ['sign']\n  );\n\n  const signatureBytes = await crypto.subtle.sign('HMAC', key, encoder.encode(data));\n  const computedSignature = btoa(String.fromCharCode(...new Uint8Array(signatureBytes)));\n\n  return computedSignature === signature;\n}\n\n// \u2500\u2500\u2500 Quiet Hours \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Check if current time is within quiet hours (9pm - 9am Eastern).\n * Returns true if it's currently quiet hours and SMS should be deferred.\n */\nexport function isQuietHours(): boolean {\n  const now = new Date();\n  // Convert to Eastern Time\n  const eastern = new Date(now.toLocaleString('en-US', { timeZone: 'America/Toronto' }));\n  const hour = eastern.getHours();\n  return hour < 9 || hour >= 21;\n}\n\n// \u2500\u2500\u2500 Consent Check \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface CustomerSmsStatus {\n  hasConsent: boolean;\n  isOptedOut: boolean;\n  phoneE164: string | null;\n}\n\nexport async function getCustomerSmsStatus(db: D1Database, customerId: string): Promise<CustomerSmsStatus> {\n  const row = await db.prepare(\n    'SELECT sms_consent, sms_opted_out, phone_e164 FROM customers WHERE id = ?'\n  ).bind(customerId).first<{ sms_consent: number; sms_opted_out: number; phone_e164: string | null }>();\n\n  if (!row) {\n    return { hasConsent: false, isOptedOut: false, phoneE164: null };\n  }\n\n  return {\n    hasConsent: row.sms_consent === 1,\n    isOptedOut: row.sms_opted_out === 1,\n    phoneE164: row.phone_e164,\n  };\n}\n\n/**\n * Check if we're allowed to send an automated SMS to this customer.\n * Requires: consent given, not opted out, valid phone.\n */\nexport function canSendAutomatedSms(status: CustomerSmsStatus): boolean {\n  return status.hasConsent && !status.isOptedOut && !!status.phoneE164;\n}\n\n// \u2500\u2500\u2500 High-Level Send \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface SendJobSmsParams {\n  db: D1Database;\n  jobId: string;\n  customerId: string;\n  eventType: string;\n  vars: TemplateVars;\n  statusCallbackUrl?: string;\n  messageId?: string | null;\n  skipConsentCheck?: boolean;  // For admin-initiated replies\n  skipQuietHours?: boolean;    // For admin-initiated replies\n}\n\n/**\n * High-level function to send a templated SMS for a job event.\n * Handles: config check, consent check, quiet hours, template lookup, send, and logging.\n * Returns the sms_log id on success, or null if skipped/failed.\n */\nexport async function sendJobSms(params: SendJobSmsParams): Promise<string | null> {\n  const { db, jobId, customerId, eventType, vars, statusCallbackUrl, messageId, skipConsentCheck, skipQuietHours } = params;\n\n  // 1. Check Twilio config\n  const config = await getTwilioConfig(db);\n  if (!config?.enabled) {\n    console.log(`[sms] Twilio not configured/enabled, skipping ${eventType}`);\n    return null;\n  }\n\n  // 2. Check consent + opt-out\n  if (!skipConsentCheck) {\n    const smsStatus = await getCustomerSmsStatus(db, customerId);\n    if (!canSendAutomatedSms(smsStatus)) {\n      console.log(`[sms] Customer ${customerId} not eligible for SMS (consent=${smsStatus.hasConsent}, optedOut=${smsStatus.isOptedOut}, phone=${smsStatus.phoneE164})`);\n      return null;\n    }\n  }\n\n  // 3. Quiet hours check\n  if (!skipQuietHours && isQuietHours()) {\n    console.log(`[sms] Quiet hours active, skipping ${eventType} for job ${jobId}`);\n    // TODO: Queue for later delivery when we add scheduled sending\n    return null;\n  }\n\n  // 4. Look up template\n  const template = await db.prepare(\n    'SELECT body_template, is_active FROM sms_templates WHERE event_type = ?'\n  ).bind(eventType).first<{ body_template: string; is_active: number }>();\n\n  if (!template || !template.is_active) {\n    console.log(`[sms] Template ${eventType} not found or disabled`);\n    return null;\n  }\n\n  // 5. Get customer phone\n  const customer = await db.prepare(\n    'SELECT phone_e164, phone FROM customers WHERE id = ?'\n  ).bind(customerId).first<{ phone_e164: string | null; phone: string | null }>();\n\n  const phoneTo = customer?.phone_e164 || normalizePhoneE164(customer?.phone);\n  if (!phoneTo) {\n    console.log(`[sms] No valid phone for customer ${customerId}`);\n    return null;\n  }\n\n  // 6. Render template\n  const body = renderTemplate(template.body_template, vars);\n  const segments = countSegments(body);\n\n  // 7. Send\n  const result = await sendSms(config, phoneTo, body, statusCallbackUrl);\n\n  // 8. Log\n  const logId = await logSms(db, {\n    customerId,\n    jobId,\n    messageId: messageId || null,\n    direction: 'outbound',\n    phoneTo,\n    phoneFrom: config.phoneNumber,\n    body,\n    templateEvent: eventType,\n    twilioSid: result.twilioSid || null,\n    status: result.success ? 'sent' : 'failed',\n    errorCode: result.errorCode || null,\n    errorMessage: result.error || null,\n    segments,\n  });\n\n  if (!result.success) {\n    console.error(`[sms] Failed to send ${eventType} for job ${jobId}: ${result.error}`);\n  }\n\n  return logId;\n}\n\n// \u2500\u2500\u2500 Admin Direct Send \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface SendDirectSmsParams {\n  db: D1Database;\n  to: string;           // E.164 phone number\n  body: string;         // Raw message body\n  customerId?: string;\n  jobId?: string;\n  messageId?: string;   // Link back to inbox message if replying\n  statusCallbackUrl?: string;\n}\n\n/**\n * Send a direct SMS (admin reply). Bypasses template system and consent check.\n * Still requires Twilio to be configured and enabled.\n */\nexport async function sendDirectSms(params: SendDirectSmsParams): Promise<{ logId: string; success: boolean; error?: string }> {\n  const { db, to, body, customerId, jobId, messageId, statusCallbackUrl } = params;\n\n  const config = await getTwilioConfig(db);\n  if (!config?.enabled) {\n    return { logId: '', success: false, error: 'Twilio is not configured or enabled' };\n  }\n\n  const result = await sendSms(config, to, body, statusCallbackUrl);\n  const segments = countSegments(body);\n\n  const logId = await logSms(db, {\n    customerId: customerId || null,\n    jobId: jobId || null,\n    messageId: messageId || null,\n    direction: 'outbound',\n    phoneTo: to,\n    phoneFrom: config.phoneNumber,\n    body,\n    twilioSid: result.twilioSid || null,\n    status: result.success ? 'sent' : 'failed',\n    errorCode: result.errorCode || null,\n    errorMessage: result.error || null,\n    segments,\n  });\n\n  return { logId, success: result.success, error: result.error };\n}\n", "// src/compose.ts\nvar compose = (middleware, onError, onNotFound) => {\n  return (context, next) => {\n    let index = -1;\n    return dispatch(0);\n    async function dispatch(i) {\n      if (i <= index) {\n        throw new Error(\"next() called multiple times\");\n      }\n      index = i;\n      let res;\n      let isError = false;\n      let handler;\n      if (middleware[i]) {\n        handler = middleware[i][0][0];\n        context.req.routeIndex = i;\n      } else {\n        handler = i === middleware.length && next || void 0;\n      }\n      if (handler) {\n        try {\n          res = await handler(context, () => dispatch(i + 1));\n        } catch (err) {\n          if (err instanceof Error && onError) {\n            context.error = err;\n            res = await onError(err, context);\n            isError = true;\n          } else {\n            throw err;\n          }\n        }\n      } else {\n        if (context.finalized === false && onNotFound) {\n          res = await onNotFound(context);\n        }\n      }\n      if (res && (context.finalized === false || isError)) {\n        context.res = res;\n      }\n      return context;\n    }\n  };\n};\nexport {\n  compose\n};\n", "// src/http-exception.ts\nvar HTTPException = class extends Error {\n  res;\n  status;\n  /**\n   * Creates an instance of `HTTPException`.\n   * @param status - HTTP status code for the exception. Defaults to 500.\n   * @param options - Additional options for the exception.\n   */\n  constructor(status = 500, options) {\n    super(options?.message, { cause: options?.cause });\n    this.res = options?.res;\n    this.status = status;\n  }\n  /**\n   * Returns the response object associated with the exception.\n   * If a response object is not provided, a new response is created with the error message and status code.\n   * @returns The response object.\n   */\n  getResponse() {\n    if (this.res) {\n      const newResponse = new Response(this.res.body, {\n        status: this.status,\n        headers: this.res.headers\n      });\n      return newResponse;\n    }\n    return new Response(this.message, {\n      status: this.status\n    });\n  }\n};\nexport {\n  HTTPException\n};\n", "// src/request/constants.ts\nvar GET_MATCH_RESULT = /* @__PURE__ */ Symbol();\nexport {\n  GET_MATCH_RESULT\n};\n", "// src/utils/body.ts\nimport { HonoRequest } from \"../request.js\";\nvar parseBody = async (request, options = /* @__PURE__ */ Object.create(null)) => {\n  const { all = false, dot = false } = options;\n  const headers = request instanceof HonoRequest ? request.raw.headers : request.headers;\n  const contentType = headers.get(\"Content-Type\");\n  if (contentType?.startsWith(\"multipart/form-data\") || contentType?.startsWith(\"application/x-www-form-urlencoded\")) {\n    return parseFormData(request, { all, dot });\n  }\n  return {};\n};\nasync function parseFormData(request, options) {\n  const formData = await request.formData();\n  if (formData) {\n    return convertFormDataToBodyData(formData, options);\n  }\n  return {};\n}\nfunction convertFormDataToBodyData(formData, options) {\n  const form = /* @__PURE__ */ Object.create(null);\n  formData.forEach((value, key) => {\n    const shouldParseAllValues = options.all || key.endsWith(\"[]\");\n    if (!shouldParseAllValues) {\n      form[key] = value;\n    } else {\n      handleParsingAllValues(form, key, value);\n    }\n  });\n  if (options.dot) {\n    Object.entries(form).forEach(([key, value]) => {\n      const shouldParseDotValues = key.includes(\".\");\n      if (shouldParseDotValues) {\n        handleParsingNestedValues(form, key, value);\n        delete form[key];\n      }\n    });\n  }\n  return form;\n}\nvar handleParsingAllValues = (form, key, value) => {\n  if (form[key] !== void 0) {\n    if (Array.isArray(form[key])) {\n      ;\n      form[key].push(value);\n    } else {\n      form[key] = [form[key], value];\n    }\n  } else {\n    if (!key.endsWith(\"[]\")) {\n      form[key] = value;\n    } else {\n      form[key] = [value];\n    }\n  }\n};\nvar handleParsingNestedValues = (form, key, value) => {\n  let nestedForm = form;\n  const keys = key.split(\".\");\n  keys.forEach((key2, index) => {\n    if (index === keys.length - 1) {\n      nestedForm[key2] = value;\n    } else {\n      if (!nestedForm[key2] || typeof nestedForm[key2] !== \"object\" || Array.isArray(nestedForm[key2]) || nestedForm[key2] instanceof File) {\n        nestedForm[key2] = /* @__PURE__ */ Object.create(null);\n      }\n      nestedForm = nestedForm[key2];\n    }\n  });\n};\nexport {\n  parseBody\n};\n", "// src/utils/url.ts\nvar splitPath = (path) => {\n  const paths = path.split(\"/\");\n  if (paths[0] === \"\") {\n    paths.shift();\n  }\n  return paths;\n};\nvar splitRoutingPath = (routePath) => {\n  const { groups, path } = extractGroupsFromPath(routePath);\n  const paths = splitPath(path);\n  return replaceGroupMarks(paths, groups);\n};\nvar extractGroupsFromPath = (path) => {\n  const groups = [];\n  path = path.replace(/\\{[^}]+\\}/g, (match, index) => {\n    const mark = `@${index}`;\n    groups.push([mark, match]);\n    return mark;\n  });\n  return { groups, path };\n};\nvar replaceGroupMarks = (paths, groups) => {\n  for (let i = groups.length - 1; i >= 0; i--) {\n    const [mark] = groups[i];\n    for (let j = paths.length - 1; j >= 0; j--) {\n      if (paths[j].includes(mark)) {\n        paths[j] = paths[j].replace(mark, groups[i][1]);\n        break;\n      }\n    }\n  }\n  return paths;\n};\nvar patternCache = {};\nvar getPattern = (label, next) => {\n  if (label === \"*\") {\n    return \"*\";\n  }\n  const match = label.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n  if (match) {\n    const cacheKey = `${label}#${next}`;\n    if (!patternCache[cacheKey]) {\n      if (match[2]) {\n        patternCache[cacheKey] = next && next[0] !== \":\" && next[0] !== \"*\" ? [cacheKey, match[1], new RegExp(`^${match[2]}(?=/${next})`)] : [label, match[1], new RegExp(`^${match[2]}$`)];\n      } else {\n        patternCache[cacheKey] = [label, match[1], true];\n      }\n    }\n    return patternCache[cacheKey];\n  }\n  return null;\n};\nvar tryDecode = (str, decoder) => {\n  try {\n    return decoder(str);\n  } catch {\n    return str.replace(/(?:%[0-9A-Fa-f]{2})+/g, (match) => {\n      try {\n        return decoder(match);\n      } catch {\n        return match;\n      }\n    });\n  }\n};\nvar tryDecodeURI = (str) => tryDecode(str, decodeURI);\nvar getPath = (request) => {\n  const url = request.url;\n  const start = url.indexOf(\"/\", url.indexOf(\":\") + 4);\n  let i = start;\n  for (; i < url.length; i++) {\n    const charCode = url.charCodeAt(i);\n    if (charCode === 37) {\n      const queryIndex = url.indexOf(\"?\", i);\n      const hashIndex = url.indexOf(\"#\", i);\n      const end = queryIndex === -1 ? hashIndex === -1 ? void 0 : hashIndex : hashIndex === -1 ? queryIndex : Math.min(queryIndex, hashIndex);\n      const path = url.slice(start, end);\n      return tryDecodeURI(path.includes(\"%25\") ? path.replace(/%25/g, \"%2525\") : path);\n    } else if (charCode === 63 || charCode === 35) {\n      break;\n    }\n  }\n  return url.slice(start, i);\n};\nvar getQueryStrings = (url) => {\n  const queryIndex = url.indexOf(\"?\", 8);\n  return queryIndex === -1 ? \"\" : \"?\" + url.slice(queryIndex + 1);\n};\nvar getPathNoStrict = (request) => {\n  const result = getPath(request);\n  return result.length > 1 && result.at(-1) === \"/\" ? result.slice(0, -1) : result;\n};\nvar mergePath = (base, sub, ...rest) => {\n  if (rest.length) {\n    sub = mergePath(sub, ...rest);\n  }\n  return `${base?.[0] === \"/\" ? \"\" : \"/\"}${base}${sub === \"/\" ? \"\" : `${base?.at(-1) === \"/\" ? \"\" : \"/\"}${sub?.[0] === \"/\" ? sub.slice(1) : sub}`}`;\n};\nvar checkOptionalParameter = (path) => {\n  if (path.charCodeAt(path.length - 1) !== 63 || !path.includes(\":\")) {\n    return null;\n  }\n  const segments = path.split(\"/\");\n  const results = [];\n  let basePath = \"\";\n  segments.forEach((segment) => {\n    if (segment !== \"\" && !/\\:/.test(segment)) {\n      basePath += \"/\" + segment;\n    } else if (/\\:/.test(segment)) {\n      if (/\\?/.test(segment)) {\n        if (results.length === 0 && basePath === \"\") {\n          results.push(\"/\");\n        } else {\n          results.push(basePath);\n        }\n        const optionalSegment = segment.replace(\"?\", \"\");\n        basePath += \"/\" + optionalSegment;\n        results.push(basePath);\n      } else {\n        basePath += \"/\" + segment;\n      }\n    }\n  });\n  return results.filter((v, i, a) => a.indexOf(v) === i);\n};\nvar _decodeURI = (value) => {\n  if (!/[%+]/.test(value)) {\n    return value;\n  }\n  if (value.indexOf(\"+\") !== -1) {\n    value = value.replace(/\\+/g, \" \");\n  }\n  return value.indexOf(\"%\") !== -1 ? tryDecode(value, decodeURIComponent_) : value;\n};\nvar _getQueryParam = (url, key, multiple) => {\n  let encoded;\n  if (!multiple && key && !/[%+]/.test(key)) {\n    let keyIndex2 = url.indexOf(\"?\", 8);\n    if (keyIndex2 === -1) {\n      return void 0;\n    }\n    if (!url.startsWith(key, keyIndex2 + 1)) {\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    while (keyIndex2 !== -1) {\n      const trailingKeyCode = url.charCodeAt(keyIndex2 + key.length + 1);\n      if (trailingKeyCode === 61) {\n        const valueIndex = keyIndex2 + key.length + 2;\n        const endIndex = url.indexOf(\"&\", valueIndex);\n        return _decodeURI(url.slice(valueIndex, endIndex === -1 ? void 0 : endIndex));\n      } else if (trailingKeyCode == 38 || isNaN(trailingKeyCode)) {\n        return \"\";\n      }\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    encoded = /[%+]/.test(url);\n    if (!encoded) {\n      return void 0;\n    }\n  }\n  const results = {};\n  encoded ??= /[%+]/.test(url);\n  let keyIndex = url.indexOf(\"?\", 8);\n  while (keyIndex !== -1) {\n    const nextKeyIndex = url.indexOf(\"&\", keyIndex + 1);\n    let valueIndex = url.indexOf(\"=\", keyIndex);\n    if (valueIndex > nextKeyIndex && nextKeyIndex !== -1) {\n      valueIndex = -1;\n    }\n    let name = url.slice(\n      keyIndex + 1,\n      valueIndex === -1 ? nextKeyIndex === -1 ? void 0 : nextKeyIndex : valueIndex\n    );\n    if (encoded) {\n      name = _decodeURI(name);\n    }\n    keyIndex = nextKeyIndex;\n    if (name === \"\") {\n      continue;\n    }\n    let value;\n    if (valueIndex === -1) {\n      value = \"\";\n    } else {\n      value = url.slice(valueIndex + 1, nextKeyIndex === -1 ? void 0 : nextKeyIndex);\n      if (encoded) {\n        value = _decodeURI(value);\n      }\n    }\n    if (multiple) {\n      if (!(results[name] && Array.isArray(results[name]))) {\n        results[name] = [];\n      }\n      ;\n      results[name].push(value);\n    } else {\n      results[name] ??= value;\n    }\n  }\n  return key ? results[key] : results;\n};\nvar getQueryParam = _getQueryParam;\nvar getQueryParams = (url, key) => {\n  return _getQueryParam(url, key, true);\n};\nvar decodeURIComponent_ = decodeURIComponent;\nexport {\n  checkOptionalParameter,\n  decodeURIComponent_,\n  getPath,\n  getPathNoStrict,\n  getPattern,\n  getQueryParam,\n  getQueryParams,\n  getQueryStrings,\n  mergePath,\n  splitPath,\n  splitRoutingPath,\n  tryDecode\n};\n", "// src/request.ts\nimport { HTTPException } from \"./http-exception.js\";\nimport { GET_MATCH_RESULT } from \"./request/constants.js\";\nimport { parseBody } from \"./utils/body.js\";\nimport { decodeURIComponent_, getQueryParam, getQueryParams, tryDecode } from \"./utils/url.js\";\nvar tryDecodeURIComponent = (str) => tryDecode(str, decodeURIComponent_);\nvar HonoRequest = class {\n  /**\n   * `.raw` can get the raw Request object.\n   *\n   * @see {@link https://hono.dev/docs/api/request#raw}\n   *\n   * @example\n   * ```ts\n   * // For Cloudflare Workers\n   * app.post('/', async (c) => {\n   *   const metadata = c.req.raw.cf?.hostMetadata?\n   *   ...\n   * })\n   * ```\n   */\n  raw;\n  #validatedData;\n  // Short name of validatedData\n  #matchResult;\n  routeIndex = 0;\n  /**\n   * `.path` can get the pathname of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#path}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const pathname = c.req.path // `/about/me`\n   * })\n   * ```\n   */\n  path;\n  bodyCache = {};\n  constructor(request, path = \"/\", matchResult = [[]]) {\n    this.raw = request;\n    this.path = path;\n    this.#matchResult = matchResult;\n    this.#validatedData = {};\n  }\n  param(key) {\n    return key ? this.#getDecodedParam(key) : this.#getAllDecodedParams();\n  }\n  #getDecodedParam(key) {\n    const paramKey = this.#matchResult[0][this.routeIndex][1][key];\n    const param = this.#getParamValue(paramKey);\n    return param && /\\%/.test(param) ? tryDecodeURIComponent(param) : param;\n  }\n  #getAllDecodedParams() {\n    const decoded = {};\n    const keys = Object.keys(this.#matchResult[0][this.routeIndex][1]);\n    for (const key of keys) {\n      const value = this.#getParamValue(this.#matchResult[0][this.routeIndex][1][key]);\n      if (value !== void 0) {\n        decoded[key] = /\\%/.test(value) ? tryDecodeURIComponent(value) : value;\n      }\n    }\n    return decoded;\n  }\n  #getParamValue(paramKey) {\n    return this.#matchResult[1] ? this.#matchResult[1][paramKey] : paramKey;\n  }\n  query(key) {\n    return getQueryParam(this.url, key);\n  }\n  queries(key) {\n    return getQueryParams(this.url, key);\n  }\n  header(name) {\n    if (name) {\n      return this.raw.headers.get(name) ?? void 0;\n    }\n    const headerData = {};\n    this.raw.headers.forEach((value, key) => {\n      headerData[key] = value;\n    });\n    return headerData;\n  }\n  async parseBody(options) {\n    return this.bodyCache.parsedBody ??= await parseBody(this, options);\n  }\n  #cachedBody = (key) => {\n    const { bodyCache, raw } = this;\n    const cachedBody = bodyCache[key];\n    if (cachedBody) {\n      return cachedBody;\n    }\n    const anyCachedKey = Object.keys(bodyCache)[0];\n    if (anyCachedKey) {\n      return bodyCache[anyCachedKey].then((body) => {\n        if (anyCachedKey === \"json\") {\n          body = JSON.stringify(body);\n        }\n        return new Response(body)[key]();\n      });\n    }\n    return bodyCache[key] = raw[key]();\n  };\n  /**\n   * `.json()` can parse Request body of type `application/json`\n   *\n   * @see {@link https://hono.dev/docs/api/request#json}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.json()\n   * })\n   * ```\n   */\n  json() {\n    return this.#cachedBody(\"text\").then((text) => JSON.parse(text));\n  }\n  /**\n   * `.text()` can parse Request body of type `text/plain`\n   *\n   * @see {@link https://hono.dev/docs/api/request#text}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.text()\n   * })\n   * ```\n   */\n  text() {\n    return this.#cachedBody(\"text\");\n  }\n  /**\n   * `.arrayBuffer()` parse Request body as an `ArrayBuffer`\n   *\n   * @see {@link https://hono.dev/docs/api/request#arraybuffer}\n   *\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.arrayBuffer()\n   * })\n   * ```\n   */\n  arrayBuffer() {\n    return this.#cachedBody(\"arrayBuffer\");\n  }\n  /**\n   * Parses the request body as a `Blob`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.blob();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#blob\n   */\n  blob() {\n    return this.#cachedBody(\"blob\");\n  }\n  /**\n   * Parses the request body as `FormData`.\n   * @example\n   * ```ts\n   * app.post('/entry', async (c) => {\n   *   const body = await c.req.formData();\n   * });\n   * ```\n   * @see https://hono.dev/docs/api/request#formdata\n   */\n  formData() {\n    return this.#cachedBody(\"formData\");\n  }\n  /**\n   * Adds validated data to the request.\n   *\n   * @param target - The target of the validation.\n   * @param data - The validated data to add.\n   */\n  addValidatedData(target, data) {\n    this.#validatedData[target] = data;\n  }\n  valid(target) {\n    return this.#validatedData[target];\n  }\n  /**\n   * `.url()` can get the request url strings.\n   *\n   * @see {@link https://hono.dev/docs/api/request#url}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const url = c.req.url // `http://localhost:8787/about/me`\n   *   ...\n   * })\n   * ```\n   */\n  get url() {\n    return this.raw.url;\n  }\n  /**\n   * `.method()` can get the method name of the request.\n   *\n   * @see {@link https://hono.dev/docs/api/request#method}\n   *\n   * @example\n   * ```ts\n   * app.get('/about/me', (c) => {\n   *   const method = c.req.method // `GET`\n   * })\n   * ```\n   */\n  get method() {\n    return this.raw.method;\n  }\n  get [GET_MATCH_RESULT]() {\n    return this.#matchResult;\n  }\n  /**\n   * `.matchedRoutes()` can return a matched route in the handler\n   *\n   * @deprecated\n   *\n   * Use matchedRoutes helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#matchedroutes}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async function logger(c, next) {\n   *   await next()\n   *   c.req.matchedRoutes.forEach(({ handler, method, path }, i) => {\n   *     const name = handler.name || (handler.length < 2 ? '[handler]' : '[middleware]')\n   *     console.log(\n   *       method,\n   *       ' ',\n   *       path,\n   *       ' '.repeat(Math.max(10 - path.length, 0)),\n   *       name,\n   *       i === c.req.routeIndex ? '<- respond from here' : ''\n   *     )\n   *   })\n   * })\n   * ```\n   */\n  get matchedRoutes() {\n    return this.#matchResult[0].map(([[, route]]) => route);\n  }\n  /**\n   * `routePath()` can retrieve the path registered within the handler\n   *\n   * @deprecated\n   *\n   * Use routePath helper defined in \"hono/route\" instead.\n   *\n   * @see {@link https://hono.dev/docs/api/request#routepath}\n   *\n   * @example\n   * ```ts\n   * app.get('/posts/:id', (c) => {\n   *   return c.json({ path: c.req.routePath })\n   * })\n   * ```\n   */\n  get routePath() {\n    return this.#matchResult[0].map(([[, route]]) => route)[this.routeIndex].path;\n  }\n};\nvar cloneRawRequest = async (req) => {\n  if (!req.raw.bodyUsed) {\n    return req.raw.clone();\n  }\n  const cacheKey = Object.keys(req.bodyCache)[0];\n  if (!cacheKey) {\n    throw new HTTPException(500, {\n      message: \"Cannot clone request: body was already consumed and not cached. Please use HonoRequest methods (e.g., req.json(), req.text()) instead of consuming req.raw directly.\"\n    });\n  }\n  const requestInit = {\n    body: await req[cacheKey](),\n    cache: req.raw.cache,\n    credentials: req.raw.credentials,\n    headers: req.header(),\n    integrity: req.raw.integrity,\n    keepalive: req.raw.keepalive,\n    method: req.method,\n    mode: req.raw.mode,\n    redirect: req.raw.redirect,\n    referrer: req.raw.referrer,\n    referrerPolicy: req.raw.referrerPolicy,\n    signal: req.raw.signal\n  };\n  return new Request(req.url, requestInit);\n};\nexport {\n  HonoRequest,\n  cloneRawRequest\n};\n", "// src/utils/html.ts\nvar HtmlEscapedCallbackPhase = {\n  Stringify: 1,\n  BeforeStream: 2,\n  Stream: 3\n};\nvar raw = (value, callbacks) => {\n  const escapedString = new String(value);\n  escapedString.isEscaped = true;\n  escapedString.callbacks = callbacks;\n  return escapedString;\n};\nvar escapeRe = /[&<>'\"]/;\nvar stringBufferToString = async (buffer, callbacks) => {\n  let str = \"\";\n  callbacks ||= [];\n  const resolvedBuffer = await Promise.all(buffer);\n  for (let i = resolvedBuffer.length - 1; ; i--) {\n    str += resolvedBuffer[i];\n    i--;\n    if (i < 0) {\n      break;\n    }\n    let r = resolvedBuffer[i];\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    const isEscaped = r.isEscaped;\n    r = await (typeof r === \"object\" ? r.toString() : r);\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    if (r.isEscaped ?? isEscaped) {\n      str += r;\n    } else {\n      const buf = [str];\n      escapeToBuffer(r, buf);\n      str = buf[0];\n    }\n  }\n  return raw(str, callbacks);\n};\nvar escapeToBuffer = (str, buffer) => {\n  const match = str.search(escapeRe);\n  if (match === -1) {\n    buffer[0] += str;\n    return;\n  }\n  let escape;\n  let index;\n  let lastIndex = 0;\n  for (index = match; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escape = \"&quot;\";\n        break;\n      case 39:\n        escape = \"&#39;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      case 62:\n        escape = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    buffer[0] += str.substring(lastIndex, index) + escape;\n    lastIndex = index + 1;\n  }\n  buffer[0] += str.substring(lastIndex, index);\n};\nvar resolveCallbackSync = (str) => {\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return str;\n  }\n  const buffer = [str];\n  const context = {};\n  callbacks.forEach((c) => c({ phase: HtmlEscapedCallbackPhase.Stringify, buffer, context }));\n  return buffer[0];\n};\nvar resolveCallback = async (str, phase, preserveCallbacks, context, buffer) => {\n  if (typeof str === \"object\" && !(str instanceof String)) {\n    if (!(str instanceof Promise)) {\n      str = str.toString();\n    }\n    if (str instanceof Promise) {\n      str = await str;\n    }\n  }\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return Promise.resolve(str);\n  }\n  if (buffer) {\n    buffer[0] += str;\n  } else {\n    buffer = [str];\n  }\n  const resStr = Promise.all(callbacks.map((c) => c({ phase, buffer, context }))).then(\n    (res) => Promise.all(\n      res.filter(Boolean).map((str2) => resolveCallback(str2, phase, false, context, buffer))\n    ).then(() => buffer[0])\n  );\n  if (preserveCallbacks) {\n    return raw(await resStr, callbacks);\n  } else {\n    return resStr;\n  }\n};\nexport {\n  HtmlEscapedCallbackPhase,\n  escapeToBuffer,\n  raw,\n  resolveCallback,\n  resolveCallbackSync,\n  stringBufferToString\n};\n", "// src/context.ts\nimport { HonoRequest } from \"./request.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"./utils/html.js\";\nvar TEXT_PLAIN = \"text/plain; charset=UTF-8\";\nvar setDefaultContentType = (contentType, headers) => {\n  return {\n    \"Content-Type\": contentType,\n    ...headers\n  };\n};\nvar Context = class {\n  #rawRequest;\n  #req;\n  /**\n   * `.env` can get bindings (environment variables, secrets, KV namespaces, D1 database, R2 bucket etc.) in Cloudflare Workers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#env}\n   *\n   * @example\n   * ```ts\n   * // Environment object for Cloudflare Workers\n   * app.get('*', async c => {\n   *   const counter = c.env.COUNTER\n   * })\n   * ```\n   */\n  env = {};\n  #var;\n  finalized = false;\n  /**\n   * `.error` can get the error object from the middleware if the Handler throws an error.\n   *\n   * @see {@link https://hono.dev/docs/api/context#error}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   await next()\n   *   if (c.error) {\n   *     // do something...\n   *   }\n   * })\n   * ```\n   */\n  error;\n  #status;\n  #executionCtx;\n  #res;\n  #layout;\n  #renderer;\n  #notFoundHandler;\n  #preparedHeaders;\n  #matchResult;\n  #path;\n  /**\n   * Creates an instance of the Context class.\n   *\n   * @param req - The Request object.\n   * @param options - Optional configuration options for the context.\n   */\n  constructor(req, options) {\n    this.#rawRequest = req;\n    if (options) {\n      this.#executionCtx = options.executionCtx;\n      this.env = options.env;\n      this.#notFoundHandler = options.notFoundHandler;\n      this.#path = options.path;\n      this.#matchResult = options.matchResult;\n    }\n  }\n  /**\n   * `.req` is the instance of {@link HonoRequest}.\n   */\n  get req() {\n    this.#req ??= new HonoRequest(this.#rawRequest, this.#path, this.#matchResult);\n    return this.#req;\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#event}\n   * The FetchEvent associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have a FetchEvent.\n   */\n  get event() {\n    if (this.#executionCtx && \"respondWith\" in this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no FetchEvent\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#executionctx}\n   * The ExecutionContext associated with the current request.\n   *\n   * @throws Will throw an error if the context does not have an ExecutionContext.\n   */\n  get executionCtx() {\n    if (this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no ExecutionContext\");\n    }\n  }\n  /**\n   * @see {@link https://hono.dev/docs/api/context#res}\n   * The Response object for the current request.\n   */\n  get res() {\n    return this.#res ||= new Response(null, {\n      headers: this.#preparedHeaders ??= new Headers()\n    });\n  }\n  /**\n   * Sets the Response object for the current request.\n   *\n   * @param _res - The Response object to set.\n   */\n  set res(_res) {\n    if (this.#res && _res) {\n      _res = new Response(_res.body, _res);\n      for (const [k, v] of this.#res.headers.entries()) {\n        if (k === \"content-type\") {\n          continue;\n        }\n        if (k === \"set-cookie\") {\n          const cookies = this.#res.headers.getSetCookie();\n          _res.headers.delete(\"set-cookie\");\n          for (const cookie of cookies) {\n            _res.headers.append(\"set-cookie\", cookie);\n          }\n        } else {\n          _res.headers.set(k, v);\n        }\n      }\n    }\n    this.#res = _res;\n    this.finalized = true;\n  }\n  /**\n   * `.render()` can create a response within a layout.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   return c.render('Hello!')\n   * })\n   * ```\n   */\n  render = (...args) => {\n    this.#renderer ??= (content) => this.html(content);\n    return this.#renderer(...args);\n  };\n  /**\n   * Sets the layout for the response.\n   *\n   * @param layout - The layout to set.\n   * @returns The layout function.\n   */\n  setLayout = (layout) => this.#layout = layout;\n  /**\n   * Gets the current layout for the response.\n   *\n   * @returns The current layout function.\n   */\n  getLayout = () => this.#layout;\n  /**\n   * `.setRenderer()` can set the layout in the custom middleware.\n   *\n   * @see {@link https://hono.dev/docs/api/context#render-setrenderer}\n   *\n   * @example\n   * ```tsx\n   * app.use('*', async (c, next) => {\n   *   c.setRenderer((content) => {\n   *     return c.html(\n   *       <html>\n   *         <body>\n   *           <p>{content}</p>\n   *         </body>\n   *       </html>\n   *     )\n   *   })\n   *   await next()\n   * })\n   * ```\n   */\n  setRenderer = (renderer) => {\n    this.#renderer = renderer;\n  };\n  /**\n   * `.header()` can set headers.\n   *\n   * @see {@link https://hono.dev/docs/api/context#header}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  header = (name, value, options) => {\n    if (this.finalized) {\n      this.#res = new Response(this.#res.body, this.#res);\n    }\n    const headers = this.#res ? this.#res.headers : this.#preparedHeaders ??= new Headers();\n    if (value === void 0) {\n      headers.delete(name);\n    } else if (options?.append) {\n      headers.append(name, value);\n    } else {\n      headers.set(name, value);\n    }\n  };\n  status = (status) => {\n    this.#status = status;\n  };\n  /**\n   * `.set()` can set the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.use('*', async (c, next) => {\n   *   c.set('message', 'Hono is hot!!')\n   *   await next()\n   * })\n   * ```\n   */\n  set = (key, value) => {\n    this.#var ??= /* @__PURE__ */ new Map();\n    this.#var.set(key, value);\n  };\n  /**\n   * `.get()` can use the value specified by the key.\n   *\n   * @see {@link https://hono.dev/docs/api/context#set-get}\n   *\n   * @example\n   * ```ts\n   * app.get('/', (c) => {\n   *   const message = c.get('message')\n   *   return c.text(`The message is \"${message}\"`)\n   * })\n   * ```\n   */\n  get = (key) => {\n    return this.#var ? this.#var.get(key) : void 0;\n  };\n  /**\n   * `.var` can access the value of a variable.\n   *\n   * @see {@link https://hono.dev/docs/api/context#var}\n   *\n   * @example\n   * ```ts\n   * const result = c.var.client.oneMethod()\n   * ```\n   */\n  // c.var.propName is a read-only\n  get var() {\n    if (!this.#var) {\n      return {};\n    }\n    return Object.fromEntries(this.#var);\n  }\n  #newResponse(data, arg, headers) {\n    const responseHeaders = this.#res ? new Headers(this.#res.headers) : this.#preparedHeaders ?? new Headers();\n    if (typeof arg === \"object\" && \"headers\" in arg) {\n      const argHeaders = arg.headers instanceof Headers ? arg.headers : new Headers(arg.headers);\n      for (const [key, value] of argHeaders) {\n        if (key.toLowerCase() === \"set-cookie\") {\n          responseHeaders.append(key, value);\n        } else {\n          responseHeaders.set(key, value);\n        }\n      }\n    }\n    if (headers) {\n      for (const [k, v] of Object.entries(headers)) {\n        if (typeof v === \"string\") {\n          responseHeaders.set(k, v);\n        } else {\n          responseHeaders.delete(k);\n          for (const v2 of v) {\n            responseHeaders.append(k, v2);\n          }\n        }\n      }\n    }\n    const status = typeof arg === \"number\" ? arg : arg?.status ?? this.#status;\n    return new Response(data, { status, headers: responseHeaders });\n  }\n  newResponse = (...args) => this.#newResponse(...args);\n  /**\n   * `.body()` can return the HTTP response.\n   * You can set headers with `.header()` and set HTTP status code with `.status`.\n   * This can also be set in `.text()`, `.json()` and so on.\n   *\n   * @see {@link https://hono.dev/docs/api/context#body}\n   *\n   * @example\n   * ```ts\n   * app.get('/welcome', (c) => {\n   *   // Set headers\n   *   c.header('X-Message', 'Hello!')\n   *   c.header('Content-Type', 'text/plain')\n   *   // Set HTTP status code\n   *   c.status(201)\n   *\n   *   // Return the response body\n   *   return c.body('Thank you for coming')\n   * })\n   * ```\n   */\n  body = (data, arg, headers) => this.#newResponse(data, arg, headers);\n  /**\n   * `.text()` can render text as `Content-Type:text/plain`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#text}\n   *\n   * @example\n   * ```ts\n   * app.get('/say', (c) => {\n   *   return c.text('Hello!')\n   * })\n   * ```\n   */\n  text = (text, arg, headers) => {\n    return !this.#preparedHeaders && !this.#status && !arg && !headers && !this.finalized ? new Response(text) : this.#newResponse(\n      text,\n      arg,\n      setDefaultContentType(TEXT_PLAIN, headers)\n    );\n  };\n  /**\n   * `.json()` can render JSON as `Content-Type:application/json`.\n   *\n   * @see {@link https://hono.dev/docs/api/context#json}\n   *\n   * @example\n   * ```ts\n   * app.get('/api', (c) => {\n   *   return c.json({ message: 'Hello!' })\n   * })\n   * ```\n   */\n  json = (object, arg, headers) => {\n    return this.#newResponse(\n      JSON.stringify(object),\n      arg,\n      setDefaultContentType(\"application/json\", headers)\n    );\n  };\n  html = (html, arg, headers) => {\n    const res = (html2) => this.#newResponse(html2, arg, setDefaultContentType(\"text/html; charset=UTF-8\", headers));\n    return typeof html === \"object\" ? resolveCallback(html, HtmlEscapedCallbackPhase.Stringify, false, {}).then(res) : res(html);\n  };\n  /**\n   * `.redirect()` can Redirect, default status code is 302.\n   *\n   * @see {@link https://hono.dev/docs/api/context#redirect}\n   *\n   * @example\n   * ```ts\n   * app.get('/redirect', (c) => {\n   *   return c.redirect('/')\n   * })\n   * app.get('/redirect-permanently', (c) => {\n   *   return c.redirect('/', 301)\n   * })\n   * ```\n   */\n  redirect = (location, status) => {\n    const locationString = String(location);\n    this.header(\n      \"Location\",\n      // Multibyes should be encoded\n      // eslint-disable-next-line no-control-regex\n      !/[^\\x00-\\xFF]/.test(locationString) ? locationString : encodeURI(locationString)\n    );\n    return this.newResponse(null, status ?? 302);\n  };\n  /**\n   * `.notFound()` can return the Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/context#notfound}\n   *\n   * @example\n   * ```ts\n   * app.get('/notfound', (c) => {\n   *   return c.notFound()\n   * })\n   * ```\n   */\n  notFound = () => {\n    this.#notFoundHandler ??= () => new Response();\n    return this.#notFoundHandler(this);\n  };\n};\nexport {\n  Context,\n  TEXT_PLAIN\n};\n", "// src/router.ts\nvar METHOD_NAME_ALL = \"ALL\";\nvar METHOD_NAME_ALL_LOWERCASE = \"all\";\nvar METHODS = [\"get\", \"post\", \"put\", \"delete\", \"options\", \"patch\"];\nvar MESSAGE_MATCHER_IS_ALREADY_BUILT = \"Can not add a route since the matcher is already built.\";\nvar UnsupportedPathError = class extends Error {\n};\nexport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHODS,\n  METHOD_NAME_ALL,\n  METHOD_NAME_ALL_LOWERCASE,\n  UnsupportedPathError\n};\n", "// src/utils/constants.ts\nvar COMPOSED_HANDLER = \"__COMPOSED_HANDLER\";\nexport {\n  COMPOSED_HANDLER\n};\n", "// src/hono-base.ts\nimport { compose } from \"./compose.js\";\nimport { Context } from \"./context.js\";\nimport { METHODS, METHOD_NAME_ALL, METHOD_NAME_ALL_LOWERCASE } from \"./router.js\";\nimport { COMPOSED_HANDLER } from \"./utils/constants.js\";\nimport { getPath, getPathNoStrict, mergePath } from \"./utils/url.js\";\nvar notFoundHandler = (c) => {\n  return c.text(\"404 Not Found\", 404);\n};\nvar errorHandler = (err, c) => {\n  if (\"getResponse\" in err) {\n    const res = err.getResponse();\n    return c.newResponse(res.body, res);\n  }\n  console.error(err);\n  return c.text(\"Internal Server Error\", 500);\n};\nvar Hono = class _Hono {\n  get;\n  post;\n  put;\n  delete;\n  options;\n  patch;\n  all;\n  on;\n  use;\n  /*\n    This class is like an abstract class and does not have a router.\n    To use it, inherit the class and implement router in the constructor.\n  */\n  router;\n  getPath;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  _basePath = \"/\";\n  #path = \"/\";\n  routes = [];\n  constructor(options = {}) {\n    const allMethods = [...METHODS, METHOD_NAME_ALL_LOWERCASE];\n    allMethods.forEach((method) => {\n      this[method] = (args1, ...args) => {\n        if (typeof args1 === \"string\") {\n          this.#path = args1;\n        } else {\n          this.#addRoute(method, this.#path, args1);\n        }\n        args.forEach((handler) => {\n          this.#addRoute(method, this.#path, handler);\n        });\n        return this;\n      };\n    });\n    this.on = (method, path, ...handlers) => {\n      for (const p of [path].flat()) {\n        this.#path = p;\n        for (const m of [method].flat()) {\n          handlers.map((handler) => {\n            this.#addRoute(m.toUpperCase(), this.#path, handler);\n          });\n        }\n      }\n      return this;\n    };\n    this.use = (arg1, ...handlers) => {\n      if (typeof arg1 === \"string\") {\n        this.#path = arg1;\n      } else {\n        this.#path = \"*\";\n        handlers.unshift(arg1);\n      }\n      handlers.forEach((handler) => {\n        this.#addRoute(METHOD_NAME_ALL, this.#path, handler);\n      });\n      return this;\n    };\n    const { strict, ...optionsWithoutStrict } = options;\n    Object.assign(this, optionsWithoutStrict);\n    this.getPath = strict ?? true ? options.getPath ?? getPath : getPathNoStrict;\n  }\n  #clone() {\n    const clone = new _Hono({\n      router: this.router,\n      getPath: this.getPath\n    });\n    clone.errorHandler = this.errorHandler;\n    clone.#notFoundHandler = this.#notFoundHandler;\n    clone.routes = this.routes;\n    return clone;\n  }\n  #notFoundHandler = notFoundHandler;\n  // Cannot use `#` because it requires visibility at JavaScript runtime.\n  errorHandler = errorHandler;\n  /**\n   * `.route()` allows grouping other Hono instance in routes.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#grouping}\n   *\n   * @param {string} path - base Path\n   * @param {Hono} app - other Hono instance\n   * @returns {Hono} routed Hono instance\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * const app2 = new Hono()\n   *\n   * app2.get(\"/user\", (c) => c.text(\"user\"))\n   * app.route(\"/api\", app2) // GET /api/user\n   * ```\n   */\n  route(path, app) {\n    const subApp = this.basePath(path);\n    app.routes.map((r) => {\n      let handler;\n      if (app.errorHandler === errorHandler) {\n        handler = r.handler;\n      } else {\n        handler = async (c, next) => (await compose([], app.errorHandler)(c, () => r.handler(c, next))).res;\n        handler[COMPOSED_HANDLER] = r.handler;\n      }\n      subApp.#addRoute(r.method, r.path, handler);\n    });\n    return this;\n  }\n  /**\n   * `.basePath()` allows base paths to be specified.\n   *\n   * @see {@link https://hono.dev/docs/api/routing#base-path}\n   *\n   * @param {string} path - base Path\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * const api = new Hono().basePath('/api')\n   * ```\n   */\n  basePath(path) {\n    const subApp = this.#clone();\n    subApp._basePath = mergePath(this._basePath, path);\n    return subApp;\n  }\n  /**\n   * `.onError()` handles an error and returns a customized Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#error-handling}\n   *\n   * @param {ErrorHandler} handler - request Handler for error\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.onError((err, c) => {\n   *   console.error(`${err}`)\n   *   return c.text('Custom Error Message', 500)\n   * })\n   * ```\n   */\n  onError = (handler) => {\n    this.errorHandler = handler;\n    return this;\n  };\n  /**\n   * `.notFound()` allows you to customize a Not Found Response.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#not-found}\n   *\n   * @param {NotFoundHandler} handler - request handler for not-found\n   * @returns {Hono} changed Hono instance\n   *\n   * @example\n   * ```ts\n   * app.notFound((c) => {\n   *   return c.text('Custom 404 Message', 404)\n   * })\n   * ```\n   */\n  notFound = (handler) => {\n    this.#notFoundHandler = handler;\n    return this;\n  };\n  /**\n   * `.mount()` allows you to mount applications built with other frameworks into your Hono application.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#mount}\n   *\n   * @param {string} path - base Path\n   * @param {Function} applicationHandler - other Request Handler\n   * @param {MountOptions} [options] - options of `.mount()`\n   * @returns {Hono} mounted Hono instance\n   *\n   * @example\n   * ```ts\n   * import { Router as IttyRouter } from 'itty-router'\n   * import { Hono } from 'hono'\n   * // Create itty-router application\n   * const ittyRouter = IttyRouter()\n   * // GET /itty-router/hello\n   * ittyRouter.get('/hello', () => new Response('Hello from itty-router'))\n   *\n   * const app = new Hono()\n   * app.mount('/itty-router', ittyRouter.handle)\n   * ```\n   *\n   * @example\n   * ```ts\n   * const app = new Hono()\n   * // Send the request to another application without modification.\n   * app.mount('/app', anotherApp, {\n   *   replaceRequest: (req) => req,\n   * })\n   * ```\n   */\n  mount(path, applicationHandler, options) {\n    let replaceRequest;\n    let optionHandler;\n    if (options) {\n      if (typeof options === \"function\") {\n        optionHandler = options;\n      } else {\n        optionHandler = options.optionHandler;\n        if (options.replaceRequest === false) {\n          replaceRequest = (request) => request;\n        } else {\n          replaceRequest = options.replaceRequest;\n        }\n      }\n    }\n    const getOptions = optionHandler ? (c) => {\n      const options2 = optionHandler(c);\n      return Array.isArray(options2) ? options2 : [options2];\n    } : (c) => {\n      let executionContext = void 0;\n      try {\n        executionContext = c.executionCtx;\n      } catch {\n      }\n      return [c.env, executionContext];\n    };\n    replaceRequest ||= (() => {\n      const mergedPath = mergePath(this._basePath, path);\n      const pathPrefixLength = mergedPath === \"/\" ? 0 : mergedPath.length;\n      return (request) => {\n        const url = new URL(request.url);\n        url.pathname = url.pathname.slice(pathPrefixLength) || \"/\";\n        return new Request(url, request);\n      };\n    })();\n    const handler = async (c, next) => {\n      const res = await applicationHandler(replaceRequest(c.req.raw), ...getOptions(c));\n      if (res) {\n        return res;\n      }\n      await next();\n    };\n    this.#addRoute(METHOD_NAME_ALL, mergePath(path, \"*\"), handler);\n    return this;\n  }\n  #addRoute(method, path, handler) {\n    method = method.toUpperCase();\n    path = mergePath(this._basePath, path);\n    const r = { basePath: this._basePath, path, method, handler };\n    this.router.add(method, path, [handler, r]);\n    this.routes.push(r);\n  }\n  #handleError(err, c) {\n    if (err instanceof Error) {\n      return this.errorHandler(err, c);\n    }\n    throw err;\n  }\n  #dispatch(request, executionCtx, env, method) {\n    if (method === \"HEAD\") {\n      return (async () => new Response(null, await this.#dispatch(request, executionCtx, env, \"GET\")))();\n    }\n    const path = this.getPath(request, { env });\n    const matchResult = this.router.match(method, path);\n    const c = new Context(request, {\n      path,\n      matchResult,\n      env,\n      executionCtx,\n      notFoundHandler: this.#notFoundHandler\n    });\n    if (matchResult[0].length === 1) {\n      let res;\n      try {\n        res = matchResult[0][0][0][0](c, async () => {\n          c.res = await this.#notFoundHandler(c);\n        });\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n      return res instanceof Promise ? res.then(\n        (resolved) => resolved || (c.finalized ? c.res : this.#notFoundHandler(c))\n      ).catch((err) => this.#handleError(err, c)) : res ?? this.#notFoundHandler(c);\n    }\n    const composed = compose(matchResult[0], this.errorHandler, this.#notFoundHandler);\n    return (async () => {\n      try {\n        const context = await composed(c);\n        if (!context.finalized) {\n          throw new Error(\n            \"Context is not finalized. Did you forget to return a Response object or `await next()`?\"\n          );\n        }\n        return context.res;\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n    })();\n  }\n  /**\n   * `.fetch()` will be entry point of your app.\n   *\n   * @see {@link https://hono.dev/docs/api/hono#fetch}\n   *\n   * @param {Request} request - request Object of request\n   * @param {Env} Env - env Object\n   * @param {ExecutionContext} - context of execution\n   * @returns {Response | Promise<Response>} response of request\n   *\n   */\n  fetch = (request, ...rest) => {\n    return this.#dispatch(request, rest[1], rest[0], request.method);\n  };\n  /**\n   * `.request()` is a useful method for testing.\n   * You can pass a URL or pathname to send a GET request.\n   * app will return a Response object.\n   * ```ts\n   * test('GET /hello is ok', async () => {\n   *   const res = await app.request('/hello')\n   *   expect(res.status).toBe(200)\n   * })\n   * ```\n   * @see https://hono.dev/docs/api/hono#request\n   */\n  request = (input, requestInit, Env, executionCtx) => {\n    if (input instanceof Request) {\n      return this.fetch(requestInit ? new Request(input, requestInit) : input, Env, executionCtx);\n    }\n    input = input.toString();\n    return this.fetch(\n      new Request(\n        /^https?:\\/\\//.test(input) ? input : `http://localhost${mergePath(\"/\", input)}`,\n        requestInit\n      ),\n      Env,\n      executionCtx\n    );\n  };\n  /**\n   * `.fire()` automatically adds a global fetch event listener.\n   * This can be useful for environments that adhere to the Service Worker API, such as non-ES module Cloudflare Workers.\n   * @deprecated\n   * Use `fire` from `hono/service-worker` instead.\n   * ```ts\n   * import { Hono } from 'hono'\n   * import { fire } from 'hono/service-worker'\n   *\n   * const app = new Hono()\n   * // ...\n   * fire(app)\n   * ```\n   * @see https://hono.dev/docs/api/hono#fire\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API\n   * @see https://developers.cloudflare.com/workers/reference/migrate-to-module-workers/\n   */\n  fire = () => {\n    addEventListener(\"fetch\", (event) => {\n      event.respondWith(this.#dispatch(event.request, event, void 0, event.request.method));\n    });\n  };\n};\nexport {\n  Hono as HonoBase\n};\n", "// src/router/reg-exp-router/matcher.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nvar emptyParam = [];\nfunction match(method, path) {\n  const matchers = this.buildAllMatchers();\n  const match2 = ((method2, path2) => {\n    const matcher = matchers[method2] || matchers[METHOD_NAME_ALL];\n    const staticMatch = matcher[2][path2];\n    if (staticMatch) {\n      return staticMatch;\n    }\n    const match3 = path2.match(matcher[0]);\n    if (!match3) {\n      return [[], emptyParam];\n    }\n    const index = match3.indexOf(\"\", 1);\n    return [matcher[1][index], match3];\n  });\n  this.match = match2;\n  return match2(method, path);\n}\nexport {\n  emptyParam,\n  match\n};\n", "// src/router/reg-exp-router/node.ts\nvar LABEL_REG_EXP_STR = \"[^/]+\";\nvar ONLY_WILDCARD_REG_EXP_STR = \".*\";\nvar TAIL_WILDCARD_REG_EXP_STR = \"(?:|/.*)\";\nvar PATH_ERROR = /* @__PURE__ */ Symbol();\nvar regExpMetaChars = new Set(\".\\\\+*[^]$()\");\nfunction compareKey(a, b) {\n  if (a.length === 1) {\n    return b.length === 1 ? a < b ? -1 : 1 : -1;\n  }\n  if (b.length === 1) {\n    return 1;\n  }\n  if (a === ONLY_WILDCARD_REG_EXP_STR || a === TAIL_WILDCARD_REG_EXP_STR) {\n    return 1;\n  } else if (b === ONLY_WILDCARD_REG_EXP_STR || b === TAIL_WILDCARD_REG_EXP_STR) {\n    return -1;\n  }\n  if (a === LABEL_REG_EXP_STR) {\n    return 1;\n  } else if (b === LABEL_REG_EXP_STR) {\n    return -1;\n  }\n  return a.length === b.length ? a < b ? -1 : 1 : b.length - a.length;\n}\nvar Node = class _Node {\n  #index;\n  #varIndex;\n  #children = /* @__PURE__ */ Object.create(null);\n  insert(tokens, index, paramMap, context, pathErrorCheckOnly) {\n    if (tokens.length === 0) {\n      if (this.#index !== void 0) {\n        throw PATH_ERROR;\n      }\n      if (pathErrorCheckOnly) {\n        return;\n      }\n      this.#index = index;\n      return;\n    }\n    const [token, ...restTokens] = tokens;\n    const pattern = token === \"*\" ? restTokens.length === 0 ? [\"\", \"\", ONLY_WILDCARD_REG_EXP_STR] : [\"\", \"\", LABEL_REG_EXP_STR] : token === \"/*\" ? [\"\", \"\", TAIL_WILDCARD_REG_EXP_STR] : token.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n    let node;\n    if (pattern) {\n      const name = pattern[1];\n      let regexpStr = pattern[2] || LABEL_REG_EXP_STR;\n      if (name && pattern[2]) {\n        if (regexpStr === \".*\") {\n          throw PATH_ERROR;\n        }\n        regexpStr = regexpStr.replace(/^\\((?!\\?:)(?=[^)]+\\)$)/, \"(?:\");\n        if (/\\((?!\\?:)/.test(regexpStr)) {\n          throw PATH_ERROR;\n        }\n      }\n      node = this.#children[regexpStr];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[regexpStr] = new _Node();\n        if (name !== \"\") {\n          node.#varIndex = context.varIndex++;\n        }\n      }\n      if (!pathErrorCheckOnly && name !== \"\") {\n        paramMap.push([name, node.#varIndex]);\n      }\n    } else {\n      node = this.#children[token];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k.length > 1 && k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[token] = new _Node();\n      }\n    }\n    node.insert(restTokens, index, paramMap, context, pathErrorCheckOnly);\n  }\n  buildRegExpStr() {\n    const childKeys = Object.keys(this.#children).sort(compareKey);\n    const strList = childKeys.map((k) => {\n      const c = this.#children[k];\n      return (typeof c.#varIndex === \"number\" ? `(${k})@${c.#varIndex}` : regExpMetaChars.has(k) ? `\\\\${k}` : k) + c.buildRegExpStr();\n    });\n    if (typeof this.#index === \"number\") {\n      strList.unshift(`#${this.#index}`);\n    }\n    if (strList.length === 0) {\n      return \"\";\n    }\n    if (strList.length === 1) {\n      return strList[0];\n    }\n    return \"(?:\" + strList.join(\"|\") + \")\";\n  }\n};\nexport {\n  Node,\n  PATH_ERROR\n};\n", "// src/router/reg-exp-router/trie.ts\nimport { Node } from \"./node.js\";\nvar Trie = class {\n  #context = { varIndex: 0 };\n  #root = new Node();\n  insert(path, index, pathErrorCheckOnly) {\n    const paramAssoc = [];\n    const groups = [];\n    for (let i = 0; ; ) {\n      let replaced = false;\n      path = path.replace(/\\{[^}]+\\}/g, (m) => {\n        const mark = `@\\\\${i}`;\n        groups[i] = [mark, m];\n        i++;\n        replaced = true;\n        return mark;\n      });\n      if (!replaced) {\n        break;\n      }\n    }\n    const tokens = path.match(/(?::[^\\/]+)|(?:\\/\\*$)|./g) || [];\n    for (let i = groups.length - 1; i >= 0; i--) {\n      const [mark] = groups[i];\n      for (let j = tokens.length - 1; j >= 0; j--) {\n        if (tokens[j].indexOf(mark) !== -1) {\n          tokens[j] = tokens[j].replace(mark, groups[i][1]);\n          break;\n        }\n      }\n    }\n    this.#root.insert(tokens, index, paramAssoc, this.#context, pathErrorCheckOnly);\n    return paramAssoc;\n  }\n  buildRegExp() {\n    let regexp = this.#root.buildRegExpStr();\n    if (regexp === \"\") {\n      return [/^$/, [], []];\n    }\n    let captureIndex = 0;\n    const indexReplacementMap = [];\n    const paramReplacementMap = [];\n    regexp = regexp.replace(/#(\\d+)|@(\\d+)|\\.\\*\\$/g, (_, handlerIndex, paramIndex) => {\n      if (handlerIndex !== void 0) {\n        indexReplacementMap[++captureIndex] = Number(handlerIndex);\n        return \"$()\";\n      }\n      if (paramIndex !== void 0) {\n        paramReplacementMap[Number(paramIndex)] = ++captureIndex;\n        return \"\";\n      }\n      return \"\";\n    });\n    return [new RegExp(`^${regexp}`), indexReplacementMap, paramReplacementMap];\n  }\n};\nexport {\n  Trie\n};\n", "// src/router/reg-exp-router/router.ts\nimport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHOD_NAME_ALL,\n  UnsupportedPathError\n} from \"../../router.js\";\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { match, emptyParam } from \"./matcher.js\";\nimport { PATH_ERROR } from \"./node.js\";\nimport { Trie } from \"./trie.js\";\nvar nullMatcher = [/^$/, [], /* @__PURE__ */ Object.create(null)];\nvar wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\nfunction buildWildcardRegExp(path) {\n  return wildcardRegExpCache[path] ??= new RegExp(\n    path === \"*\" ? \"\" : `^${path.replace(\n      /\\/\\*$|([.\\\\+*[^\\]$()])/g,\n      (_, metaChar) => metaChar ? `\\\\${metaChar}` : \"(?:|/.*)\"\n    )}$`\n  );\n}\nfunction clearWildcardRegExpCache() {\n  wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\n}\nfunction buildMatcherFromPreprocessedRoutes(routes) {\n  const trie = new Trie();\n  const handlerData = [];\n  if (routes.length === 0) {\n    return nullMatcher;\n  }\n  const routesWithStaticPathFlag = routes.map(\n    (route) => [!/\\*|\\/:/.test(route[0]), ...route]\n  ).sort(\n    ([isStaticA, pathA], [isStaticB, pathB]) => isStaticA ? 1 : isStaticB ? -1 : pathA.length - pathB.length\n  );\n  const staticMap = /* @__PURE__ */ Object.create(null);\n  for (let i = 0, j = -1, len = routesWithStaticPathFlag.length; i < len; i++) {\n    const [pathErrorCheckOnly, path, handlers] = routesWithStaticPathFlag[i];\n    if (pathErrorCheckOnly) {\n      staticMap[path] = [handlers.map(([h]) => [h, /* @__PURE__ */ Object.create(null)]), emptyParam];\n    } else {\n      j++;\n    }\n    let paramAssoc;\n    try {\n      paramAssoc = trie.insert(path, j, pathErrorCheckOnly);\n    } catch (e) {\n      throw e === PATH_ERROR ? new UnsupportedPathError(path) : e;\n    }\n    if (pathErrorCheckOnly) {\n      continue;\n    }\n    handlerData[j] = handlers.map(([h, paramCount]) => {\n      const paramIndexMap = /* @__PURE__ */ Object.create(null);\n      paramCount -= 1;\n      for (; paramCount >= 0; paramCount--) {\n        const [key, value] = paramAssoc[paramCount];\n        paramIndexMap[key] = value;\n      }\n      return [h, paramIndexMap];\n    });\n  }\n  const [regexp, indexReplacementMap, paramReplacementMap] = trie.buildRegExp();\n  for (let i = 0, len = handlerData.length; i < len; i++) {\n    for (let j = 0, len2 = handlerData[i].length; j < len2; j++) {\n      const map = handlerData[i][j]?.[1];\n      if (!map) {\n        continue;\n      }\n      const keys = Object.keys(map);\n      for (let k = 0, len3 = keys.length; k < len3; k++) {\n        map[keys[k]] = paramReplacementMap[map[keys[k]]];\n      }\n    }\n  }\n  const handlerMap = [];\n  for (const i in indexReplacementMap) {\n    handlerMap[i] = handlerData[indexReplacementMap[i]];\n  }\n  return [regexp, handlerMap, staticMap];\n}\nfunction findMiddleware(middleware, path) {\n  if (!middleware) {\n    return void 0;\n  }\n  for (const k of Object.keys(middleware).sort((a, b) => b.length - a.length)) {\n    if (buildWildcardRegExp(k).test(path)) {\n      return [...middleware[k]];\n    }\n  }\n  return void 0;\n}\nvar RegExpRouter = class {\n  name = \"RegExpRouter\";\n  #middleware;\n  #routes;\n  constructor() {\n    this.#middleware = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n    this.#routes = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n  }\n  add(method, path, handler) {\n    const middleware = this.#middleware;\n    const routes = this.#routes;\n    if (!middleware || !routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    if (!middleware[method]) {\n      ;\n      [middleware, routes].forEach((handlerMap) => {\n        handlerMap[method] = /* @__PURE__ */ Object.create(null);\n        Object.keys(handlerMap[METHOD_NAME_ALL]).forEach((p) => {\n          handlerMap[method][p] = [...handlerMap[METHOD_NAME_ALL][p]];\n        });\n      });\n    }\n    if (path === \"/*\") {\n      path = \"*\";\n    }\n    const paramCount = (path.match(/\\/:/g) || []).length;\n    if (/\\*$/.test(path)) {\n      const re = buildWildcardRegExp(path);\n      if (method === METHOD_NAME_ALL) {\n        Object.keys(middleware).forEach((m) => {\n          middleware[m][path] ||= findMiddleware(middleware[m], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n        });\n      } else {\n        middleware[method][path] ||= findMiddleware(middleware[method], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n      }\n      Object.keys(middleware).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(middleware[m]).forEach((p) => {\n            re.test(p) && middleware[m][p].push([handler, paramCount]);\n          });\n        }\n      });\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(routes[m]).forEach(\n            (p) => re.test(p) && routes[m][p].push([handler, paramCount])\n          );\n        }\n      });\n      return;\n    }\n    const paths = checkOptionalParameter(path) || [path];\n    for (let i = 0, len = paths.length; i < len; i++) {\n      const path2 = paths[i];\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          routes[m][path2] ||= [\n            ...findMiddleware(middleware[m], path2) || findMiddleware(middleware[METHOD_NAME_ALL], path2) || []\n          ];\n          routes[m][path2].push([handler, paramCount - len + i + 1]);\n        }\n      });\n    }\n  }\n  match = match;\n  buildAllMatchers() {\n    const matchers = /* @__PURE__ */ Object.create(null);\n    Object.keys(this.#routes).concat(Object.keys(this.#middleware)).forEach((method) => {\n      matchers[method] ||= this.#buildMatcher(method);\n    });\n    this.#middleware = this.#routes = void 0;\n    clearWildcardRegExpCache();\n    return matchers;\n  }\n  #buildMatcher(method) {\n    const routes = [];\n    let hasOwnRoute = method === METHOD_NAME_ALL;\n    [this.#middleware, this.#routes].forEach((r) => {\n      const ownRoute = r[method] ? Object.keys(r[method]).map((path) => [path, r[method][path]]) : [];\n      if (ownRoute.length !== 0) {\n        hasOwnRoute ||= true;\n        routes.push(...ownRoute);\n      } else if (method !== METHOD_NAME_ALL) {\n        routes.push(\n          ...Object.keys(r[METHOD_NAME_ALL]).map((path) => [path, r[METHOD_NAME_ALL][path]])\n        );\n      }\n    });\n    if (!hasOwnRoute) {\n      return null;\n    } else {\n      return buildMatcherFromPreprocessedRoutes(routes);\n    }\n  }\n};\nexport {\n  RegExpRouter\n};\n", "// src/router/smart-router/router.ts\nimport { MESSAGE_MATCHER_IS_ALREADY_BUILT, UnsupportedPathError } from \"../../router.js\";\nvar SmartRouter = class {\n  name = \"SmartRouter\";\n  #routers = [];\n  #routes = [];\n  constructor(init) {\n    this.#routers = init.routers;\n  }\n  add(method, path, handler) {\n    if (!this.#routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    this.#routes.push([method, path, handler]);\n  }\n  match(method, path) {\n    if (!this.#routes) {\n      throw new Error(\"Fatal error\");\n    }\n    const routers = this.#routers;\n    const routes = this.#routes;\n    const len = routers.length;\n    let i = 0;\n    let res;\n    for (; i < len; i++) {\n      const router = routers[i];\n      try {\n        for (let i2 = 0, len2 = routes.length; i2 < len2; i2++) {\n          router.add(...routes[i2]);\n        }\n        res = router.match(method, path);\n      } catch (e) {\n        if (e instanceof UnsupportedPathError) {\n          continue;\n        }\n        throw e;\n      }\n      this.match = router.match.bind(router);\n      this.#routers = [router];\n      this.#routes = void 0;\n      break;\n    }\n    if (i === len) {\n      throw new Error(\"Fatal error\");\n    }\n    this.name = `SmartRouter + ${this.activeRouter.name}`;\n    return res;\n  }\n  get activeRouter() {\n    if (this.#routes || this.#routers.length !== 1) {\n      throw new Error(\"No active router has been determined yet.\");\n    }\n    return this.#routers[0];\n  }\n};\nexport {\n  SmartRouter\n};\n", "// src/router/trie-router/node.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nimport { getPattern, splitPath, splitRoutingPath } from \"../../utils/url.js\";\nvar emptyParams = /* @__PURE__ */ Object.create(null);\nvar Node = class _Node {\n  #methods;\n  #children;\n  #patterns;\n  #order = 0;\n  #params = emptyParams;\n  constructor(method, handler, children) {\n    this.#children = children || /* @__PURE__ */ Object.create(null);\n    this.#methods = [];\n    if (method && handler) {\n      const m = /* @__PURE__ */ Object.create(null);\n      m[method] = { handler, possibleKeys: [], score: 0 };\n      this.#methods = [m];\n    }\n    this.#patterns = [];\n  }\n  insert(method, path, handler) {\n    this.#order = ++this.#order;\n    let curNode = this;\n    const parts = splitRoutingPath(path);\n    const possibleKeys = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const p = parts[i];\n      const nextP = parts[i + 1];\n      const pattern = getPattern(p, nextP);\n      const key = Array.isArray(pattern) ? pattern[0] : p;\n      if (key in curNode.#children) {\n        curNode = curNode.#children[key];\n        if (pattern) {\n          possibleKeys.push(pattern[1]);\n        }\n        continue;\n      }\n      curNode.#children[key] = new _Node();\n      if (pattern) {\n        curNode.#patterns.push(pattern);\n        possibleKeys.push(pattern[1]);\n      }\n      curNode = curNode.#children[key];\n    }\n    curNode.#methods.push({\n      [method]: {\n        handler,\n        possibleKeys: possibleKeys.filter((v, i, a) => a.indexOf(v) === i),\n        score: this.#order\n      }\n    });\n    return curNode;\n  }\n  #getHandlerSets(node, method, nodeParams, params) {\n    const handlerSets = [];\n    for (let i = 0, len = node.#methods.length; i < len; i++) {\n      const m = node.#methods[i];\n      const handlerSet = m[method] || m[METHOD_NAME_ALL];\n      const processedSet = {};\n      if (handlerSet !== void 0) {\n        handlerSet.params = /* @__PURE__ */ Object.create(null);\n        handlerSets.push(handlerSet);\n        if (nodeParams !== emptyParams || params && params !== emptyParams) {\n          for (let i2 = 0, len2 = handlerSet.possibleKeys.length; i2 < len2; i2++) {\n            const key = handlerSet.possibleKeys[i2];\n            const processed = processedSet[handlerSet.score];\n            handlerSet.params[key] = params?.[key] && !processed ? params[key] : nodeParams[key] ?? params?.[key];\n            processedSet[handlerSet.score] = true;\n          }\n        }\n      }\n    }\n    return handlerSets;\n  }\n  search(method, path) {\n    const handlerSets = [];\n    this.#params = emptyParams;\n    const curNode = this;\n    let curNodes = [curNode];\n    const parts = splitPath(path);\n    const curNodesQueue = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const part = parts[i];\n      const isLast = i === len - 1;\n      const tempNodes = [];\n      for (let j = 0, len2 = curNodes.length; j < len2; j++) {\n        const node = curNodes[j];\n        const nextNode = node.#children[part];\n        if (nextNode) {\n          nextNode.#params = node.#params;\n          if (isLast) {\n            if (nextNode.#children[\"*\"]) {\n              handlerSets.push(\n                ...this.#getHandlerSets(nextNode.#children[\"*\"], method, node.#params)\n              );\n            }\n            handlerSets.push(...this.#getHandlerSets(nextNode, method, node.#params));\n          } else {\n            tempNodes.push(nextNode);\n          }\n        }\n        for (let k = 0, len3 = node.#patterns.length; k < len3; k++) {\n          const pattern = node.#patterns[k];\n          const params = node.#params === emptyParams ? {} : { ...node.#params };\n          if (pattern === \"*\") {\n            const astNode = node.#children[\"*\"];\n            if (astNode) {\n              handlerSets.push(...this.#getHandlerSets(astNode, method, node.#params));\n              astNode.#params = params;\n              tempNodes.push(astNode);\n            }\n            continue;\n          }\n          const [key, name, matcher] = pattern;\n          if (!part && !(matcher instanceof RegExp)) {\n            continue;\n          }\n          const child = node.#children[key];\n          const restPathString = parts.slice(i).join(\"/\");\n          if (matcher instanceof RegExp) {\n            const m = matcher.exec(restPathString);\n            if (m) {\n              params[name] = m[0];\n              handlerSets.push(...this.#getHandlerSets(child, method, node.#params, params));\n              if (Object.keys(child.#children).length) {\n                child.#params = params;\n                const componentCount = m[0].match(/\\//)?.length ?? 0;\n                const targetCurNodes = curNodesQueue[componentCount] ||= [];\n                targetCurNodes.push(child);\n              }\n              continue;\n            }\n          }\n          if (matcher === true || matcher.test(part)) {\n            params[name] = part;\n            if (isLast) {\n              handlerSets.push(...this.#getHandlerSets(child, method, params, node.#params));\n              if (child.#children[\"*\"]) {\n                handlerSets.push(\n                  ...this.#getHandlerSets(child.#children[\"*\"], method, params, node.#params)\n                );\n              }\n            } else {\n              child.#params = params;\n              tempNodes.push(child);\n            }\n          }\n        }\n      }\n      curNodes = tempNodes.concat(curNodesQueue.shift() ?? []);\n    }\n    if (handlerSets.length > 1) {\n      handlerSets.sort((a, b) => {\n        return a.score - b.score;\n      });\n    }\n    return [handlerSets.map(({ handler, params }) => [handler, params])];\n  }\n};\nexport {\n  Node\n};\n", "// src/router/trie-router/router.ts\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { Node } from \"./node.js\";\nvar TrieRouter = class {\n  name = \"TrieRouter\";\n  #node;\n  constructor() {\n    this.#node = new Node();\n  }\n  add(method, path, handler) {\n    const results = checkOptionalParameter(path);\n    if (results) {\n      for (let i = 0, len = results.length; i < len; i++) {\n        this.#node.insert(method, results[i], handler);\n      }\n      return;\n    }\n    this.#node.insert(method, path, handler);\n  }\n  match(method, path) {\n    return this.#node.search(method, path);\n  }\n};\nexport {\n  TrieRouter\n};\n", "// src/hono.ts\nimport { HonoBase } from \"./hono-base.js\";\nimport { RegExpRouter } from \"./router/reg-exp-router/index.js\";\nimport { SmartRouter } from \"./router/smart-router/index.js\";\nimport { TrieRouter } from \"./router/trie-router/index.js\";\nvar Hono = class extends HonoBase {\n  /**\n   * Creates an instance of the Hono class.\n   *\n   * @param options - Optional configuration options for the Hono instance.\n   */\n  constructor(options = {}) {\n    super(options);\n    this.router = options.router ?? new SmartRouter({\n      routers: [new RegExpRouter(), new TrieRouter()]\n    });\n  }\n};\nexport {\n  Hono\n};\n", "// src/middleware/cors/index.ts\nvar cors = (options) => {\n  const defaults = {\n    origin: \"*\",\n    allowMethods: [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\", \"PATCH\"],\n    allowHeaders: [],\n    exposeHeaders: []\n  };\n  const opts = {\n    ...defaults,\n    ...options\n  };\n  const findAllowOrigin = ((optsOrigin) => {\n    if (typeof optsOrigin === \"string\") {\n      if (optsOrigin === \"*\") {\n        return () => optsOrigin;\n      } else {\n        return (origin) => optsOrigin === origin ? origin : null;\n      }\n    } else if (typeof optsOrigin === \"function\") {\n      return optsOrigin;\n    } else {\n      return (origin) => optsOrigin.includes(origin) ? origin : null;\n    }\n  })(opts.origin);\n  const findAllowMethods = ((optsAllowMethods) => {\n    if (typeof optsAllowMethods === \"function\") {\n      return optsAllowMethods;\n    } else if (Array.isArray(optsAllowMethods)) {\n      return () => optsAllowMethods;\n    } else {\n      return () => [];\n    }\n  })(opts.allowMethods);\n  return async function cors2(c, next) {\n    function set(key, value) {\n      c.res.headers.set(key, value);\n    }\n    const allowOrigin = await findAllowOrigin(c.req.header(\"origin\") || \"\", c);\n    if (allowOrigin) {\n      set(\"Access-Control-Allow-Origin\", allowOrigin);\n    }\n    if (opts.credentials) {\n      set(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n    if (opts.exposeHeaders?.length) {\n      set(\"Access-Control-Expose-Headers\", opts.exposeHeaders.join(\",\"));\n    }\n    if (c.req.method === \"OPTIONS\") {\n      if (opts.origin !== \"*\") {\n        set(\"Vary\", \"Origin\");\n      }\n      if (opts.maxAge != null) {\n        set(\"Access-Control-Max-Age\", opts.maxAge.toString());\n      }\n      const allowMethods = await findAllowMethods(c.req.header(\"origin\") || \"\", c);\n      if (allowMethods.length) {\n        set(\"Access-Control-Allow-Methods\", allowMethods.join(\",\"));\n      }\n      let headers = opts.allowHeaders;\n      if (!headers?.length) {\n        const requestHeaders = c.req.header(\"Access-Control-Request-Headers\");\n        if (requestHeaders) {\n          headers = requestHeaders.split(/\\s*,\\s*/);\n        }\n      }\n      if (headers?.length) {\n        set(\"Access-Control-Allow-Headers\", headers.join(\",\"));\n        c.res.headers.append(\"Vary\", \"Access-Control-Request-Headers\");\n      }\n      c.res.headers.delete(\"Content-Length\");\n      c.res.headers.delete(\"Content-Type\");\n      return new Response(null, {\n        headers: c.res.headers,\n        status: 204,\n        statusText: \"No Content\"\n      });\n    }\n    await next();\n    if (opts.origin !== \"*\") {\n      c.header(\"Vary\", \"Origin\", { append: true });\n    }\n  };\n};\nexport {\n  cors\n};\n", "// src/helper/factory/index.ts\nimport { Hono } from \"../../hono.js\";\nvar Factory = class {\n  initApp;\n  #defaultAppOptions;\n  constructor(init) {\n    this.initApp = init?.initApp;\n    this.#defaultAppOptions = init?.defaultAppOptions;\n  }\n  createApp = (options) => {\n    const app = new Hono(\n      options && this.#defaultAppOptions ? { ...this.#defaultAppOptions, ...options } : options ?? this.#defaultAppOptions\n    );\n    if (this.initApp) {\n      this.initApp(app);\n    }\n    return app;\n  };\n  createMiddleware = (middleware) => middleware;\n  createHandlers = (...handlers) => {\n    return handlers.filter((handler) => handler !== void 0);\n  };\n};\nvar createFactory = (init) => new Factory(init);\nvar createMiddleware = (middleware) => middleware;\nexport {\n  Factory,\n  createFactory,\n  createMiddleware\n};\n", "import type { Context, Next } from 'hono';\nimport { createMiddleware } from 'hono/factory';\n\nexport interface AuthContext {\n  type: 'api_key' | 'cf_access';\n  userId?: string;\n  email?: string;\n}\n\ndeclare module 'hono' {\n  interface ContextVariableMap {\n    auth: AuthContext;\n  }\n}\n\nexport const PUBLIC_PATHS = [\n  '/health',\n  // Public static assets served via the ASSETS binding.\n  // Keep both forms to be resilient to any path matching quirks.\n  '/fonts',\n  '/fonts/',\n  '/images',\n  '/images/',\n  '/v1/scheduling/service_area_check',\n  '/v1/scheduling/timeslots',\n  '/v1/services',\n  '/v1/coupons/validate',\n  '/v1/bookings/create',\n  '/v1/messages/submit',\n  '/webhooks/twilio',\n  '/webhooks/twilio/',\n  '/widget',\n  '/widget/',\n];\n\nfunction isPublicPath(path: string): boolean {\n  return PUBLIC_PATHS.some((publicPath) => {\n    if (path === publicPath) return true;\n    // Prefix match with a boundary: '/widget' should match '/widget/..' but not '/widgetize'.\n    const prefix = publicPath.endsWith('/') ? publicPath.slice(0, -1) : publicPath;\n    return path.startsWith(`${prefix}/`);\n  });\n}\n\nasync function verifyApiKey(db: D1Database, key: string): Promise<boolean> {\n  if (!key || key.length < 10) return false;\n  \n  const prefix = key.substring(0, 8);\n  const result = await db.prepare(\n    'SELECT key_hash FROM api_keys WHERE key_prefix = ? AND is_active = 1'\n  ).bind(prefix).first<{ key_hash: string }>();\n  \n  if (!result) return false;\n  \n  const encoder = new TextEncoder();\n  const data = encoder.encode(key);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n  \n  const isValid = hashHex === result.key_hash;\n  \n  if (isValid) {\n    await db.prepare(\n      'UPDATE api_keys SET last_used_at = datetime(\"now\") WHERE key_prefix = ?'\n    ).bind(prefix).run();\n  }\n  \n  return isValid;\n}\n\nfunction base64UrlDecode(str: string): Uint8Array {\n  const base64 = str.replace(/-/g, '+').replace(/_/g, '/');\n  const padded = base64 + '='.repeat((4 - base64.length % 4) % 4);\n  const binary = atob(padded);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) {\n    bytes[i] = binary.charCodeAt(i);\n  }\n  return bytes;\n}\n\ninterface JWK {\n  kid: string;\n  kty: string;\n  alg: string;\n  n?: string;\n  e?: string;\n  crv?: string;\n  x?: string;\n  y?: string;\n}\n\ninterface JWKSResponse {\n  keys: JWK[];\n}\n\nlet cachedJwks: { keys: JWK[]; fetchedAt: number } | null = null;\nconst JWKS_CACHE_TTL_MS = 60 * 60 * 1000;\n\nasync function getJwks(teamDomain: string): Promise<JWK[]> {\n  if (cachedJwks && Date.now() - cachedJwks.fetchedAt < JWKS_CACHE_TTL_MS) {\n    return cachedJwks.keys;\n  }\n  \n  const certsUrl = `https://${teamDomain}.cloudflareaccess.com/cdn-cgi/access/certs`;\n  const response = await fetch(certsUrl);\n  if (!response.ok) {\n    throw new Error(`Failed to fetch JWKS: ${response.status}`);\n  }\n  \n  const jwks = await response.json() as JWKSResponse;\n  cachedJwks = { keys: jwks.keys, fetchedAt: Date.now() };\n  return jwks.keys;\n}\n\nasync function importJwk(jwk: JWK): Promise<CryptoKey> {\n  return crypto.subtle.importKey(\n    'jwk',\n    jwk,\n    { name: 'RSASSA-PKCS1-v1_5', hash: 'SHA-256' },\n    false,\n    ['verify']\n  );\n}\n\nfunction decodeJwtPayload(part: string): Record<string, unknown> | null {\n  try {\n    return JSON.parse(new TextDecoder().decode(base64UrlDecode(part)));\n  } catch {\n    try {\n      return JSON.parse(atob(part));\n    } catch {\n      return null;\n    }\n  }\n}\n\nasync function verifyCfAccessJwt(\n  token: string,\n  teamDomain: string,\n  aud?: string\n): Promise<{ email: string; userId: string } | null> {\n  try {\n    const parts = token.split('.');\n    if (parts.length !== 3) return null;\n    \n    const headerJson = decodeJwtPayload(parts[0]);\n    const payload = decodeJwtPayload(parts[1]);\n    if (!payload) return null;\n    \n    if (payload.exp && (payload.exp as number) * 1000 < Date.now()) {\n      return null;\n    }\n    \n    if (aud && payload.aud) {\n      const audiences = Array.isArray(payload.aud) ? payload.aud : [payload.aud];\n      if (!audiences.includes(aud)) {\n        return null;\n      }\n    }\n    \n    if (teamDomain && headerJson?.kid) {\n      try {\n        const keys = await getJwks(teamDomain);\n        const matchingKey = keys.find(k => k.kid === headerJson.kid);\n        \n        if (matchingKey) {\n          const cryptoKey = await importJwk(matchingKey);\n          const signatureBytes = base64UrlDecode(parts[2]);\n          const dataBytes = new TextEncoder().encode(`${parts[0]}.${parts[1]}`);\n          \n          const valid = await crypto.subtle.verify(\n            'RSASSA-PKCS1-v1_5',\n            cryptoKey,\n            signatureBytes,\n            dataBytes\n          );\n          \n          if (!valid) return null;\n        }\n      } catch {\n        // JWKS verification failed - fall through to basic decode for dev/test tokens\n      }\n    }\n    \n    if (!payload.email || !payload.sub) return null;\n    \n    return {\n      email: payload.email as string,\n      userId: payload.sub as string\n    };\n  } catch {\n    return null;\n  }\n}\n\nexport const authMiddleware = createMiddleware(async (c: Context, next: Next) => {\n  const path = c.req.path;\n  \n  if (isPublicPath(path)) {\n    c.set('auth', { type: 'api_key' });\n    return next();\n  }\n  \n  const teamDomain = c.env?.CF_ACCESS_TEAM_DOMAIN || '';\n  const accessAud = c.env?.CF_ACCESS_AUD || '';\n  \n  const cfAccessToken = c.req.header('CF-Access-JWT-Assertion');\n  if (cfAccessToken) {\n    const cfUser = await verifyCfAccessJwt(cfAccessToken, teamDomain, accessAud || undefined);\n    if (cfUser) {\n      c.set('auth', {\n        type: 'cf_access',\n        email: cfUser.email,\n        userId: cfUser.userId\n      });\n      return next();\n    }\n  }\n  \n  const authHeader = c.req.header('Authorization');\n  \n  if (authHeader?.startsWith('Bearer ')) {\n    const token = authHeader.substring(7);\n    \n    const cfUser = await verifyCfAccessJwt(token, teamDomain, accessAud || undefined);\n    if (cfUser) {\n      c.set('auth', {\n        type: 'cf_access',\n        email: cfUser.email,\n        userId: cfUser.userId\n      });\n      return next();\n    }\n    \n    const db = c.env.DB;\n    const isValidKey = await verifyApiKey(db, token);\n    if (isValidKey) {\n      c.set('auth', { type: 'api_key' });\n      return next();\n    }\n  }\n  \n  return c.json({ error: 'Unauthorized', message: 'Valid authentication required' }, 401);\n});\n\nexport function requireAuth() {\n  return createMiddleware(async (c: Context, next: Next) => {\n    const auth = c.get('auth');\n    if (!auth) {\n      return c.json({ error: 'Unauthorized' }, 401);\n    }\n    await next();\n  });\n}\n", "type LocationInput = {\n  postalCode?: string;\n  lat?: number;\n  lng?: number;\n};\n\ntype ServiceAreaResult = {\n  within: boolean;\n  distance?: number;\n};\n\ntype RadiusArea = {\n  center?: { lat?: number; lng?: number };\n  radius_miles?: number;\n};\n\ntype GeofencePoint = { lat: number; lng: number };\n\nconst EARTH_RADIUS_KM = 6371;\n\nconst toRadians = (value: number): number => (value * Math.PI) / 180;\n\nconst parseJson = (value: string): Record<string, unknown> => {\n  try {\n    const parsed = JSON.parse(value);\n    if (parsed && typeof parsed === 'object') {\n      return parsed as Record<string, unknown>;\n    }\n  } catch {\n  }\n  return {};\n};\n\nconst normalizePostalCode = (postalCode?: string): string => {\n  if (!postalCode) return '';\n  return postalCode.replace(/\\s+/g, '').toUpperCase();\n};\n\nconst firstThree = (postalCode?: string): string => normalizePostalCode(postalCode).slice(0, 3);\n\nconst haversineKm = (lat1: number, lng1: number, lat2: number, lng2: number): number => {\n  const dLat = toRadians(lat2 - lat1);\n  const dLng = toRadians(lng2 - lng1);\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRadians(lat1)) * Math.cos(toRadians(lat2)) * Math.sin(dLng / 2) * Math.sin(dLng / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return EARTH_RADIUS_KM * c;\n};\n\nconst toGeofencePoint = (value: unknown): GeofencePoint | null => {\n  if (Array.isArray(value) && value.length >= 2) {\n    const a = Number(value[0]);\n    const b = Number(value[1]);\n    if (Number.isFinite(a) && Number.isFinite(b)) {\n      // Historically we have stored both [lng, lat] and [lat, lng].\n      // Leaflet's LatLng is (lat, lng) and our admin UI currently serializes [lat, lng].\n      // Range-based detection alone is ambiguous for many North American longitudes\n      // (e.g. -77 is valid for both lat and lng), so we also use a sign heuristic.\n      const absA = Math.abs(a);\n      const absB = Math.abs(b);\n\n      // If one value is clearly longitude (> 90), it's unambiguous.\n      if (absA > 90 && absA <= 180 && absB <= 90) {\n        return { lat: b, lng: a };\n      }\n      if (absB > 90 && absB <= 180 && absA <= 90) {\n        return { lat: a, lng: b };\n      }\n\n      // If exactly one is negative, assume negative is longitude and positive is latitude.\n      // This matches our typical service areas (Canada/US): lat > 0, lng < 0.\n      if ((a < 0 && b > 0) || (a > 0 && b < 0)) {\n        const lat = a > 0 ? a : b;\n        const lng = a < 0 ? a : b;\n        if (Math.abs(lat) <= 90 && Math.abs(lng) <= 180) {\n          return { lat, lng };\n        }\n      }\n\n      // Ambiguous ranges (both could be lat/lng). Default to [lat, lng]\n      // because that's what our current admin UI emits.\n      return { lat: a, lng: b };\n    }\n  }\n\n  if (value && typeof value === 'object') {\n    const candidate = value as Record<string, unknown>;\n    const lat = Number(candidate.lat);\n    const lng = Number(candidate.lng);\n    if (Number.isFinite(lat) && Number.isFinite(lng)) {\n      return { lat, lng };\n    }\n  }\n\n  return null;\n};\n\nconst pointInPolygon = (point: GeofencePoint, polygon: GeofencePoint[]): boolean => {\n  let inside = false;\n  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\n    const pi = polygon[i];\n    const pj = polygon[j];\n\n    const intersects =\n      (pi.lat > point.lat) !== (pj.lat > point.lat) &&\n      point.lng < ((pj.lng - pi.lng) * (point.lat - pi.lat)) / ((pj.lat - pi.lat) || Number.EPSILON) + pi.lng;\n\n    if (intersects) inside = !inside;\n  }\n  return inside;\n};\n\nexport function checkServiceArea(\n  areaType: string,\n  areaData: string,\n  location: LocationInput,\n  _bufferKm = 0\n): ServiceAreaResult {\n  const parsed = parseJson(areaData);\n\n  if (areaType === 'zip') {\n    const zipPrefixesRaw = parsed.zip_codes ?? parsed.zipCodes;\n    const zipPrefixes = Array.isArray(zipPrefixesRaw)\n      ? zipPrefixesRaw.map((z) => firstThree(String(z))).filter(Boolean)\n      : [];\n    const locationPrefix = firstThree(location.postalCode);\n    if (!locationPrefix || zipPrefixes.length === 0) {\n      return { within: false };\n    }\n    return { within: zipPrefixes.some((prefix) => locationPrefix.startsWith(prefix)) };\n  }\n\n  if (areaType === 'radius') {\n    const radiusData = parsed as RadiusArea;\n    const centerLat = Number(radiusData.center?.lat);\n    const centerLng = Number(radiusData.center?.lng);\n    const radiusMiles = Number(radiusData.radius_miles);\n\n    if (!Number.isFinite(centerLat) || !Number.isFinite(centerLng) || !Number.isFinite(radiusMiles)) {\n      return { within: false };\n    }\n    if (!Number.isFinite(location.lat) || !Number.isFinite(location.lng)) {\n      return { within: false };\n    }\n\n    const distanceKm = haversineKm(centerLat, centerLng, location.lat, location.lng);\n    const radiusKm = radiusMiles * 1.609344;\n\n    return {\n      within: distanceKm <= radiusKm,\n      distance: distanceKm,\n    };\n  }\n\n  if (areaType === 'geofence') {\n    const rawPolygon = parsed.polygon;\n    const polygon = Array.isArray(rawPolygon)\n      ? rawPolygon.map((p) => toGeofencePoint(p)).filter((p): p is GeofencePoint => p !== null)\n      : [];\n\n    if (polygon.length < 3 || !Number.isFinite(location.lat) || !Number.isFinite(location.lng)) {\n      return { within: false };\n    }\n\n    return {\n      within: pointInPolygon({ lat: location.lat, lng: location.lng }, polygon),\n    };\n  }\n\n  return { within: false };\n}\n", "// biome-ignore assist/source/organizeImports: keep imports stable for this file\nimport { type Context, Hono } from 'hono';\nimport { checkServiceArea } from '../geo/service-area';\nimport { sendJobSms, sendDirectSms, normalizePhoneE164, getTwilioConfig, isTwilioEnabled, ensureSmsInboxMessage } from '../services/twilio';\nimport type { TemplateVars } from '../services/twilio';\nimport { buildServiceBaseLine, normalizeLine, parseEditableText, parsePriceLines, subtotalFromLines, type PriceLineItem } from '../utils/line-items';\nimport { type FormField, FormView, TableView } from '../views/components';\nimport { BrandingPage } from '../views/branding';\nimport { MessageDetailPage, SmsHistoryList, SmsThreadPanel } from '../views/message-detail';\nimport type { SmsLogRow } from '../views/message-detail';\nimport { Dashboard } from '../views/dashboard';\nimport { JobDetailPage, SmsThreadCard } from '../views/job-detail';\nimport { AddressSearchResults, CustomerSearchResults, JobWizardPage, JobWizardSwapBundle, parseWizardState, type NewJobProps, type WizardState } from '../views/job-wizard';\nimport { ProviderDetailPage } from '../views/provider-detail';\nimport { ServiceDetailPage } from '../views/service-detail';\nimport { GeofencePanel, RadiusPanel, TerritoryDetailPage, ZipPanel } from '../views/territory-detail';\nimport { SmsSettingsPage } from '../views/sms-settings';\nimport { PUSH_MANIFEST, PUSH_SERVICE_WORKER_SCRIPT, PushSettingsPage } from '../views/push-settings';\nimport { InvoiceDetailPage } from '../views/invoice-detail';\nimport { formatTorontoDate } from '../utils/datetime';\nimport {\n  deactivatePushSubscription,\n  enqueueTestPushNotificationAndPing,\n  getPushSubscriptionStatus,\n  getPushVapidPublicKey,\n  pullPendingPushNotifications,\n  upsertPushSubscription,\n} from '../services/notifications';\n\ntype WizardCustomer = { id: string; first_name: string; last_name: string; email?: string; phone?: string };\ntype WizardService = { id: string; name: string; description?: string; base_price_cents: number; base_duration_minutes: number };\ntype InboxJobOption = { id: string; label: string };\n\n\nconst parseJsonObject = (raw: string | null | undefined): Record<string, unknown> | null => {\n  if (!raw) return null;\n  try {\n    const parsed = JSON.parse(raw) as unknown;\n    if (parsed && typeof parsed === 'object' && !Array.isArray(parsed)) {\n      return parsed as Record<string, unknown>;\n    }\n  } catch {\n    return null;\n  }\n  return null;\n};\n\nconst toTaskTitle = (text: string) => {\n  const compact = text.replace(/\\s+/g, ' ').trim();\n  if (!compact) return '';\n  if (compact.length <= 72) return compact;\n  return `${compact.slice(0, 69).trimEnd()}...`;\n};\n\nconst getCompletedSmsTaskIds = async (db: D1Database, jobId: string | null): Promise<string[]> => {\n  if (!jobId) return [];\n  const job = await db.prepare('SELECT notes_json FROM jobs WHERE id = ?').bind(jobId).first<{ notes_json: string | null }>();\n  if (!job?.notes_json) return [];\n\n  const completed = new Set<string>();\n  try {\n    const notes = JSON.parse(job.notes_json) as unknown;\n    if (!Array.isArray(notes)) return [];\n\n    for (const note of notes) {\n      if (!note || typeof note !== 'object' || Array.isArray(note)) continue;\n      const noteRecord = note as Record<string, unknown>;\n      if (!noteRecord.completed) continue;\n      const source = noteRecord.source;\n      if (!source || typeof source !== 'object' || Array.isArray(source)) continue;\n      const sourceRecord = source as Record<string, unknown>;\n      if (sourceRecord.type !== 'sms') continue;\n      if (typeof sourceRecord.sms_log_id === 'string' && sourceRecord.sms_log_id.trim()) {\n        completed.add(sourceRecord.sms_log_id);\n      }\n    }\n  } catch {\n    return [];\n  }\n\n  return Array.from(completed);\n};\n\ntype AdminContext = Context<{ Bindings: { DB: D1Database; MAPBOX_ACCESS_TOKEN?: string } }>;\n\nconst app = new Hono<{ Bindings: { DB: D1Database; MAPBOX_ACCESS_TOKEN?: string } }>();\n\nconst generateId = () => crypto.randomUUID();\n\nconst getAuthenticatedStaffEmail = (c: Context): string | null => {\n  const auth = c.get('auth');\n  if (!auth || auth.type !== 'cf_access' || !auth.email) return null;\n  return auth.email;\n};\n\nconst normalizeEmail = (value: string | null | undefined) => {\n  const trimmed = (value || '').trim();\n  return trimmed ? trimmed.toLowerCase() : null;\n};\n\nconst parseMoneyToCents = (value: unknown): number => {\n  if (typeof value === 'number' && Number.isFinite(value)) return Math.max(0, Math.round(value));\n  if (typeof value !== 'string') return 0;\n  const cleaned = value.trim().replace(/[$,]/g, '');\n  const parsed = Number.parseFloat(cleaned);\n  if (!Number.isFinite(parsed)) return 0;\n  return Math.max(0, Math.round(parsed * 100));\n};\n\nconst formatCents = (value: number) => `$${(value / 100).toFixed(2)}`;\n\nconst nextInvoiceNumber = async (db: D1Database) => {\n  const row = await db.prepare(\"SELECT invoice_number FROM invoices WHERE invoice_number LIKE 'INV-%' ORDER BY invoice_number DESC LIMIT 1\")\n    .first<{ invoice_number: string | null }>();\n  const suffix = row?.invoice_number ? Number.parseInt(row.invoice_number.replace('INV-', ''), 10) : 0;\n  const next = Number.isFinite(suffix) ? suffix + 1 : 1;\n  return `INV-${String(next).padStart(6, '0')}`;\n};\n\nconst parseInvoiceLineItems = parseEditableText;\n\nconst recomputeJobTotals = async (db: D1Database, jobId: string): Promise<void> => {\n  const job = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(jobId).first<{ line_items_json: string | null }>();\n  if (!job) return;\n  const lines = parsePriceLines(job.line_items_json);\n  const total = subtotalFromLines(lines);\n  const base = lines.find((line) => line.kind === 'service')?.total_cents || total;\n  await db.prepare(\"UPDATE jobs SET base_price_cents = ?, total_price_cents = ?, updated_at = datetime('now') WHERE id = ?\")\n    .bind(base, total, jobId)\n    .run();\n};\n\nconst syncInvoiceFromJob = async (db: D1Database, jobId: string): Promise<void> => {\n  const [job, invoice] = await Promise.all([\n    db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(jobId).first<{ line_items_json: string | null }>(),\n    db.prepare('SELECT id, tax_cents, discount_cents FROM invoices WHERE job_id = ? AND status IN (\\'pending\\', \\'sent\\') ORDER BY created_at DESC LIMIT 1').bind(jobId).first<{ id: string; tax_cents: number; discount_cents: number }>(),\n  ]);\n  if (!job || !invoice) return;\n  const lines = parsePriceLines(job.line_items_json);\n  const subtotal = subtotalFromLines(lines);\n  const total = Math.max(0, subtotal + Number(invoice.tax_cents || 0) - Number(invoice.discount_cents || 0));\n  await db.prepare(\n    `UPDATE invoices\n     SET line_items_json = ?, subtotal_cents = ?, amount_cents = ?, total_cents = ?, updated_at = datetime('now')\n     WHERE id = ?`\n  ).bind(JSON.stringify(lines), subtotal, total, total, invoice.id).run();\n};\n\nconst writeInvoiceLines = async (db: D1Database, invoiceId: string, lines: PriceLineItem[]): Promise<void> => {\n  const invoice = await db.prepare('SELECT tax_cents, discount_cents FROM invoices WHERE id = ?').bind(invoiceId).first<{ tax_cents: number; discount_cents: number }>();\n  if (!invoice) return;\n  const subtotal = subtotalFromLines(lines);\n  const total = Math.max(0, subtotal + Number(invoice.tax_cents || 0) - Number(invoice.discount_cents || 0));\n  await db.prepare(\n    `UPDATE invoices\n     SET line_items_json = ?, subtotal_cents = ?, amount_cents = ?, total_cents = ?, updated_at = datetime('now')\n     WHERE id = ?`\n  ).bind(JSON.stringify(lines), subtotal, total, total, invoiceId).run();\n};\n\nconst parseImportedCustomers = (raw: string): Array<{ first_name: string; last_name: string; email: string | null; phone: string | null }> => {\n  const text = raw.trim();\n  if (!text) return [];\n  const lines = text.split(/\\r?\\n/).map((line) => line.trim()).filter(Boolean);\n  if (lines.length === 0) return [];\n\n  const looksLikeCsvHeader = /first.?name|last.?name|email|phone|name/i.test(lines[0]);\n  if (looksLikeCsvHeader) {\n    const headers = lines[0].split(',').map((h) => h.trim().toLowerCase());\n    const findIndex = (keys: string[]) => {\n      for (const key of keys) {\n        const idx = headers.indexOf(key);\n        if (idx >= 0) return idx;\n      }\n      return -1;\n    };\n    const firstNameIndex = findIndex(['first_name', 'firstname', 'first name']);\n    const lastNameIndex = findIndex(['last_name', 'lastname', 'last name']);\n    const nameIndex = findIndex(['name', 'full_name', 'full name']);\n    const emailIndex = findIndex(['email', 'email_address', 'email address']);\n    const phoneIndex = findIndex(['phone', 'phone_number', 'phone number', 'mobile']);\n\n    return lines.slice(1).map((line) => {\n      const cols = line.split(',').map((cell) => cell.trim());\n      const fullName = nameIndex >= 0 ? (cols[nameIndex] || '') : '';\n      const explicitFirst = firstNameIndex >= 0 ? (cols[firstNameIndex] || '') : '';\n      const explicitLast = lastNameIndex >= 0 ? (cols[lastNameIndex] || '') : '';\n      const nameParts = fullName.split(/\\s+/).filter(Boolean);\n      const first_name = explicitFirst || nameParts[0] || '';\n      const last_name = explicitLast || nameParts.slice(1).join(' ') || '';\n      return {\n        first_name,\n        last_name,\n        email: emailIndex >= 0 ? normalizeEmail(cols[emailIndex] || null) : null,\n        phone: phoneIndex >= 0 ? (cols[phoneIndex] || null) : null,\n      };\n    }).filter((entry) => entry.first_name && entry.last_name);\n  }\n\n  return lines.map((line) => {\n    const emailMatch = line.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}/i);\n    const phoneMatch = line.match(/(\\+?\\d[\\d\\s().-]{7,}\\d)/);\n    const cleaned = line\n      .replace(emailMatch?.[0] || '', '')\n      .replace(phoneMatch?.[0] || '', '')\n      .replace(/[<>]/g, ' ')\n      .trim();\n    const parts = cleaned.split(/\\s+/).filter(Boolean);\n    return {\n      first_name: parts[0] || '',\n      last_name: parts.slice(1).join(' ') || '',\n      email: normalizeEmail(emailMatch?.[0] || null),\n      phone: phoneMatch?.[0]?.trim() || null,\n    };\n  }).filter((entry) => entry.first_name && entry.last_name);\n};\n\napp.get('/', async (c) => {\n  const db = c.env.DB;\n  \n  const today = new Date().toISOString().split('T')[0];\n  const weekFromNow = new Date();\n  weekFromNow.setDate(weekFromNow.getDate() + 7);\n  \n  const [\n    todayJobs,\n    weekJobs,\n    totalCustomers,\n    activeTerritories,\n    activeProviders,\n    pendingInvoices,\n    upcomingJobs,\n    recentBookings,\n    recentMessages\n  ] = await Promise.all([\n    db.prepare(`\n      SELECT COUNT(*) as count FROM jobs \n      WHERE scheduled_date = ? AND status != 'cancelled'\n    `).bind(today).first<{ count: number }>(),\n    \n    db.prepare(`\n      SELECT COUNT(*) as count FROM jobs \n      WHERE scheduled_date BETWEEN ? AND ? AND status != 'cancelled'\n    `).bind(today, weekFromNow.toISOString().split('T')[0]).first<{ count: number }>(),\n    \n    db.prepare('SELECT COUNT(*) as count FROM customers').first<{ count: number }>(),\n    \n    db.prepare('SELECT COUNT(*) as count FROM territories WHERE is_active = 1').first<{ count: number }>(),\n    \n    db.prepare(`\n      SELECT COUNT(*) as count FROM team_members \n      WHERE is_active = 1 AND role = 'provider'\n    `).first<{ count: number }>(),\n    \n    db.prepare(`\n      SELECT COUNT(*) as count FROM invoices \n      WHERE status IN ('pending', 'sent')\n    `).first<{ count: number }>(),\n    \n    db.prepare(`\n      SELECT j.id, c.first_name || ' ' || c.last_name as customer_name,\n             s.name as service_name, j.scheduled_date, j.scheduled_start_time, j.status\n      FROM jobs j\n      JOIN customers c ON j.customer_id = c.id\n      LEFT JOIN services s ON j.service_id = s.id\n      WHERE j.scheduled_date BETWEEN ? AND ?\n      AND j.status NOT IN ('cancelled', 'complete')\n      ORDER BY j.scheduled_date, j.scheduled_start_time\n      LIMIT 10\n    `).bind(today, weekFromNow.toISOString().split('T')[0]).all(),\n    \n    db.prepare(`\n      SELECT j.id, c.first_name || ' ' || c.last_name as customer_name,\n             s.name as service_name, t.name as territory_name, j.status, j.created_at, j.total_price_cents\n      FROM jobs j\n      JOIN customers c ON j.customer_id = c.id\n      LEFT JOIN services s ON j.service_id = s.id\n      LEFT JOIN territories t ON j.territory_id = t.id\n      ORDER BY j.created_at DESC\n      LIMIT 10\n    `).all(),\n    \n    db.prepare(`\n      SELECT id, first_name, last_name, email, subject, is_read, created_at\n      FROM messages\n      ORDER BY created_at DESC\n      LIMIT 10\n    `).all()\n  ]);\n  \n  const stats = {\n    todayJobs: todayJobs?.count || 0,\n    weekJobs: weekJobs?.count || 0,\n    totalCustomers: totalCustomers?.count || 0,\n    activeTerritories: activeTerritories?.count || 0,\n    activeProviders: activeProviders?.count || 0,\n    pendingInvoices: pendingInvoices?.count || 0\n  };\n  \n  const dashboardHtml = Dashboard({ \n    stats,\n    upcomingJobs: upcomingJobs.results || [],\n    recentBookings: recentBookings.results || [],\n    recentMessages: recentMessages.results || []\n  });\n  \n  return c.html(dashboardHtml);\n});\n\napp.get('/territories', async (c) => {\n  const db = c.env.DB;\n  const territories = await db.prepare(`\n    SELECT id, name, service_area_type, scheduling_policy, is_active\n    FROM territories WHERE is_active = 1 ORDER BY name\n  `).all();\n  \n  const rows = (territories.results || []).map(t => ({\n    name: t.name,\n    areaType: t.service_area_type,\n    scheduling: t.scheduling_policy,\n    active: t.is_active ? 'active' : 'inactive'\n  }));\n  \n  return c.html(TableView({\n    title: 'Territories',\n    columns: ['Name', 'Area Type', 'Scheduling', 'Active'],\n    rows,\n    rawIds: (territories.results || []).map(t => t.id as string),\n    createUrl: '/admin/territories/new',\n    detailUrlPrefix: '/admin/territories',\n    deleteUrlPrefix: '/admin/territories'\n  }));\n});\n\napp.get('/territories/new', (c) => {\n  return c.html(TerritoryDetailPage({\n    territory: {\n      id: '', name: '', timezone: 'America/Toronto',\n      service_area_type: 'zip', service_area_data: '{}',\n      operating_hours: '{}', scheduling_policy: 'provider_based',\n      is_active: 1\n    },\n    services: [],\n    providers: [],\n    isNew: true\n  }));\n});\n\napp.post('/territories', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  await db.prepare(`\n    INSERT INTO territories (id, name, timezone, service_area_type, service_area_data, scheduling_policy, is_active)\n    VALUES (?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.name,\n    body.timezone || 'America/Toronto',\n    body.service_area_type,\n    body.service_area_data || '{}',\n    body.scheduling_policy,\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect(`/admin/territories/${id}`);\n});\n\napp.get('/territories/:id/edit', async (c) => {\n  return c.redirect(`/admin/territories/${c.req.param('id')}`);\n});\n\napp.post('/territories/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const section = body._section as string | undefined;\n\n  if (section === 'basic') {\n    await db.prepare(`\n      UPDATE territories\n      SET name = ?, timezone = ?, scheduling_policy = ?, is_active = ?, updated_at = datetime('now')\n      WHERE id = ?\n    `).bind(\n      body.name,\n      body.timezone || 'America/New_York',\n      body.scheduling_policy,\n      body.is_active === 'on' ? 1 : 0,\n      id\n    ).run();\n\n    return c.redirect(`/admin/territories/${id}`);\n  }\n  \n  await db.prepare(`\n    UPDATE territories \n    SET name = ?, timezone = ?, service_area_type = ?, service_area_data = ?, scheduling_policy = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.name,\n    body.timezone || 'America/New_York',\n    body.service_area_type,\n    body.service_area_data || '{}',\n    body.scheduling_policy,\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect(`/admin/territories/${id}`);\n});\n\napp.post('/territories/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM territory_services WHERE territory_id = ?').bind(id).run();\n  await db.prepare('DELETE FROM team_member_territories WHERE territory_id = ?').bind(id).run();\n  await db.prepare(\"UPDATE territories SET is_active = 0, updated_at = datetime('now') WHERE id = ?\").bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/territories/${id}`)) {\n      c.header('HX-Redirect', '/admin/territories');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/territories');\n});\n\napp.get('/territories/:id/area-panel/:type', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const panelType = c.req.param('type');\n  const territory = await db.prepare('SELECT service_area_type, service_area_data FROM territories WHERE id = ?').bind(id).first();\n  const areaData = JSON.parse((territory?.service_area_data as string) || '{}');\n  const zipCodes: string[] = areaData.zip_codes || areaData.zipCodes || [];\n\n  if (panelType === 'zip') return c.html(ZipPanel({ tid: id, zipCodes }));\n  if (panelType === 'radius') return c.html(RadiusPanel({ tid: id, areaData }));\n  if (panelType === 'geofence') return c.html(GeofencePanel({ tid: id, areaData }));\n  return c.text('Unknown panel type', 400);\n});\n\napp.get('/territories/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/territories/new');\n  \n  const territory = await db.prepare('SELECT * FROM territories WHERE id = ?').bind(id).first();\n  if (!territory) return c.redirect('/admin/territories');\n  \n  const [allServices, territoryServices, allProviders, territoryProviders] = await Promise.all([\n    db.prepare('SELECT id, name FROM services WHERE is_active = 1 ORDER BY name').all(),\n    db.prepare('SELECT service_id FROM territory_services WHERE territory_id = ?').bind(id).all(),\n    db.prepare(\"SELECT id, first_name, last_name FROM team_members WHERE role = 'provider' ORDER BY last_name\").all(),\n    db.prepare('SELECT team_member_id FROM team_member_territories WHERE territory_id = ?').bind(id).all()\n  ]);\n  \n  const assignedServiceIds = new Set((territoryServices.results || []).map(r => r.service_id as string));\n  const assignedProviderIds = new Set((territoryProviders.results || []).map(r => r.team_member_id as string));\n\n  const territoryModel = territory as unknown as {\n    id: string;\n    name: string;\n    timezone: string;\n    service_area_type: string;\n    service_area_data: string;\n    operating_hours: string;\n    scheduling_policy: string;\n    max_concurrent_jobs?: number;\n    is_active: number;\n  };\n  \n  return c.html(TerritoryDetailPage({\n    territory: territoryModel,\n    services: (allServices.results || []).map(s => ({ id: s.id as string, name: s.name as string, assigned: assignedServiceIds.has(s.id as string) })),\n    providers: (allProviders.results || []).map(p => ({ id: p.id as string, first_name: p.first_name as string, last_name: p.last_name as string, assigned: assignedProviderIds.has(p.id as string) }))\n  }));\n});\n\napp.post('/territories/:id/area', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const areaType = body.service_area_type as string;\n  let areaData = '{}';\n  \n  if (areaType === 'zip') {\n    const zips = (body.zip_codes as string).split(',').map(z => z.trim()).filter(Boolean);\n    areaData = JSON.stringify({ zip_codes: zips });\n  } else if (areaType === 'radius') {\n    areaData = JSON.stringify({ center: { lat: parseFloat(body.center_lat as string), lng: parseFloat(body.center_lng as string) }, radius_miles: parseFloat(body.radius_miles as string) });\n  } else if (areaType === 'geofence') {\n    const rawJson = body.polygon_json as string || '[]';\n    try {\n      const parsed = JSON.parse(rawJson);\n      const polygon = Array.isArray(parsed) ? parsed : (parsed.polygon || []);\n      areaData = JSON.stringify({ polygon });\n    } catch {\n      areaData = JSON.stringify({ polygon: [] });\n    }\n  }\n  \n  await db.prepare(\"UPDATE territories SET service_area_type = ?, service_area_data = ?, updated_at = datetime('now') WHERE id = ?\").bind(areaType, areaData, id).run();\n  return c.body('', 200);\n});\n\napp.post('/territories/:id/hours', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const dayKeys = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun'];\n  const hours: Record<string, { start: string; end: string } | null> = {};\n  \n  for (const key of dayKeys) {\n    if (body[`${key}_enabled`] === 'on') {\n      hours[key] = { start: body[`${key}_start`] as string, end: body[`${key}_end`] as string };\n    } else {\n      hours[key] = null;\n    }\n  }\n  \n  await db.prepare(\"UPDATE territories SET operating_hours = ?, updated_at = datetime('now') WHERE id = ?\").bind(JSON.stringify(hours), id).run();\n  return c.body('', 200);\n});\n\napp.post('/territories/:id/services', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const serviceIds = Array.isArray(body.service_ids) ? body.service_ids : (body.service_ids ? [body.service_ids] : []);\n  \n  await db.prepare('DELETE FROM territory_services WHERE territory_id = ?').bind(id).run();\n  for (const sid of serviceIds) {\n    await db.prepare('INSERT INTO territory_services (territory_id, service_id) VALUES (?, ?)').bind(id, sid).run();\n  }\n  return c.redirect(`/admin/territories/${id}`);\n});\n\napp.post('/territories/:id/services/:serviceId/toggle', async (c) => {\n  const db = c.env.DB;\n  const territoryId = c.req.param('id');\n  const serviceId = c.req.param('serviceId');\n\n  const existing = await db.prepare('SELECT 1 FROM territory_services WHERE territory_id = ? AND service_id = ?').bind(territoryId, serviceId).first();\n  if (existing) {\n    await db.prepare('DELETE FROM territory_services WHERE territory_id = ? AND service_id = ?').bind(territoryId, serviceId).run();\n  } else {\n    await db.prepare('INSERT INTO territory_services (territory_id, service_id) VALUES (?, ?)').bind(territoryId, serviceId).run();\n  }\n\n  return c.body('', 200);\n});\n\napp.post('/territories/:id/providers', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const providerIds = Array.isArray(body.provider_ids) ? body.provider_ids : (body.provider_ids ? [body.provider_ids] : []);\n  \n  await db.prepare('DELETE FROM team_member_territories WHERE territory_id = ?').bind(id).run();\n  for (const pid of providerIds) {\n    await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(pid, id).run();\n  }\n  return c.redirect(`/admin/territories/${id}`);\n});\n\napp.post('/territories/:id/providers/:providerId/toggle', async (c) => {\n  const db = c.env.DB;\n  const territoryId = c.req.param('id');\n  const providerId = c.req.param('providerId');\n\n  const existing = await db.prepare('SELECT 1 FROM team_member_territories WHERE territory_id = ? AND team_member_id = ?').bind(territoryId, providerId).first();\n  if (existing) {\n    await db.prepare('DELETE FROM team_member_territories WHERE territory_id = ? AND team_member_id = ?').bind(territoryId, providerId).run();\n  } else {\n    await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(providerId, territoryId).run();\n  }\n\n  return c.body('', 200);\n});\n\napp.get('/services', async (c) => {\n  const db = c.env.DB;\n  const services = await db.prepare(`\n    SELECT s.id, s.name, s.base_price_cents, s.base_duration_minutes, s.is_active, c.name as category_name\n    FROM services s\n    LEFT JOIN service_categories c ON s.category_id = c.id\n    WHERE s.is_active = 1\n    ORDER BY s.name\n  `).all();\n  \n  const rows = (services.results || []).map(s => ({\n    name: s.name,\n    price: `$${((s.base_price_cents as number) / 100).toFixed(2)}`,\n    duration: `${s.base_duration_minutes} min`,\n    active: s.is_active ? 'active' : 'inactive'\n  }));\n  \n  return c.html(TableView({\n    title: 'Services',\n    columns: ['Name', 'Price', 'Duration', 'Active'],\n    rows,\n    rawIds: (services.results || []).map(s => s.id as string),\n    createUrl: '/admin/services/new',\n    detailUrlPrefix: '/admin/services',\n    deleteUrlPrefix: '/admin/services'\n  }));\n});\n\napp.get('/services/new', async (c) => {\n  const db = c.env.DB;\n  const categories = await db.prepare('SELECT id, name FROM service_categories ORDER BY sort_order, name').all();\n  \n  const fields: FormField[] = [\n    { name: 'name', label: 'Name', required: true },\n    { name: 'description', label: 'Description', type: 'textarea' },\n    { name: 'category_id', label: 'Category', type: 'select', options: (categories.results || []).map(c => ({ value: c.id as string, label: c.name as string })) },\n    { name: 'base_price', label: 'Base Price ($)', type: 'number', required: true, min: 0, step: 0.01 },\n    { name: 'base_duration_minutes', label: 'Duration (minutes)', type: 'number', required: true, min: 1 },\n    { name: 'auto_assign_enabled', label: 'Auto-assign Enabled', type: 'checkbox' },\n    { name: 'auto_assign_method', label: 'Auto-assign Method', type: 'select', value: 'balanced', options: [\n      { value: 'balanced', label: 'Balanced' },\n      { value: 'prioritized', label: 'Prioritized' },\n      { value: 'drive_time', label: 'Drive Time' }\n    ]},\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Service',\n    fields,\n    submitUrl: '/admin/services',\n    cancelUrl: '/admin/services'\n  }));\n});\n\napp.post('/services', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  await db.prepare(`\n    INSERT INTO services (id, name, description, category_id, base_price_cents, base_duration_minutes, auto_assign_enabled, auto_assign_method, is_active)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.name,\n    body.description || null,\n    body.category_id || null,\n    Math.round(parseFloat(body.base_price as string || '0') * 100),\n    parseInt(body.base_duration_minutes as string, 10) || 60,\n    body.auto_assign_enabled === 'on' ? 1 : 0,\n    body.auto_assign_method || 'balanced',\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect('/admin/services');\n});\n\napp.get('/services/:id/edit', async (c) => {\n  return c.redirect(`/admin/services/${c.req.param('id')}`);\n});\n\napp.post('/services/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const section = body._section as string | undefined;\n\n  if (section === 'basic') {\n    await db.prepare(`\n      UPDATE services\n      SET name = ?, description = ?, category_id = ?, base_price_cents = ?, base_duration_minutes = ?,\n          auto_assign_enabled = ?, auto_assign_method = ?, is_active = ?, updated_at = datetime('now')\n      WHERE id = ?\n    `).bind(\n      body.name,\n      body.description || null,\n      body.category_id || null,\n      Math.round(parseFloat(body.base_price as string || '0') * 100),\n      parseInt(body.base_duration_minutes as string, 10) || 60,\n      body.auto_assign_enabled === 'on' ? 1 : 0,\n      body.auto_assign_method || 'balanced',\n      body.is_active === 'on' ? 1 : 0,\n      id\n    ).run();\n\n    return c.redirect(`/admin/services/${id}`);\n  }\n  \n  await db.prepare(`\n    UPDATE services \n    SET name = ?, description = ?, category_id = ?, base_price_cents = ?, base_duration_minutes = ?, \n        auto_assign_enabled = ?, auto_assign_method = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.name,\n    body.description || null,\n    body.category_id || null,\n    Math.round(parseFloat(body.base_price as string || '0') * 100),\n    parseInt(body.base_duration_minutes as string, 10) || 60,\n    body.auto_assign_enabled === 'on' ? 1 : 0,\n    body.auto_assign_method || 'balanced',\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect(`/admin/services/${id}`);\n});\n\napp.post('/services/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM territory_services WHERE service_id = ?').bind(id).run();\n  await db.prepare(\"UPDATE services SET is_active = 0, updated_at = datetime('now') WHERE id = ?\").bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/services/${id}`)) {\n      c.header('HX-Redirect', '/admin/services');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/services');\n});\n\nconst renderServiceDetail = async (c: AdminContext, serviceId: string) => {\n  const db = c.env.DB;\n\n  const service = await db.prepare('SELECT * FROM services WHERE id = ?').bind(serviceId).first();\n  if (!service) return c.redirect('/admin/services');\n\n  const [categories, modifiers, priceRules, reqSkills, allSkills, territories] = await Promise.all([\n    db.prepare('SELECT id, name FROM service_categories ORDER BY sort_order, name').all(),\n    db.prepare('SELECT * FROM service_modifiers WHERE service_id = ? ORDER BY sort_order').bind(serviceId).all(),\n    db.prepare('SELECT par.*, t.name as territory_name FROM price_adjustment_rules par LEFT JOIN territories t ON par.territory_id = t.id WHERE par.service_id = ?').bind(serviceId).all(),\n    db.prepare('SELECT s.id, s.name FROM service_required_skills srs JOIN skills s ON srs.skill_id = s.id WHERE srs.service_id = ?').bind(serviceId).all(),\n    db.prepare('SELECT id, name FROM skills ORDER BY name').all(),\n    db.prepare('SELECT id, name FROM territories ORDER BY name').all()\n  ]);\n\n  const serviceModel = service as unknown as {\n    id: string;\n    name: string;\n    description?: string | null;\n    category_id?: string | null;\n    base_price_cents: number;\n    base_duration_minutes: number;\n    is_active: number;\n    auto_assign_enabled: number;\n    auto_assign_method: string;\n    required_provider_count: number;\n  };\n\n  const categoryList = (categories.results || []).map(r => ({\n    id: r.id as string,\n    name: r.name as string,\n  }));\n\n  const modifierList = (modifiers.results || []).map(r => ({\n    id: r.id as string,\n    name: r.name as string,\n    description: (r.description as string) || undefined,\n    price_adjustment_cents: Number(r.price_adjustment_cents || 0),\n    duration_adjustment_minutes: Number(r.duration_adjustment_minutes || 0),\n    is_required: Number(r.is_required || 0),\n    sort_order: Number(r.sort_order || 0),\n  }));\n\n  const ruleList = (priceRules.results || []).map(r => ({\n    id: r.id as string,\n    rule_type: r.rule_type as string,\n    adjustment_type: r.adjustment_type as string,\n    adjustment_value: Number(r.adjustment_value || 0),\n    direction: r.direction as string,\n    days_of_week: (r.days_of_week as string) || undefined,\n    start_time: (r.start_time as string) || undefined,\n    end_time: (r.end_time as string) || undefined,\n    min_hours_ahead: r.min_hours_ahead !== null && r.min_hours_ahead !== undefined ? Number(r.min_hours_ahead) : undefined,\n    max_hours_ahead: r.max_hours_ahead !== null && r.max_hours_ahead !== undefined ? Number(r.max_hours_ahead) : undefined,\n    territory_id: (r.territory_id as string) || undefined,\n    territory_name: (r.territory_name as string) || undefined,\n  }));\n\n  const requiredSkillList = (reqSkills.results || []).map(r => ({\n    id: r.id as string,\n    name: r.name as string,\n  }));\n\n  const allSkillList = (allSkills.results || []).map(r => ({\n    id: r.id as string,\n    name: r.name as string,\n  }));\n\n  const territoryList = (territories.results || []).map(r => ({\n    id: r.id as string,\n    name: r.name as string,\n  }));\n\n  return c.html(ServiceDetailPage({\n    service: serviceModel,\n    categories: categoryList,\n    modifiers: modifierList,\n    priceRules: ruleList,\n    requiredSkills: requiredSkillList,\n    allSkills: allSkillList,\n    territories: territoryList\n  }));\n};\n\napp.get('/services/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/services/new');\n\n  return renderServiceDetail(c, id);\n});\n\napp.post('/services/:id/modifiers/:modId/delete', async (c) => {\n  const db = c.env.DB;\n  await db.prepare('DELETE FROM service_modifiers WHERE id = ? AND service_id = ?')\n    .bind(c.req.param('modId'), c.req.param('id')).run();\n  return renderServiceDetail(c, c.req.param('id'));\n});\n\napp.post('/services/:id/rules/:ruleId/delete', async (c) => {\n  const db = c.env.DB;\n  await db.prepare('DELETE FROM price_adjustment_rules WHERE id = ? AND service_id = ?')\n    .bind(c.req.param('ruleId'), c.req.param('id')).run();\n  return renderServiceDetail(c, c.req.param('id'));\n});\n\napp.post('/services/:id/modifiers', async (c) => {\n  const db = c.env.DB;\n  const serviceId = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  const maxOrder = await db.prepare('SELECT MAX(sort_order) as max_order FROM service_modifiers WHERE service_id = ?').bind(serviceId).first<{ max_order: number }>();\n  \n  await db.prepare('INSERT INTO service_modifiers (id, service_id, name, description, price_adjustment_cents, duration_adjustment_minutes, is_required, sort_order) VALUES (?, ?, ?, ?, ?, ?, ?, ?)').bind(\n    generateId(), serviceId, body.name, body.description || null,\n    Math.round(parseFloat(body.price_adjustment as string || '0') * 100),\n    parseInt(body.duration_adjustment_minutes as string, 10) || 0,\n    body.is_required === 'on' ? 1 : 0,\n    (maxOrder?.max_order || 0) + 1\n  ).run();\n  \n  return c.redirect(`/admin/services/${serviceId}`);\n});\n\napp.post('/services/:id/rules', async (c) => {\n  const db = c.env.DB;\n  const serviceId = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  await db.prepare('INSERT INTO price_adjustment_rules (id, service_id, rule_type, adjustment_type, adjustment_value, direction, days_of_week, start_time, end_time, min_hours_ahead, max_hours_ahead, territory_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)').bind(\n    generateId(), serviceId, body.rule_type, body.adjustment_type,\n    body.adjustment_type === 'flat'\n      ? Math.round(parseFloat(body.adjustment_value as string || '0') * 100)\n      : parseFloat(body.adjustment_value as string || '0'),\n    body.direction,\n    body.days_of_week || null, body.start_time || null, body.end_time || null,\n    body.min_hours_ahead ? parseInt(body.min_hours_ahead as string, 10) : null,\n    body.max_hours_ahead ? parseInt(body.max_hours_ahead as string, 10) : null,\n    body.territory_id || null\n  ).run();\n  \n  return c.redirect(`/admin/services/${serviceId}`);\n});\n\napp.post('/services/:id/skills', async (c) => {\n  const db = c.env.DB;\n  const serviceId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const skillIds = Array.isArray(body.skill_ids) ? body.skill_ids : (body.skill_ids ? [body.skill_ids] : []);\n  \n  await db.prepare('DELETE FROM service_required_skills WHERE service_id = ?').bind(serviceId).run();\n  for (const sid of skillIds) {\n    await db.prepare('INSERT INTO service_required_skills (service_id, skill_id) VALUES (?, ?)').bind(serviceId, sid).run();\n  }\n  return c.redirect(`/admin/services/${serviceId}`);\n});\n\napp.get('/customers', async (c) => {\n  const db = c.env.DB;\n  const customers = await db.prepare(`\n    SELECT c.id, c.first_name, c.last_name, c.email, c.phone,\n           ca.line_1, ca.city, ca.state, ca.postal_code,\n           t.name as territory_name\n    FROM customers c\n    LEFT JOIN customer_addresses ca ON ca.customer_id = c.id AND ca.is_default = 1\n    LEFT JOIN jobs j ON j.customer_id = c.id\n    LEFT JOIN territories t ON j.territory_id = t.id\n    GROUP BY c.id\n    ORDER BY c.created_at DESC LIMIT 50\n  `).all();\n  \n  return c.html(TableView({\n    title: 'Customers',\n    columns: ['Name', 'Email', 'Phone', 'Address', 'Territory'],\n    rows: (customers.results || []).map(cust => ({\n      name: `${cust.first_name} ${cust.last_name}`,\n      email: cust.email || '-',\n      phone: cust.phone || '-',\n      address: cust.line_1 ? `${cust.line_1}${cust.city ? `, ${cust.city}` : ''}${cust.state ? `, ${cust.state}` : ''} ${cust.postal_code || ''}`.trim() : '-',\n      territory: cust.territory_name || '-'\n    })),\n    rawIds: (customers.results || []).map(cust => cust.id as string),\n    createUrl: '/admin/customers/new',\n    extraActions: [{ label: 'Import', url: '/admin/customers/import' }],\n    detailUrlPrefix: '/admin/customers',\n    deleteUrlPrefix: '/admin/customers'\n  }));\n});\n\napp.get('/customers/new', (c) => {\n  const error = c.req.query('error') || undefined;\n  const fields: FormField[] = [\n    { name: 'first_name', label: 'First Name', required: true },\n    { name: 'last_name', label: 'Last Name', required: true },\n    { name: 'email', label: 'Email', type: 'email' },\n    { name: 'phone', label: 'Phone', type: 'tel' },\n    {\n      name: 'address_line_1',\n      label: 'Address',\n      placeholder: 'Start typing address',\n      attrs: {\n        'hx-get': '/admin/api/address/search',\n        'hx-trigger': 'input changed delay:300ms',\n        'hx-target': '#address-results',\n        autocomplete: 'off',\n      }\n    },\n    { name: 'address_line_2', label: 'Address Line 2' },\n    { name: 'address_city', label: 'City' },\n    { name: 'address_state', label: 'Province / State' },\n    { name: 'address_postal', label: 'Postal Code' },\n    { name: 'address_lat', label: 'Latitude', type: 'hidden' },\n    { name: 'address_lng', label: 'Longitude', type: 'hidden' }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Customer',\n    fields,\n    error,\n    submitUrl: '/admin/customers',\n    cancelUrl: '/admin/customers'\n  }));\n});\n\napp.post('/customers', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  const email = normalizeEmail(typeof body.email === 'string' ? body.email : null);\n  const phoneRaw = typeof body.phone === 'string' ? body.phone.trim() : '';\n  const phoneE164 = normalizePhoneE164(phoneRaw || null);\n\n  const duplicate = await db.prepare(\n    `SELECT id, first_name, last_name FROM customers\n     WHERE (? IS NOT NULL AND LOWER(email) = ?)\n        OR (? IS NOT NULL AND phone_e164 = ?)\n     LIMIT 1`\n  ).bind(email, email, phoneE164, phoneE164).first<{ id: string; first_name: string; last_name: string }>();\n\n  if (duplicate) {\n    const q = new URLSearchParams({ error: `A customer already exists: ${duplicate.first_name} ${duplicate.last_name}.` });\n    return c.redirect(`/admin/customers/new?${q.toString()}`);\n  }\n  \n  await db.prepare(`\n    INSERT INTO customers (id, first_name, last_name, email, phone, phone_e164)\n    VALUES (?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.first_name,\n    body.last_name,\n    email,\n    phoneRaw || null,\n    phoneE164\n  ).run();\n\n  const line1 = typeof body.address_line_1 === 'string' ? body.address_line_1.trim() : '';\n  const city = typeof body.address_city === 'string' ? body.address_city.trim() : '';\n  const state = typeof body.address_state === 'string' ? body.address_state.trim() : '';\n  const postal = typeof body.address_postal === 'string' ? body.address_postal.trim() : '';\n  if (line1 && city && state && postal) {\n    await db.prepare(`\n      INSERT INTO customer_addresses (id, customer_id, line_1, line_2, city, state, postal_code, lat, lng, is_default)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 1)\n    `).bind(\n      generateId(),\n      id,\n      line1,\n      (typeof body.address_line_2 === 'string' && body.address_line_2.trim()) ? body.address_line_2.trim() : null,\n      city,\n      state,\n      postal,\n      (typeof body.address_lat === 'string' && body.address_lat.trim()) ? Number.parseFloat(body.address_lat) : null,\n      (typeof body.address_lng === 'string' && body.address_lng.trim()) ? Number.parseFloat(body.address_lng) : null,\n    ).run();\n  }\n  \n  return c.redirect('/admin/customers');\n});\n\napp.get('/customers/import', (c) => {\n  const error = c.req.query('error') || undefined;\n  const fields: FormField[] = [\n    {\n      name: 'source_text',\n      label: 'Paste Contacts (CSV or one contact per line)',\n      type: 'textarea',\n      required: true,\n      placeholder: 'first_name,last_name,email,phone\\nJane,Doe,jane@example.com,613-555-0101\\n\\nOR\\n\\nJane Doe jane@example.com 613-555-0101'\n    }\n  ];\n  return c.html(FormView({\n    title: 'Import Customers',\n    fields,\n    error,\n    submitUrl: '/admin/customers/import',\n    cancelUrl: '/admin/customers'\n  }));\n});\n\napp.post('/customers/import', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const source = typeof body.source_text === 'string' ? body.source_text : '';\n  const parsed = parseImportedCustomers(source);\n  if (parsed.length === 0) {\n    const q = new URLSearchParams({ error: 'No valid contacts found. Use CSV headers or one contact per line.' });\n    return c.redirect(`/admin/customers/import?${q.toString()}`);\n  }\n\n  for (const entry of parsed) {\n    const phoneE164 = normalizePhoneE164(entry.phone || null);\n    const existing = await db.prepare(\n      `SELECT id FROM customers\n       WHERE (? IS NOT NULL AND LOWER(email) = ?)\n          OR (? IS NOT NULL AND phone_e164 = ?)\n       LIMIT 1`\n    ).bind(entry.email, entry.email, phoneE164, phoneE164).first();\n    if (existing) continue;\n\n    await db.prepare(\n      `INSERT INTO customers (id, first_name, last_name, email, phone, phone_e164)\n       VALUES (?, ?, ?, ?, ?, ?)`\n    ).bind(\n      generateId(),\n      entry.first_name,\n      entry.last_name,\n      entry.email,\n      entry.phone,\n      phoneE164,\n    ).run();\n  }\n\n  return c.redirect('/admin/customers');\n});\n\napp.get('/customers/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/customers/new');\n  return c.redirect(`/admin/customers/${id}/edit`);\n});\n\napp.get('/customers/:id/edit', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const error = c.req.query('error') || undefined;\n  const [customer, address, territory] = await Promise.all([\n    db.prepare('SELECT * FROM customers WHERE id = ?').bind(id).first(),\n    db.prepare('SELECT * FROM customer_addresses WHERE customer_id = ? ORDER BY is_default DESC, created_at DESC LIMIT 1').bind(id).first(),\n    db.prepare('SELECT t.name FROM jobs j JOIN territories t ON j.territory_id = t.id WHERE j.customer_id = ? ORDER BY j.created_at DESC LIMIT 1').bind(id).first<{ name: string }>()\n  ]);\n  \n  if (!customer) {\n    return c.redirect('/admin/customers');\n  }\n\n  const fields: FormField[] = [\n    { name: 'first_name', label: 'First Name', required: true, value: customer.first_name as string },\n    { name: 'last_name', label: 'Last Name', required: true, value: customer.last_name as string },\n    { name: 'email', label: 'Email', type: 'email', value: customer.email as string },\n    { name: 'phone', label: 'Phone', type: 'tel', value: customer.phone as string },\n    {\n      name: 'address_line_1',\n      label: 'Address',\n      value: (address?.line_1 as string) || '',\n      placeholder: 'Start typing address',\n      attrs: {\n        'hx-get': '/admin/api/address/search',\n        'hx-trigger': 'input changed delay:300ms',\n        'hx-target': '#address-results',\n        autocomplete: 'off',\n      }\n    },\n    { name: 'address_line_2', label: 'Address Line 2', value: (address?.line_2 as string) || '' },\n    { name: 'address_city', label: 'City', value: (address?.city as string) || '' },\n    { name: 'address_state', label: 'Province / State', value: (address?.state as string) || '' },\n    { name: 'address_postal', label: 'Postal Code', value: (address?.postal_code as string) || '' },\n    { name: 'address_lat', label: 'Latitude', type: 'hidden', value: String(address?.lat || '') },\n    { name: 'address_lng', label: 'Longitude', type: 'hidden', value: String(address?.lng || '') },\n    ...(territory ? [{ name: '_territory', label: 'Territory', value: territory.name, readonly: true } as FormField] : [])\n  ];\n  \n  return c.html(FormView({\n    title: 'Edit Customer',\n    fields,\n    error,\n    submitUrl: `/admin/customers/${id}`,\n    cancelUrl: '/admin/customers',\n    isEdit: true,\n    deleteUrl: `/admin/customers/${id}/delete`\n  }));\n});\n\napp.post('/customers/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const email = normalizeEmail(typeof body.email === 'string' ? body.email : null);\n  const phoneRaw = typeof body.phone === 'string' ? body.phone.trim() : '';\n  const phoneE164 = normalizePhoneE164(phoneRaw || null);\n\n  const duplicate = await db.prepare(\n    `SELECT id, first_name, last_name FROM customers\n     WHERE id != ?\n       AND ((? IS NOT NULL AND LOWER(email) = ?) OR (? IS NOT NULL AND phone_e164 = ?))\n     LIMIT 1`\n  ).bind(id, email, email, phoneE164, phoneE164).first<{ id: string; first_name: string; last_name: string }>();\n\n  if (duplicate) {\n    const q = new URLSearchParams({ error: `A customer already exists: ${duplicate.first_name} ${duplicate.last_name}.` });\n    return c.redirect(`/admin/customers/${id}/edit?${q.toString()}`);\n  }\n  \n  await db.prepare(`\n    UPDATE customers \n    SET first_name = ?, last_name = ?, email = ?, phone = ?, phone_e164 = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.first_name,\n    body.last_name,\n    email,\n    phoneRaw || null,\n    phoneE164,\n    id\n  ).run();\n\n  const line1 = typeof body.address_line_1 === 'string' ? body.address_line_1.trim() : '';\n  const city = typeof body.address_city === 'string' ? body.address_city.trim() : '';\n  const state = typeof body.address_state === 'string' ? body.address_state.trim() : '';\n  const postal = typeof body.address_postal === 'string' ? body.address_postal.trim() : '';\n  await db.prepare('DELETE FROM customer_addresses WHERE customer_id = ? AND is_default = 1').bind(id).run();\n  if (line1 && city && state && postal) {\n    await db.prepare(`\n      INSERT INTO customer_addresses (id, customer_id, line_1, line_2, city, state, postal_code, lat, lng, is_default)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, 1)\n    `).bind(\n      generateId(),\n      id,\n      line1,\n      (typeof body.address_line_2 === 'string' && body.address_line_2.trim()) ? body.address_line_2.trim() : null,\n      city,\n      state,\n      postal,\n      (typeof body.address_lat === 'string' && body.address_lat.trim()) ? Number.parseFloat(body.address_lat) : null,\n      (typeof body.address_lng === 'string' && body.address_lng.trim()) ? Number.parseFloat(body.address_lng) : null,\n    ).run();\n  }\n  \n  return c.redirect('/admin/customers');\n});\n\napp.post('/customers/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM customers WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/customers/${id}`)) {\n      c.header('HX-Redirect', '/admin/customers');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/customers');\n});\n\napp.get('/team', async (c) => {\n  const db = c.env.DB;\n  const team = await db.prepare(`\n    SELECT id, first_name, last_name, email, role, is_active\n    FROM team_members WHERE is_active = 1 ORDER BY last_name, first_name\n  `).all();\n  \n  const rows = (team.results || []).map(t => ({\n    name: `${t.first_name} ${t.last_name}`,\n    role: t.role,\n    email: t.email,\n    active: t.is_active ? 'active' : 'inactive'\n  }));\n  \n  return c.html(TableView({\n    title: 'Team',\n    columns: ['Name', 'Role', 'Email', 'Active'],\n    rows,\n    rawIds: (team.results || []).map(t => t.id as string),\n    createUrl: '/admin/team/new',\n    detailUrlPrefix: '/admin/team',\n    deleteUrlPrefix: '/admin/team'\n  }));\n});\n\napp.get('/team/new', (c) => {\n  const fields: FormField[] = [\n    { name: 'first_name', label: 'First Name', required: true },\n    { name: 'last_name', label: 'Last Name', required: true },\n    { name: 'email', label: 'Email', type: 'email', required: true },\n    { name: 'phone', label: 'Phone', type: 'tel' },\n    { name: 'role', label: 'Role', type: 'select', required: true, value: 'provider', options: [\n      { value: 'manager', label: 'Manager' },\n      { value: 'provider', label: 'Provider' }\n    ]},\n    { name: 'can_be_auto_assigned', label: 'Can be Auto-assigned', type: 'checkbox', value: true },\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Team Member',\n    fields,\n    submitUrl: '/admin/team',\n    cancelUrl: '/admin/team'\n  }));\n});\n\napp.post('/team', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  await db.prepare(`\n    INSERT INTO team_members (id, first_name, last_name, email, phone, role, can_be_auto_assigned, is_active)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.first_name,\n    body.last_name,\n    body.email,\n    body.phone || null,\n    body.role || 'provider',\n    body.can_be_auto_assigned === 'on' ? 1 : 0,\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect('/admin/team');\n});\n\napp.get('/team/:id/edit', async (c) => {\n  return c.redirect(`/admin/team/${c.req.param('id')}`);\n});\n\napp.post('/team/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const section = body._section as string | undefined;\n  if (section && section !== 'profile') {\n    // Backward-compat: unknown sections behave like full update.\n  }\n  \n  await db.prepare(`\n    UPDATE team_members \n    SET first_name = ?, last_name = ?, email = ?, phone = ?, role = ?, \n        can_be_auto_assigned = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.first_name,\n    body.last_name,\n    body.email,\n    body.phone || null,\n    body.role || 'provider',\n    body.can_be_auto_assigned === 'on' ? 1 : 0,\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect(`/admin/team/${id}`);\n});\n\napp.post('/team/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('UPDATE team_members SET is_active = 0 WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/team/${id}`)) {\n      c.header('HX-Redirect', '/admin/team');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/team');\n});\n\napp.get('/team/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/team/new');\n  \n  const member = await db.prepare('SELECT * FROM team_members WHERE id = ?').bind(id).first();\n  if (!member) return c.redirect('/admin/team');\n  \n  const [weeklyHours, dateOverrides, memberSkills, allSkills, allTerritories, memberTerritories] = await Promise.all([\n    db.prepare('SELECT day_of_week, start_time, end_time FROM provider_weekly_hours WHERE team_member_id = ? ORDER BY day_of_week').bind(id).all(),\n    db.prepare('SELECT * FROM provider_date_overrides WHERE team_member_id = ? ORDER BY date').bind(id).all(),\n    db.prepare('SELECT s.id, s.name FROM team_member_skills tms JOIN skills s ON tms.skill_id = s.id WHERE tms.team_member_id = ?').bind(id).all(),\n    db.prepare('SELECT id, name FROM skills ORDER BY name').all(),\n    db.prepare('SELECT id, name FROM territories ORDER BY name').all(),\n    db.prepare('SELECT territory_id FROM team_member_territories WHERE team_member_id = ?').bind(id).all()\n  ]);\n  \n  const assignedTerritoryIds = new Set((memberTerritories.results || []).map(r => r.territory_id as string));\n\n  const memberModel = member as unknown as {\n    id: string;\n    first_name: string;\n    last_name: string;\n    email: string;\n    phone?: string;\n    role: string;\n    is_active: number;\n    can_be_auto_assigned: number;\n    can_edit_availability: number;\n    auto_assign_priority: number;\n  };\n  \n  return c.html(ProviderDetailPage({\n    member: memberModel,\n    weeklyHours: (weeklyHours.results || []).map(h => ({\n      day_of_week: Number(h.day_of_week),\n      start_time: h.start_time as string,\n      end_time: h.end_time as string,\n    })),\n    dateOverrides: (dateOverrides.results || []).map(o => ({\n      id: o.id as string,\n      date: o.date as string,\n      is_available: Number(o.is_available),\n      start_time: (o.start_time as string) || undefined,\n      end_time: (o.end_time as string) || undefined,\n    })),\n    skills: (memberSkills.results || []).map(s => ({ id: s.id as string, name: s.name as string })),\n    allSkills: (allSkills.results || []).map(s => ({ id: s.id as string, name: s.name as string })),\n    territories: (allTerritories.results || []).map(t => ({ id: t.id as string, name: t.name as string, assigned: assignedTerritoryIds.has(t.id as string) }))\n  }));\n});\n\napp.post('/team/:id/hours', async (c) => {\n  const db = c.env.DB;\n  const memberId = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  await db.prepare('DELETE FROM provider_weekly_hours WHERE team_member_id = ?').bind(memberId).run();\n  \n  for (let day = 0; day <= 6; day++) {\n    if (body[`day_${day}_enabled`] === 'on') {\n      await db.prepare('INSERT INTO provider_weekly_hours (id, team_member_id, day_of_week, start_time, end_time) VALUES (?, ?, ?, ?, ?)').bind(\n        generateId(), memberId, day, body[`day_${day}_start`] as string, body[`day_${day}_end`] as string\n      ).run();\n    }\n  }\n  \n  return c.redirect(`/admin/team/${memberId}`);\n});\n\napp.post('/team/:id/overrides', async (c) => {\n  const db = c.env.DB;\n  const memberId = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  await db.prepare('INSERT INTO provider_date_overrides (id, team_member_id, date, is_available, start_time, end_time) VALUES (?, ?, ?, ?, ?, ?)').bind(\n    generateId(), memberId, body.date,\n    parseInt(body.is_available as string, 10), body.start_time || null, body.end_time || null\n  ).run();\n  \n  return c.redirect(`/admin/team/${memberId}`);\n});\n\napp.delete('/team/:id/overrides/:oId', async (c) => {\n  const db = c.env.DB;\n  const memberId = c.req.param('id');\n  const overrideId = c.req.param('oId');\n\n  await db.prepare('DELETE FROM provider_date_overrides WHERE id = ? AND team_member_id = ?').bind(overrideId, memberId).run();\n  return c.redirect(`/admin/team/${memberId}`);\n});\n\napp.post('/team/:id/skills', async (c) => {\n  const db = c.env.DB;\n  const memberId = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const removeSkillId = body.remove_skill_id as string | undefined;\n  if (removeSkillId) {\n    await db.prepare('DELETE FROM team_member_skills WHERE team_member_id = ? AND skill_id = ?').bind(memberId, removeSkillId).run();\n    return c.redirect(`/admin/team/${memberId}`);\n  }\n\n  const skillIds = Array.isArray(body.skill_ids) ? body.skill_ids : (body.skill_ids ? [body.skill_ids] : []);\n  \n  await db.prepare('DELETE FROM team_member_skills WHERE team_member_id = ?').bind(memberId).run();\n  for (const sid of skillIds) {\n    await db.prepare('INSERT INTO team_member_skills (team_member_id, skill_id) VALUES (?, ?)').bind(memberId, sid).run();\n  }\n  return c.redirect(`/admin/team/${memberId}`);\n});\n\napp.post('/team/:id/territories', async (c) => {\n  const db = c.env.DB;\n  const memberId = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const removeTerritoryId = body.remove_territory_id as string | undefined;\n  if (removeTerritoryId) {\n    await db.prepare('DELETE FROM team_member_territories WHERE team_member_id = ? AND territory_id = ?').bind(memberId, removeTerritoryId).run();\n    return c.redirect(`/admin/team/${memberId}`);\n  }\n\n  const territoryIds = Array.isArray(body.territory_ids) ? body.territory_ids : (body.territory_ids ? [body.territory_ids] : []);\n  \n  await db.prepare('DELETE FROM team_member_territories WHERE team_member_id = ?').bind(memberId).run();\n  for (const tid of territoryIds) {\n    await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(memberId, tid).run();\n  }\n  return c.redirect(`/admin/team/${memberId}`);\n});\n\napp.get('/jobs', async (c) => {\n  const db = c.env.DB;\n  const jobs = await db.prepare(`\n    SELECT j.id, c.first_name || ' ' || c.last_name as customer_name,\n           s.name as service_name, j.scheduled_date, j.status\n    FROM jobs j\n    JOIN customers c ON j.customer_id = c.id\n    LEFT JOIN services s ON j.service_id = s.id\n    ORDER BY j.scheduled_date DESC\n    LIMIT 50\n  `).all();\n  \n  const rows = (jobs.results || []).map(j => ({\n    customer: j.customer_name,\n    service: j.service_name || 'Custom',\n    date: j.scheduled_date,\n    status: j.status\n  }));\n  \n  return c.html(TableView({\n    title: 'Jobs',\n    columns: ['Customer', 'Service', 'Date', 'Status'],\n    rows,\n    rawIds: (jobs.results || []).map(j => j.id as string),\n    createUrl: '/admin/jobs/new',\n    detailUrlPrefix: '/admin/jobs',\n    deleteUrlPrefix: '/admin/jobs'\n  }));\n});\n\napp.get('/jobs/new', async (c) => {\n  const db = c.env.DB;\n\n  const customerId = c.req.query('customer_id') || undefined;\n  const territoryIdQ = c.req.query('territory_id') || undefined;\n  const serviceIdQ = c.req.query('service_id') || undefined;\n  const dateQ = c.req.query('date') || undefined;\n  const timeQ = c.req.query('time') || undefined;\n  const providerIdQ = c.req.query('provider_id') || undefined;\n  const addressLine1 = c.req.query('address_line1') || undefined;\n  const error = c.req.query('error') || undefined;\n\n  let customer: WizardCustomer | undefined;\n  if (customerId) {\n    const row = await db.prepare('SELECT id, first_name, last_name, email, phone FROM customers WHERE id = ?').bind(customerId).first();\n    if (row) customer = row as unknown as WizardCustomer;\n  }\n\n  const territoriesRes = await db.prepare('SELECT id, name FROM territories WHERE is_active = 1 ORDER BY name').all();\n  const territories = (territoriesRes.results || []).map(t => ({ id: t.id as string, name: t.name as string }));\n\n  let selectedTerritoryId = territoryIdQ;\n  const onlyTerritory = territories.length === 1 ? territories[0] : undefined;\n  if (!selectedTerritoryId && onlyTerritory) selectedTerritoryId = onlyTerritory.id;\n\n  let services: WizardService[] = [];\n  if (selectedTerritoryId) {\n    const servicesRes = await db.prepare(\n      'SELECT s.id, s.name, s.description, s.base_price_cents, s.base_duration_minutes FROM services s JOIN territory_services ts ON s.id = ts.service_id WHERE ts.territory_id = ? AND s.is_active = 1 ORDER BY s.name'\n    ).bind(selectedTerritoryId).all();\n    services = (servicesRes.results || []) as unknown as WizardService[];\n  }\n\n  // Clear invalid service selection (eg. stale query)\n  let selectedServiceId = serviceIdQ;\n  if (selectedServiceId && services.length > 0 && !services.some(s => s.id === selectedServiceId)) {\n    selectedServiceId = undefined;\n  }\n  const onlyService = services.length === 1 ? services[0] : undefined;\n  if (!selectedServiceId && onlyService) selectedServiceId = onlyService.id;\n\n  const today = new Date();\n  const dates: string[] = [];\n  for (let i = 1; i <= 7; i++) {\n    const d = new Date(today.getTime() + i * 86400000);\n    const dateStr = d.toISOString().split('T')[0];\n    if (dateStr) dates.push(dateStr);\n  }\n\n  let selectedDate = dateQ;\n  if (selectedDate && !dates.includes(selectedDate)) {\n    // Keep the day strip stable; ignore out-of-window date\n    selectedDate = undefined;\n  }\n\n  // Reuse the legacy wizard Step 3 logic: hourly slots 8am-5pm\n  const timeslots: string[] = [];\n  if (selectedServiceId && selectedDate) {\n    for (let h = 8; h <= 17; h++) {\n      timeslots.push(`${String(h).padStart(2, '0')}:00`);\n    }\n  }\n\n  let selectedTime = timeQ;\n  if (selectedTime && (!timeslots.includes(selectedTime) || !selectedDate)) {\n    selectedTime = undefined;\n  }\n\n  let providers: { id: string; first_name: string; last_name: string; role: string; is_available: boolean }[] = [];\n  if (selectedServiceId && selectedDate && selectedTime) {\n    const providerQuery = \"SELECT id, first_name, last_name, role, is_active FROM team_members WHERE role = 'provider' AND is_active = 1\";\n    const providersRes = await db.prepare(`${providerQuery} ORDER BY last_name, first_name`).all();\n    providers = (providersRes.results || []).map(p => ({\n      id: p.id as string,\n      first_name: p.first_name as string,\n      last_name: p.last_name as string,\n      role: p.role as string,\n      is_available: Boolean(p.is_active),\n    }));\n  }\n\n  let selectedProviderId = providerIdQ;\n  if (selectedProviderId && providers.length > 0 && !providers.some(p => p.id === selectedProviderId)) {\n    selectedProviderId = undefined;\n  }\n  const onlyProvider = providers.length === 1 ? providers[0] : undefined;\n  if (!selectedProviderId && onlyProvider) selectedProviderId = onlyProvider.id;\n\n  const props: NewJobProps = {\n    customer,\n    territories,\n    services,\n    dates,\n    timeslots,\n    providers,\n    addressLine1,\n    selectedTerritoryId,\n    selectedServiceId,\n    selectedDate,\n    selectedTime,\n    selectedProviderId,\n    error,\n  };\n\n  if (c.req.header('HX-Request') === 'true') {\n    const targetId = c.req.header('HX-Target') || '';\n    if (targetId && targetId !== 'page-content') {\n      return c.html(JobWizardSwapBundle({ props, targetId }));\n    }\n  }\n\n  return c.html(JobWizardPage(props));\n});\n\napp.post('/jobs/quick-create', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n\n  const customerId = typeof body.customer_id === 'string' ? body.customer_id : '';\n  const territoryId = typeof body.territory_id === 'string' ? body.territory_id : '';\n  const serviceId = typeof body.service_id === 'string' ? body.service_id : '';\n  const date = typeof body.date === 'string' ? body.date : '';\n  const time = typeof body.time === 'string' ? body.time : '';\n  const providerId = typeof body.provider_id === 'string' ? body.provider_id : '';\n  const addressLine1 = typeof body.address_line1 === 'string' ? body.address_line1.trim() : '';\n\n  if (!customerId || !territoryId || !serviceId || !date || !time) {\n    const q = new URLSearchParams();\n    if (customerId) q.set('customer_id', customerId);\n    if (territoryId) q.set('territory_id', territoryId);\n    if (serviceId) q.set('service_id', serviceId);\n    if (date) q.set('date', date);\n    if (time) q.set('time', time);\n    if (providerId) q.set('provider_id', providerId);\n    if (addressLine1) q.set('address_line1', addressLine1);\n    q.set('error', 'Pick a customer, territory, service, date, and time.');\n    return c.redirect(`/admin/jobs/new?${q.toString()}`);\n  }\n\n  const service = await db\n    .prepare('SELECT base_price_cents, base_duration_minutes FROM services WHERE id = ?')\n    .bind(serviceId)\n    .first<{ base_price_cents: number; base_duration_minutes: number }>();\n\n  const jobId = generateId();\n  const priceCents = service?.base_price_cents || 0;\n  const duration = service?.base_duration_minutes || 60;\n\n  let customerAddressId: string | null = null;\n  if (addressLine1) {\n    customerAddressId = generateId();\n    await db\n      .prepare(\n        'INSERT INTO customer_addresses (id, customer_id, line_1, city, state, postal_code, is_default) VALUES (?, ?, ?, ?, ?, ?, 1)'\n      )\n      .bind(customerAddressId, customerId, addressLine1, '', '', '')\n      .run();\n  }\n\n  await db\n    .prepare(`\n      INSERT INTO jobs (id, customer_id, service_id, territory_id, customer_address_id, scheduled_date, scheduled_start_time,\n                        duration_minutes, base_price_cents, total_price_cents, line_items_json, status)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `)\n    .bind(\n      jobId,\n      customerId,\n      serviceId,\n      territoryId,\n      customerAddressId,\n      date,\n      time,\n      duration,\n      priceCents,\n      priceCents,\n      JSON.stringify([buildServiceBaseLine('Service', priceCents)]),\n      providerId ? 'assigned' : 'created'\n    )\n    .run();\n\n  if (providerId) {\n    await db.prepare('INSERT INTO job_providers (job_id, team_member_id) VALUES (?, ?)').bind(jobId, providerId).run();\n  }\n\n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.get('/api/customers/search', async (c) => {\n  const db = c.env.DB;\n  const q = c.req.query('q') || '';\n  if (q.length < 2) return c.html('');\n  \n  const customers = await db.prepare(\n    'SELECT id, first_name, last_name, email FROM customers WHERE first_name LIKE ? OR last_name LIKE ? OR email LIKE ? ORDER BY last_name, first_name LIMIT 10'\n  ).bind(`%${q}%`, `%${q}%`, `%${q}%`).all();\n  \n  return c.html(CustomerSearchResults({ customers: (customers.results || []) as { id: string; first_name: string; last_name: string; email?: string }[] }));\n});\n\napp.get('/api/address/search', async (c) => {\n  const q = c.req.query('q')\n    || c.req.query('center_address_q')\n    || c.req.query('address_line1')\n    || c.req.query('address_line_1')\n    || '';\n  const targetPrefix = c.req.query('center_address_q') ? 'radius' : undefined;\n  if (q.length < 4) return c.html('');\n  \n  try {\n    const token = c.env?.MAPBOX_ACCESS_TOKEN || '';\n    if (!token) {\n      return c.html('<div class=\"search-results\"><div class=\"search-item text-muted-foreground\">Mapbox is not configured.</div></div>');\n    }\n    const res = await fetch(`https://api.mapbox.com/search/geocode/v6/forward?q=${encodeURIComponent(q)}&country=ca&limit=5&access_token=${token}`);\n    const data = await res.json() as {\n      features?: Array<{\n        properties: { full_address?: string; name?: string; context?: { place?: { name?: string }; region?: { region_code?: string }; postcode?: { name?: string }; address?: { street_name?: string; address_number?: string } } };\n        geometry: { coordinates: [number, number] };\n      }>;\n    };\n\n    const results = (data.features || []).map(f => {\n      const p = f.properties;\n      const ctx = p.context || {};\n      return {\n        display: p.full_address || p.name || '',\n        line1: p.name || '',\n        city: ctx.place?.name || '',\n        state: ctx.region?.region_code || '',\n        postal: ctx.postcode?.name || '',\n        lat: String(f.geometry.coordinates[1]),\n        lng: String(f.geometry.coordinates[0])\n      };\n    });\n\n    return c.html(AddressSearchResults({ results, targetPrefix }));\n  } catch {\n    return c.html(AddressSearchResults({ results: [], targetPrefix }));\n  }\n});\n\napp.post('/api/customers/create-for-job', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const email = normalizeEmail(typeof body.email === 'string' ? body.email : null);\n  const phoneRaw = typeof body.phone === 'string' ? body.phone.trim() : '';\n  const phoneE164 = normalizePhoneE164(phoneRaw || null);\n\n  const existing = await db.prepare(\n    `SELECT id, first_name, last_name, email, phone FROM customers\n     WHERE (? IS NOT NULL AND LOWER(email) = ?)\n        OR (? IS NOT NULL AND phone_e164 = ?)\n     LIMIT 1`\n  ).bind(email, email, phoneE164, phoneE164).first<{ id: string; first_name: string; last_name: string; email: string | null; phone: string | null }>();\n\n  const id = existing?.id || generateId();\n  if (!existing) {\n    await db.prepare('INSERT INTO customers (id, first_name, last_name, email, phone, phone_e164) VALUES (?, ?, ?, ?, ?, ?)').bind(\n      id, body.first_name, body.last_name, email, phoneRaw || null, phoneE164\n    ).run();\n  }\n  \n  return c.html(JobWizardPage({\n    step: 1,\n    state: {},\n    customer: existing\n      ? { id: existing.id, first_name: existing.first_name, last_name: existing.last_name, email: existing.email || '', phone: existing.phone || '' }\n      : { id, first_name: body.first_name as string, last_name: body.last_name as string, email: email || '', phone: phoneRaw }\n  }));\n});\n\napp.post('/jobs/wizard/step1-address', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  \n  const state: WizardState = {\n    customer_id: body.customer_id as string,\n    customer_name: body.customer_name as string,\n    customer_email: body.customer_email as string,\n    address_line1: body.address_line1 as string,\n    address_city: body.address_city as string,\n    address_state: body.address_state as string,\n    address_postal: body.address_postal as string,\n    address_lat: body.address_lat as string,\n    address_lng: body.address_lng as string,\n  };\n\n  try {\n    const territories = await db.prepare('SELECT id, name, service_area_type, service_area_data FROM territories WHERE is_active = 1').all();\n    \n    let matchedTerritory: { id: string; name: string } | null = null;\n    for (const t of (territories.results || [])) {\n      try {\n        const result = checkServiceArea(\n          t.service_area_type as string,\n          t.service_area_data as string,\n          {\n            postalCode: state.address_postal,\n            lat: state.address_lat ? parseFloat(state.address_lat) : undefined,\n            lng: state.address_lng ? parseFloat(state.address_lng) : undefined,\n          }\n        );\n        if (result.within) {\n          matchedTerritory = { id: t.id as string, name: t.name as string };\n          break;\n        }\n      } catch { /* skip malformed territory data */ }\n    }\n    \n    if (!matchedTerritory) {\n      const customer = await db.prepare('SELECT id, first_name, last_name, email, phone FROM customers WHERE id = ?').bind(state.customer_id).first();\n      return c.html(JobWizardPage({\n        step: 1,\n        state,\n        customer: customer as unknown as WizardCustomer,\n        error: `No service territory covers ${state.address_postal || 'this address'}. Check your territory settings.`\n      }));\n    }\n    \n    state.territory_id = matchedTerritory.id;\n    state.territory_name = matchedTerritory.name;\n    \n    const addressId = generateId();\n    await db.prepare(\n      'INSERT OR IGNORE INTO customer_addresses (id, customer_id, line_1, city, state, postal_code, lat, lng, is_default) VALUES (?, ?, ?, ?, ?, ?, ?, ?, 1)'\n    ).bind(\n      addressId, state.customer_id, state.address_line1, state.address_city,\n      state.address_state, state.address_postal,\n      state.address_lat ? parseFloat(state.address_lat) : null,\n      state.address_lng ? parseFloat(state.address_lng) : null\n    ).run();\n    \n    const services = await db.prepare(\n      'SELECT s.id, s.name, s.description, s.base_price_cents, s.base_duration_minutes FROM services s JOIN territory_services ts ON s.id = ts.service_id WHERE ts.territory_id = ? AND s.is_active = 1 ORDER BY s.name'\n    ).bind(matchedTerritory.id).all();\n    \n    let serviceList = (services.results || []) as WizardService[];\n    if (serviceList.length === 0) {\n      serviceList = (await db.prepare('SELECT id, name, description, base_price_cents, base_duration_minutes FROM services WHERE is_active = 1 ORDER BY name').all()).results as WizardService[] || [];\n    }\n    \n    return c.html(JobWizardPage({ step: 2, state, services: serviceList }));\n  } catch (error) {\n    console.error('Error in step1-address:', error);\n    const errorMsg = error instanceof Error ? error.message : 'Unknown error';\n    const customer = await db.prepare('SELECT id, first_name, last_name, email, phone FROM customers WHERE id = ?').bind(state.customer_id).first();\n    return c.html(JobWizardPage({\n      step: 1,\n      state,\n      customer: customer as unknown as WizardCustomer,\n      error: `Error processing address: ${errorMsg}`\n    }));\n  }\n});\n\napp.post('/jobs/wizard/step3', async (c) => {\n  const body = await c.req.parseBody();\n  const state = parseWizardState(body);\n  \n  const today = new Date();\n  const timeslots: { date: string; start_time: string; available: boolean }[] = [];\n  for (let i = 1; i <= 14; i++) {\n    const d = new Date(today.getTime() + i * 86400000);\n    const dateStr = d.toISOString().split('T')[0];\n    for (let h = 8; h <= 17; h++) {\n      timeslots.push({ date: dateStr, start_time: `${String(h).padStart(2, '0')}:00`, available: true });\n    }\n  }\n  \n  return c.html(JobWizardPage({ step: 3, state, timeslots }));\n});\n\napp.post('/jobs/wizard/step4', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const state = parseWizardState(body);\n  \n  const providerQuery = \"SELECT id, first_name, last_name, role, is_active FROM team_members WHERE role = 'provider'\";\n  const providers = await db.prepare(`${providerQuery} ORDER BY last_name, first_name`).all();\n  \n  return c.html(JobWizardPage({\n    step: 4,\n    state,\n    providers: (providers.results || []).map(p => ({\n      id: p.id as string,\n      first_name: p.first_name as string,\n      last_name: p.last_name as string,\n      role: p.role as string,\n      is_available: Boolean(p.is_active)\n    }))\n  }));\n});\n\napp.post('/jobs/create', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const state = parseWizardState(body);\n  const jobId = generateId();\n  \n  const priceCents = state.service_price ? parseInt(String(state.service_price), 10) : 0;\n  const duration = state.service_duration ? parseInt(String(state.service_duration), 10) : 60;\n  \n  await db.prepare(`\n    INSERT INTO jobs (id, customer_id, service_id, territory_id, scheduled_date, scheduled_start_time, duration_minutes, base_price_cents, total_price_cents, line_items_json, status)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    jobId, state.customer_id, state.service_id || null, state.territory_id,\n    state.date, state.time, duration, priceCents, priceCents,\n    JSON.stringify([buildServiceBaseLine('Service', priceCents)]),\n    state.provider_id ? 'assigned' : 'created'\n  ).run();\n  \n  if (state.provider_id) {\n    await db.prepare('INSERT INTO job_providers (job_id, team_member_id) VALUES (?, ?)').bind(jobId, state.provider_id).run();\n  }\n  \n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.get('/jobs/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  \n  if (id === 'new' || id === 'wizard') return c.redirect('/admin/jobs/new');\n  \n  const job = await db.prepare('SELECT * FROM jobs WHERE id = ?').bind(id).first();\n  if (!job) return c.redirect('/admin/jobs');\n  \n  const notesJson = (job.notes_json as string) || '[]';\n  const parsedLineItems = parsePriceLines((job.line_items_json as string) || '[]');\n  \n  const [customer, service, territory, jobProviders, teamProviders] = await Promise.all([\n    job.customer_id ? db.prepare('SELECT id, first_name, last_name, email, phone, phone_e164 FROM customers WHERE id = ?').bind(job.customer_id).first() : null,\n    job.service_id ? db.prepare('SELECT id, name, description FROM services WHERE id = ?').bind(job.service_id).first() : null,\n    job.territory_id ? db.prepare('SELECT id, name FROM territories WHERE id = ?').bind(job.territory_id).first() : null,\n    db.prepare('SELECT tm.id, tm.first_name, tm.last_name FROM job_providers jp JOIN team_members tm ON jp.team_member_id = tm.id WHERE jp.job_id = ?').bind(id).all(),\n    db.prepare(\"SELECT id, first_name, last_name FROM team_members WHERE role = 'provider' ORDER BY last_name, first_name\").all()\n  ]);\n\n  const customerPhone = (customer as { phone_e164?: string | null; phone?: string | null } | null)?.phone_e164\n    || normalizePhoneE164((customer as { phone?: string | null } | null)?.phone || null);\n  const smsThreadMessage = await db.prepare(\n    `SELECT id, is_read, updated_at, body,\n            CASE WHEN json_extract(metadata, '$.job_id') = ? THEN 0 ELSE 1 END as sort_priority\n     FROM messages\n     WHERE source = 'sms'\n       AND (\n         json_extract(metadata, '$.job_id') = ?\n         OR phone = ?\n       )\n     ORDER BY sort_priority ASC, updated_at DESC\n     LIMIT 1`\n  ).bind(id, id, customerPhone || '').first<{ id: string; is_read: number; updated_at: string; body: string | null }>();\n\n  const assignedProviderId = (jobProviders.results || [])[0]?.id as string | undefined;\n\n  const jobModel = job as unknown as {\n    id: string;\n    status: string;\n    scheduled_date: string;\n    scheduled_start_time: string;\n    duration_minutes: number;\n    base_price_cents: number;\n    total_price_cents: number;\n    custom_service_name?: string | null;\n    created_at: string;\n  };\n\n  const notes = JSON.parse(notesJson) as Array<{ text: string; timestamp: string; completed: number }>;\n  const lineItems = parsedLineItems.length > 0\n    ? parsedLineItems\n    : [buildServiceBaseLine((service as { name?: string } | null)?.name || (job.custom_service_name as string) || 'Service', Number(job.total_price_cents || 0))];\n  \n  return c.html(JobDetailPage({\n    job: jobModel,\n    customer: customer ? (customer as unknown as { id: string; first_name: string; last_name: string; email?: string; phone?: string }) : undefined,\n    service: service ? (service as unknown as { id: string; name: string; description?: string }) : undefined,\n    territory: territory ? (territory as unknown as { id: string; name: string }) : undefined,\n    team: (teamProviders.results || []).map(p => ({\n      id: p.id as string,\n      first_name: p.first_name as string,\n      last_name: p.last_name as string,\n    })),\n    assignedProviderId: assignedProviderId || null,\n    notes,\n    lineItems,\n    smsThreadMessage: smsThreadMessage\n      ? {\n        id: smsThreadMessage.id,\n        is_read: smsThreadMessage.is_read,\n        updated_at: smsThreadMessage.updated_at,\n        body: smsThreadMessage.body,\n      }\n      : null,\n  }));\n});\n\napp.post('/jobs/:id/line-items/add', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const job = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(jobId).first<{ line_items_json: string | null }>();\n  if (!job) return c.redirect('/admin/jobs');\n\n  const description = typeof body.description === 'string' ? body.description.trim() : '';\n  const quantity = Math.max(1, Number.parseFloat(String(body.quantity || '1')) || 1);\n  const unitPriceCents = parseMoneyToCents(body.unit_price);\n  if (!description) return c.redirect(`/admin/jobs/${jobId}`);\n\n  const lines = parsePriceLines(job.line_items_json);\n  lines.push(normalizeLine(description, quantity, unitPriceCents, 'custom', null, 1));\n  await db.prepare(\"UPDATE jobs SET line_items_json = ?, updated_at = datetime('now') WHERE id = ?\")\n    .bind(JSON.stringify(lines), jobId)\n    .run();\n  await recomputeJobTotals(db, jobId);\n  await syncInvoiceFromJob(db, jobId);\n\n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.post('/jobs/:id/line-items/delete', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const lineId = typeof body.lineId === 'string' ? body.lineId : '';\n  if (!lineId) return c.redirect(`/admin/jobs/${jobId}`);\n\n  const job = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(jobId).first<{ line_items_json: string | null }>();\n  if (!job) return c.redirect('/admin/jobs');\n  const lines = parsePriceLines(job.line_items_json).filter((line) => !(line.id === lineId && line.is_custom === 1));\n  await db.prepare(\"UPDATE jobs SET line_items_json = ?, updated_at = datetime('now') WHERE id = ?\")\n    .bind(JSON.stringify(lines), jobId)\n    .run();\n  await recomputeJobTotals(db, jobId);\n  await syncInvoiceFromJob(db, jobId);\n\n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.get('/jobs/:id/sms-thread-card', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  const job = await db.prepare('SELECT customer_id FROM jobs WHERE id = ?').bind(id).first<{ customer_id: string | null }>();\n  const customer = job?.customer_id\n    ? await db.prepare('SELECT phone, phone_e164 FROM customers WHERE id = ?').bind(job.customer_id).first<{ phone: string | null; phone_e164: string | null }>()\n    : null;\n  const customerPhone = customer?.phone_e164 || normalizePhoneE164(customer?.phone || null);\n\n  const smsThreadMessage = await db.prepare(\n    `SELECT id, is_read, updated_at, body,\n            CASE WHEN json_extract(metadata, '$.job_id') = ? THEN 0 ELSE 1 END as sort_priority\n     FROM messages\n     WHERE source = 'sms'\n       AND (\n         json_extract(metadata, '$.job_id') = ?\n         OR phone = ?\n       )\n     ORDER BY sort_priority ASC, updated_at DESC\n     LIMIT 1`\n  ).bind(id, id, customerPhone || '').first<{ id: string; is_read: number; updated_at: string; body: string | null }>();\n\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n\n  return c.html(SmsThreadCard({\n    jobId: id,\n    smsThreadMessage: smsThreadMessage\n      ? {\n        id: smsThreadMessage.id,\n        is_read: smsThreadMessage.is_read,\n        updated_at: smsThreadMessage.updated_at,\n        body: smsThreadMessage.body,\n      }\n      : null,\n  }));\n});\n\napp.post('/jobs/:id/notes/add', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  const job = await db.prepare('SELECT notes_json FROM jobs WHERE id = ?').bind(jobId).first<{ notes_json: string }>();\n  const notes = job?.notes_json ? JSON.parse(job.notes_json) : [];\n  \n  notes.push({\n    text: body.text,\n    timestamp: new Date().toISOString(),\n    completed: 0\n  });\n  \n  await db.prepare('UPDATE jobs SET notes_json = ?, updated_at = datetime(\"now\") WHERE id = ?').bind(JSON.stringify(notes), jobId).run();\n  \n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.post('/jobs/:id/notes/toggle', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const noteIndex = parseInt(body.noteIndex as string, 10);\n  \n  const job = await db.prepare('SELECT notes_json FROM jobs WHERE id = ?').bind(jobId).first<{ notes_json: string }>();\n  const notes = job?.notes_json ? JSON.parse(job.notes_json) : [];\n  \n  if (notes[noteIndex]) {\n    notes[noteIndex].completed = notes[noteIndex].completed ? 0 : 1;\n  }\n  \n  await db.prepare('UPDATE jobs SET notes_json = ?, updated_at = datetime(\"now\") WHERE id = ?').bind(JSON.stringify(notes), jobId).run();\n  \n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.post('/jobs/:id/notes/delete', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const noteIndex = parseInt(body.noteIndex as string, 10);\n  \n  const job = await db.prepare('SELECT notes_json FROM jobs WHERE id = ?').bind(jobId).first<{ notes_json: string }>();\n  const notes = job?.notes_json ? JSON.parse(job.notes_json) : [];\n  \n  notes.splice(noteIndex, 1);\n  \n  await db.prepare('UPDATE jobs SET notes_json = ?, updated_at = datetime(\"now\") WHERE id = ?').bind(JSON.stringify(notes), jobId).run();\n  \n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.post('/jobs/:id/status', async (c) => {\n  const db = c.env.DB;\n  const jobId = c.req.param('id');\n  const body = await c.req.parseBody();\n  const status = body.status as string;\n  \n  const validStatuses = ['created', 'assigned', 'enroute', 'in_progress', 'complete', 'cancelled'];\n  if (!validStatuses.includes(status)) return c.redirect(`/admin/jobs/${jobId}`);\n  \n  const updates: string[] = ['status = ?', \"updated_at = datetime('now')\"];\n  const binds: unknown[] = [status];\n  if (status === 'complete') updates.push(\"completed_at = datetime('now')\");\n  if (status === 'cancelled') updates.push(\"cancelled_at = datetime('now')\");\n  binds.push(jobId);\n  \n  await db.prepare(`UPDATE jobs SET ${updates.join(', ')} WHERE id = ?`).bind(...binds).run();\n  \n  const jobData = await db.prepare(\n    `SELECT j.customer_id, j.total_price_cents, j.scheduled_date, j.scheduled_start_time, j.line_items_json,\n            c.first_name, c.last_name, c.email, c.phone_e164,\n            COALESCE(s.name, j.custom_service_name, 'Service') as service_name\n     FROM jobs j\n     JOIN customers c ON c.id = j.customer_id\n     LEFT JOIN services s ON s.id = j.service_id\n     WHERE j.id = ?`\n  ).bind(jobId).first<{\n    customer_id: string; total_price_cents: number; scheduled_date: string; scheduled_start_time: string; line_items_json: string | null;\n    first_name: string; last_name: string; email: string | null; phone_e164: string | null; service_name: string;\n  }>();\n\n  if (jobData) {\n    if (status === 'complete') {\n      const existingInvoice = await db.prepare(\n        'SELECT id FROM invoices WHERE job_id = ?'\n      ).bind(jobId).first();\n      \n      if (!existingInvoice) {\n        const invoiceId = generateId();\n        const invoiceNumber = await nextInvoiceNumber(db);\n        const dueDate = new Date();\n        dueDate.setDate(dueDate.getDate() + 14);\n        const jobLines = parsePriceLines(jobData.line_items_json);\n        const effectiveLines = jobLines.length > 0 ? jobLines : [buildServiceBaseLine(jobData.service_name, jobData.total_price_cents)];\n        const subtotal = subtotalFromLines(effectiveLines);\n        \n        await db.prepare(`\n          INSERT INTO invoices (id, invoice_number, job_id, customer_id, currency, amount_cents, subtotal_cents, tax_cents, discount_cents, total_cents, line_items_json, due_date, status)\n          VALUES (?, ?, ?, ?, 'CAD', ?, ?, 0, 0, ?, ?, ?, 'pending')\n        `).bind(\n          invoiceId,\n          invoiceNumber,\n          jobId,\n          jobData.customer_id,\n          subtotal,\n          subtotal,\n          subtotal,\n          JSON.stringify(effectiveLines),\n          dueDate.toISOString().split('T')[0],\n        ).run();\n      }\n    }\n\n    let providerName = '';\n    if (['assigned', 'enroute'].includes(status)) {\n      const provider = await db.prepare(\n        `SELECT tm.first_name, tm.last_name FROM job_providers jp\n         JOIN team_members tm ON tm.id = jp.team_member_id\n         WHERE jp.job_id = ? LIMIT 1`\n      ).bind(jobId).first<{ first_name: string; last_name: string }>();\n      if (provider) providerName = `${provider.first_name} ${provider.last_name}`.trim();\n    }\n\n    const statusEventMap: Record<string, string> = {\n      assigned: 'status.assigned',\n      enroute: 'status.enroute',\n      in_progress: 'status.in_progress',\n      complete: 'status.complete',\n      cancelled: 'status.cancelled',\n    };\n\n    const eventType = statusEventMap[status];\n    if (eventType) {\n      const baseUrl = new URL(c.req.url).origin;\n      const inboxMessageId = jobData.phone_e164\n        ? await ensureSmsInboxMessage({\n          db,\n          phoneE164: jobData.phone_e164,\n          customerId: jobData.customer_id,\n          jobId,\n          firstName: jobData.first_name,\n          lastName: jobData.last_name,\n          email: jobData.email,\n        })\n        : null;\n\n      const templateVars: TemplateVars = {\n        first_name: jobData.first_name,\n        last_name: jobData.last_name,\n        service_name: jobData.service_name,\n        date: jobData.scheduled_date,\n        time: jobData.scheduled_start_time,\n        provider_name: providerName || 'your technician',\n        total: (jobData.total_price_cents / 100).toFixed(2),\n      };\n\n      c.executionCtx.waitUntil(\n        sendJobSms({\n          db,\n          jobId,\n          customerId: jobData.customer_id,\n          eventType,\n          vars: templateVars,\n          messageId: inboxMessageId,\n          statusCallbackUrl: `${baseUrl}/webhooks/twilio/status`,\n          skipQuietHours: true,\n        })\n      );\n    }\n  }\n  \n  return c.redirect(`/admin/jobs/${jobId}`);\n});\n\napp.post('/jobs', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  const totalPriceCents = parseInt(body.total_price_cents as string, 10) || 0;\n  \n  await db.prepare(`\n    INSERT INTO jobs (id, customer_id, service_id, territory_id, scheduled_date, scheduled_start_time, \n                      duration_minutes, base_price_cents, total_price_cents, line_items_json, custom_service_name, status)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.customer_id,\n    body.service_id || null,\n    body.territory_id,\n    body.scheduled_date,\n    body.scheduled_start_time,\n    parseInt(body.duration_minutes as string, 10) || 60,\n    totalPriceCents,\n    totalPriceCents,\n    JSON.stringify([buildServiceBaseLine(String(body.custom_service_name || 'Service'), totalPriceCents)]),\n    body.custom_service_name || null,\n    body.status || 'created'\n  ).run();\n  \n  return c.redirect('/admin/jobs');\n});\n\napp.get('/jobs/:id/edit', async (c) => {\n  return c.redirect(`/admin/jobs/${c.req.param('id')}`);\n});\n\napp.post('/jobs/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const section = body._section as string | undefined;\n  if (section === 'details') {\n    const duration = parseInt(body.duration_minutes as string, 10) || 60;\n    const basePriceCents = Math.round(parseFloat(body.base_price as string || '0') * 100);\n    const totalPriceCents = Math.round(parseFloat(body.total_price as string || '0') * 100);\n    const providerId = (body.provider_id as string | undefined) || '';\n\n    const existing = await db.prepare('SELECT custom_service_name, line_items_json FROM jobs WHERE id = ?').bind(id).first<{ custom_service_name: string | null; line_items_json: string | null }>();\n    const customLines = parsePriceLines(existing?.line_items_json || '[]').filter((line) => line.is_custom === 1);\n    const generated = buildServiceBaseLine((existing?.custom_service_name || 'Service'), totalPriceCents);\n\n    await db.prepare(`\n      UPDATE jobs\n      SET scheduled_date = ?, scheduled_start_time = ?, duration_minutes = ?,\n          base_price_cents = ?, total_price_cents = ?, line_items_json = ?, updated_at = datetime('now')\n      WHERE id = ?\n    `).bind(\n      body.scheduled_date,\n      body.scheduled_start_time,\n      duration,\n      basePriceCents,\n      totalPriceCents,\n      JSON.stringify([generated, ...customLines]),\n      id\n    ).run();\n\n    await db.prepare('DELETE FROM job_providers WHERE job_id = ?').bind(id).run();\n    if (providerId) {\n      await db.prepare('INSERT INTO job_providers (job_id, team_member_id) VALUES (?, ?)').bind(id, providerId).run();\n    }\n\n    return c.redirect(`/admin/jobs/${id}`);\n  }\n\n  // Backward-compat for legacy full edit forms.\n  const totalPriceCents = parseInt(body.total_price_cents as string, 10) || 0;\n  const existing = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(id).first<{ line_items_json: string | null }>();\n  const customLines = parsePriceLines(existing?.line_items_json || '[]').filter((line) => line.is_custom === 1);\n  const baseLine = buildServiceBaseLine(String(body.custom_service_name || 'Service'), totalPriceCents);\n  await db.prepare(`\n    UPDATE jobs \n    SET customer_id = ?, service_id = ?, territory_id = ?, scheduled_date = ?, scheduled_start_time = ?,\n        duration_minutes = ?, total_price_cents = ?, line_items_json = ?, custom_service_name = ?, status = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.customer_id,\n    body.service_id || null,\n    body.territory_id,\n    body.scheduled_date,\n    body.scheduled_start_time,\n    parseInt(body.duration_minutes as string, 10) || 60,\n    totalPriceCents,\n    JSON.stringify([baseLine, ...customLines]),\n    body.custom_service_name || null,\n    body.status || 'created',\n    id\n  ).run();\n\n  return c.redirect(`/admin/jobs/${id}`);\n});\n\napp.post('/jobs/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM job_notes WHERE job_id = ?').bind(id).run();\n  await db.prepare('DELETE FROM job_providers WHERE job_id = ?').bind(id).run();\n  await db.prepare('DELETE FROM invoices WHERE job_id = ?').bind(id).run();\n  await db.prepare('DELETE FROM jobs WHERE id = ?').bind(id).run();\n\n  const isHtmx = c.req.header('HX-Request');\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/jobs/${id}`)) {\n      c.header('HX-Redirect', '/admin/jobs');\n    }\n    return c.body('', 200);\n  }\n  return c.redirect('/admin/jobs');\n});\n\napp.get('/invoices', async (c) => {\n  const db = c.env.DB;\n  const invoices = await db.prepare(`\n    SELECT i.id, i.invoice_number, i.customer_id,\n           TRIM(COALESCE(c.first_name, '') || ' ' || COALESCE(c.last_name, '')) as customer_name,\n           i.total_cents, i.currency, i.status, i.due_date, i.created_at\n    FROM invoices i\n    JOIN customers c ON i.customer_id = c.id\n    ORDER BY i.created_at DESC\n    LIMIT 50\n  `).all();\n  \n  return c.html(TableView({\n    title: 'Invoices',\n    columns: ['Invoice #', 'Customer', 'Total', 'Status', 'Due', 'Created'],\n    rows: (invoices.results || []).map(i => ({\n      invoice: i.invoice_number || i.id,\n      customer: (typeof i.customer_name === 'string' && i.customer_name.trim()) ? i.customer_name : `Customer ${i.customer_id}`,\n      total: `${i.currency || 'CAD'} ${formatCents(Number(i.total_cents || 0))}`,\n      status: i.status,\n      due: i.due_date || '-',\n      created: formatTorontoDate(`${i.created_at as string}Z`, {}) || (i.created_at as string)\n    })),\n    rawIds: (invoices.results || []).map(i => i.id as string),\n    createUrl: '/admin/invoices/new',\n    detailUrlPrefix: '/admin/invoices',\n    deleteUrlPrefix: '/admin/invoices'\n  }));\n});\n\napp.get('/invoices/new', async (c) => {\n  const db = c.env.DB;\n  const [customers, jobs] = await Promise.all([\n    db.prepare('SELECT id, first_name, last_name FROM customers ORDER BY last_name, first_name').all(),\n    db.prepare(`SELECT j.id, c.first_name || ' ' || c.last_name as customer_name, j.scheduled_date \n                FROM jobs j JOIN customers c ON j.customer_id = c.id \n                WHERE j.status != 'cancelled' ORDER BY j.scheduled_date DESC LIMIT 100`).all()\n  ]);\n\n  const invoiceNumber = await nextInvoiceNumber(db);\n  \n  const fields: FormField[] = [\n    { name: 'invoice_number', label: 'Invoice Number', required: true, value: invoiceNumber },\n    { name: 'customer_id', label: 'Customer', type: 'select', required: true, options: (customers.results || []).map(c => ({ value: c.id as string, label: `${c.first_name} ${c.last_name}` })) },\n    { name: 'job_id', label: 'Job (optional)', type: 'select', options: (jobs.results || []).map(j => ({ value: j.id as string, label: `${j.customer_name} - ${j.scheduled_date}` })) },\n    { name: 'currency', label: 'Currency', type: 'select', required: true, value: 'CAD', options: [\n      { value: 'CAD', label: 'CAD' },\n      { value: 'USD', label: 'USD' }\n    ]},\n    { name: 'line_items_text', label: 'Line Items (one per line: description | qty | unit price)', type: 'textarea', placeholder: 'Tune-up | 1 | 125.00\\nTire install | 2 | 35.00' },\n    { name: 'tax_amount', label: 'Tax ($)', type: 'number', min: 0, step: 0.01, value: 0 },\n    { name: 'discount_amount', label: 'Discount ($)', type: 'number', min: 0, step: 0.01, value: 0 },\n    { name: 'total_amount', label: 'Total ($)', type: 'number', required: true, min: 0, step: 0.01 },\n    { name: 'due_date', label: 'Due Date', type: 'date' },\n    { name: 'notes', label: 'Notes', type: 'textarea', placeholder: 'Payment terms, memo, or internal notes' },\n    { name: 'status', label: 'Status', type: 'select', required: true, value: 'pending', options: [\n      { value: 'pending', label: 'Pending' },\n      { value: 'sent', label: 'Sent' },\n      { value: 'paid', label: 'Paid' },\n      { value: 'void', label: 'Void' }\n    ]}\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Invoice',\n    fields,\n    submitUrl: '/admin/invoices',\n    cancelUrl: '/admin/invoices'\n  }));\n});\n\napp.post('/invoices', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  let lineItems = parseInvoiceLineItems(typeof body.line_items_text === 'string' ? body.line_items_text : null);\n  if (lineItems.length === 0 && body.job_id) {\n    const job = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(body.job_id).first<{ line_items_json: string | null }>();\n    lineItems = parsePriceLines(job?.line_items_json || '[]');\n  }\n  const subtotalCents = lineItems.reduce((sum, item) => sum + item.total_cents, 0);\n  const taxCents = parseMoneyToCents(body.tax_amount);\n  const discountCents = parseMoneyToCents(body.discount_amount);\n  const computedTotalCents = Math.max(0, subtotalCents + taxCents - discountCents);\n  const totalCents = computedTotalCents;\n  const status = typeof body.status === 'string' ? body.status : 'pending';\n  const paidAt = status === 'paid' ? new Date().toISOString() : null;\n  \n  await db.prepare(`\n    INSERT INTO invoices (id, invoice_number, customer_id, job_id, currency, amount_cents, subtotal_cents, tax_cents, discount_cents, total_cents, line_items_json, due_date, status, paid_at, notes)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.invoice_number || await nextInvoiceNumber(db),\n    body.customer_id,\n    body.job_id || null,\n    body.currency || 'CAD',\n    totalCents,\n    subtotalCents,\n    taxCents,\n    discountCents,\n    totalCents,\n    JSON.stringify(lineItems),\n    body.due_date || null,\n    status,\n    paidAt,\n    body.notes || null\n  ).run();\n  \n  return c.redirect('/admin/invoices');\n});\n\napp.get('/invoices/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/invoices/new');\n  return c.redirect(`/admin/invoices/${id}/edit`);\n});\n\napp.get('/invoices/:id/edit', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const [invoice, customers, jobs] = await Promise.all([\n    db.prepare('SELECT * FROM invoices WHERE id = ?').bind(id).first(),\n    db.prepare('SELECT id, first_name, last_name FROM customers ORDER BY last_name, first_name').all(),\n    db.prepare(`SELECT j.id, c.first_name || ' ' || c.last_name as customer_name, j.scheduled_date \n                FROM jobs j JOIN customers c ON j.customer_id = c.id ORDER BY j.scheduled_date DESC LIMIT 100`).all()\n  ]);\n  \n  if (!invoice) {\n    return c.redirect('/admin/invoices');\n  }\n  \n  const lineItems = parsePriceLines(invoice.line_items_json as string | null);\n  return c.html(InvoiceDetailPage({\n    invoice: {\n      id: invoice.id as string,\n      invoice_number: (invoice.invoice_number as string) || '',\n      customer_id: invoice.customer_id as string,\n      job_id: (invoice.job_id as string) || null,\n      currency: ((invoice.currency as string) || 'CAD').toUpperCase(),\n      due_date: (invoice.due_date as string) || null,\n      status: (invoice.status as string) || 'pending',\n      notes: (invoice.notes as string) || null,\n      tax_cents: Number(invoice.tax_cents || 0),\n      discount_cents: Number(invoice.discount_cents || 0),\n    },\n    customers: (customers.results || []).map((row) => ({\n      id: row.id as string,\n      first_name: row.first_name as string,\n      last_name: row.last_name as string,\n    })),\n    jobs: (jobs.results || []).map((row) => ({\n      id: row.id as string,\n      customer_name: row.customer_name as string,\n      scheduled_date: row.scheduled_date as string,\n    })),\n    lineItems,\n  }));\n});\n\napp.post('/invoices/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const existingInvoice = await db.prepare('SELECT line_items_json FROM invoices WHERE id = ?').bind(id).first<{ line_items_json: string | null }>();\n  if (!existingInvoice) return c.redirect('/admin/invoices');\n  let lineItems = typeof body.line_items_text === 'string'\n    ? parseInvoiceLineItems(body.line_items_text)\n    : parsePriceLines(existingInvoice.line_items_json || '[]');\n  if (lineItems.length === 0 && body.job_id) {\n    const job = await db.prepare('SELECT line_items_json FROM jobs WHERE id = ?').bind(body.job_id).first<{ line_items_json: string | null }>();\n    lineItems = parsePriceLines(job?.line_items_json || '[]');\n  }\n  const subtotalCents = lineItems.reduce((sum, item) => sum + item.total_cents, 0);\n  const taxCents = parseMoneyToCents(body.tax_amount);\n  const discountCents = parseMoneyToCents(body.discount_amount);\n  const computedTotalCents = Math.max(0, subtotalCents + taxCents - discountCents);\n  const totalCents = computedTotalCents;\n  const status = typeof body.status === 'string' ? body.status : 'pending';\n  const paidAt = status === 'paid' ? new Date().toISOString() : null;\n  \n  await db.prepare(`\n    UPDATE invoices \n    SET invoice_number = ?, customer_id = ?, job_id = ?, currency = ?, amount_cents = ?, subtotal_cents = ?, tax_cents = ?, discount_cents = ?, total_cents = ?, line_items_json = ?, due_date = ?, status = ?, paid_at = CASE WHEN ? = 'paid' THEN COALESCE(paid_at, ?) ELSE NULL END, notes = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.invoice_number,\n    body.customer_id,\n    body.job_id || null,\n    body.currency || 'CAD',\n    totalCents,\n    subtotalCents,\n    taxCents,\n    discountCents,\n    totalCents,\n    JSON.stringify(lineItems),\n    body.due_date || null,\n    status,\n    status,\n    paidAt,\n    body.notes || null,\n    id\n  ).run();\n  \n  return c.redirect('/admin/invoices');\n});\n\napp.post('/invoices/:id/line-items/add', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const invoice = await db.prepare('SELECT line_items_json FROM invoices WHERE id = ?').bind(id).first<{ line_items_json: string | null }>();\n  if (!invoice) return c.redirect('/admin/invoices');\n  const description = typeof body.description === 'string' ? body.description.trim() : '';\n  const quantity = Math.max(1, Number.parseFloat(String(body.quantity || '1')) || 1);\n  const unitPriceCents = parseMoneyToCents(body.unit_price);\n  if (!description) return c.redirect(`/admin/invoices/${id}/edit`);\n  const lines = parsePriceLines(invoice.line_items_json);\n  lines.push(normalizeLine(description, quantity, unitPriceCents, 'custom', null, 1));\n  await writeInvoiceLines(db, id, lines);\n  return c.redirect(`/admin/invoices/${id}/edit`);\n});\n\napp.post('/invoices/:id/line-items/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const lineId = typeof body.lineId === 'string' ? body.lineId : '';\n  if (!lineId) return c.redirect(`/admin/invoices/${id}/edit`);\n  const invoice = await db.prepare('SELECT line_items_json FROM invoices WHERE id = ?').bind(id).first<{ line_items_json: string | null }>();\n  if (!invoice) return c.redirect('/admin/invoices');\n  const lines = parsePriceLines(invoice.line_items_json).filter((line) => !(line.id === lineId && line.is_custom === 1));\n  await writeInvoiceLines(db, id, lines);\n  return c.redirect(`/admin/invoices/${id}/edit`);\n});\n\napp.post('/invoices/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM invoices WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/invoices/${id}`)) {\n      c.header('HX-Redirect', '/admin/invoices');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/invoices');\n});\n\napp.get('/recurring', async (c) => {\n  const db = c.env.DB;\n  const recurring = await db.prepare(`\n    SELECT rb.id, c.first_name || ' ' || c.last_name as customer_name,\n           s.name as service_name, rb.frequency, rb.is_active\n    FROM recurring_bookings rb\n    JOIN customers c ON rb.customer_id = c.id\n    LEFT JOIN services s ON rb.service_id = s.id\n    ORDER BY rb.created_at DESC\n    LIMIT 50\n  `).all();\n  \n  return c.html(TableView({\n    title: 'Recurring Bookings',\n    columns: ['Customer', 'Service', 'Frequency', 'Active'],\n    rows: (recurring.results || []).map(r => ({\n      customer: r.customer_name,\n      service: r.service_name || 'N/A',\n      frequency: r.frequency,\n      active: r.is_active ? 'active' : 'inactive'\n    })),\n    createUrl: '/admin/recurring/new',\n    detailUrlPrefix: '/admin/recurring',\n    deleteUrlPrefix: '/admin/recurring'\n  }));\n});\n\napp.get('/recurring/new', async (c) => {\n  const db = c.env.DB;\n  const [customers, services, territories] = await Promise.all([\n    db.prepare('SELECT id, first_name, last_name FROM customers ORDER BY last_name, first_name').all(),\n    db.prepare('SELECT id, name FROM services WHERE is_active = 1 ORDER BY name').all(),\n    db.prepare('SELECT id, name FROM territories WHERE is_active = 1 ORDER BY name').all()\n  ]);\n  \n  const fields: FormField[] = [\n    { name: 'customer_id', label: 'Customer', type: 'select', required: true, options: (customers.results || []).map(c => ({ value: c.id as string, label: `${c.first_name} ${c.last_name}` })) },\n    { name: 'service_id', label: 'Service', type: 'select', required: true, options: (services.results || []).map(s => ({ value: s.id as string, label: s.name as string })) },\n    { name: 'territory_id', label: 'Territory', type: 'select', required: true, options: (territories.results || []).map(t => ({ value: t.id as string, label: t.name as string })) },\n    { name: 'frequency', label: 'Frequency', type: 'select', required: true, options: [\n      { value: 'weekly', label: 'Weekly' },\n      { value: 'biweekly', label: 'Biweekly' },\n      { value: 'monthly', label: 'Monthly' }\n    ]},\n    { name: 'day_of_week', label: 'Day of Week', type: 'select', options: [\n      { value: '0', label: 'Sunday' },\n      { value: '1', label: 'Monday' },\n      { value: '2', label: 'Tuesday' },\n      { value: '3', label: 'Wednesday' },\n      { value: '4', label: 'Thursday' },\n      { value: '5', label: 'Friday' },\n      { value: '6', label: 'Saturday' }\n    ]},\n    { name: 'scheduled_start_time', label: 'Start Time', type: 'time' },\n    { name: 'duration_minutes', label: 'Duration (minutes)', type: 'number', required: true, value: 60, min: 1 },\n    { name: 'total_price', label: 'Total Price ($)', type: 'number', required: true, value: '0.00', min: 0, step: 0.01 },\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Recurring Booking',\n    fields,\n    submitUrl: '/admin/recurring',\n    cancelUrl: '/admin/recurring'\n  }));\n});\n\napp.post('/recurring', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  const totalPriceCents = Math.round(parseFloat(body.total_price as string || '0') * 100);\n  \n  await db.prepare(`\n    INSERT INTO recurring_bookings (id, customer_id, service_id, territory_id, frequency, day_of_week, \n                                    scheduled_start_time, duration_minutes, base_price_cents, total_price_cents, is_active)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.customer_id,\n    body.service_id,\n    body.territory_id,\n    body.frequency,\n    body.day_of_week ? parseInt(body.day_of_week as string, 10) : null,\n    body.scheduled_start_time || null,\n    parseInt(body.duration_minutes as string, 10) || 60,\n    totalPriceCents,\n    totalPriceCents,\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect('/admin/recurring');\n});\n\napp.get('/recurring/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/recurring/new');\n  return c.redirect(`/admin/recurring/${id}/edit`);\n});\n\napp.get('/recurring/:id/edit', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const [recurring, customers, services, territories] = await Promise.all([\n    db.prepare('SELECT * FROM recurring_bookings WHERE id = ?').bind(id).first(),\n    db.prepare('SELECT id, first_name, last_name FROM customers ORDER BY last_name, first_name').all(),\n    db.prepare('SELECT id, name FROM services WHERE is_active = 1 ORDER BY name').all(),\n    db.prepare('SELECT id, name FROM territories ORDER BY name').all()\n  ]);\n  \n  if (!recurring) {\n    return c.redirect('/admin/recurring');\n  }\n  \n  const fields: FormField[] = [\n    { name: 'customer_id', label: 'Customer', type: 'select', required: true, value: recurring.customer_id as string, options: (customers.results || []).map(c => ({ value: c.id as string, label: `${c.first_name} ${c.last_name}` })) },\n    { name: 'service_id', label: 'Service', type: 'select', required: true, value: recurring.service_id as string, options: (services.results || []).map(s => ({ value: s.id as string, label: s.name as string })) },\n    { name: 'territory_id', label: 'Territory', type: 'select', required: true, value: recurring.territory_id as string, options: (territories.results || []).map(t => ({ value: t.id as string, label: t.name as string })) },\n    { name: 'frequency', label: 'Frequency', type: 'select', required: true, value: recurring.frequency as string, options: [\n      { value: 'weekly', label: 'Weekly' },\n      { value: 'biweekly', label: 'Biweekly' },\n      { value: 'monthly', label: 'Monthly' }\n    ]},\n    { name: 'day_of_week', label: 'Day of Week', type: 'select', value: recurring.day_of_week?.toString(), options: [\n      { value: '0', label: 'Sunday' },\n      { value: '1', label: 'Monday' },\n      { value: '2', label: 'Tuesday' },\n      { value: '3', label: 'Wednesday' },\n      { value: '4', label: 'Thursday' },\n      { value: '5', label: 'Friday' },\n      { value: '6', label: 'Saturday' }\n    ]},\n    { name: 'scheduled_start_time', label: 'Start Time', type: 'time', value: recurring.scheduled_start_time as string },\n    { name: 'duration_minutes', label: 'Duration (minutes)', type: 'number', required: true, value: recurring.duration_minutes as number, min: 1 },\n    { name: 'total_price', label: 'Total Price ($)', type: 'number', required: true, value: ((recurring.total_price_cents as number) / 100).toFixed(2), min: 0, step: 0.01 },\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: Boolean(recurring.is_active) }\n  ];\n  \n  return c.html(FormView({\n    title: 'Edit Recurring Booking',\n    fields,\n    submitUrl: `/admin/recurring/${id}`,\n    cancelUrl: '/admin/recurring',\n    isEdit: true,\n    deleteUrl: `/admin/recurring/${id}/delete`\n  }));\n});\n\napp.post('/recurring/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  const totalPriceCents = Math.round(parseFloat(body.total_price as string || '0') * 100);\n  \n  await db.prepare(`\n    UPDATE recurring_bookings \n    SET customer_id = ?, service_id = ?, territory_id = ?, frequency = ?, day_of_week = ?,\n        scheduled_start_time = ?, duration_minutes = ?, total_price_cents = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.customer_id,\n    body.service_id,\n    body.territory_id,\n    body.frequency,\n    body.day_of_week ? parseInt(body.day_of_week as string, 10) : null,\n    body.scheduled_start_time || null,\n    parseInt(body.duration_minutes as string, 10) || 60,\n    totalPriceCents,\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect('/admin/recurring');\n});\n\napp.post('/recurring/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM recurring_bookings WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/recurring/${id}`)) {\n      c.header('HX-Redirect', '/admin/recurring');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/recurring');\n});\n\napp.get('/branding', async (c) => {\n  const db = c.env.DB;\n  const row = await db.prepare(\"SELECT value FROM settings WHERE key = 'widget_branding'\").first<{ value: string }>();\n  let branding = { primaryColor: '#2563eb' };\n  if (row) {\n    try {\n      branding = { ...branding, ...JSON.parse(row.value) };\n    } catch {\n    }\n  }\n  return c.html(BrandingPage(branding));\n});\n\napp.post('/branding', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const branding = { primaryColor: (body.primaryColor as string) || '#2563eb' };\n  await db.prepare(\"INSERT OR REPLACE INTO settings (key, value, updated_at) VALUES ('widget_branding', ?, datetime('now'))\").bind(JSON.stringify(branding)).run();\n  return c.body('', 200);\n});\n\napp.get('/settings', async (c) => {\n  const db = c.env.DB;\n  const settings = await db.prepare('SELECT key, value FROM settings ORDER BY key').all();\n  \n  return c.html(TableView({\n    title: 'Settings',\n    columns: ['Key', 'Value'],\n    rows: (settings.results || []).map(s => ({\n      id: s.key,\n      key: s.key,\n      value: s.value\n    })),\n    createUrl: '/admin/settings/new',\n  }));\n});\n\napp.get('/settings/new', (c) => {\n  const fields: FormField[] = [\n    { name: 'key', label: 'Key', required: true },\n    { name: 'value', label: 'Value', type: 'textarea', required: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Setting',\n    fields,\n    submitUrl: '/admin/settings',\n    cancelUrl: '/admin/settings'\n  }));\n});\n\napp.post('/settings', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  \n  await db.prepare(`\n    INSERT OR REPLACE INTO settings (key, value, updated_at)\n    VALUES (?, ?, datetime('now'))\n  `).bind(body.key, body.value).run();\n  \n  return c.redirect('/admin/settings');\n});\n\napp.get('/settings/:key/edit', async (c) => {\n  const db = c.env.DB;\n  const key = c.req.param('key');\n  const setting = await db.prepare('SELECT * FROM settings WHERE key = ?').bind(key).first();\n  \n  if (!setting) {\n    return c.redirect('/admin/settings');\n  }\n  \n  const fields: FormField[] = [\n    { name: 'key', label: 'Key', required: true, value: setting.key as string },\n    { name: 'value', label: 'Value', type: 'textarea', required: true, value: setting.value as string }\n  ];\n  \n  return c.html(FormView({\n    title: 'Edit Setting',\n    fields,\n    submitUrl: `/admin/settings/${key}`,\n    cancelUrl: '/admin/settings',\n    isEdit: true,\n    deleteUrl: `/admin/settings/${key}/delete`\n  }));\n});\n\napp.post('/settings/:key', async (c) => {\n  const db = c.env.DB;\n  const oldKey = c.req.param('key');\n  const body = await c.req.parseBody();\n  \n  if (oldKey !== body.key) {\n    await db.prepare('DELETE FROM settings WHERE key = ?').bind(oldKey).run();\n  }\n  \n  await db.prepare(`\n    INSERT OR REPLACE INTO settings (key, value, updated_at)\n    VALUES (?, ?, datetime('now'))\n  `).bind(body.key, body.value).run();\n  \n  return c.redirect('/admin/settings');\n});\n\napp.post('/settings/:key/delete', async (c) => {\n  const db = c.env.DB;\n  const key = c.req.param('key');\n\n  await db.prepare('DELETE FROM settings WHERE key = ?').bind(key).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/settings/${key}`)) {\n      c.header('HX-Redirect', '/admin/settings');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/settings');\n});\n\napp.get('/push-settings', (c) => {\n  return c.html(PushSettingsPage());\n});\n\napp.get('/manifest.webmanifest', (c) => {\n  return c.text(JSON.stringify(PUSH_MANIFEST), 200, {\n    'Content-Type': 'application/manifest+json; charset=utf-8',\n    'Cache-Control': 'no-store, no-cache, must-revalidate, max-age=0',\n  });\n});\n\napp.get('/sw.js', (c) => {\n  return c.text(PUSH_SERVICE_WORKER_SCRIPT, 200, {\n    'Content-Type': 'application/javascript; charset=utf-8',\n    'Cache-Control': 'no-store, no-cache, must-revalidate, max-age=0',\n  });\n});\n\napp.get('/push/vapid-public-key', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ error: 'Cloudflare Access user required' }, 403);\n  }\n\n  try {\n    const publicKey = await getPushVapidPublicKey(db);\n    return c.json({ publicKey });\n  } catch (error) {\n    return c.json(\n      {\n        error: error instanceof Error ? error.message : String(error),\n        step: 'getPushVapidPublicKey',\n      },\n      500,\n    );\n  }\n});\n\napp.get('/push/status', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ error: 'Cloudflare Access user required' }, 403);\n  }\n\n  const endpoint = (c.req.query('endpoint') || '').trim();\n\n  try {\n    const status = await getPushSubscriptionStatus(db, email, endpoint || undefined);\n    return c.json(status);\n  } catch (error) {\n    return c.json(\n      {\n        error: error instanceof Error ? error.message : String(error),\n        step: 'getPushSubscriptionStatus',\n      },\n      500,\n    );\n  }\n});\n\napp.post('/push/subscribe', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ error: 'Cloudflare Access user required' }, 403);\n  }\n\n  const body = await c.req.json<Record<string, unknown>>();\n  const subscriptionRaw = body.subscription;\n  const preferencesRaw = body.preferences;\n\n  if (!subscriptionRaw || typeof subscriptionRaw !== 'object' || Array.isArray(subscriptionRaw)) {\n    return c.json({ error: 'Invalid subscription payload' }, 400);\n  }\n\n  const subscriptionRecord = subscriptionRaw as Record<string, unknown>;\n  const endpoint = typeof subscriptionRecord.endpoint === 'string' ? subscriptionRecord.endpoint.trim() : '';\n  const keysRaw = subscriptionRecord.keys;\n  const keysRecord = (keysRaw && typeof keysRaw === 'object' && !Array.isArray(keysRaw))\n    ? keysRaw as Record<string, unknown>\n    : null;\n  const p256dh = typeof keysRecord?.p256dh === 'string' ? keysRecord.p256dh.trim() : '';\n  const auth = typeof keysRecord?.auth === 'string' ? keysRecord.auth.trim() : '';\n\n  if (!endpoint || !p256dh || !auth) {\n    return c.json({ error: 'Subscription endpoint and keys are required' }, 400);\n  }\n\n  const preferencesRecord = (preferencesRaw && typeof preferencesRaw === 'object' && !Array.isArray(preferencesRaw))\n    ? preferencesRaw as Record<string, unknown>\n    : {};\n\n  try {\n    await upsertPushSubscription(\n      db,\n      email,\n      {\n        endpoint,\n        keys: { p256dh, auth },\n      },\n      {\n        notifyNewJobs: preferencesRecord.notifyNewJobs !== false,\n        notifyNewMessages: preferencesRecord.notifyNewMessages !== false,\n      },\n    );\n\n    return c.json({ success: true });\n  } catch (error) {\n    return c.json(\n      {\n        error: error instanceof Error ? error.message : String(error),\n        step: 'upsertPushSubscription',\n      },\n      500,\n    );\n  }\n});\n\napp.post('/push/unsubscribe', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ error: 'Cloudflare Access user required' }, 403);\n  }\n\n  const body = await c.req.json<Record<string, unknown>>();\n  const endpoint = typeof body.endpoint === 'string' ? body.endpoint.trim() : '';\n  if (!endpoint) return c.json({ success: true });\n\n  try {\n    await deactivatePushSubscription(db, email, endpoint);\n    return c.json({ success: true });\n  } catch (error) {\n    return c.json(\n      {\n        error: error instanceof Error ? error.message : String(error),\n        step: 'deactivatePushSubscription',\n      },\n      500,\n    );\n  }\n});\n\napp.post('/push/test', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ error: 'Cloudflare Access user required' }, 403);\n  }\n\n  const body = await c.req.json<Record<string, unknown>>();\n  const endpoint = typeof body.endpoint === 'string' ? body.endpoint.trim() : '';\n  if (!endpoint) {\n    return c.json({ error: 'Endpoint is required' }, 400);\n  }\n\n  try {\n    const result = await enqueueTestPushNotificationAndPing(db, email, endpoint);\n    return c.json({ success: true, ...result });\n  } catch (error) {\n    return c.json(\n      {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      },\n      400,\n    );\n  }\n});\n\napp.get('/push/pending', async (c) => {\n  const db = c.env.DB;\n  const email = getAuthenticatedStaffEmail(c);\n  if (!email) {\n    return c.json({ notifications: [] }, 403);\n  }\n\n  const endpoint = (c.req.query('endpoint') || '').trim();\n  if (!endpoint) {\n    return c.json({ notifications: [] });\n  }\n\n  const limitRaw = Number.parseInt(c.req.query('limit') || '6', 10);\n\n  let notifications: Awaited<ReturnType<typeof pullPendingPushNotifications>> = [];\n  try {\n    notifications = await pullPendingPushNotifications(\n      db,\n      email,\n      endpoint,\n      Number.isFinite(limitRaw) ? limitRaw : 6,\n    );\n  } catch (error) {\n    return c.json(\n      {\n        notifications: [],\n        error: error instanceof Error ? error.message : String(error),\n        step: 'pullPendingPushNotifications',\n      },\n      500,\n    );\n  }\n\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n  return c.json({ notifications });\n});\n\napp.get('/sms-settings', async (c) => {\n  const db = c.env.DB;\n  const config = await getTwilioConfig(db);\n  const templates = await db.prepare('SELECT * FROM sms_templates ORDER BY event_type').all();\n\n  const smsStats = await db.prepare(\n    `SELECT\n       COUNT(*) as total,\n       SUM(CASE WHEN direction = 'outbound' THEN 1 ELSE 0 END) as sent,\n       SUM(CASE WHEN direction = 'inbound' THEN 1 ELSE 0 END) as received,\n       SUM(CASE WHEN status = 'failed' THEN 1 ELSE 0 END) as failed,\n       SUM(segments) as total_segments\n     FROM sms_log`\n  ).first<{ total: number; sent: number; received: number; failed: number; total_segments: number }>();\n\n  return c.html(SmsSettingsPage({\n    config: config ? { accountSid: config.accountSid, authToken: config.authToken, phoneNumber: config.phoneNumber, enabled: config.enabled } : null,\n    templates: (templates.results || []) as { id: string; event_type: string; label: string; body_template: string; is_active: number }[],\n    stats: smsStats || null,\n  }));\n});\n\napp.post('/sms-settings', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n\n  const config = {\n    accountSid: (body.account_sid as string || '').trim(),\n    authToken: (body.auth_token as string || '').trim(),\n    phoneNumber: normalizePhoneE164(body.phone_number as string) || (body.phone_number as string || '').trim(),\n    enabled: body.enabled === '1',\n  };\n\n  await db.prepare(\n    \"INSERT OR REPLACE INTO settings (key, value, updated_at) VALUES ('twilio_config', ?, datetime('now'))\"\n  ).bind(JSON.stringify(config)).run();\n\n  return c.redirect('/admin/sms-settings');\n});\n\napp.post('/sms-templates/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n\n  const bodyTemplate = (body.body_template as string || '').trim();\n  const isActive = body.is_active === '1' ? 1 : 0;\n\n  if (bodyTemplate) {\n    await db.prepare(\n      \"UPDATE sms_templates SET body_template = ?, is_active = ?, updated_at = datetime('now') WHERE id = ?\"\n    ).bind(bodyTemplate, isActive, id).run();\n  } else {\n    await db.prepare(\n      \"UPDATE sms_templates SET is_active = ?, updated_at = datetime('now') WHERE id = ?\"\n    ).bind(isActive, id).run();\n  }\n\n  return c.body('', 200);\n});\n\napp.get('/coupons', async (c) => {\n  const db = c.env.DB;\n  const coupons = await db.prepare(`\n    SELECT id, code, discount_type, discount_value, max_uses, current_uses, is_active\n    FROM coupons ORDER BY created_at DESC\n  `).all();\n  \n  return c.html(TableView({\n    title: 'Coupons',\n    columns: ['Code', 'Type', 'Value', 'Uses', 'Active'],\n    rows: (coupons.results || []).map(cp => ({\n      code: cp.code,\n      type: cp.discount_type,\n      value: cp.discount_type === 'percentage' ? `${cp.discount_value}%` : `$${((cp.discount_value as number) / 100).toFixed(2)}`,\n      uses: `${cp.current_uses} / ${cp.max_uses ?? '\u221E'}`,\n      active: cp.is_active ? 'active' : 'inactive'\n    })),\n    createUrl: '/admin/coupons/new',\n    detailUrlPrefix: '/admin/coupons',\n    deleteUrlPrefix: '/admin/coupons'\n  }));\n});\n\napp.get('/coupons/new', (c) => {\n  const fields: FormField[] = [\n    { name: 'code', label: 'Code', required: true, placeholder: 'SUMMER20' },\n    { name: 'discount_type', label: 'Discount Type', type: 'select', required: true, options: [\n      { value: 'percentage', label: 'Percentage' },\n      { value: 'fixed', label: 'Fixed Amount' }\n    ]},\n    { name: 'discount_value', label: 'Discount Value (% or $)', type: 'number', required: true, min: 0, step: 0.01 },\n    { name: 'max_uses', label: 'Max Uses (leave empty for unlimited)', type: 'number', min: 1 },\n    { name: 'valid_from', label: 'Valid From', type: 'date' },\n    { name: 'valid_until', label: 'Valid Until', type: 'date' },\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Coupon',\n    fields,\n    submitUrl: '/admin/coupons',\n    cancelUrl: '/admin/coupons'\n  }));\n});\n\napp.post('/coupons', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  \n  await db.prepare(`\n    INSERT INTO coupons (id, code, discount_type, discount_value, max_uses, valid_from, valid_until, is_active)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    (body.code as string).toUpperCase(),\n    body.discount_type,\n    parseInt(body.discount_value as string, 10) || 0,\n    body.max_uses ? parseInt(body.max_uses as string, 10) : null,\n    body.valid_from || null,\n    body.valid_until || null,\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect('/admin/coupons');\n});\n\napp.get('/coupons/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/coupons/new');\n  return c.redirect(`/admin/coupons/${id}/edit`);\n});\n\napp.get('/coupons/:id/edit', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const coupon = await db.prepare('SELECT * FROM coupons WHERE id = ?').bind(id).first();\n  \n  if (!coupon) {\n    return c.redirect('/admin/coupons');\n  }\n  \n  const fields: FormField[] = [\n    { name: 'code', label: 'Code', required: true, value: coupon.code as string },\n    { name: 'discount_type', label: 'Discount Type', type: 'select', required: true, value: coupon.discount_type as string, options: [\n      { value: 'percentage', label: 'Percentage' },\n      { value: 'fixed', label: 'Fixed Amount' }\n    ]},\n    { name: 'discount_value', label: 'Discount Value', type: 'number', required: true, min: 0, value: coupon.discount_value as number },\n    { name: 'max_uses', label: 'Max Uses', type: 'number', min: 1, value: coupon.max_uses as number },\n    { name: 'valid_from', label: 'Valid From', type: 'date', value: coupon.valid_from as string },\n    { name: 'valid_until', label: 'Valid Until', type: 'date', value: coupon.valid_until as string },\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: Boolean(coupon.is_active) }\n  ];\n  \n  return c.html(FormView({\n    title: 'Edit Coupon',\n    fields,\n    submitUrl: `/admin/coupons/${id}`,\n    cancelUrl: '/admin/coupons',\n    isEdit: true,\n    deleteUrl: `/admin/coupons/${id}/delete`\n  }));\n});\n\napp.post('/coupons/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  await db.prepare(`\n    UPDATE coupons \n    SET code = ?, discount_type = ?, discount_value = ?, max_uses = ?, valid_from = ?, valid_until = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    (body.code as string).toUpperCase(),\n    body.discount_type,\n    parseInt(body.discount_value as string, 10) || 0,\n    body.max_uses ? parseInt(body.max_uses as string, 10) : null,\n    body.valid_from || null,\n    body.valid_until || null,\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect('/admin/coupons');\n});\n\napp.post('/coupons/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM coupons WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/coupons/${id}`)) {\n      c.header('HX-Redirect', '/admin/coupons');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/coupons');\n});\n\napp.get('/webhooks', async (c) => {\n  const db = c.env.DB;\n  const webhooks = await db.prepare(`\n    SELECT id, url, event_type, is_active FROM webhooks ORDER BY created_at DESC\n  `).all();\n  \n  return c.html(TableView({\n    title: 'Webhooks',\n    columns: ['URL', 'Event Type', 'Active'],\n    rows: (webhooks.results || []).map(w => ({\n      url: w.url,\n      eventType: w.event_type,\n      active: w.is_active ? 'active' : 'inactive'\n    })),\n    createUrl: '/admin/webhooks/new',\n    detailUrlPrefix: '/admin/webhooks',\n    deleteUrlPrefix: '/admin/webhooks'\n  }));\n});\n\napp.get('/webhooks/new', (c) => {\n  const fields: FormField[] = [\n    { name: 'url', label: 'Webhook URL', required: true, placeholder: 'https://example.com/webhook' },\n    { name: 'event_type', label: 'Event Type', type: 'select', required: true, options: [\n      { value: 'job.created', label: 'Job Created' },\n      { value: 'job.updated', label: 'Job Updated' },\n      { value: 'job.assigned', label: 'Job Assigned' },\n      { value: 'job.completed', label: 'Job Completed' },\n      { value: 'job.cancelled', label: 'Job Cancelled' },\n      { value: 'customer.created', label: 'Customer Created' },\n      { value: 'invoice.created', label: 'Invoice Created' },\n      { value: 'invoice.paid', label: 'Invoice Paid' }\n    ]},\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: true }\n  ];\n  \n  return c.html(FormView({\n    title: 'Create Webhook',\n    fields,\n    submitUrl: '/admin/webhooks',\n    cancelUrl: '/admin/webhooks'\n  }));\n});\n\napp.post('/webhooks', async (c) => {\n  const db = c.env.DB;\n  const body = await c.req.parseBody();\n  const id = generateId();\n  const secret = crypto.randomUUID();\n  \n  await db.prepare(`\n    INSERT INTO webhooks (id, url, event_type, secret, is_active)\n    VALUES (?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    body.url,\n    body.event_type,\n    secret,\n    body.is_active === 'on' ? 1 : 0\n  ).run();\n  \n  return c.redirect('/admin/webhooks');\n});\n\napp.get('/webhooks/:id', async (c) => {\n  const id = c.req.param('id');\n  if (id === 'new') return c.redirect('/admin/webhooks/new');\n  return c.redirect(`/admin/webhooks/${id}/edit`);\n});\n\napp.get('/webhooks/:id/edit', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const webhook = await db.prepare('SELECT * FROM webhooks WHERE id = ?').bind(id).first();\n  \n  if (!webhook) {\n    return c.redirect('/admin/webhooks');\n  }\n  \n  const fields: FormField[] = [\n    { name: 'url', label: 'Webhook URL', required: true, value: webhook.url as string },\n    { name: 'event_type', label: 'Event Type', type: 'select', required: true, value: webhook.event_type as string, options: [\n      { value: 'job.created', label: 'Job Created' },\n      { value: 'job.updated', label: 'Job Updated' },\n      { value: 'job.assigned', label: 'Job Assigned' },\n      { value: 'job.completed', label: 'Job Completed' },\n      { value: 'job.cancelled', label: 'Job Cancelled' },\n      { value: 'customer.created', label: 'Customer Created' },\n      { value: 'invoice.created', label: 'Invoice Created' },\n      { value: 'invoice.paid', label: 'Invoice Paid' }\n    ]},\n    { name: 'is_active', label: 'Active', type: 'checkbox', value: Boolean(webhook.is_active) }\n  ];\n  \n  return c.html(FormView({\n    title: 'Edit Webhook',\n    fields,\n    submitUrl: `/admin/webhooks/${id}`,\n    cancelUrl: '/admin/webhooks',\n    isEdit: true,\n    deleteUrl: `/admin/webhooks/${id}/delete`\n  }));\n});\n\napp.post('/webhooks/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  \n  await db.prepare(`\n    UPDATE webhooks \n    SET url = ?, event_type = ?, is_active = ?, updated_at = datetime('now')\n    WHERE id = ?\n  `).bind(\n    body.url,\n    body.event_type,\n    body.is_active === 'on' ? 1 : 0,\n    id\n  ).run();\n  \n  return c.redirect('/admin/webhooks');\n});\n\napp.post('/webhooks/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  await db.prepare('DELETE FROM webhooks WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/webhooks/${id}`)) {\n      c.header('HX-Redirect', '/admin/webhooks');\n    }\n    return c.body('', 200);\n  }\n\n  return c.redirect('/admin/webhooks');\n});\n\napp.get('/inbox', async (c) => {\n  const db = c.env.DB;\n  const { source } = c.req.query();\n\n  let sql = 'SELECT id, source, status, first_name, last_name, email, subject, is_read, created_at FROM messages';\n  const params: unknown[] = [];\n\n  if (source) {\n    sql += ' WHERE source = ?';\n    params.push(source);\n  }\n\n  sql += ' ORDER BY created_at DESC LIMIT 100';\n\n  const stmt = db.prepare(sql);\n  const messages = await (params.length > 0 ? stmt.bind(...params) : stmt).all();\n\n  const unreadCount = await db.prepare('SELECT COUNT(*) as count FROM messages WHERE is_read = 0').first<{ count: number }>();\n\n  const rows = (messages.results || []).map((m: Record<string, unknown>) => {\n    const name = [m.first_name, m.last_name].filter(Boolean).join(' ') || (m.email as string) || '-';\n    const dateStr = formatTorontoDate(`${m.created_at as string}Z`, { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' }) || (m.created_at as string);\n    return {\n      from: m.is_read ? name : `\u25CF ${name}`,\n      subject: (m.subject as string) || '-',\n      source: m.source as string,\n      date: dateStr,\n      status: m.status as string,\n    };\n  });\n\n  const title = `Inbox${(unreadCount?.count || 0) > 0 ? ` (${unreadCount?.count})` : ''}`;\n\n  return c.html(TableView({\n    title,\n    columns: ['From', 'Subject', 'Source', 'Date', 'Status'],\n    rows,\n    rawIds: (messages.results || []).map(m => m.id as string),\n    detailUrlPrefix: '/admin/inbox',\n    deleteUrlPrefix: '/admin/inbox',\n  }));\n});\n\nasync function getInboxSmsContext(db: D1Database, messageId: string) {\n  const msg = await db.prepare('SELECT phone FROM messages WHERE id = ?').bind(messageId).first<{ phone: string | null }>();\n  const phoneE164 = normalizePhoneE164(msg?.phone);\n\n  let smsHistory: SmsLogRow[] = [];\n  if (phoneE164) {\n    const rows = await db.prepare(\n      `SELECT id, direction, body, status, created_at, segments\n       FROM sms_log\n       WHERE phone_to = ? OR phone_from = ?\n       ORDER BY created_at ASC\n       LIMIT 100`\n    ).bind(phoneE164, phoneE164).all();\n    smsHistory = (rows.results || []) as SmsLogRow[];\n  }\n\n  return { phoneE164, smsHistory };\n}\n\nasync function getInboxJobContext(db: D1Database, messageId: string): Promise<{ jobOptions: InboxJobOption[]; selectedJobId: string | null }> {\n  const msg = await db.prepare('SELECT phone, metadata FROM messages WHERE id = ?').bind(messageId).first<{ phone: string | null; metadata: string | null }>();\n  if (!msg) return { jobOptions: [], selectedJobId: null };\n\n  const meta = parseJsonObject(msg.metadata);\n  const metaCustomerId = typeof meta?.customer_id === 'string' && meta.customer_id ? meta.customer_id : null;\n  const metaJobId = typeof meta?.job_id === 'string' && meta.job_id ? meta.job_id : null;\n\n  const phoneE164 = normalizePhoneE164(msg.phone);\n  let customerId = metaCustomerId;\n  if (!customerId && phoneE164) {\n    const customer = await db.prepare(\n      `SELECT id\n       FROM customers\n       WHERE phone_e164 = ? OR phone = ?\n       ORDER BY updated_at DESC\n       LIMIT 1`\n    ).bind(phoneE164, msg.phone || phoneE164).first<{ id: string }>();\n    customerId = customer?.id || null;\n  }\n\n  if (!customerId) {\n    return { jobOptions: [], selectedJobId: null };\n  }\n\n  const jobs = await db.prepare(\n    `SELECT j.id, j.scheduled_date, j.status,\n            COALESCE(s.name, j.custom_service_name, 'Service') as service_name\n     FROM jobs j\n     LEFT JOIN services s ON s.id = j.service_id\n     WHERE j.customer_id = ?\n     ORDER BY j.updated_at DESC\n     LIMIT 20`\n  ).bind(customerId).all<{ id: string; scheduled_date: string; status: string; service_name: string }>();\n\n  const jobOptions = (jobs.results || []).map((job) => ({\n    id: job.id,\n    label: `${job.scheduled_date} \u2022 ${job.service_name} \u2022 ${job.status.replace('_', ' ')}`,\n  }));\n\n  const selectedJobId = jobOptions.some((job) => job.id === metaJobId)\n    ? metaJobId\n    : (jobOptions[0]?.id || null);\n\n  return { jobOptions, selectedJobId };\n}\n\napp.get('/inbox/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const msg = await db.prepare('SELECT * FROM messages WHERE id = ?').bind(id).first();\n\n  if (!msg) return c.redirect('/admin/inbox');\n\n  if (!msg.is_read) {\n    await db.prepare(\"UPDATE messages SET is_read = 1, read_at = datetime('now'), status = CASE WHEN status = 'new' THEN 'read' ELSE status END, updated_at = datetime('now') WHERE id = ?\").bind(id).run();\n    msg.is_read = 1;\n    if (msg.status === 'new') msg.status = 'read';\n  }\n\n  const twilioEnabled = await isTwilioEnabled(db);\n  const { phoneE164, smsHistory } = await getInboxSmsContext(db, id);\n  const { jobOptions, selectedJobId } = await getInboxJobContext(db, id);\n  const completedTaskSmsIds = await getCompletedSmsTaskIds(db, selectedJobId);\n\n  return c.html(MessageDetailPage({\n    message: msg as {\n      id: string; source: string; status: string;\n      first_name: string | null; last_name: string | null; email: string | null;\n      phone: string | null; postal_code: string | null; reason: string | null;\n      subject: string | null; body: string | null; metadata: string | null;\n      is_read: number; read_at: string | null; replied_at: string | null;\n      created_at: string; updated_at: string;\n    },\n    smsHistory,\n    twilioEnabled,\n    phoneE164,\n    jobOptions,\n    selectedJobId,\n    completedTaskSmsIds,\n  }));\n});\n\napp.get('/inbox/:id/sms-thread', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const { smsHistory } = await getInboxSmsContext(db, id);\n  const { jobOptions, selectedJobId } = await getInboxJobContext(db, id);\n  const completedTaskSmsIds = await getCompletedSmsTaskIds(db, selectedJobId);\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n  return c.html(SmsHistoryList({\n    smsHistory,\n    messageId: id,\n    canCreateTask: jobOptions.length > 0,\n    jobOptions,\n    selectedJobId,\n    completedTaskSmsIds,\n  }));\n});\n\napp.get('/inbox/:id/sms-thread-panel', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n\n  const twilioEnabled = await isTwilioEnabled(db);\n  const { phoneE164, smsHistory } = await getInboxSmsContext(db, id);\n  const { jobOptions, selectedJobId } = await getInboxJobContext(db, id);\n  const completedTaskSmsIds = await getCompletedSmsTaskIds(db, selectedJobId);\n\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n\n  return c.html(SmsThreadPanel({\n    messageId: id,\n    smsHistory,\n    twilioEnabled,\n    phoneE164,\n    jobOptions,\n    selectedJobId,\n    completedTaskSmsIds,\n  }));\n});\n\napp.post('/inbox/:id/sms-reply', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const smsBody = (body.sms_body as string || '').trim();\n\n  const { phoneE164 } = await getInboxSmsContext(db, id);\n\n  let sendResult: { success: boolean; error?: string } | null = null;\n\n  if (!smsBody) {\n    sendResult = { success: false, error: 'Message body is required' };\n  } else if (!phoneE164) {\n    sendResult = { success: false, error: 'No valid phone number for this contact' };\n  } else {\n    const result = await sendDirectSms({ db, to: phoneE164, body: smsBody, messageId: id });\n    sendResult = { success: result.success, error: result.error };\n\n    if (result.success) {\n      await db.prepare(\n        \"UPDATE messages SET status = 'replied', replied_at = datetime('now'), updated_at = datetime('now') WHERE id = ?\"\n      ).bind(id).run();\n    }\n  }\n\n  const twilioEnabled = await isTwilioEnabled(db);\n  const { smsHistory } = await getInboxSmsContext(db, id);\n  const { jobOptions, selectedJobId } = await getInboxJobContext(db, id);\n  const completedTaskSmsIds = await getCompletedSmsTaskIds(db, selectedJobId);\n\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n  return c.html(SmsThreadPanel({ messageId: id, smsHistory, twilioEnabled, phoneE164, jobOptions, selectedJobId, completedTaskSmsIds, sendResult }));\n});\n\napp.post('/inbox/:id/sms-task', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.parseBody();\n  const smsLogId = (body.sms_log_id as string || '').trim();\n  const jobId = (body.job_id as string || '').trim();\n  const taskTitle = toTaskTitle(body.task_title as string || '');\n\n  const twilioEnabled = await isTwilioEnabled(db);\n  const { phoneE164, smsHistory } = await getInboxSmsContext(db, id);\n  const { jobOptions, selectedJobId } = await getInboxJobContext(db, id);\n\n  let taskResult: { success: boolean; error?: string; message?: string } = { success: false, error: 'Unable to add task' };\n\n  if (!smsLogId) {\n    taskResult = { success: false, error: 'No SMS message selected' };\n  } else if (!taskTitle) {\n    taskResult = { success: false, error: 'Task title is required' };\n  } else if (!jobId) {\n    taskResult = { success: false, error: 'Select a job first' };\n  } else {\n    const sms = await db.prepare(\n      `SELECT id, direction, body, created_at, phone_to, phone_from\n       FROM sms_log\n       WHERE id = ?\n       LIMIT 1`\n    ).bind(smsLogId).first<{ id: string; direction: string; body: string; created_at: string; phone_to: string; phone_from: string }>();\n\n    const job = await db.prepare('SELECT notes_json FROM jobs WHERE id = ?').bind(jobId).first<{ notes_json: string | null }>();\n\n    if (!sms) {\n      taskResult = { success: false, error: 'SMS message not found' };\n    } else if (!job) {\n      taskResult = { success: false, error: 'Job not found' };\n    } else if (phoneE164 && sms.phone_to !== phoneE164 && sms.phone_from !== phoneE164) {\n      taskResult = { success: false, error: 'Selected SMS is not part of this thread' };\n    } else if (sms.direction !== 'inbound') {\n      taskResult = { success: false, error: 'Only customer messages can become tasks' };\n    } else {\n      const smsBody = (sms.body || '').trim();\n      if (!smsBody) {\n        taskResult = { success: false, error: 'Selected message has no text' };\n      } else {\n        const notes = job.notes_json ? JSON.parse(job.notes_json) as Array<Record<string, unknown>> : [];\n        notes.push({\n          text: taskTitle,\n          timestamp: new Date().toISOString(),\n          completed: 0,\n          source: {\n            type: 'sms',\n            sms_log_id: sms.id,\n            message_id: id,\n            excerpt: smsBody,\n            received_at: sms.created_at,\n          },\n        });\n\n        await db.prepare(\n          'UPDATE jobs SET notes_json = ?, updated_at = datetime(\"now\") WHERE id = ?'\n        ).bind(JSON.stringify(notes), jobId).run();\n\n        const messageMetaRow = await db.prepare('SELECT metadata FROM messages WHERE id = ?').bind(id).first<{ metadata: string | null }>();\n        const messageMeta = parseJsonObject(messageMetaRow?.metadata) || {};\n        messageMeta.job_id = jobId;\n        await db.prepare('UPDATE messages SET metadata = ?, updated_at = datetime(\"now\") WHERE id = ?').bind(JSON.stringify(messageMeta), id).run();\n\n        taskResult = { success: true, message: 'Task added to job' };\n      }\n    }\n  }\n\n  c.header('Cache-Control', 'no-store, no-cache, must-revalidate, max-age=0');\n  c.header('Pragma', 'no-cache');\n  c.header('Expires', '0');\n  const activeJobId = jobOptions.some((job) => job.id === jobId) ? jobId : selectedJobId;\n  const completedTaskSmsIds = await getCompletedSmsTaskIds(db, activeJobId);\n  return c.html(\n    SmsThreadPanel({\n      messageId: id,\n      smsHistory,\n      twilioEnabled,\n      phoneE164,\n      jobOptions,\n      selectedJobId: jobId || selectedJobId,\n      completedTaskSmsIds,\n      taskResult,\n    })\n  );\n});\n\napp.post('/inbox/:id/archive', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  await db.prepare(\"UPDATE messages SET status = 'archived', updated_at = datetime('now') WHERE id = ?\").bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    c.header('HX-Redirect', '/admin/inbox');\n    return c.body('', 200);\n  }\n  return c.redirect('/admin/inbox');\n});\n\napp.post('/inbox/:id/delete', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  await db.prepare('DELETE FROM messages WHERE id = ?').bind(id).run();\n\n  const isHtmx = Boolean(c.req.header('HX-Request'));\n  if (isHtmx) {\n    const from = c.req.header('HX-Current-URL') || '';\n    if (from.includes(`/inbox/${id}`)) {\n      c.header('HX-Redirect', '/admin/inbox');\n    }\n    return c.body('', 200);\n  }\n  return c.redirect('/admin/inbox');\n});\n\nexport default app;\n", "export type LineItemKind = 'service' | 'modifier' | 'rule' | 'custom';\n\nexport type PriceLineItem = {\n  id: string;\n  parent_id: string | null;\n  kind: LineItemKind;\n  description: string;\n  quantity: number;\n  unit_price_cents: number;\n  total_cents: number;\n  is_custom: number;\n};\n\nconst clampCents = (value: number) => Math.round(Number.isFinite(value) ? value : 0);\n\nexport const formatMoney = (cents: number) => `$${(cents / 100).toFixed(2)}`;\n\nexport const parsePriceLines = (raw: string | null | undefined): PriceLineItem[] => {\n  if (!raw) return [];\n  try {\n    const parsed = JSON.parse(raw) as unknown;\n    if (!Array.isArray(parsed)) return [];\n    return parsed\n      .filter((entry): entry is Record<string, unknown> => Boolean(entry && typeof entry === 'object' && !Array.isArray(entry)))\n      .map((entry) => {\n        const quantity = typeof entry.quantity === 'number' ? entry.quantity : Number.parseFloat(String(entry.quantity || 1)) || 1;\n        const unit = typeof entry.unit_price_cents === 'number'\n          ? entry.unit_price_cents\n          : Number.parseInt(String(entry.unit_price_cents || 0), 10) || 0;\n        const total = typeof entry.total_cents === 'number'\n          ? entry.total_cents\n          : Math.round(quantity * unit);\n        const kind = (entry.kind === 'service' || entry.kind === 'modifier' || entry.kind === 'rule' || entry.kind === 'custom')\n          ? entry.kind\n          : 'custom';\n        return {\n          id: typeof entry.id === 'string' && entry.id.trim() ? entry.id : crypto.randomUUID(),\n          parent_id: typeof entry.parent_id === 'string' && entry.parent_id.trim() ? entry.parent_id : null,\n          kind,\n          description: typeof entry.description === 'string' && entry.description.trim() ? entry.description.trim() : 'Line item',\n          quantity,\n          unit_price_cents: clampCents(unit),\n          total_cents: clampCents(total),\n          is_custom: entry.is_custom ? 1 : 0,\n        };\n      });\n  } catch {\n    return [];\n  }\n};\n\nexport const linesToInvoicePayload = (lines: PriceLineItem[]) => lines.map((line) => ({\n  description: line.description,\n  quantity: line.quantity,\n  unit_price_cents: line.unit_price_cents,\n  total_cents: line.total_cents,\n}));\n\nexport const subtotalFromLines = (lines: PriceLineItem[]) => lines.reduce((sum, line) => sum + line.total_cents, 0);\n\nexport const normalizeLine = (description: string, quantity: number, unitPriceCents: number, kind: LineItemKind, parentId: string | null, isCustom: number): PriceLineItem => ({\n  id: crypto.randomUUID(),\n  parent_id: parentId,\n  kind,\n  description: description.trim() || 'Line item',\n  quantity: Number.isFinite(quantity) && quantity > 0 ? quantity : 1,\n  unit_price_cents: clampCents(unitPriceCents),\n  total_cents: clampCents((Number.isFinite(quantity) && quantity > 0 ? quantity : 1) * unitPriceCents),\n  is_custom: isCustom ? 1 : 0,\n});\n\nexport const buildServiceBaseLine = (serviceName: string, unitPriceCents: number): PriceLineItem => normalizeLine(serviceName || 'Service', 1, unitPriceCents, 'service', null, 0);\n\nexport const linesToEditableText = (lines: PriceLineItem[]) => lines.map((line) => `${line.description} | ${line.quantity} | ${(line.unit_price_cents / 100).toFixed(2)}`).join('\\n');\n\nexport const parseEditableText = (raw: string | null | undefined): PriceLineItem[] => {\n  const lines = (raw || '').split(/\\r?\\n/).map((line) => line.trim()).filter(Boolean);\n  const parsed: PriceLineItem[] = [];\n  for (const line of lines) {\n    const parts = line.split('|').map((part) => part.trim());\n    if (parts.length < 3) continue;\n    const description = parts[0] || 'Line item';\n    const quantity = Math.max(0, Number.parseFloat(parts[1]) || 0);\n    const unitCents = Math.max(0, Math.round((Number.parseFloat(parts[2].replace(/[$,]/g, '')) || 0) * 100));\n    if (!description || quantity <= 0) continue;\n    parsed.push(normalizeLine(description, quantity, unitCents, 'custom', null, 1));\n  }\n  return parsed;\n};\n", "// src/helper/html/index.ts\nimport { escapeToBuffer, raw, resolveCallbackSync, stringBufferToString } from \"../../utils/html.js\";\nvar html = (strings, ...values) => {\n  const buffer = [\"\"];\n  for (let i = 0, len = strings.length - 1; i < len; i++) {\n    buffer[0] += strings[i];\n    const children = Array.isArray(values[i]) ? values[i].flat(Infinity) : [values[i]];\n    for (let i2 = 0, len2 = children.length; i2 < len2; i2++) {\n      const child = children[i2];\n      if (typeof child === \"string\") {\n        escapeToBuffer(child, buffer);\n      } else if (typeof child === \"number\") {\n        ;\n        buffer[0] += child;\n      } else if (typeof child === \"boolean\" || child === null || child === void 0) {\n        continue;\n      } else if (typeof child === \"object\" && child.isEscaped) {\n        if (child.callbacks) {\n          buffer.unshift(\"\", child);\n        } else {\n          const tmp = child.toString();\n          if (tmp instanceof Promise) {\n            buffer.unshift(\"\", tmp);\n          } else {\n            buffer[0] += tmp;\n          }\n        }\n      } else if (child instanceof Promise) {\n        buffer.unshift(\"\", child);\n      } else {\n        escapeToBuffer(child.toString(), buffer);\n      }\n    }\n  }\n  buffer[0] += strings.at(-1);\n  return buffer.length === 1 ? \"callbacks\" in buffer ? raw(resolveCallbackSync(raw(buffer[0], buffer.callbacks))) : raw(buffer[0]) : stringBufferToString(buffer, buffer.callbacks);\n};\nexport {\n  html,\n  raw\n};\n", "// src/jsx/constants.ts\nvar DOM_RENDERER = /* @__PURE__ */ Symbol(\"RENDERER\");\nvar DOM_ERROR_HANDLER = /* @__PURE__ */ Symbol(\"ERROR_HANDLER\");\nvar DOM_STASH = /* @__PURE__ */ Symbol(\"STASH\");\nvar DOM_INTERNAL_TAG = /* @__PURE__ */ Symbol(\"INTERNAL\");\nvar DOM_MEMO = /* @__PURE__ */ Symbol(\"MEMO\");\nvar PERMALINK = /* @__PURE__ */ Symbol(\"PERMALINK\");\nexport {\n  DOM_ERROR_HANDLER,\n  DOM_INTERNAL_TAG,\n  DOM_MEMO,\n  DOM_RENDERER,\n  DOM_STASH,\n  PERMALINK\n};\n", "// src/jsx/dom/utils.ts\nimport { DOM_INTERNAL_TAG } from \"../constants.js\";\nvar setInternalTagFlag = (fn) => {\n  ;\n  fn[DOM_INTERNAL_TAG] = true;\n  return fn;\n};\nexport {\n  setInternalTagFlag\n};\n", "// src/jsx/dom/context.ts\nimport { DOM_ERROR_HANDLER } from \"../constants.js\";\nimport { globalContexts } from \"../context.js\";\nimport { setInternalTagFlag } from \"./utils.js\";\nvar createContextProviderFunction = (values) => ({ value, children }) => {\n  if (!children) {\n    return void 0;\n  }\n  const props = {\n    children: [\n      {\n        tag: setInternalTagFlag(() => {\n          values.push(value);\n        }),\n        props: {}\n      }\n    ]\n  };\n  if (Array.isArray(children)) {\n    props.children.push(...children.flat());\n  } else {\n    props.children.push(children);\n  }\n  props.children.push({\n    tag: setInternalTagFlag(() => {\n      values.pop();\n    }),\n    props: {}\n  });\n  const res = { tag: \"\", props, type: \"\" };\n  res[DOM_ERROR_HANDLER] = (err) => {\n    values.pop();\n    throw err;\n  };\n  return res;\n};\nvar createContext = (defaultValue) => {\n  const values = [defaultValue];\n  const context = createContextProviderFunction(values);\n  context.values = values;\n  context.Provider = context;\n  globalContexts.push(context);\n  return context;\n};\nexport {\n  createContext,\n  createContextProviderFunction\n};\n", "// src/jsx/context.ts\nimport { raw } from \"../helper/html/index.js\";\nimport { JSXFragmentNode } from \"./base.js\";\nimport { DOM_RENDERER } from \"./constants.js\";\nimport { createContextProviderFunction } from \"./dom/context.js\";\nvar globalContexts = [];\nvar createContext = (defaultValue) => {\n  const values = [defaultValue];\n  const context = ((props) => {\n    values.push(props.value);\n    let string;\n    try {\n      string = props.children ? (Array.isArray(props.children) ? new JSXFragmentNode(\"\", {}, props.children) : props.children).toString() : \"\";\n    } catch (e) {\n      values.pop();\n      throw e;\n    }\n    if (string instanceof Promise) {\n      return string.finally(() => values.pop()).then((resString) => raw(resString, resString.callbacks));\n    } else {\n      values.pop();\n      return raw(string);\n    }\n  });\n  context.values = values;\n  context.Provider = context;\n  context[DOM_RENDERER] = createContextProviderFunction(values);\n  globalContexts.push(context);\n  return context;\n};\nvar useContext = (context) => {\n  return context.values.at(-1);\n};\nexport {\n  createContext,\n  globalContexts,\n  useContext\n};\n", "// src/jsx/intrinsic-element/common.ts\nvar deDupeKeyMap = {\n  title: [],\n  script: [\"src\"],\n  style: [\"data-href\"],\n  link: [\"href\"],\n  meta: [\"name\", \"httpEquiv\", \"charset\", \"itemProp\"]\n};\nvar domRenderers = {};\nvar dataPrecedenceAttr = \"data-precedence\";\nexport {\n  dataPrecedenceAttr,\n  deDupeKeyMap,\n  domRenderers\n};\n", "// src/jsx/intrinsic-element/components.ts\nimport { raw } from \"../../helper/html/index.js\";\nimport { JSXNode, getNameSpaceContext } from \"../base.js\";\nimport { toArray } from \"../children.js\";\nimport { PERMALINK } from \"../constants.js\";\nimport { useContext } from \"../context.js\";\nimport { dataPrecedenceAttr, deDupeKeyMap } from \"./common.js\";\nvar metaTagMap = /* @__PURE__ */ new WeakMap();\nvar insertIntoHead = (tagName, tag, props, precedence) => ({ buffer, context }) => {\n  if (!buffer) {\n    return;\n  }\n  const map = metaTagMap.get(context) || {};\n  metaTagMap.set(context, map);\n  const tags = map[tagName] ||= [];\n  let duped = false;\n  const deDupeKeys = deDupeKeyMap[tagName];\n  if (deDupeKeys.length > 0) {\n    LOOP: for (const [, tagProps] of tags) {\n      for (const key of deDupeKeys) {\n        if ((tagProps?.[key] ?? null) === props?.[key]) {\n          duped = true;\n          break LOOP;\n        }\n      }\n    }\n  }\n  if (duped) {\n    buffer[0] = buffer[0].replaceAll(tag, \"\");\n  } else if (deDupeKeys.length > 0) {\n    tags.push([tag, props, precedence]);\n  } else {\n    tags.unshift([tag, props, precedence]);\n  }\n  if (buffer[0].indexOf(\"</head>\") !== -1) {\n    let insertTags;\n    if (precedence === void 0) {\n      insertTags = tags.map(([tag2]) => tag2);\n    } else {\n      const precedences = [];\n      insertTags = tags.map(([tag2, , precedence2]) => {\n        let order = precedences.indexOf(precedence2);\n        if (order === -1) {\n          precedences.push(precedence2);\n          order = precedences.length - 1;\n        }\n        return [tag2, order];\n      }).sort((a, b) => a[1] - b[1]).map(([tag2]) => tag2);\n    }\n    insertTags.forEach((tag2) => {\n      buffer[0] = buffer[0].replaceAll(tag2, \"\");\n    });\n    buffer[0] = buffer[0].replace(/(?=<\\/head>)/, insertTags.join(\"\"));\n  }\n};\nvar returnWithoutSpecialBehavior = (tag, children, props) => raw(new JSXNode(tag, props, toArray(children ?? [])).toString());\nvar documentMetadataTag = (tag, children, props, sort) => {\n  if (\"itemProp\" in props) {\n    return returnWithoutSpecialBehavior(tag, children, props);\n  }\n  let { precedence, blocking, ...restProps } = props;\n  precedence = sort ? precedence ?? \"\" : void 0;\n  if (sort) {\n    restProps[dataPrecedenceAttr] = precedence;\n  }\n  const string = new JSXNode(tag, restProps, toArray(children || [])).toString();\n  if (string instanceof Promise) {\n    return string.then(\n      (resString) => raw(string, [\n        ...resString.callbacks || [],\n        insertIntoHead(tag, resString, restProps, precedence)\n      ])\n    );\n  } else {\n    return raw(string, [insertIntoHead(tag, string, restProps, precedence)]);\n  }\n};\nvar title = ({ children, ...props }) => {\n  const nameSpaceContext = getNameSpaceContext();\n  if (nameSpaceContext) {\n    const context = useContext(nameSpaceContext);\n    if (context === \"svg\" || context === \"head\") {\n      return new JSXNode(\n        \"title\",\n        props,\n        toArray(children ?? [])\n      );\n    }\n  }\n  return documentMetadataTag(\"title\", children, props, false);\n};\nvar script = ({\n  children,\n  ...props\n}) => {\n  const nameSpaceContext = getNameSpaceContext();\n  if ([\"src\", \"async\"].some((k) => !props[k]) || nameSpaceContext && useContext(nameSpaceContext) === \"head\") {\n    return returnWithoutSpecialBehavior(\"script\", children, props);\n  }\n  return documentMetadataTag(\"script\", children, props, false);\n};\nvar style = ({\n  children,\n  ...props\n}) => {\n  if (![\"href\", \"precedence\"].every((k) => k in props)) {\n    return returnWithoutSpecialBehavior(\"style\", children, props);\n  }\n  props[\"data-href\"] = props.href;\n  delete props.href;\n  return documentMetadataTag(\"style\", children, props, true);\n};\nvar link = ({ children, ...props }) => {\n  if ([\"onLoad\", \"onError\"].some((k) => k in props) || props.rel === \"stylesheet\" && (!(\"precedence\" in props) || \"disabled\" in props)) {\n    return returnWithoutSpecialBehavior(\"link\", children, props);\n  }\n  return documentMetadataTag(\"link\", children, props, \"precedence\" in props);\n};\nvar meta = ({ children, ...props }) => {\n  const nameSpaceContext = getNameSpaceContext();\n  if (nameSpaceContext && useContext(nameSpaceContext) === \"head\") {\n    return returnWithoutSpecialBehavior(\"meta\", children, props);\n  }\n  return documentMetadataTag(\"meta\", children, props, false);\n};\nvar newJSXNode = (tag, { children, ...props }) => (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  new JSXNode(tag, props, toArray(children ?? []))\n);\nvar form = (props) => {\n  if (typeof props.action === \"function\") {\n    props.action = PERMALINK in props.action ? props.action[PERMALINK] : void 0;\n  }\n  return newJSXNode(\"form\", props);\n};\nvar formActionableElement = (tag, props) => {\n  if (typeof props.formAction === \"function\") {\n    props.formAction = PERMALINK in props.formAction ? props.formAction[PERMALINK] : void 0;\n  }\n  return newJSXNode(tag, props);\n};\nvar input = (props) => formActionableElement(\"input\", props);\nvar button = (props) => formActionableElement(\"button\", props);\nexport {\n  button,\n  form,\n  input,\n  link,\n  meta,\n  script,\n  style,\n  title\n};\n", "// src/jsx/children.ts\nvar toArray = (children) => Array.isArray(children) ? children : [children];\nvar Children = {\n  map: (children, fn) => toArray(children).map(fn),\n  forEach: (children, fn) => {\n    toArray(children).forEach(fn);\n  },\n  count: (children) => toArray(children).length,\n  only: (_children) => {\n    const children = toArray(_children);\n    if (children.length !== 1) {\n      throw new Error(\"Children.only() expects only one child\");\n    }\n    return children[0];\n  },\n  toArray\n};\nexport {\n  Children,\n  toArray\n};\n", "// src/jsx/utils.ts\nvar normalizeElementKeyMap = /* @__PURE__ */ new Map([\n  [\"className\", \"class\"],\n  [\"htmlFor\", \"for\"],\n  [\"crossOrigin\", \"crossorigin\"],\n  [\"httpEquiv\", \"http-equiv\"],\n  [\"itemProp\", \"itemprop\"],\n  [\"fetchPriority\", \"fetchpriority\"],\n  [\"noModule\", \"nomodule\"],\n  [\"formAction\", \"formaction\"]\n]);\nvar normalizeIntrinsicElementKey = (key) => normalizeElementKeyMap.get(key) || key;\nvar styleObjectForEach = (style, fn) => {\n  for (const [k, v] of Object.entries(style)) {\n    const key = k[0] === \"-\" || !/[A-Z]/.test(k) ? k : k.replace(/[A-Z]/g, (m) => `-${m.toLowerCase()}`);\n    fn(\n      key,\n      v == null ? null : typeof v === \"number\" ? !key.match(\n        /^(?:a|border-im|column(?:-c|s)|flex(?:$|-[^b])|grid-(?:ar|[^a])|font-w|li|or|sca|st|ta|wido|z)|ty$/\n      ) ? `${v}px` : `${v}` : v\n    );\n  }\n};\nexport {\n  normalizeIntrinsicElementKey,\n  styleObjectForEach\n};\n", "// src/jsx/base.ts\nimport { raw } from \"../helper/html/index.js\";\nimport { escapeToBuffer, resolveCallbackSync, stringBufferToString } from \"../utils/html.js\";\nimport { DOM_RENDERER, DOM_MEMO } from \"./constants.js\";\nimport { createContext, globalContexts, useContext } from \"./context.js\";\nimport { domRenderers } from \"./intrinsic-element/common.js\";\nimport * as intrinsicElementTags from \"./intrinsic-element/components.js\";\nimport { normalizeIntrinsicElementKey, styleObjectForEach } from \"./utils.js\";\nvar nameSpaceContext = void 0;\nvar getNameSpaceContext = () => nameSpaceContext;\nvar toSVGAttributeName = (key) => /[A-Z]/.test(key) && // Presentation attributes are findable in style object. \"clip-path\", \"font-size\", \"stroke-width\", etc.\n// Or other un-deprecated kebab-case attributes. \"overline-position\", \"paint-order\", \"strikethrough-position\", etc.\nkey.match(\n  /^(?:al|basel|clip(?:Path|Rule)$|co|do|fill|fl|fo|gl|let|lig|i|marker[EMS]|o|pai|pointe|sh|st[or]|text[^L]|tr|u|ve|w)/\n) ? key.replace(/([A-Z])/g, \"-$1\").toLowerCase() : key;\nvar emptyTags = [\n  \"area\",\n  \"base\",\n  \"br\",\n  \"col\",\n  \"embed\",\n  \"hr\",\n  \"img\",\n  \"input\",\n  \"keygen\",\n  \"link\",\n  \"meta\",\n  \"param\",\n  \"source\",\n  \"track\",\n  \"wbr\"\n];\nvar booleanAttributes = [\n  \"allowfullscreen\",\n  \"async\",\n  \"autofocus\",\n  \"autoplay\",\n  \"checked\",\n  \"controls\",\n  \"default\",\n  \"defer\",\n  \"disabled\",\n  \"download\",\n  \"formnovalidate\",\n  \"hidden\",\n  \"inert\",\n  \"ismap\",\n  \"itemscope\",\n  \"loop\",\n  \"multiple\",\n  \"muted\",\n  \"nomodule\",\n  \"novalidate\",\n  \"open\",\n  \"playsinline\",\n  \"readonly\",\n  \"required\",\n  \"reversed\",\n  \"selected\"\n];\nvar childrenToStringToBuffer = (children, buffer) => {\n  for (let i = 0, len = children.length; i < len; i++) {\n    const child = children[i];\n    if (typeof child === \"string\") {\n      escapeToBuffer(child, buffer);\n    } else if (typeof child === \"boolean\" || child === null || child === void 0) {\n      continue;\n    } else if (child instanceof JSXNode) {\n      child.toStringToBuffer(buffer);\n    } else if (typeof child === \"number\" || child.isEscaped) {\n      ;\n      buffer[0] += child;\n    } else if (child instanceof Promise) {\n      buffer.unshift(\"\", child);\n    } else {\n      childrenToStringToBuffer(child, buffer);\n    }\n  }\n};\nvar JSXNode = class {\n  tag;\n  props;\n  key;\n  children;\n  isEscaped = true;\n  localContexts;\n  constructor(tag, props, children) {\n    this.tag = tag;\n    this.props = props;\n    this.children = children;\n  }\n  get type() {\n    return this.tag;\n  }\n  // Added for compatibility with libraries that rely on React's internal structure\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  get ref() {\n    return this.props.ref || null;\n  }\n  toString() {\n    const buffer = [\"\"];\n    this.localContexts?.forEach(([context, value]) => {\n      context.values.push(value);\n    });\n    try {\n      this.toStringToBuffer(buffer);\n    } finally {\n      this.localContexts?.forEach(([context]) => {\n        context.values.pop();\n      });\n    }\n    return buffer.length === 1 ? \"callbacks\" in buffer ? resolveCallbackSync(raw(buffer[0], buffer.callbacks)).toString() : buffer[0] : stringBufferToString(buffer, buffer.callbacks);\n  }\n  toStringToBuffer(buffer) {\n    const tag = this.tag;\n    const props = this.props;\n    let { children } = this;\n    buffer[0] += `<${tag}`;\n    const normalizeKey = nameSpaceContext && useContext(nameSpaceContext) === \"svg\" ? (key) => toSVGAttributeName(normalizeIntrinsicElementKey(key)) : (key) => normalizeIntrinsicElementKey(key);\n    for (let [key, v] of Object.entries(props)) {\n      key = normalizeKey(key);\n      if (key === \"children\") {\n      } else if (key === \"style\" && typeof v === \"object\") {\n        let styleStr = \"\";\n        styleObjectForEach(v, (property, value) => {\n          if (value != null) {\n            styleStr += `${styleStr ? \";\" : \"\"}${property}:${value}`;\n          }\n        });\n        buffer[0] += ' style=\"';\n        escapeToBuffer(styleStr, buffer);\n        buffer[0] += '\"';\n      } else if (typeof v === \"string\") {\n        buffer[0] += ` ${key}=\"`;\n        escapeToBuffer(v, buffer);\n        buffer[0] += '\"';\n      } else if (v === null || v === void 0) {\n      } else if (typeof v === \"number\" || v.isEscaped) {\n        buffer[0] += ` ${key}=\"${v}\"`;\n      } else if (typeof v === \"boolean\" && booleanAttributes.includes(key)) {\n        if (v) {\n          buffer[0] += ` ${key}=\"\"`;\n        }\n      } else if (key === \"dangerouslySetInnerHTML\") {\n        if (children.length > 0) {\n          throw new Error(\"Can only set one of `children` or `props.dangerouslySetInnerHTML`.\");\n        }\n        children = [raw(v.__html)];\n      } else if (v instanceof Promise) {\n        buffer[0] += ` ${key}=\"`;\n        buffer.unshift('\"', v);\n      } else if (typeof v === \"function\") {\n        if (!key.startsWith(\"on\") && key !== \"ref\") {\n          throw new Error(`Invalid prop '${key}' of type 'function' supplied to '${tag}'.`);\n        }\n      } else {\n        buffer[0] += ` ${key}=\"`;\n        escapeToBuffer(v.toString(), buffer);\n        buffer[0] += '\"';\n      }\n    }\n    if (emptyTags.includes(tag) && children.length === 0) {\n      buffer[0] += \"/>\";\n      return;\n    }\n    buffer[0] += \">\";\n    childrenToStringToBuffer(children, buffer);\n    buffer[0] += `</${tag}>`;\n  }\n};\nvar JSXFunctionNode = class extends JSXNode {\n  toStringToBuffer(buffer) {\n    const { children } = this;\n    const props = { ...this.props };\n    if (children.length) {\n      props.children = children.length === 1 ? children[0] : children;\n    }\n    const res = this.tag.call(null, props);\n    if (typeof res === \"boolean\" || res == null) {\n      return;\n    } else if (res instanceof Promise) {\n      if (globalContexts.length === 0) {\n        buffer.unshift(\"\", res);\n      } else {\n        const currentContexts = globalContexts.map((c) => [c, c.values.at(-1)]);\n        buffer.unshift(\n          \"\",\n          res.then((childRes) => {\n            if (childRes instanceof JSXNode) {\n              childRes.localContexts = currentContexts;\n            }\n            return childRes;\n          })\n        );\n      }\n    } else if (res instanceof JSXNode) {\n      res.toStringToBuffer(buffer);\n    } else if (typeof res === \"number\" || res.isEscaped) {\n      buffer[0] += res;\n      if (res.callbacks) {\n        buffer.callbacks ||= [];\n        buffer.callbacks.push(...res.callbacks);\n      }\n    } else {\n      escapeToBuffer(res, buffer);\n    }\n  }\n};\nvar JSXFragmentNode = class extends JSXNode {\n  toStringToBuffer(buffer) {\n    childrenToStringToBuffer(this.children, buffer);\n  }\n};\nvar jsx = (tag, props, ...children) => {\n  props ??= {};\n  if (children.length) {\n    props.children = children.length === 1 ? children[0] : children;\n  }\n  const key = props.key;\n  delete props[\"key\"];\n  const node = jsxFn(tag, props, children);\n  node.key = key;\n  return node;\n};\nvar initDomRenderer = false;\nvar jsxFn = (tag, props, children) => {\n  if (!initDomRenderer) {\n    for (const k in domRenderers) {\n      ;\n      intrinsicElementTags[k][DOM_RENDERER] = domRenderers[k];\n    }\n    initDomRenderer = true;\n  }\n  if (typeof tag === \"function\") {\n    return new JSXFunctionNode(tag, props, children);\n  } else if (intrinsicElementTags[tag]) {\n    return new JSXFunctionNode(\n      intrinsicElementTags[tag],\n      props,\n      children\n    );\n  } else if (tag === \"svg\" || tag === \"head\") {\n    nameSpaceContext ||= createContext(\"\");\n    return new JSXNode(tag, props, [\n      new JSXFunctionNode(\n        nameSpaceContext,\n        {\n          value: tag\n        },\n        children\n      )\n    ]);\n  } else {\n    return new JSXNode(tag, props, children);\n  }\n};\nvar shallowEqual = (a, b) => {\n  if (a === b) {\n    return true;\n  }\n  const aKeys = Object.keys(a).sort();\n  const bKeys = Object.keys(b).sort();\n  if (aKeys.length !== bKeys.length) {\n    return false;\n  }\n  for (let i = 0, len = aKeys.length; i < len; i++) {\n    if (aKeys[i] === \"children\" && bKeys[i] === \"children\" && !a.children?.length && !b.children?.length) {\n      continue;\n    } else if (a[aKeys[i]] !== b[aKeys[i]]) {\n      return false;\n    }\n  }\n  return true;\n};\nvar memo = (component, propsAreEqual = shallowEqual) => {\n  let computed = null;\n  let prevProps = void 0;\n  const wrapper = ((props) => {\n    if (prevProps && !propsAreEqual(prevProps, props)) {\n      computed = null;\n    }\n    prevProps = props;\n    return computed ||= component(props);\n  });\n  wrapper[DOM_MEMO] = propsAreEqual;\n  wrapper[DOM_RENDERER] = component;\n  return wrapper;\n};\nvar Fragment = ({\n  children\n}) => {\n  return new JSXFragmentNode(\n    \"\",\n    {\n      children\n    },\n    Array.isArray(children) ? children : children ? [children] : []\n  );\n};\nvar isValidElement = (element) => {\n  return !!(element && typeof element === \"object\" && \"tag\" in element && \"props\" in element);\n};\nvar cloneElement = (element, props, ...children) => {\n  let childrenToClone;\n  if (children.length > 0) {\n    childrenToClone = children;\n  } else {\n    const c = element.props.children;\n    childrenToClone = Array.isArray(c) ? c : [c];\n  }\n  return jsx(\n    element.tag,\n    { ...element.props, ...props },\n    ...childrenToClone\n  );\n};\nvar reactAPICompatVersion = \"19.0.0-hono-jsx\";\nexport {\n  Fragment,\n  JSXFragmentNode,\n  JSXNode,\n  booleanAttributes,\n  cloneElement,\n  getNameSpaceContext,\n  isValidElement,\n  jsx,\n  jsxFn,\n  memo,\n  reactAPICompatVersion,\n  shallowEqual\n};\n", "// src/jsx/jsx-dev-runtime.ts\nimport { jsxFn } from \"./base.js\";\nimport { Fragment } from \"./base.js\";\nfunction jsxDEV(tag, props, key) {\n  let node;\n  if (!props || !(\"children\" in props)) {\n    node = jsxFn(tag, props, []);\n  } else {\n    const children = props.children;\n    node = Array.isArray(children) ? jsxFn(tag, props, children) : jsxFn(tag, props, [children]);\n  }\n  node.key = key;\n  return node;\n}\nexport {\n  Fragment,\n  jsxDEV\n};\n", "/** @jsx jsx */\n/** @jsxFrag Fragment */\nimport { html } from 'hono/html';\n// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { Fragment, jsx } from 'hono/jsx';\n\nexport const Layout = ({ title, children }: { title: string; children: unknown }) => {\n  return (\n    <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover\" />\n        <title>{title} - GOATkit Admin</title>\n        <link rel=\"manifest\" href=\"/admin/manifest.webmanifest\" />\n        <meta name=\"theme-color\" content=\"#eff1f5\" id=\"theme-color-meta\" />\n        <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n        <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\" />\n          {html`<script>\n(function(){\n  function autoThemeFromLocalTime() {\n    // Heuristic: use Mocha in the evening/night unless user explicitly chose.\n    // Assumption: \"after 5pm\" means 17:00-06:59 local time.\n    try {\n      var h = new Date().getHours();\n      return (h >= 17 || h < 7) ? 'dark' : 'light';\n    } catch (e) {\n      return 'light';\n    }\n  }\n\n  function syncThemeColorMeta(){\n    try {\n      var meta = document.getElementById('theme-color-meta');\n      if (!meta) return;\n      var css = getComputedStyle(document.documentElement);\n      var c = String(css.getPropertyValue('--theme-color') || '').trim();\n      if (c) {\n        meta.setAttribute('content', c);\n        return;\n      }\n      // Fallback for first paint before CSS vars are available.\n      var t = document.documentElement.getAttribute('data-theme') || 'light';\n      meta.setAttribute('content', t === 'dark' ? '#1e1e2e' : '#eff1f5');\n    } catch (e) {}\n  }\n\n  // Default to Latte unless user explicitly chose otherwise.\n  var s = localStorage.getItem('theme');\n  var t = (s === 'dark' || s === 'light') ? s : autoThemeFromLocalTime();\n  document.documentElement.setAttribute('data-theme', t);\n\n  // Set a sensible theme-color immediately for browser chrome.\n  try {\n    var meta = document.getElementById('theme-color-meta');\n    if (meta) meta.setAttribute('content', t === 'dark' ? '#1e1e2e' : '#eff1f5');\n  } catch (e) {}\n\n  // Styles load immediately after this script; wait a tick so CSS vars are available.\n  requestAnimationFrame(syncThemeColorMeta);\n  window.__syncThemeColorMeta = syncThemeColorMeta;\n\n  // If user never chose a theme, automatically switch based on local time.\n  // Keeps manual override stable once set.\n  setInterval(function() {\n    try {\n      var manual = localStorage.getItem('theme');\n      if (manual === 'dark' || manual === 'light') return;\n      var next = autoThemeFromLocalTime();\n      var cur = document.documentElement.getAttribute('data-theme') || 'light';\n      if (next !== cur) {\n        document.documentElement.setAttribute('data-theme', next);\n        syncThemeColorMeta();\n        if (typeof window.updateThemeLabels === 'function') window.updateThemeLabels(next);\n      }\n    } catch (e) {}\n  }, 60 * 1000);\n})();\n</script>\n<style data-fodt>\n@font-face {\n  font-family: 'TideSans';\n  src: url('/fonts/TideSans-200LilMondo.otf') format('opentype');\n  font-weight: 200;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'TideSans';\n  src: url('/fonts/TideSans-500Dudette.otf') format('opentype');\n  font-weight: 500;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'TideSans';\n  src: url('/fonts/TideSans-800Kahuna.otf') format('opentype');\n  font-weight: 800;\n  font-display: block;\n}\n\n* {\n  font-family: 'TideSans', system-ui, -apple-system, sans-serif !important;\n  font-feature-settings: 'kern' 1;\n}\n\n:root {\n  --brand: #dc8a78;\n  --on-brand: #1e1e2e;\n  --bg: #eff1f5;\n  --bg-card: #ffffff;\n  --bg-sidebar: #e6e9ef;\n  --text: #4c4f69;\n  --text-secondary: #5c5f78;\n  --text-sidebar: #6c6f85;\n  --text-sidebar-hover: #4c4f69;\n  --text-sidebar-active: #1e66f5;\n  --border: #ccd0da;\n  --input-bg: #ffffff;\n  --surface-0: #ccd0da;\n  --surface-1: #bcc0cc;\n  --surface-2: #acb0be;\n  --destructive: #e64553;\n  --destructive-hover: #d20f39;\n  --destructive-soft: #fdecee;\n  --destructive-border: #ea999f;\n  --sidebar-divider: rgba(76, 79, 105, 0.14);\n  --sidebar-hover-bg: rgba(76, 79, 105, 0.08);\n  --sidebar-active-bg: rgba(30, 102, 245, 0.12);\n\n  --theme-color: #eff1f5;\n\n  /* Badge accents (Catppuccin Latte) */\n  --badge-neutral-bg: rgba(188, 192, 204, 0.40);\n  --badge-neutral-border: rgba(156, 160, 176, 0.60);\n  --badge-neutral-text: var(--text);\n  --badge-primary: #1e66f5;\n  --badge-primary-bg: rgba(30, 102, 245, 0.16);\n  --badge-primary-border: rgba(30, 102, 245, 0.30);\n  --badge-secondary: #40a02b;\n  --badge-secondary-bg: rgba(64, 160, 43, 0.16);\n  --badge-secondary-border: rgba(64, 160, 43, 0.30);\n  --badge-destructive: #d20f39;\n  --badge-destructive-bg: rgba(210, 15, 57, 0.14);\n  --badge-destructive-border: rgba(210, 15, 57, 0.28);\n\n  --safe-top: env(safe-area-inset-top, 0px);\n  --safe-right: env(safe-area-inset-right, 0px);\n  --safe-bottom: env(safe-area-inset-bottom, 0px);\n  --safe-left: env(safe-area-inset-left, 0px);\n}\n\n[data-theme=\"dark\"] {\n  --bg: #1e1e2e;\n  --bg-card: #313244;\n  --bg-sidebar: #11111b;\n  --text: #cdd6f4;\n  --text-secondary: #a6adc8;\n  --text-sidebar: #6c7086;\n  --text-sidebar-hover: #bac2de;\n  --text-sidebar-active: #cdd6f4;\n  --border: #45475a;\n  --input-bg: #45475a;\n  --surface-0: #313244;\n  --surface-1: #45475a;\n  --surface-2: #585b70;\n  --destructive: #eba0ac;\n  --destructive-hover: #f38ba8;\n  --destructive-soft: rgba(235, 160, 172, 0.14);\n  --destructive-border: #6c7086;\n  --sidebar-divider: rgba(255, 255, 255, 0.08);\n  --sidebar-hover-bg: rgba(255, 255, 255, 0.06);\n  --sidebar-active-bg: rgba(255, 255, 255, 0.1);\n\n  --theme-color: #1e1e2e;\n\n  /* Badge accents (Catppuccin Mocha) */\n  --badge-neutral-bg: rgba(88, 91, 112, 0.42);\n  --badge-neutral-border: rgba(147, 153, 178, 0.40);\n  --badge-neutral-text: var(--text);\n  --badge-primary: #89b4fa;\n  --badge-primary-bg: rgba(137, 180, 250, 0.20);\n  --badge-primary-border: rgba(137, 180, 250, 0.34);\n  --badge-secondary: #a6e3a1;\n  --badge-secondary-bg: rgba(166, 227, 161, 0.18);\n  --badge-secondary-border: rgba(166, 227, 161, 0.32);\n  --badge-destructive: #f38ba8;\n  --badge-destructive-bg: rgba(243, 139, 168, 0.18);\n  --badge-destructive-border: rgba(243, 139, 168, 0.32);\n}\n\nbody { opacity: 0; }\nbody.ready { opacity: 1; transition: opacity .15s; }\n\nhtml, body {\n  background: var(--bg);\n}\n\n/* iOS: allow headers to extend under translucent status bar, but keep content readable. */\n.sticky.top-0.z-50 {\n  padding-top: var(--safe-top);\n}\n\n/* Apply Catppuccin variables to Franken/UIkit components in light mode too.\n   (Dark mode already has explicit overrides; these base rules bring Latte in line.) */\n.uk-card { background: var(--bg-card) !important; border-color: var(--border) !important; color: var(--text) !important; }\n.bg-white { background: var(--bg-card) !important; }\n.border-b, .border-border { border-color: var(--border) !important; }\n.text-muted-foreground { color: var(--text-secondary) !important; }\n.uk-input, .uk-select, .uk-textarea { background: var(--input-bg) !important; color: var(--text) !important; border-color: var(--border) !important; }\n.uk-table th { color: var(--text-secondary) !important; border-color: var(--border) !important; }\n.uk-table td { color: var(--text) !important; }\n.uk-table-divider > :not(:first-child) > tr, .uk-table-divider > tr:not(:first-child) { border-color: var(--border) !important; }\n.uk-label {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 2px 10px;\n  border-radius: 999px;\n  border: 1px solid var(--badge-neutral-border) !important;\n  background: var(--badge-neutral-bg) !important;\n  color: var(--badge-neutral-text) !important;\n  font-weight: 600 !important;\n  letter-spacing: 0.02em;\n}\n.uk-label-primary {\n  border-color: var(--badge-primary-border) !important;\n  background: var(--badge-primary-bg) !important;\n  color: var(--badge-primary) !important;\n}\n.uk-label-secondary {\n  border-color: var(--badge-secondary-border) !important;\n  background: var(--badge-secondary-bg) !important;\n  color: var(--badge-secondary) !important;\n}\n.uk-label-destructive {\n  border-color: var(--badge-destructive-border) !important;\n  background: var(--badge-destructive-bg) !important;\n  color: var(--badge-destructive) !important;\n}\n.uk-btn-default { background: var(--input-bg) !important; color: var(--text) !important; border-color: var(--border) !important; }\n.uk-btn-primary { background: var(--brand) !important; border-color: var(--brand) !important; color: var(--on-brand) !important; }\n.uk-checkbox, .uk-toggle-switch { background: var(--input-bg) !important; border-color: var(--border) !important; }\n.uk-checkbox:checked { background-color: var(--brand) !important; border-color: var(--brand) !important; }\n.uk-toggle-switch:checked { background-color: var(--brand) !important; border-color: var(--brand) !important; }\n.uk-offcanvas-bar { background: var(--bg-sidebar) !important; }\n.uk-form-label { color: var(--text-secondary) !important; }\nh2, h3 { color: var(--text) !important; }\np { color: var(--text) !important; }\n.uk-nav-header { color: var(--text-secondary) !important; }\n.uk-close { color: var(--text) !important; }\n\n[data-theme=\"dark\"] .uk-card { background: var(--bg-card) !important; border-color: var(--border) !important; color: var(--text) !important; }\n[data-theme=\"dark\"] .bg-white { background: var(--bg-card) !important; }\n[data-theme=\"dark\"] .border-b, [data-theme=\"dark\"] .border-border { border-color: var(--border) !important; }\n[data-theme=\"dark\"] .text-muted-foreground { color: var(--text-secondary) !important; }\n[data-theme=\"dark\"] .uk-input, [data-theme=\"dark\"] .uk-select, [data-theme=\"dark\"] .uk-textarea { background: var(--input-bg) !important; color: var(--text) !important; border-color: var(--border) !important; }\n[data-theme=\"dark\"] .uk-table th { color: var(--text-secondary) !important; border-color: var(--border) !important; }\n[data-theme=\"dark\"] .uk-table td { color: var(--text) !important; }\n[data-theme=\"dark\"] .uk-table-divider > :not(:first-child) > tr, [data-theme=\"dark\"] .uk-table-divider > tr:not(:first-child) { border-color: var(--border) !important; }\n[data-theme=\"dark\"] .uk-btn-default { background: var(--input-bg) !important; color: var(--text) !important; border-color: var(--border) !important; }\n[data-theme=\"dark\"] .uk-btn-primary { background: var(--brand) !important; border-color: var(--brand) !important; color: #1e1e2e !important; }\n[data-theme=\"dark\"] .uk-checkbox, [data-theme=\"dark\"] .uk-toggle-switch { background: var(--input-bg) !important; border-color: var(--border) !important; }\n[data-theme=\"dark\"] .uk-checkbox:checked { background-color: var(--brand) !important; border-color: var(--brand) !important; }\n[data-theme=\"dark\"] .uk-toggle-switch:checked { background-color: var(--brand) !important; border-color: var(--brand) !important; }\n[data-theme=\"dark\"] .uk-offcanvas-bar { background: var(--bg-sidebar) !important; }\n[data-theme=\"dark\"] .uk-form-label { color: var(--text-secondary) !important; }\n[data-theme=\"dark\"] h2, [data-theme=\"dark\"] h3 { color: var(--text) !important; }\n[data-theme=\"dark\"] p { color: var(--text) !important; }\n[data-theme=\"dark\"] a.uk-link { color: var(--brand) !important; }\n[data-theme=\"dark\"] .uk-nav-header { color: var(--text-secondary) !important; }\n[data-theme=\"dark\"] .uk-close { color: var(--text) !important; }\n</style>`}\n        <script src=\"https://unpkg.com/htmx.org@1.9.10\"></script>\n        <script src=\"/admin.js\" defer></script>\n        <link rel=\"stylesheet\" href=\"https://unpkg.com/franken-ui@2.1.2/dist/css/core.min.css\" />\n        <script src=\"https://unpkg.com/franken-ui@2.1.2/dist/js/core.iife.js\"></script>\n        <script src=\"https://cdn.tailwindcss.com/3.4.17\"></script>\n        {html`<script>tailwind.config = { corePlugins: { preflight: false } };\n(function() {\n  var fk = document.querySelector('link[href*=\"franken\"]');\n  if (!fk) return;\n  function fixOrder() {\n    document.head.querySelectorAll('style:not([data-fodt])').forEach(function(s) {\n      if (fk.compareDocumentPosition(s) & Node.DOCUMENT_POSITION_PRECEDING) {\n        document.head.appendChild(s);\n      }\n    });\n  }\n  var obs = new MutationObserver(fixOrder);\n  obs.observe(document.head, { childList: true });\n  document.addEventListener('DOMContentLoaded', function() { fixOrder(); obs.disconnect(); });\n})();\n</script>`}\n\n        <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n        <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n        <link rel=\"stylesheet\" href=\"https://unpkg.com/@geoman-io/leaflet-geoman-free@2.17.0/dist/leaflet-geoman.css\" />\n        <script src=\"https://unpkg.com/@geoman-io/leaflet-geoman-free@2.17.0/dist/leaflet-geoman.js\"></script>\n        <style>{`.leaflet-container img { max-width: none !important; max-height: none !important; }`}</style>\n        {html`<script>\nfunction _onRadiusMilesInput() { updateRadius(); }\nfunction _onRadiusLatChange() { updateRadius(); }\nfunction _onRadiusLngChange() { updateRadius(); }\n\nfunction initMaps() {\n  if (typeof L === 'undefined') return;\n\n  var rm = document.getElementById('radius-map');\n  if (rm && !rm._mapInit) {\n    rm._mapInit = true;\n    var lat = parseFloat(rm.dataset.lat) || 44.1628;\n    var lng = parseFloat(rm.dataset.lng) || -77.3832;\n    var miles = parseFloat(rm.dataset.miles) || 10;\n    var map = L.map(rm).setView([lat, lng], 11);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18, attribution: '\u00A9 OpenStreetMap' }).addTo(map);\n    var circle = L.circle([lat, lng], { radius: miles * 1609.34, color: '#0f3460', fillColor: '#0f3460', fillOpacity: 0.12 }).addTo(map);\n    if (lat !== 44.1628) map.fitBounds(circle.getBounds().pad(0.1));\n    map.on('click', function(e) {\n      var latEl = document.getElementById('center-lat');\n      var lngEl = document.getElementById('center-lng');\n      if (latEl) latEl.value = e.latlng.lat.toFixed(6);\n      if (lngEl) lngEl.value = e.latlng.lng.toFixed(6);\n      updateRadius();\n    });\n    window._radiusMap = map;\n    window._radiusCircle = circle;\n    var milesEl = document.getElementById('radius-miles');\n    if (milesEl) milesEl.addEventListener('input', _onRadiusMilesInput);\n    var latEl = document.getElementById('center-lat');\n    var lngEl = document.getElementById('center-lng');\n    if (latEl) latEl.addEventListener('change', _onRadiusLatChange);\n    if (lngEl) lngEl.addEventListener('change', _onRadiusLngChange);\n    setTimeout(function() { map.invalidateSize(); }, 200);\n  }\n\n    var gm = document.getElementById('geofence-map');\n    if (gm && !gm._mapInit) {\n      gm._mapInit = true;\n      var pts = [];\n      try { pts = JSON.parse(gm.dataset.points || '[]'); } catch(e) {}\n\n     function normalizePair(a, b) {\n       var x = Number(a);\n       var y = Number(b);\n       if (!isFinite(x) || !isFinite(y)) return [44.1628, -77.3832];\n       var ax = Math.abs(x);\n       var ay = Math.abs(y);\n       if (ax > 90 && ax <= 180 && ay <= 90) return [y, x];\n       if (ay > 90 && ay <= 180 && ax <= 90) return [x, y];\n       if ((x < 0 && y > 0) || (x > 0 && y < 0)) {\n         var lat = x > 0 ? x : y;\n         var lng = x < 0 ? x : y;\n         if (Math.abs(lat) <= 90 && Math.abs(lng) <= 180) return [lat, lng];\n       }\n       return [x, y];\n     }\n\n     function toLL(p) {\n       if (Array.isArray(p) && p.length >= 2) return normalizePair(p[0], p[1]);\n       if (p && typeof p === 'object') return normalizePair(p.lat, p.lng);\n       return [44.1628, -77.3832];\n     }\n\n      var center = pts.length > 0 ? toLL(pts[0]) : [44.1628, -77.3832];\n      var map = L.map(gm).setView(center, 12);\n     L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18, attribution: '\u00A9 OpenStreetMap' }).addTo(map);\n     var poly = null;\n\n    function syncToHidden() {\n      var coords = [];\n      if (poly) {\n        poly.getLatLngs()[0].forEach(function(ll) { coords.push([ll.lat, ll.lng]); });\n      }\n      var h = document.getElementById('polygon-json-hidden');\n      if (h) {\n        h.value = coords.length ? JSON.stringify(coords) : '';\n        h.dispatchEvent(new Event('change', { bubbles: true }));\n      }\n      var c = document.getElementById('gf-count');\n      if (c) c.textContent = coords.length + ' pts';\n    }\n\n     function enableEdit() {\n       if (poly && poly.pm && typeof poly.pm.enable === 'function') {\n         poly.pm.enable({ allowSelfIntersection: false });\n       }\n     }\n\n     function loadExisting() {\n       if (pts.length >= 3) {\n         poly = L.polygon(pts.map(toLL), { color: '#0f3460', fillColor: '#0f3460', fillOpacity: 0.12 }).addTo(map);\n         map.fitBounds(poly.getBounds().pad(0.1));\n         enableEdit();\n         if (poly.pm) {\n           poly.on('pm:edit', syncToHidden);\n           poly.on('pm:vertexremoved', syncToHidden);\n         }\n         syncToHidden();\n       }\n     }\n     loadExisting();\n\n     var drawBtn = document.getElementById('gf-draw-btn');\n\n     if (!map.pm) {\n       if (drawBtn) {\n         drawBtn.textContent = 'Drawing unavailable';\n         drawBtn.disabled = true;\n       }\n     } else {\n       map.pm.addControls({ position: 'topleft', drawMarker: false, drawCircleMarker: false, drawPolyline: false, drawRectangle: false, drawPolygon: false, drawCircle: false, drawText: false, editMode: false, dragMode: false, cutPolygon: false, removalMode: false, rotateMode: false });\n       map.pm.setGlobalOptions({ pathOptions: { color: '#0f3460', fillColor: '#0f3460', fillOpacity: 0.12 } });\n\n       if (drawBtn) drawBtn.addEventListener('click', function() {\n         if (poly) { map.removeLayer(poly); poly = null; syncToHidden(); }\n         map.pm.enableDraw('Polygon', { snappable: false });\n         drawBtn.textContent = 'Drawing...';\n         drawBtn.disabled = true;\n       });\n\n       map.on('pm:create', function(e) {\n         poly = e.layer;\n         enableEdit();\n         poly.on('pm:edit', syncToHidden);\n         poly.on('pm:vertexremoved', syncToHidden);\n         syncToHidden();\n         if (drawBtn) { drawBtn.textContent = 'Redraw'; drawBtn.disabled = false; }\n       });\n\n       map.on('pm:drawend', function() {\n         if (drawBtn) { drawBtn.textContent = poly ? 'Redraw' : 'Draw Polygon'; drawBtn.disabled = false; }\n       });\n     }\n\n    var clearBtn = document.getElementById('clear-geofence-btn');\n    if (clearBtn) clearBtn.addEventListener('click', function() {\n      if (poly) { map.removeLayer(poly); poly = null; }\n      syncToHidden();\n      if (drawBtn) { drawBtn.textContent = 'Draw Polygon'; drawBtn.disabled = false; }\n    });\n\n    window._geofenceMap = map;\n    setTimeout(function() { map.invalidateSize(); }, 200);\n  }\n}\n\nfunction updateRadius() {\n  var map = window._radiusMap;\n  var circle = window._radiusCircle;\n  if (!map || !circle) return;\n  var la = parseFloat(document.getElementById('center-lat').value) || 44.1628;\n  var ln = parseFloat(document.getElementById('center-lng').value) || -77.3832;\n  var mi = parseFloat(document.getElementById('radius-miles').value) || 10;\n  map.removeLayer(circle);\n  var newCircle = L.circle([la, ln], { radius: mi * 1609.34, color: '#0f3460', fillColor: '#0f3460', fillOpacity: 0.12 }).addTo(map);\n  window._radiusCircle = newCircle;\n  map.setView([la, ln]);\n  var rf = document.getElementById('radius-form');\n  if (rf) rf.dispatchEvent(new Event('change', { bubbles: true }));\n}\n\ndocument.addEventListener('htmx:beforeCleanupElement', function(e) {\n  var el = e.detail.elt;\n  if (el.id === 'radius-map' && window._radiusMap) {\n    var milesEl = document.getElementById('radius-miles');\n    var latEl = document.getElementById('center-lat');\n    var lngEl = document.getElementById('center-lng');\n    if (milesEl) milesEl.removeEventListener('input', _onRadiusMilesInput);\n    if (latEl) latEl.removeEventListener('change', _onRadiusLatChange);\n    if (lngEl) lngEl.removeEventListener('change', _onRadiusLngChange);\n    window._radiusMap.off();\n    window._radiusMap.remove();\n    window._radiusMap = null;\n    window._radiusCircle = null;\n    el._mapInit = false;\n  }\n  if (el.id === 'geofence-map' && window._geofenceMap) {\n    window._geofenceMap.off();\n    window._geofenceMap.remove();\n    window._geofenceMap = null;\n    el._mapInit = false;\n  }\n});\n\ndocument.addEventListener('click', function(e) {\n  var item = e.target.closest('.address-result');\n  if (!item) return;\n  var d = item.dataset;\n  var prefix = d.prefix || 'addr';\n  if (prefix === 'radius') {\n    var cLat = document.getElementById('center-lat');\n    var cLng = document.getElementById('center-lng');\n    if (cLat) cLat.value = d.lat;\n    if (cLng) cLng.value = d.lng;\n    var rr = document.getElementById('radius-address-results');\n    if (rr) rr.innerHTML = '';\n    updateRadius();\n  } else {\n    var ids = {\n      'addr-line1': d.line1,\n      'addr-city': d.city,\n      'addr-state': d.state,\n      'addr-postal': d.postal,\n      'addr-lat': d.lat,\n      'addr-lng': d.lng,\n      'address_line_1': d.line1,\n      'address_city': d.city,\n      'address_state': d.state,\n      'address_postal': d.postal,\n      'address_lat': d.lat,\n      'address_lng': d.lng,\n    };\n    for (var id in ids) { var el = document.getElementById(id); if (el) el.value = ids[id]; }\n    var ar = document.getElementById('address-results');\n    if (ar) ar.innerHTML = '';\n  }\n});\n\ndocument.addEventListener('htmx:configRequest', function(e) {\n  var el = e.detail.elt;\n  if (el.id === 'area-type') {\n    var tid = window.location.pathname.split('/territories/')[1];\n    if (tid) tid = tid.split('/')[0];\n    e.detail.path = '/admin/territories/' + tid + '/area-panel/' + el.value;\n  }\n});\n\ndocument.addEventListener('htmx:afterSettle', function() {\n  setTimeout(initMaps, 100);\n});\ndocument.addEventListener('DOMContentLoaded', function() { setTimeout(initMaps, 100); });\n\nfunction scrollSmsThreadToBottom(force) {\n  var scroller = document.getElementById('sms-history-scroll');\n  if (!scroller) return;\n\n  var canScroll = scroller.scrollHeight > (scroller.clientHeight + 12);\n\n  var didInitial = scroller.dataset && scroller.dataset.smsInitialScrollDone === '1';\n  if (!didInitial) force = true;\n\n  if (!force) {\n    var distanceFromBottom = scroller.scrollHeight - scroller.scrollTop - scroller.clientHeight;\n    if (distanceFromBottom > 96) return;\n  }\n\n  scroller.scrollTop = scroller.scrollHeight;\n  if (canScroll && scroller.dataset) scroller.dataset.smsInitialScrollDone = '1';\n}\n\nfunction scrollSmsThreadToBottomSoon(force) {\n  requestAnimationFrame(function() {\n    requestAnimationFrame(function() {\n      scrollSmsThreadToBottom(force);\n    });\n  });\n\n  // iOS Safari/PWA can report an intermediate scrollHeight during initial\n  // layout/font hydration. Retry a couple times without being aggressive.\n  setTimeout(function() { scrollSmsThreadToBottom(force); }, 60);\n  setTimeout(function() { scrollSmsThreadToBottom(force); }, 220);\n}\n\nfunction focusSmsComposer() {\n  var textarea = document.querySelector('#sms-thread-panel textarea[name=\"sms_body\"]');\n  if (!textarea || typeof textarea.focus !== 'function') return;\n  try {\n    textarea.focus({ preventScroll: true });\n  } catch {\n    textarea.focus();\n  }\n  if (typeof textarea.setSelectionRange === 'function') {\n    var end = textarea.value ? textarea.value.length : 0;\n    textarea.setSelectionRange(end, end);\n  }\n}\n\nfunction focusSmsComposerWithRetries() {\n  focusSmsComposer();\n  setTimeout(focusSmsComposer, 60);\n  setTimeout(focusSmsComposer, 180);\n}\n\nfunction recalcInvoiceTotal() {\n  var lineItems = document.getElementById('line_items_text');\n  var tax = document.getElementById('tax_amount');\n  var discount = document.getElementById('discount_amount');\n  var total = document.getElementById('total_amount');\n  if (!lineItems || !total) return;\n\n  var subtotal = 0;\n  var lines = String(lineItems.value || '').split(/\\r?\\n/);\n  for (var i = 0; i < lines.length; i++) {\n    var line = lines[i].trim();\n    if (!line) continue;\n    var parts = line.split('|').map(function (part) { return part.trim(); });\n    if (parts.length < 3) continue;\n    var qty = parseFloat(parts[1] || '0');\n    var unit = parseFloat((parts[2] || '0').replace(/[$,]/g, ''));\n    if (!isFinite(qty) || qty <= 0 || !isFinite(unit) || unit < 0) continue;\n    subtotal += qty * unit;\n  }\n\n  var taxValue = tax ? parseFloat(String(tax.value || '0').replace(/[$,]/g, '')) : 0;\n  var discountValue = discount ? parseFloat(String(discount.value || '0').replace(/[$,]/g, '')) : 0;\n  if (!isFinite(taxValue)) taxValue = 0;\n  if (!isFinite(discountValue)) discountValue = 0;\n\n  var next = Math.max(0, subtotal + taxValue - discountValue);\n  total.value = next.toFixed(2);\n}\n\ndocument.addEventListener('input', function (e) {\n  var target = e.target;\n  if (!target || !target.id) return;\n  if (target.id === 'line_items_text' || target.id === 'tax_amount' || target.id === 'discount_amount') {\n    recalcInvoiceTotal();\n  }\n});\n\ndocument.addEventListener('htmx:afterSettle', function () {\n  recalcInvoiceTotal();\n});\n\nfunction flashSmsSendButton() {\n  var btn = document.querySelector('#sms-thread-panel [data-sms-send-success=\"true\"]');\n  if (!btn) return;\n  var originalStyle = btn.getAttribute('style') || '';\n  var originalText = btn.textContent || 'Send';\n  btn.textContent = 'Sent';\n  btn.setAttribute('style', 'min-width:110px;background:#16a34a;border-color:#15803d;color:#fff;');\n  setTimeout(function() {\n    if (!document.body.contains(btn)) return;\n    btn.textContent = originalText;\n    btn.setAttribute('style', originalStyle || 'min-width:110px;');\n  }, 1200);\n}\n\nwindow.openSmsTaskModal = function(config) {\n  var existing = document.getElementById('sms-task-modal-overlay');\n  if (existing) existing.remove();\n  var openedAt = Date.now();\n\n  var overlay = document.createElement('div');\n  overlay.id = 'sms-task-modal-overlay';\n  overlay.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.4);z-index:1100;display:flex;align-items:flex-end;justify-content:center;padding:16px;';\n\n  var panel = document.createElement('div');\n  panel.id = 'sms-task-modal-panel';\n  panel.style.cssText = 'width:100%;max-width:520px;background:var(--bg-card,#fff);border:1px solid var(--border,#ccd0da);border-radius:14px;padding:14px;box-shadow:0 18px 48px rgba(0,0,0,0.22);overflow:auto;';\n\n  var title = document.createElement('div');\n  title.textContent = 'Add Task';\n  title.style.cssText = 'font-weight:600;font-size:16px;color:var(--text,#1f2937);margin-bottom:10px;';\n\n  var labelTask = document.createElement('label');\n  labelTask.textContent = 'Task title';\n  labelTask.style.cssText = 'display:block;font-size:12px;font-weight:600;letter-spacing:.02em;color:var(--text-secondary,#6b7280);margin-bottom:6px;';\n\n  var taskInput = document.createElement('input');\n  taskInput.type = 'text';\n  taskInput.maxLength = 72;\n  taskInput.value = (config && config.suggestedTitle ? config.suggestedTitle : '') || '';\n  taskInput.placeholder = 'One-line task title';\n  taskInput.className = 'uk-input';\n  taskInput.style.cssText = 'width:100%;margin-bottom:10px;';\n\n  var labelJob = document.createElement('label');\n  labelJob.textContent = 'Task target';\n  labelJob.style.cssText = 'display:block;font-size:12px;font-weight:600;letter-spacing:.02em;color:var(--text-secondary,#6b7280);margin-bottom:6px;';\n\n  var jobSelect = document.createElement('select');\n  jobSelect.className = 'uk-select';\n  jobSelect.style.cssText = 'width:100%;margin-bottom:12px;';\n\n  var options = (config && Array.isArray(config.jobOptions)) ? config.jobOptions : [];\n  var selectedId = config && config.selectedJobId ? config.selectedJobId : '';\n  for (var i = 0; i < options.length; i++) {\n    var opt = document.createElement('option');\n    opt.value = options[i].id;\n    opt.textContent = options[i].label || options[i].id;\n    if (options[i].id === selectedId) opt.selected = true;\n    jobSelect.appendChild(opt);\n  }\n\n  var actions = document.createElement('div');\n  actions.style.cssText = 'display:flex;justify-content:flex-end;gap:8px;';\n\n  var cancelBtn = document.createElement('button');\n  cancelBtn.type = 'button';\n  cancelBtn.className = 'uk-btn uk-btn-default uk-btn-sm';\n  cancelBtn.textContent = 'Cancel';\n\n  var saveBtn = document.createElement('button');\n  saveBtn.type = 'button';\n  saveBtn.className = 'uk-btn uk-btn-primary uk-btn-sm';\n  saveBtn.textContent = 'Add task';\n\n  function applyViewportBounds() {\n    var vv = window.visualViewport;\n    var viewportHeight = vv ? vv.height : window.innerHeight;\n    var viewportTop = vv ? vv.offsetTop : 0;\n    var keyboardBottomInset = vv ? Math.max(0, window.innerHeight - (vv.height + vv.offsetTop)) : 0;\n\n    overlay.style.top = viewportTop + 'px';\n    overlay.style.bottom = keyboardBottomInset + 'px';\n    panel.style.maxHeight = Math.max(220, Math.floor(viewportHeight - 24)) + 'px';\n  }\n\n  function onViewportChange() {\n    applyViewportBounds();\n  }\n\n  function closeModal() {\n    if (window.visualViewport) {\n      window.visualViewport.removeEventListener('resize', onViewportChange);\n      window.visualViewport.removeEventListener('scroll', onViewportChange);\n    }\n    window.removeEventListener('orientationchange', onViewportChange);\n    overlay.remove();\n  }\n\n  cancelBtn.addEventListener('click', closeModal);\n  overlay.addEventListener('click', function(e) {\n    if (Date.now() - openedAt < 450) return;\n    if (e.target === overlay) closeModal();\n  });\n\n  saveBtn.addEventListener('click', function() {\n    var t = (taskInput.value || '').replace(/\\s+/g, ' ').trim();\n    if (!t) {\n      taskInput.focus();\n      return;\n    }\n    var j = jobSelect.value || '';\n    if (!j) return;\n    if (config && typeof config.onSubmit === 'function') {\n      config.onSubmit({ taskTitle: t, jobId: j });\n    }\n    closeModal();\n  });\n\n  actions.appendChild(cancelBtn);\n  actions.appendChild(saveBtn);\n  panel.appendChild(title);\n  panel.appendChild(labelTask);\n  panel.appendChild(taskInput);\n  panel.appendChild(labelJob);\n  panel.appendChild(jobSelect);\n  panel.appendChild(actions);\n  overlay.appendChild(panel);\n  document.body.appendChild(overlay);\n  applyViewportBounds();\n  if (window.visualViewport) {\n    window.visualViewport.addEventListener('resize', onViewportChange);\n    window.visualViewport.addEventListener('scroll', onViewportChange);\n  }\n  window.addEventListener('orientationchange', onViewportChange);\n  try {\n    taskInput.focus({ preventScroll: true });\n  } catch {\n    taskInput.focus();\n  }\n  taskInput.select();\n};\n\nwindow.handleSmsTaskBubble = function(btn, triggerEvent) {\n  if (!btn || !btn.dataset) return false;\n\n  if (triggerEvent && typeof triggerEvent.type === 'string') {\n    var now = Date.now();\n    var lastTouch = parseInt(btn.dataset.smsLastTouchAt || '0', 10);\n    if (triggerEvent.type === 'touchend') {\n      btn.dataset.smsLastTouchAt = String(now);\n    } else if (triggerEvent.type === 'click' && lastTouch > 0 && now - lastTouch < 700) {\n      return false;\n    }\n  }\n\n  var optionsRaw = btn.dataset.jobOptions || '[]';\n  var jobOptions = [];\n  try {\n    jobOptions = JSON.parse(optionsRaw);\n  } catch {\n    jobOptions = [];\n  }\n\n  if (!Array.isArray(jobOptions) || jobOptions.length === 0) {\n    return false;\n  }\n\n  if (typeof htmx === 'undefined' || !btn.dataset.smsTaskUrl) {\n    return false;\n  }\n\n  window.openSmsTaskModal({\n    jobOptions: jobOptions,\n    selectedJobId: btn.dataset.selectedJobId || '',\n    suggestedTitle: (btn.dataset.taskSuggestedTitle || '').trim(),\n    onSubmit: function(values) {\n      htmx.ajax('POST', btn.dataset.smsTaskUrl, {\n        target: '#sms-thread-panel',\n        swap: 'outerHTML',\n        values: {\n          sms_log_id: btn.dataset.smsLogId || '',\n          job_id: values.jobId,\n          task_title: values.taskTitle,\n        },\n      });\n    },\n  });\n\n  return false;\n};\n\nwindow.prepareSmsTaskFromBubble = window.handleSmsTaskBubble;\n\nfunction handleSmsTaskBubbleEvent(e) {\n  var btn = e.target.closest('[data-sms-task-url]');\n  if (!btn) return;\n  e.preventDefault();\n  if (typeof e.stopPropagation === 'function') e.stopPropagation();\n  if (window.handleSmsTaskBubble) {\n    window.handleSmsTaskBubble(btn, e);\n  }\n}\n\ndocument.addEventListener('touchend', handleSmsTaskBubbleEvent, { passive: false });\ndocument.addEventListener('click', handleSmsTaskBubbleEvent);\n\ndocument.addEventListener('htmx:afterSwap', function(e) {\n  var target = e.detail && e.detail.target ? e.detail.target : null;\n  if (!target) return;\n  var requestConfig = e.detail && e.detail.requestConfig ? e.detail.requestConfig : null;\n  var requestPath = requestConfig && typeof requestConfig.path === 'string' ? requestConfig.path : '';\n  var requestElt = requestConfig && requestConfig.elt ? requestConfig.elt : null;\n  if (target.id === 'sms-history') {\n    scrollSmsThreadToBottomSoon(false);\n    return;\n  }\n  if (target.id === 'sms-thread-panel') {\n    scrollSmsThreadToBottomSoon(true);\n    var sentFromReplyForm = requestPath.indexOf('/sms-reply') !== -1;\n    if (!sentFromReplyForm && requestElt && typeof requestElt.matches === 'function') {\n      sentFromReplyForm = requestElt.matches('form[hx-post*=\"/sms-reply\"]');\n    }\n    if (target.querySelector('[data-sms-send-success=\"true\"]')) {\n      requestAnimationFrame(flashSmsSendButton);\n    }\n    if (target.querySelector('[data-sms-send-result]') || sentFromReplyForm) {\n      requestAnimationFrame(focusSmsComposerWithRetries);\n    }\n    return;\n  }\n  if (target.id === 'page-content') {\n    scrollSmsThreadToBottomSoon(true);\n  }\n});\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  scrollSmsThreadToBottomSoon(true);\n});\n\ndocument.addEventListener('htmx:beforeRequest', function(e) {\n  var oc = document.getElementById('offcanvas-nav');\n  if (oc && typeof UIkit !== 'undefined') {\n    var inst = UIkit.offcanvas(oc);\n    if (inst && inst.isToggled && inst.isToggled()) inst.hide();\n  }\n});\n\ndocument.addEventListener('htmx:afterRequest', function(e) {\n  var el = e.detail.elt;\n  var ind = null;\n  if (el.classList.contains('autosave')) {\n    ind = el.querySelector('.save-indicator');\n  } else if (el.tagName === 'INPUT' && el.type === 'checkbox') {\n    var section = el.closest('section');\n    if (section) ind = section.querySelector('.save-indicator');\n  }\n  if (!ind) return;\n  if (e.detail.successful) {\n    ind.textContent = 'Saved';\n    ind.className = 'save-indicator save-ok';\n    ind.style.opacity = '1';\n    setTimeout(function() { ind.style.opacity = '0'; }, 2000);\n    if (el.tagName === 'INPUT' && el.type === 'checkbox') {\n      var section = el.closest('section');\n      if (section) {\n        var count = section.querySelectorAll('input[type=checkbox]:checked').length;\n        var badge = section.querySelector('[id$=\"-count\"]');\n        if (badge) badge.textContent = count + ' assigned';\n      }\n    }\n  } else {\n    ind.textContent = 'Error saving';\n    ind.className = 'save-indicator save-err';\n    ind.style.opacity = '1';\n    if (el.tagName === 'INPUT' && el.type === 'checkbox') el.checked = !el.checked;\n  }\n});\ndocument.addEventListener('htmx:beforeRequest', function(e) {\n  var el = e.detail.elt;\n  var ind = null;\n  if (el.classList.contains('autosave')) {\n    ind = el.querySelector('.save-indicator');\n  } else if (el.tagName === 'INPUT' && el.type === 'checkbox') {\n    var section = el.closest('section');\n    if (section) ind = section.querySelector('.save-indicator');\n  }\n  if (ind) { ind.textContent = 'Saving\u2026'; ind.className = 'save-indicator save-pending'; ind.style.opacity = '1'; }\n});\n\ndocument.addEventListener('htmx:confirm', function(e) {\n  var btn = e.detail.elt;\n  if (btn.getAttribute('data-confirm') !== 'arm') return;\n  if (btn.classList.contains('delete-armed')) return;\n  e.preventDefault();\n  var orig = btn.textContent;\n  btn.textContent = 'Confirm';\n  btn.classList.add('delete-armed');\n  btn._disarmTimer = setTimeout(function() {\n    btn.textContent = orig;\n    btn.classList.remove('delete-armed');\n  }, 4000);\n});\n\ndocument.addEventListener('click', function(e) {\n  var btn = e.target.closest('.delete-armed');\n  if (!btn) return;\n  if (btn._disarmTimer) clearTimeout(btn._disarmTimer);\n});\n        </script>`}\n        <style>{`\n          *, *::before, *::after { box-sizing: border-box; }\n          html { -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }\n          body { background: var(--bg); color: var(--text); overscroll-behavior: none; -webkit-font-smoothing: antialiased; }\n\n          @layer base {\n            input, select, textarea, button { font-size: 16px; }\n            input[type=\"time\"], input[type=\"date\"] { -webkit-appearance: none; appearance: none; }\n          }\n          select:not(.uk-select) { -webkit-appearance: none; appearance: none; background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23999' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E\"); background-repeat: no-repeat; background-position: right 10px center; padding-right: 28px; }\n          a, button, input, select, textarea, label, [role=\"switch\"], [hx-post], [hx-get], [hx-delete] { touch-action: manipulation; }\n          .main-content { -webkit-overflow-scrolling: touch; }\n          body { padding-env: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left); }\n\n          .admin-layout { min-height: 100vh; min-height: 100dvh; }\n\n          .desktop-sidebar { display: none; }\n\n          .main-content { flex: 1; padding: 0; min-height: 100vh; min-height: 100dvh; }\n\n          .page-header {\n            background: var(--bg-card);\n            padding: 16px 32px 16px 52px;\n            border-bottom: 1px solid var(--border);\n            display: grid;\n            grid-template-columns: 1fr auto;\n            align-items: center;\n            gap: 8px 16px;\n            position: -webkit-sticky;\n            position: sticky;\n            top: 0;\n            z-index: 50;\n          }\n          .page-header h2 { font-size: 20px; color: var(--text); font-weight: 600; letter-spacing: -0.3px; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\n          .page-header-info { grid-column: 1; min-width: 0; }\n          .page-header-actions { grid-column: 2; display: flex; align-items: center; gap: 8px; flex-shrink: 0; }\n          .page-header-meta { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; margin-top: 2px; font-size: 13px; color: var(--text-secondary); }\n          .page-header-meta > span:not(:first-child)::before { content: '\u00B7'; margin-right: 6px; opacity: 0.5; }\n          .page-header-meta > span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }\n          .page-header--rich { grid-template-rows: auto auto; }\n          .page-header--rich .page-header-info { grid-row: 1 / -1; }\n          .page-header--rich .page-header-actions { grid-row: 1 / -1; align-self: center; }\n\n          .status-icon { display: inline-flex; align-items: center; justify-content: center; flex-shrink: 0; }\n          .status-icon svg { display: block; }\n          .status-icon--neutral { color: var(--text-secondary); }\n          .status-icon--primary { color: var(--badge-primary); }\n          .status-icon--secondary { color: var(--badge-secondary); }\n          .status-icon--destructive { color: var(--badge-destructive); }\n\n          .danger-card { border-color: var(--destructive-border, var(--border)) !important; }\n          .danger-card h3 { color: var(--text-secondary) !important; font-size: 13px !important; }\n\n          .wizard-progress { display: flex; align-items: center; gap: 4px; }\n          .wizard-progress-step { width: 28px; height: 4px; border-radius: 2px; background: var(--border); }\n          .wizard-progress-step.is-done { background: var(--badge-primary); }\n          .wizard-progress-step.is-active { background: var(--brand); }\n\n          .page-body { padding: 28px 32px; }\n\n          @media (min-width: 1024px) {\n            .admin-layout { display: flex; }\n            .desktop-sidebar { display: flex; flex-direction: column; width: 260px; min-width: 260px; background: var(--bg-sidebar); min-height: 100vh; min-height: 100dvh; position: sticky; top: 0; height: 100vh; height: 100dvh; overflow-y: auto; padding: 24px 0; }\n            .mobile-menu-btn { display: none !important; }\n            .page-header { padding: 20px 32px; }\n          }\n\n          table { width: 100%; border-collapse: collapse; }\n\n          .search-box { position: relative; }\n          .search-box input { padding-left: 36px; background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23999' viewBox='0 0 16 16'%3E%3Cpath d='M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85zm-5.242.656a5 5 0 1 1 0-10 5 5 0 0 1 0 10z'/%3E%3C/svg%3E\"); background-repeat: no-repeat; background-position: 12px center; }\n          .search-results { position: absolute; top: 100%; left: 0; right: 0; background: var(--bg-card); border: 1px solid var(--border); border-top: none; border-radius: 0 0 8px 8px; max-height: 240px; overflow-y: auto; z-index: 100; box-shadow: 0 8px 24px rgba(0,0,0,0.15); }\n          /* Customer create/edit forms don't wrap the input in .search-box, so absolute positioning can land off-screen.\n             For those inline address result containers, render results as a normal block list. */\n          #address-results .search-results { position: static; border-top: 1px solid var(--border); border-radius: 8px; box-shadow: 0 8px 18px rgba(0,0,0,0.12); }\n          .search-item { padding: 10px 16px; cursor: pointer; border-bottom: 1px solid var(--border); font-size: 14px; color: var(--text); }\n          .search-item:hover { background: rgba(127,127,127,0.08); }\n          .search-item .name { font-weight: 500; }\n          .search-item .meta { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }\n\n          .avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--brand); color: #1e1e2e; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 15px; flex-shrink: 0; }\n          .avatar-sm { width: 32px; height: 32px; font-size: 13px; }\n\n          .save-indicator { font-size: 12px; font-weight: 500; transition: opacity 0.3s; opacity: 0; margin-left: 8px; }\n          .save-ok { color: #16a34a; }\n          .save-err { color: #dc2626; }\n          .save-pending { color: var(--text-secondary); }\n          .autosave .save-indicator, #territory-services .save-indicator, #territory-providers .save-indicator { display: inline-block; }\n\n          .delete-btn { color: var(--destructive); background: var(--bg-card); border: 1px solid var(--destructive-border); padding: 6px 14px; border-radius: 7px; cursor: pointer; font-size: 13px; font-weight: 500; transition: all 0.15s; }\n          .delete-btn:hover { background: var(--destructive-soft); border-color: var(--destructive-hover); color: var(--destructive-hover); }\n          .delete-btn.delete-armed { background: var(--destructive); color: #fff; border-color: var(--destructive); font-weight: 600; }\n          .delete-btn.delete-armed:hover { background: var(--destructive-hover); border-color: var(--destructive-hover); }\n\n          .mobile-menu-btn {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            background: none;\n            border: none;\n            color: var(--text);\n            cursor: pointer;\n            position: fixed;\n            top: 0;\n            left: 0;\n            height: calc(48px + var(--safe-top));\n            width: calc(48px + var(--safe-left));\n            padding-top: var(--safe-top);\n            padding-left: var(--safe-left);\n            z-index: 100;\n          }\n          .mobile-menu-btn svg {\n            transform: translateY(0px);\n          }\n\n          .sidebar-nav { padding: 0 4px; }\n          .sidebar-nav .uk-nav-header { color: var(--text-sidebar); font-size: 11px; text-transform: uppercase; letter-spacing: 0.8px; font-weight: 600; padding: 16px 12px 6px; margin: 0; }\n          .sidebar-nav .uk-nav-header:first-child { padding-top: 4px; }\n          .sidebar-nav .uk-nav-divider { border-color: var(--sidebar-divider); margin: 8px 12px; }\n          .sidebar-nav > li > a { color: var(--text-sidebar); padding: 8px 12px; border-radius: 6px; font-size: 14px; font-weight: 450; transition: all 0.15s; display: block; text-decoration: none; }\n          .sidebar-nav > li > a:hover { color: var(--text-sidebar-hover); background: var(--sidebar-hover-bg); }\n          .sidebar-nav > li.uk-active > a { color: var(--text-sidebar-active); background: var(--sidebar-active-bg); font-weight: 500; }\n\n          .admin-theme-toggle {\n            width: 100%;\n            border: 0;\n            background: transparent;\n            color: var(--text-sidebar);\n            padding: 8px 12px;\n            border-radius: 6px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            font-size: 14px;\n            cursor: pointer;\n            text-align: left;\n          }\n          .admin-theme-toggle:hover { color: var(--text-sidebar-hover); background: var(--sidebar-hover-bg); }\n          .admin-theme-toggle .theme-toggle-icon {\n            position: relative;\n            width: 24px;\n            height: 24px;\n            flex-shrink: 0;\n          }\n          .admin-theme-toggle .moon-or-sun {\n            position: relative;\n            width: 24px;\n            height: 24px;\n            border-radius: 50%;\n            border: 1px solid currentColor;\n            background: currentColor;\n            transform: scale(1);\n            transition: all 0.45s ease;\n            overflow: hidden;\n            opacity: 0.85;\n          }\n          .admin-theme-toggle .moon-or-sun::before {\n            content: \"\";\n            position: absolute;\n            right: -9px;\n            top: -9px;\n            height: 24px;\n            width: 24px;\n            border: 2px solid currentColor;\n            border-radius: 50%;\n            transform: translate(0, 0);\n            opacity: 1;\n            transition: transform 0.45s ease;\n          }\n          .admin-theme-toggle .moon-or-sun::after {\n            content: \"\";\n            width: 8px;\n            height: 8px;\n            border-radius: 50%;\n            margin: -4px 0 0 -4px;\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            box-shadow: 0 -23px 0 currentColor,\n              0 23px 0 currentColor,\n              23px 0 0 currentColor,\n              -23px 0 0 currentColor,\n              15px 15px 0 currentColor,\n              -15px 15px 0 currentColor,\n              15px -15px 0 currentColor,\n              -15px -15px 0 currentColor;\n            transform: scale(0);\n            transition: all 0.35s ease;\n          }\n          .admin-theme-toggle .moon-mask {\n            position: absolute;\n            right: -9px;\n            top: -8px;\n            height: 24px;\n            width: 24px;\n            border-radius: 50%;\n            border: 0;\n            background: var(--bg-sidebar);\n            transform: translate(0, 0);\n            opacity: 1;\n            transition: background 0.25s ease, transform 0.45s ease;\n          }\n          [data-theme=\"dark\"] .admin-theme-toggle .moon-or-sun {\n            transform: scale(0.55);\n            overflow: visible;\n          }\n          [data-theme=\"dark\"] .admin-theme-toggle .moon-or-sun::before {\n            transform: translate(14px, -14px);\n            opacity: 0;\n          }\n          [data-theme=\"dark\"] .admin-theme-toggle .moon-or-sun::after {\n            transform: scale(1);\n          }\n          [data-theme=\"dark\"] .admin-theme-toggle .moon-mask {\n            transform: translate(14px, -14px);\n            opacity: 0;\n          }\n          .theme-label { line-height: 1; }\n          \n          .sidebar-logo { display: flex; align-items: center; gap: 10px; padding: 0 20px; margin-bottom: 24px; }\n          .sidebar-logo img { width: 36px; height: 36px; }\n          .sidebar-logo span { font-size: 18px; color: var(--text-sidebar-active); letter-spacing: -0.3px; font-weight: 600; }\n\n          /* iOS PWA: give offcanvas enough top room under translucent status bar. */\n          #offcanvas-nav .uk-offcanvas-bar {\n            padding-top: calc(16px + var(--safe-top));\n          }\n\n          @media (max-width: 768px) {\n            .page-header { padding: 12px 16px 12px 52px; }\n            .page-header h2 { font-size: 17px; }\n            .page-header--rich { grid-template-columns: 1fr; }\n            .page-header--rich .page-header-actions { grid-column: 1; grid-row: auto; justify-self: start; }\n            .page-header-meta > span { max-width: 140px; }\n            .page-body { padding: 16px; }\n          }\n\n          #sms-thread-modal-overlay {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(0, 0, 0, 0.55);\n            z-index: 1200;\n            display: none;\n            align-items: stretch;\n            justify-content: stretch;\n            padding: 0;\n          }\n          #sms-thread-modal-overlay[data-open=\"true\"] { display: flex; }\n          #sms-thread-modal-panel {\n            width: 100%;\n            height: 100%;\n            background: var(--bg);\n            color: var(--text);\n            display: flex;\n            flex-direction: column;\n          }\n          #sms-thread-modal-header {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            gap: 12px;\n            padding: calc(12px + var(--safe-top)) calc(12px + var(--safe-right)) 12px calc(12px + var(--safe-left));\n            border-bottom: 1px solid var(--border);\n            background: var(--bg-card);\n          }\n          #sms-thread-modal-header h3 { margin: 0; font-size: 15px; font-weight: 650; letter-spacing: -0.2px; line-height: 1.2; }\n          #sms-thread-modal-actions { display: inline-flex; align-items: center; gap: 8px; }\n          #sms-thread-modal-open-inbox { text-decoration: none; }\n          #sms-thread-modal-content {\n            flex: 1;\n            min-height: 0;\n            overflow: hidden;\n            padding: 0;\n            display: flex;\n            flex-direction: column;\n          }\n          #sms-thread-modal-status {\n            display: block;\n            padding: 12px calc(12px + var(--safe-right)) 0 calc(12px + var(--safe-left));\n          }\n          #sms-thread-modal-loading {\n            display: none;\n            padding: 12px;\n            border: 1px solid var(--border);\n            border-radius: 14px;\n            background: rgba(0,0,0,0.02);\n            margin-bottom: 12px;\n          }\n          #sms-thread-modal-loading.htmx-request { display: block; }\n          #sms-thread-modal-loading .skel { display: flex; flex-direction: column; gap: 10px; }\n          #sms-thread-modal-loading .skel-row { display: flex; align-items: center; gap: 10px; }\n          #sms-thread-modal-loading .skel-dot {\n            width: 10px;\n            height: 10px;\n            border-radius: 999px;\n            background: rgba(0,0,0,0.08);\n            flex: 0 0 auto;\n          }\n          #sms-thread-modal-loading .skel-line {\n            height: 12px;\n            border-radius: 999px;\n            background: linear-gradient(90deg, rgba(0,0,0,0.06), rgba(0,0,0,0.10), rgba(0,0,0,0.06));\n            background-size: 240% 100%;\n            animation: smsSkel 1.15s ease-in-out infinite;\n          }\n          #sms-thread-modal-loading .skel-line.w-30 { width: 30%; }\n          #sms-thread-modal-loading .skel-line.w-45 { width: 45%; }\n          #sms-thread-modal-loading .skel-line.w-70 { width: 70%; }\n          #sms-thread-modal-loading .skel-line.w-85 { width: 85%; }\n          @keyframes smsSkel {\n            0% { background-position: 100% 0; }\n            100% { background-position: 0 0; }\n          }\n          @media (prefers-reduced-motion: reduce) {\n            #sms-thread-modal-loading .skel-line { animation: none; background: rgba(0,0,0,0.08); }\n          }\n          #sms-thread-modal-error {\n            display: none;\n            padding: 12px;\n            border: 1px solid rgba(239,68,68,0.35);\n            border-radius: 12px;\n            background: rgba(239,68,68,0.08);\n            color: #b91c1c;\n            font-size: 13px;\n            margin-bottom: 12px;\n          }\n          #sms-thread-modal-error[data-open=\"true\"] { display: block; }\n          #sms-thread-modal-body {\n            flex: 1;\n            min-height: 0;\n            padding: 0;\n          }\n          #sms-thread-modal-body #sms-thread-panel {\n            height: 100%;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n            background: transparent !important;\n            border: 0 !important;\n            padding: 0 !important;\n            box-shadow: none !important;\n          }\n          #sms-thread-modal-body #sms-thread-panel.uk-card,\n          #sms-thread-modal-body #sms-thread-panel.uk-card-body {\n            box-shadow: none !important;\n            border: 0 !important;\n            background: transparent !important;\n          }\n          #sms-thread-modal-body #sms-thread-panel [data-sms-thread-modal-open] { display: none !important; }\n          #sms-thread-modal-body #sms-thread-panel [data-sms-thread-header] { display: none; }\n          #sms-thread-modal-body #sms-thread-panel [data-sms-thread-body] {\n            flex: 1;\n            min-height: 0;\n            overflow: hidden;\n            display: flex;\n            flex-direction: column;\n          }\n          #sms-thread-modal-body #sms-thread-panel [data-sms-thread-body] {\n            padding: 0 calc(12px + var(--safe-right)) 0 calc(12px + var(--safe-left));\n          }\n          #sms-thread-modal-body #sms-history-scroll {\n            max-height: none !important;\n            flex: 1;\n            min-height: 0;\n            overflow-y: auto !important;\n            padding: 10px 0 12px 0 !important;\n          }\n          #sms-thread-modal-body #sms-thread-panel form {\n            margin-left: calc(-1 * (12px + var(--safe-left)));\n            margin-right: calc(-1 * (12px + var(--safe-right)));\n            padding: 12px calc(12px + var(--safe-right)) calc(16px + var(--safe-bottom)) calc(12px + var(--safe-left));\n            border-top: 1px solid var(--border);\n            background: var(--bg);\n          }\n          #sms-thread-modal-body #sms-thread-panel form textarea {\n            margin-bottom: 2px;\n          }\n          #sms-thread-modal-body #sms-thread-panel form [data-sms-counter] {\n            padding-bottom: 6px;\n          }\n\n          @media (min-width: 768px) {\n            #sms-thread-modal-header h3 { font-size: 16px; }\n            #sms-thread-modal-overlay {\n              padding: 24px;\n              align-items: center;\n              justify-content: center;\n            }\n            #sms-thread-modal-panel {\n              max-width: 760px;\n              height: min(90vh, 860px);\n              border-radius: 16px;\n              border: 1px solid var(--border);\n              box-shadow: 0 18px 48px rgba(0,0,0,0.22);\n              overflow: hidden;\n            }\n          }\n        `}</style>\n      </head>\n      <body>\n        <div id=\"offcanvas-nav\" data-uk-offcanvas=\"mode: slide; overlay: true\">\n          <div class=\"uk-offcanvas-bar\" style=\"background: var(--bg-sidebar); width: 260px;\">\n            <button class=\"uk-offcanvas-close\" type=\"button\" data-uk-close style=\"color: var(--text-sidebar-active);\"></button>\n            <div class=\"sidebar-logo\" style=\"padding: 0 16px;\">\n              <img src=\"/images/uncle-logo.svg\" alt=\"\" />\n              <span>Uncle Bike</span>\n            </div>\n            <ul class=\"uk-nav uk-nav-default sidebar-nav\" data-uk-nav>\n              <li class=\"uk-nav-header\">Overview</li>\n              <li><a href=\"/admin\" hx-get=\"/admin\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Dashboard</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Operations</li>\n              <li><a href=\"/admin/inbox\" hx-get=\"/admin/inbox\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Inbox</a></li>\n              <li><a href=\"/admin/jobs\" hx-get=\"/admin/jobs\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Jobs</a></li>\n              <li><a href=\"/admin/customers\" hx-get=\"/admin/customers\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Customers</a></li>\n              <li><a href=\"/admin/recurring\" hx-get=\"/admin/recurring\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Recurring</a></li>\n              <li><a href=\"/admin/invoices\" hx-get=\"/admin/invoices\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Invoices</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Setup</li>\n              <li><a href=\"/admin/territories\" hx-get=\"/admin/territories\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Territories</a></li>\n              <li><a href=\"/admin/services\" hx-get=\"/admin/services\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Services</a></li>\n              <li><a href=\"/admin/team\" hx-get=\"/admin/team\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Team</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Config</li>\n              <li><a href=\"/admin/branding\" hx-get=\"/admin/branding\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Branding</a></li>\n              <li><a href=\"/admin/coupons\" hx-get=\"/admin/coupons\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Coupons</a></li>\n              <li><a href=\"/admin/webhooks\" hx-get=\"/admin/webhooks\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Webhooks</a></li>\n              <li><a href=\"/admin/sms-settings\" hx-get=\"/admin/sms-settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">SMS</a></li>\n              <li><a href=\"/admin/push-settings\" hx-get=\"/admin/push-settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Push</a></li>\n              <li><a href=\"/admin/settings\" hx-get=\"/admin/settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Settings</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li>\n                <button type=\"button\" class=\"admin-theme-toggle\" onclick=\"toggleTheme()\" aria-label=\"Toggle theme\">\n                  <div class=\"theme-toggle-icon\">\n                    <div class=\"moon-or-sun\">\n                      <div class=\"moon-mask\"></div>\n                    </div>\n                  </div>\n                  <span class=\"theme-label\"></span>\n                </button>\n              </li>\n            </ul>\n          </div>\n        </div>\n        <div class=\"admin-layout\">\n          <aside class=\"desktop-sidebar\">\n            <div class=\"sidebar-logo\">\n              <img src=\"/images/uncle-logo.svg\" alt=\"\" />\n              <span>Uncle Bike</span>\n            </div>\n            <ul class=\"uk-nav uk-nav-default sidebar-nav\" data-uk-nav>\n              <li class=\"uk-nav-header\">Overview</li>\n              <li><a href=\"/admin\" hx-get=\"/admin\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Dashboard</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Operations</li>\n              <li><a href=\"/admin/inbox\" hx-get=\"/admin/inbox\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Inbox</a></li>\n              <li><a href=\"/admin/jobs\" hx-get=\"/admin/jobs\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Jobs</a></li>\n              <li><a href=\"/admin/customers\" hx-get=\"/admin/customers\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Customers</a></li>\n              <li><a href=\"/admin/recurring\" hx-get=\"/admin/recurring\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Recurring</a></li>\n              <li><a href=\"/admin/invoices\" hx-get=\"/admin/invoices\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Invoices</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Setup</li>\n              <li><a href=\"/admin/territories\" hx-get=\"/admin/territories\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Territories</a></li>\n              <li><a href=\"/admin/services\" hx-get=\"/admin/services\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Services</a></li>\n              <li><a href=\"/admin/team\" hx-get=\"/admin/team\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Team</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li class=\"uk-nav-header\">Config</li>\n              <li><a href=\"/admin/branding\" hx-get=\"/admin/branding\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Branding</a></li>\n              <li><a href=\"/admin/coupons\" hx-get=\"/admin/coupons\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Coupons</a></li>\n              <li><a href=\"/admin/webhooks\" hx-get=\"/admin/webhooks\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Webhooks</a></li>\n              <li><a href=\"/admin/sms-settings\" hx-get=\"/admin/sms-settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">SMS</a></li>\n              <li><a href=\"/admin/push-settings\" hx-get=\"/admin/push-settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Push</a></li>\n              <li><a href=\"/admin/settings\" hx-get=\"/admin/settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"outerHTML\" hx-push-url=\"true\">Settings</a></li>\n              <li class=\"uk-nav-divider\"></li>\n              <li>\n                <button type=\"button\" class=\"admin-theme-toggle\" onclick=\"toggleTheme()\" aria-label=\"Toggle theme\">\n                  <div class=\"theme-toggle-icon\">\n                    <div class=\"moon-or-sun\">\n                      <div class=\"moon-mask\"></div>\n                    </div>\n                  </div>\n                  <span class=\"theme-label\"></span>\n                </button>\n              </li>\n            </ul>\n          </aside>\n          <main class=\"main-content\" id=\"main-content\">\n            <button type=\"button\" class=\"mobile-menu-btn\" data-uk-toggle=\"target: #offcanvas-nav\" aria-label=\"Open menu\">\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><title>Menu</title><line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"/><line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\"/><line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\"/></svg>\n            </button>\n            <div id=\"page-content\">\n              {children}\n            </div>\n          </main>\n        </div>\n\n        <div id=\"sms-thread-modal-overlay\" hidden>\n          <div id=\"sms-thread-modal-panel\" role=\"dialog\" aria-modal=\"true\" aria-label=\"SMS conversation\">\n            <div id=\"sms-thread-modal-header\">\n              <h3>Conversation</h3>\n              <div id=\"sms-thread-modal-actions\">\n                <a id=\"sms-thread-modal-open-inbox\" class=\"uk-btn uk-btn-default uk-btn-sm\" href=\"/admin/inbox\" style=\"display:none;\">Inbox</a>\n                <button type=\"button\" class=\"uk-btn uk-btn-default uk-btn-sm\" data-sms-thread-modal-close aria-label=\"Close conversation\">Close</button>\n              </div>\n            </div>\n            <div id=\"sms-thread-modal-content\">\n              <div id=\"sms-thread-modal-status\">\n                <div id=\"sms-thread-modal-loading\" aria-live=\"polite\" aria-busy=\"true\">\n                  <div class=\"skel\">\n                    <div class=\"skel-row\"><div class=\"skel-dot\"></div><div class=\"skel-line w-70\"></div></div>\n                    <div class=\"skel-row\"><div class=\"skel-dot\"></div><div class=\"skel-line w-85\"></div></div>\n                    <div class=\"skel-row\"><div class=\"skel-dot\"></div><div class=\"skel-line w-45\"></div></div>\n                  </div>\n                </div>\n                <div id=\"sms-thread-modal-error\" role=\"alert\"></div>\n              </div>\n              <div id=\"sms-thread-modal-body\"></div>\n            </div>\n          </div>\n        </div>\n\n        {html`<script>\nfunction toggleTheme() {\n  var cur = document.documentElement.getAttribute('data-theme');\n  var next = cur === 'dark' ? 'light' : 'dark';\n  document.documentElement.setAttribute('data-theme', next);\n  localStorage.setItem('theme', next);\n  updateThemeLabels(next);\n  if (typeof window.__syncThemeColorMeta === 'function') {\n    window.__syncThemeColorMeta();\n  }\n}\nfunction updateThemeLabels(t) {\n  document.querySelectorAll('.theme-label').forEach(function(el) { el.textContent = t === 'dark' ? 'Light Mode' : 'Dark Mode'; });\n}\nupdateThemeLabels(document.documentElement.getAttribute('data-theme') || 'light');\nwindow.updateThemeLabels = updateThemeLabels;\nrequestAnimationFrame(function(){requestAnimationFrame(function(){document.body.classList.add('ready')})});\n</script>`}\n      </body>\n    </html>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { Fragment, jsx } from 'hono/jsx';\nimport { Layout } from './layout';\n\ntype FieldType = 'text' | 'email' | 'tel' | 'number' | 'textarea' | 'select' | 'checkbox' | 'date' | 'time' | 'hidden';\n\ninterface FormField {\n  name: string;\n  label: string;\n  type?: FieldType;\n  required?: boolean;\n  value?: string | number | boolean;\n  options?: { value: string; label: string }[];\n  placeholder?: string;\n  min?: number;\n  max?: number;\n  step?: number;\n  readonly?: boolean;\n  attrs?: Record<string, string>;\n}\n\ninterface TableViewProps {\n  title: string;\n  columns: string[];\n  rows: Record<string, unknown>[];\n  createUrl?: string;\n  extraActions?: { label: string; url: string }[];\n  detailUrlPrefix?: string;\n  deleteUrlPrefix?: string;\n  rawIds?: string[];\n}\n\nconst BADGE_STATUSES = new Set([\n  'created',\n  'assigned',\n  'enroute',\n  'in_progress',\n  'complete',\n  'cancelled',\n  'pending',\n  'sent',\n  'paid',\n  'void',\n  'active',\n  'inactive',\n  'manager',\n  'provider',\n  'zip',\n  'radius',\n  'geofence',\n  'weekly',\n  'biweekly',\n  'monthly',\n  'new',\n  'read',\n  'replied',\n  'archived',\n  'contact',\n  'newsletter',\n  'registration',\n]);\n\nconst isBadgeStatus = (value: unknown): value is string => typeof value === 'string' && BADGE_STATUSES.has(value.toLowerCase());\n\nconst isEmptyValue = (value: unknown) => value === null || value === undefined || value === '' || value === '-';\n\nconst mobilePriorityScore = (label: string) => {\n  const l = label.toLowerCase();\n  if (/(amount|price|total|value)/.test(l)) return 100;\n  if (/(status|active|state)/.test(l)) return 95;\n  if (/(date|time|booked|created|due)/.test(l)) return 90;\n  if (/(service|frequency|duration|territory|area|type|role)/.test(l)) return 80;\n  if (/(phone|email|from|subject|event)/.test(l)) return 70;\n  return 40;\n};\n\nconst stringifyValue = (value: unknown) => {\n  if (typeof value === 'string' || typeof value === 'number') return String(value);\n  if (typeof value === 'boolean') return value ? 'Yes' : 'No';\n  return '';\n};\n\nconst inferFormHints = (field: FormField): Record<string, string> => {\n  const hints: Record<string, string> = {};\n  const n = field.name.toLowerCase();\n  const t = (field.type || 'text').toLowerCase();\n\n  if (n === 'first_name') hints.autocomplete = 'given-name';\n  if (n === 'last_name') hints.autocomplete = 'family-name';\n\n  if (t === 'email' || n.includes('email')) {\n    hints.autocomplete = hints.autocomplete || 'email';\n    hints.inputmode = 'email';\n    hints.autocapitalize = 'off';\n    hints.spellcheck = 'false';\n  }\n\n  if (t === 'tel' || n.includes('phone') || n.includes('mobile')) {\n    hints.autocomplete = hints.autocomplete || 'tel';\n    hints.inputmode = 'tel';\n    hints.autocapitalize = 'off';\n    hints.spellcheck = 'false';\n  }\n\n  if (n.includes('postal')) {\n    hints.autocomplete = 'postal-code';\n    hints.autocapitalize = 'characters';\n  }\n\n  if (n === 'address_line_1') hints.autocomplete = 'address-line1';\n  if (n === 'address_line_2') hints.autocomplete = 'address-line2';\n  if (n === 'address_city') hints.autocomplete = 'address-level2';\n  if (n === 'address_state') hints.autocomplete = 'address-level1';\n  if (n.includes('country')) hints.autocomplete = 'country-name';\n\n  if (t === 'number') {\n    const isDecimal = field.step !== undefined && Number(field.step) !== 1;\n    hints.inputmode = isDecimal ? 'decimal' : 'numeric';\n  }\n\n  if (n.includes('search') || n === 'q') {\n    hints.autocomplete = 'off';\n    hints.inputmode = 'search';\n  }\n\n  return hints;\n};\n\ninterface FormViewProps {\n  title: string;\n  fields: FormField[];\n  submitUrl: string;\n  cancelUrl: string;\n  isEdit?: boolean;\n  deleteUrl?: string;\n  error?: string;\n}\n\nconst TableView = ({ title, columns, rows, createUrl, extraActions, detailUrlPrefix, deleteUrlPrefix, rawIds }: TableViewProps) => (\n  <Layout title={title}>\n    <div class=\"page-header\">\n      <h2>{title}</h2>\n      <div class=\"page-header-actions\">\n        {(extraActions || []).map((action) => (\n          <a href={action.url} class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get={action.url} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\" key={action.url}>\n            {action.label}\n          </a>\n        ))}\n        {createUrl && <a href={createUrl} class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get={createUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">+ Create New</a>}\n      </div>\n    </div>\n    <div class=\"p-8\">\n      <div class=\"uk-card uk-card-body\">\n        <section>\n          {rows.length === 0 ? (\n            <div class=\"text-center py-12 text-muted-foreground\">\n              <p class=\"mb-4 text-sm\">No {title.toLowerCase()} found.</p>\n              {createUrl && <a href={createUrl} class=\"uk-btn uk-btn-default\" hx-get={createUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Create your first</a>}\n            </div>\n          ) : (\n            <>\n               <div class=\"grid gap-3 md:hidden\">\n                 {rows.map((row: Record<string, unknown>, i: number) => {\n                   const displayId = typeof row.id === 'string' ? row.id : '';\n                   const actualId = rawIds ? rawIds[i] : displayId;\n                   const values = Object.values(row);\n                   const detailUrl = detailUrlPrefix ? `${detailUrlPrefix}/${actualId}` : null;\n                  const entries = values.map((value, index) => ({\n                    index,\n                    label: columns[index] || 'Field',\n                    value,\n                  }));\n                  const primary = entries[0];\n                  const statusEntry = entries.find((entry, index) => index > 0 && isBadgeStatus(entry.value));\n                  const compactMeta = entries\n                    .filter((entry) => entry.index !== 0 && entry !== statusEntry && !isEmptyValue(entry.value))\n                    .sort((a, b) => mobilePriorityScore(b.label) - mobilePriorityScore(a.label))\n                    .slice(0, 2);\n                   return (\n                     <article\n                       class=\"border border-border rounded-lg p-3\"\n                       style=\"background:var(--bg-card);\"\n                       key={i}\n                     >\n                       <div class=\"flex items-start justify-between gap-3\">\n                         <div class=\"min-w-0 flex-1\">\n                           {detailUrl ? (\n                             <a\n                               href={detailUrl}\n                               hx-get={detailUrl}\n                               hx-target=\"#page-content\"\n                               hx-select=\"#page-content\"\n                               hx-push-url=\"true\"\n                               class=\"uk-link font-semibold leading-snug block truncate\"\n                               style=\"color:var(--text);\"\n                               data-uk-tooltip={typeof primary?.value === 'string' && primary.value.length === 8 ? `title: ${actualId}` : undefined}\n                             >\n                               {primary?.value}\n                             </a>\n                           ) : (\n                             <p class=\"font-semibold leading-snug truncate\">{primary?.value as string | number | boolean | null | undefined}</p>\n                           )}\n                         </div>\n                         {statusEntry && (\n                           <span class=\"shrink-0\" style=\"margin-top:1px;\">\n                             <StatusBadge status={String(statusEntry.value).toLowerCase()} />\n                           </span>\n                         )}\n                       </div>\n\n                       {compactMeta.length > 0 && (\n                         <div class=\"grid grid-cols-2 gap-2 mt-2\">\n                           {compactMeta.map((entry) => (\n                             <div class=\"min-w-0\" key={entry.index}>\n                               <p class=\"text-[10px] uppercase tracking-wide text-muted-foreground truncate\">{entry.label}</p>\n                               <p class=\"text-xs font-medium truncate\">{stringifyValue(entry.value) || '-'}</p>\n                             </div>\n                           ))}\n                         </div>\n                       )}\n\n                      {!statusEntry && isBadgeStatus(primary?.value) && (\n                        <div class=\"mt-2\">\n                          <StatusBadge status={String(primary.value).toLowerCase()} />\n                        </div>\n                      )}\n\n                      {compactMeta.length === 0 && entries[1] && !isEmptyValue(entries[1].value) && (\n                        <p class=\"text-xs text-muted-foreground mt-2 truncate\">{entries[1].label}: {stringifyValue(entries[1].value)}</p>\n                      )}\n\n                       <div class=\"flex items-center justify-between gap-2 mt-3\">\n                         {detailUrl && (\n                           <a\n                             href={detailUrl}\n                             class=\"uk-btn uk-btn-default uk-btn-sm\"\n                             hx-get={detailUrl}\n                             hx-target=\"#page-content\"\n                             hx-select=\"#page-content\"\n                             hx-push-url=\"true\"\n                           >\n                             View\n                           </a>\n                         )}\n                         {deleteUrlPrefix && (\n                           <button\n                             type=\"button\"\n                             class=\"delete-btn\"\n                             data-confirm=\"arm\"\n                             hx-post={`${deleteUrlPrefix}/${actualId}/delete`}\n                             hx-target=\"closest article\"\n                             hx-swap=\"delete swap:300ms\"\n                           >\n                             Delete\n                           </button>\n                         )}\n                       </div>\n                     </article>\n                   );\n                 })}\n               </div>\n              <div class=\"uk-overflow-auto hidden md:block\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm\">\n              <thead>\n                <tr class=\"border-b border-border\">\n                  {columns.map((col: string) => <th class=\"text-left py-3 px-4 font-medium text-muted-foreground\" key={col}>{col}</th>)}\n                  <th class=\"text-left py-3 px-4 font-medium text-muted-foreground\" style=\"width: 100px;\">Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {rows.map((row: Record<string, unknown>, i: number) => {\n                  const displayId = typeof row.id === 'string' ? row.id : '';\n                  const actualId = rawIds ? rawIds[i] : displayId;\n                  const values = Object.values(row);\n                  const detailUrl = detailUrlPrefix ? `${detailUrlPrefix}/${actualId}` : null;\n                  return (\n                    <tr class=\"border-b border-border hover:bg-muted/50 transition-colors\" key={i} style={detailUrl ? 'cursor: pointer;' : ''}>\n                      {values.map((val, j: number) => (\n                        <td class=\"py-3 px-4\" key={j}>\n                           {j === 0 && detailUrl ? (\n                             <a\n                               href={detailUrl}\n                               hx-get={detailUrl}\n                               hx-target=\"#page-content\"\n                               hx-select=\"#page-content\"\n                               hx-push-url=\"true\"\n                               class=\"uk-link font-medium text-primary hover:underline\"\n                               data-uk-tooltip={typeof val === 'string' && val.length === 8 ? `title: ${actualId}` : undefined}\n                             >\n                               {val}\n                             </a>\n                           ) : (isBadgeStatus(val) ? <StatusBadge status={val.toLowerCase()} /> : (val as string | number | boolean | null | undefined))}\n                         </td>\n                       ))}\n                      <td class=\"py-3 px-4\">\n                        <div class=\"flex items-center gap-2\">\n                          {detailUrl && (\n                             <a href={detailUrl} class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get={detailUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">View</a>\n                           )}\n                          {deleteUrlPrefix && (\n                            <button\n                              type=\"button\"\n                              class=\"delete-btn\"\n                              data-confirm=\"arm\"\n                              hx-post={`${deleteUrlPrefix}/${actualId}/delete`}\n                              hx-target=\"closest tr\"\n                              hx-swap=\"delete swap:300ms\"\n                            >\n                              Delete\n                            </button>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n                </table>\n              </div>\n            </>\n          )}\n        </section>\n      </div>\n    </div>\n  </Layout>\n);\n\nconst renderField = (field: FormField) => {\n  if (field.readonly) {\n    return (\n      <p class=\"text-sm py-2 px-3 bg-muted/50 rounded-md\">{String(field.value || '-')}</p>\n    );\n  }\n\n  const baseProps = {\n    id: field.name,\n    name: field.name,\n    required: field.required,\n    placeholder: field.placeholder,\n    ...inferFormHints(field),\n    ...(field.attrs || {}),\n  };\n\n  switch (field.type) {\n    case 'textarea':\n       return (\n         <textarea {...baseProps} rows={4} class=\"uk-textarea\">\n           {field.value || ''}\n         </textarea>\n       );\n\n     case 'select':\n       return (\n         <select {...baseProps} class=\"uk-select\">\n           <option value=\"\">Select...</option>\n          {(field.options || []).map(opt => (\n            <option key={opt.value} value={opt.value} selected={field.value === opt.value}>\n              {opt.label}\n            </option>\n          ))}\n        </select>\n      );\n\n    case 'checkbox':\n      return (\n        <div class=\"flex items-center gap-2\">\n          <input \n            type=\"checkbox\" \n            id={field.name}\n            name={field.name}\n            checked={Boolean(field.value)}\n            class=\"uk-checkbox\"\n          />\n          <label for={field.name} class=\"text-sm\">{field.label}</label>\n        </div>\n      );\n\n     case 'number':\n       return (\n         <input \n           type=\"number\" \n           {...baseProps}\n           value={field.value ?? ''}\n           min={field.min}\n           max={field.max}\n           step={field.step || 1}\n           class=\"uk-input\"\n         />\n       );\n\n     case 'hidden':\n       return <input type=\"hidden\" {...baseProps} value={field.value ?? ''} />;\n\n      default:\n       return (\n         <input \n           type={field.type || 'text'} \n           {...baseProps}\n           value={field.value ?? ''}\n           class=\"uk-input\"\n         />\n       );\n  }\n};\n\nconst FormView = ({ title, fields, submitUrl, cancelUrl, isEdit, deleteUrl, error }: FormViewProps) => (\n  <Layout title={title}>\n    <div class=\"page-header\">\n      <h2>{title}</h2>\n    </div>\n    <div class=\"p-8\">\n       <div class=\"uk-card uk-card-body\" style=\"max-width: 720px;\">\n        <section>\n          <form class=\"form\" hx-post={submitUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url={cancelUrl}>\n            {error && (\n              <div class=\"mb-4 rounded-md border px-3 py-2 text-sm\" style=\"border-color: #fecaca; background: #fff1f2; color: #b91c1c;\">\n                {error}\n              </div>\n            )}\n            <div class=\"grid gap-4 sm:grid-cols-2\">\n              {fields.map((field) => {\n                if (field.type === 'hidden') {\n                  return <div key={field.name}>{renderField(field)}</div>;\n                }\n                if (field.type === 'checkbox') {\n                  const isChecked = Boolean(field.value);\n                  return (\n                    <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\" key={field.name}>\n                       <input type=\"checkbox\" name={field.name} checked={isChecked} role=\"switch\" aria-checked={isChecked ? 'true' : 'false'} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                       {field.label}\n                     </label>\n                  );\n                }\n                const wide = field.type === 'textarea' || field.type === 'select';\n                return (\n                  <div class={`grid gap-2${wide ? ' sm:col-span-2' : ''}`} key={field.name}>\n                    <label for={field.name} class=\"uk-form-label\">{field.label}{field.required && ' *'}</label>\n                    {renderField(field)}\n                    {field.name === 'address_line_1' && (\n                      <div id=\"address-results\" class=\"mt-2\" style=\"position: relative;\"></div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n            <div class=\"flex items-center gap-3 mt-6 sm:col-span-2\">\n               <button type=\"submit\" class=\"uk-btn uk-btn-primary\">{isEdit ? 'Update' : 'Create'}</button>\n               <a href={cancelUrl} class=\"uk-btn uk-btn-default\" hx-get={cancelUrl} hx-target=\"#page-content\" hx-push-url=\"true\">Cancel</a>\n              {deleteUrl && (\n                <button type=\"button\" class=\"delete-btn\" data-confirm=\"arm\" hx-post={deleteUrl} style=\"margin-left: auto;\">Delete</button>\n              )}\n            </div>\n          </form>\n        </section>\n      </div>\n    </div>\n  </Layout>\n);\n\ninterface DetailViewProps {\n  title: string;\n  subtitle?: string;\n  fields: { label: string; value: unknown }[];\n  editUrl?: string;\n  backUrl: string;\n  actions?: { label: string; url: string; method?: string; variant?: 'primary' | 'secondary' | 'danger' }[];\n}\n\nconst DetailView = ({ title, subtitle, fields, editUrl, backUrl, actions }: DetailViewProps) => (\n  <Layout title={title}>\n    <div class=\"page-header\">\n      <div class=\"page-header-info\">\n        <h2>{title}</h2>\n        {subtitle && <p class=\"text-sm text-muted-foreground\" style=\"margin:2px 0 0;\">{subtitle}</p>}\n      </div>\n      <div class=\"page-header-actions\">\n        {editUrl && (\n          <a href={editUrl} class=\"uk-btn uk-btn-primary uk-btn-sm\" hx-get={editUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">\n            Edit\n          </a>\n        )}\n        <a href={backUrl} class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get={backUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">\n          Back\n        </a>\n      </div>\n    </div>\n    <div class=\"p-4 md:p-8\">\n      <div class=\"uk-card uk-card-body\" style=\"max-width: 800px;\">\n        <div class=\"grid gap-3\">\n          {fields.map(f => (\n            <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated, var(--input-bg));\" key={f.label}>\n              <span class=\"text-xs uppercase tracking-wide text-muted-foreground\">{f.label}</span>\n              <p class=\"text-sm font-medium text-right\">{f.value || '-'}</p>\n            </div>\n          ))}\n        </div>\n      </div>\n      {actions && actions.length > 0 && (\n        <div class=\"uk-card uk-card-body danger-card\" style=\"max-width: 800px; margin-top: 24px;\">\n          <h3 class=\"text-sm font-semibold text-muted-foreground mb-3\">Actions</h3>\n          <div class=\"flex flex-wrap gap-2\">\n            {actions.map(action => {\n              const variantClass = action.variant === 'primary' ? 'uk-btn-primary' : action.variant === 'danger' ? 'delete-btn' : 'uk-btn-default';\n              const isDelete = action.variant === 'danger';\n              return (\n                <button\n                  type=\"button\"\n                  class={isDelete ? 'delete-btn' : `uk-btn ${variantClass} uk-btn-sm`}\n                  hx-post={action.url}\n                  hx-target=\"#page-content\"\n                  data-confirm={isDelete ? 'arm' : undefined}\n                  key={action.label}\n                >\n                  {action.label}\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  </Layout>\n);\n\nconst STATUS_ICON_MAP: Record<string, { cls: string; label: string }> = {\n  created:     { cls: 'status-icon--neutral',     label: 'Created' },\n  assigned:    { cls: 'status-icon--neutral',     label: 'Assigned' },\n  enroute:     { cls: 'status-icon--secondary',   label: 'En route' },\n  in_progress: { cls: 'status-icon--secondary',   label: 'In progress' },\n  complete:    { cls: 'status-icon--primary',     label: 'Complete' },\n  cancelled:   { cls: 'status-icon--destructive', label: 'Cancelled' },\n  pending:     { cls: 'status-icon--secondary',   label: 'Pending' },\n  sent:        { cls: 'status-icon--neutral',     label: 'Sent' },\n  paid:        { cls: 'status-icon--primary',     label: 'Paid' },\n  void:        { cls: 'status-icon--destructive', label: 'Void' },\n  new:         { cls: 'status-icon--destructive', label: 'New' },\n  read:        { cls: 'status-icon--secondary',   label: 'Read' },\n  replied:     { cls: 'status-icon--primary',     label: 'Replied' },\n  archived:    { cls: 'status-icon--neutral',     label: 'Archived' },\n  active:      { cls: 'status-icon--primary',     label: 'Active' },\n  inactive:    { cls: 'status-icon--secondary',   label: 'Inactive' },\n};\n\nconst svgProps = { width: '14', height: '14', viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', 'stroke-width': '2', 'stroke-linecap': 'round', 'stroke-linejoin': 'round', 'aria-hidden': 'true' };\n\nconst StatusIconSvg = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'created':\n      return <svg {...svgProps}><circle cx=\"12\" cy=\"12\" r=\"9\" /></svg>;\n    case 'assigned':\n      return <svg {...svgProps}><circle cx=\"9\" cy=\"7\" r=\"4\" /><path d=\"M2 21v-2a4 4 0 0 1 4-4h6a4 4 0 0 1 4 4v2\" /><path d=\"m16 11 2 2 4-4\" /></svg>;\n    case 'enroute':\n      return <svg {...svgProps}><path d=\"M5 12h14m-7-7 7 7-7 7\" /></svg>;\n    case 'in_progress':\n      return <svg {...svgProps}><polygon points=\"6 3 20 12 6 21 6 3\" /></svg>;\n    case 'complete':\n    case 'paid':\n      return <svg {...svgProps}><path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" /><path d=\"m22 4-10 10.01-3-3\" /></svg>;\n    case 'cancelled':\n      return <svg {...svgProps}><circle cx=\"12\" cy=\"12\" r=\"10\" /><path d=\"m15 9-6 6m0-6 6 6\" /></svg>;\n    case 'pending':\n      return <svg {...svgProps}><circle cx=\"12\" cy=\"12\" r=\"10\" /><path d=\"M12 6v6l4 2\" /></svg>;\n    case 'sent':\n      return <svg {...svgProps}><path d=\"m22 2-7 20-4-9-9-4z\" /><path d=\"M22 2 11 13\" /></svg>;\n    case 'void':\n      return <svg {...svgProps}><circle cx=\"12\" cy=\"12\" r=\"10\" /><path d=\"m4.93 4.93 14.14 14.14\" /></svg>;\n    case 'new':\n      return <svg {...svgProps} fill=\"currentColor\" stroke=\"none\"><circle cx=\"12\" cy=\"12\" r=\"5\" /></svg>;\n    case 'read':\n      return <svg {...svgProps}><path d=\"M20 6 9 17l-5-5\" /></svg>;\n    case 'replied':\n      return <svg {...svgProps}><path d=\"m9 17-5-5 5-5\" /><path d=\"M20 18v-2a4 4 0 0 0-4-4H4\" /></svg>;\n    case 'archived':\n      return <svg {...svgProps}><rect x=\"2\" y=\"3\" width=\"20\" height=\"5\" rx=\"1\" /><path d=\"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8\" /><path d=\"M10 12h4\" /></svg>;\n    case 'active':\n      return <svg {...svgProps}><path d=\"M20 6 9 17l-5-5\" /></svg>;\n    case 'inactive':\n      return <svg {...svgProps}><path d=\"M18 6 6 18M6 6l12 12\" /></svg>;\n    default:\n      return <svg {...svgProps}><circle cx=\"12\" cy=\"12\" r=\"9\" /></svg>;\n  }\n};\n\nconst StatusIcon = ({ status }: { status: string }) => {\n  const s = status.toLowerCase();\n  const info = STATUS_ICON_MAP[s] || { cls: 'status-icon--neutral', label: s.replace('_', ' ') };\n  return (\n    <span class={`status-icon ${info.cls}`} title={info.label} aria-label={info.label}>\n      <StatusIconSvg status={s} />\n    </span>\n  );\n};\n\nconst BADGE_CLASS_MAP: Record<string, string> = {\n  created: 'uk-label',\n  assigned: 'uk-label',\n  enroute: 'uk-label uk-label-secondary',\n  in_progress: 'uk-label uk-label-secondary',\n  complete: 'uk-label uk-label-primary',\n  cancelled: 'uk-label uk-label-destructive',\n  pending: 'uk-label uk-label-secondary',\n  sent: 'uk-label',\n  paid: 'uk-label uk-label-primary',\n  void: 'uk-label uk-label-destructive',\n  active: 'uk-label uk-label-primary',\n  inactive: 'uk-label uk-label-secondary',\n  manager: 'uk-label',\n  provider: 'uk-label uk-label-secondary',\n  zip: 'uk-label',\n  radius: 'uk-label uk-label-secondary',\n  geofence: 'uk-label uk-label-secondary',\n  weekly: 'uk-label',\n  biweekly: 'uk-label uk-label-secondary',\n  monthly: 'uk-label uk-label-primary',\n  new: 'uk-label uk-label-destructive',\n  read: 'uk-label uk-label-secondary',\n  replied: 'uk-label uk-label-primary',\n  archived: 'uk-label',\n  contact: 'uk-label uk-label-primary',\n  newsletter: 'uk-label uk-label-secondary',\n  registration: 'uk-label',\n};\n\nconst StatusBadge = ({ status }: { status: string }) => {\n  const s = status.toLowerCase();\n  const hasIcon = s in STATUS_ICON_MAP;\n  const label = s.replace('_', ' ');\n  return (\n    <span class={BADGE_CLASS_MAP[s] || 'uk-label'}>\n      {hasIcon && <StatusIconSvg status={s} />}\n      {label}\n    </span>\n  );\n};\n\nexport { TableView, FormView, DetailView, StatusBadge, StatusIcon };\nexport type { FormField, TableViewProps, FormViewProps, DetailViewProps };\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { Layout } from './layout';\n\nexport const BrandingPage = ({ primaryColor }: { primaryColor: string }) => {\n  const initialColor = /^#[0-9a-fA-F]{6}$/.test(primaryColor) ? primaryColor : '#2563eb';\n\n  return (\n    <Layout title=\"Branding\">\n      <div class=\"page-header\">\n        <h2>Branding</h2>\n      </div>\n\n      <div class=\"p-8\">\n        <div class=\"uk-card uk-card-body\">\n          <section id=\"branding-settings\">\n            <form\n              class=\"autosave\"\n              hx-post=\"/admin/branding\"\n              hx-swap=\"none\"\n              hx-trigger=\"input delay:500ms, change\"\n              hx-sync=\"this:queue last\"\n            >\n              <div class=\"flex items-center justify-between mb-4\">\n                <h3 class=\"text-base font-semibold\">Widget Appearance</h3>\n                <span class=\"save-indicator\"></span>\n              </div>\n\n              <div class=\"grid grid-cols-1 md:grid-cols-[220px_1fr] gap-4 items-end\">\n                <div class=\"grid gap-2\">\n                  <label class=\"uk-form-label\" for=\"widget-primary-color\">Widget Primary Colour</label>\n                  <input\n                    id=\"widget-primary-color\"\n                    name=\"primaryColor\"\n                    type=\"color\"\n                    class=\"uk-input\"\n                    value={initialColor}\n                  />\n                </div>\n\n                <div class=\"grid gap-2\">\n                  <label class=\"uk-form-label\" for=\"widget-primary-color-text\">Hex Value</label>\n                  <input\n                    id=\"widget-primary-color-text\"\n                    type=\"text\"\n                    class=\"uk-input\"\n                    value={initialColor}\n                    inputmode=\"text\"\n                    maxlength={7}\n                    pattern=\"^#[0-9a-fA-F]{6}$\"\n                  />\n                </div>\n              </div>\n\n              <div class=\"mt-6 grid gap-3\">\n                <span class=\"uk-form-label mb-0\">Live Preview</span>\n                <button\n                  id=\"widget-primary-color-preview\"\n                  type=\"button\"\n                  class=\"uk-btn uk-btn-primary\"\n                  style={`background:${initialColor};border-color:${initialColor};`}\n                >\n                  Book Now\n                </button>\n                <p class=\"text-sm text-muted-foreground mb-0\">This is how your booking widget buttons will look.</p>\n              </div>\n            </form>\n          </section>\n        </div>\n      </div>\n\n      <script>{`\n        (function() {\n          var colorInput = document.getElementById('widget-primary-color');\n          var textInput = document.getElementById('widget-primary-color-text');\n          var preview = document.getElementById('widget-primary-color-preview');\n          if (!colorInput || !textInput || !preview) return;\n\n          function applyColor(value) {\n            preview.style.backgroundColor = value;\n            preview.style.borderColor = value;\n          }\n\n          function normalizeHex(value) {\n            if (!value) return '';\n            var normalized = String(value).trim();\n            if (normalized[0] !== '#') normalized = '#' + normalized;\n            return normalized.slice(0, 7);\n          }\n\n          colorInput.addEventListener('input', function() {\n            var value = colorInput.value;\n            textInput.value = value;\n            applyColor(value);\n          });\n\n          textInput.addEventListener('input', function() {\n            var value = normalizeHex(textInput.value);\n            textInput.value = value;\n            if (/^#[0-9a-fA-F]{6}$/.test(value)) {\n              colorInput.value = value;\n              applyColor(value);\n            }\n          });\n\n          textInput.addEventListener('change', function() {\n            if (!/^#[0-9a-fA-F]{6}$/.test(textInput.value)) {\n              textInput.value = colorInput.value;\n            }\n            applyColor(colorInput.value);\n          });\n\n          applyColor(colorInput.value);\n        })();\n      `}</script>\n    </Layout>\n  );\n};\n", "export const TORONTO_TIME_ZONE = 'America/Toronto';\n\nconst DATE_ONLY_RE = /^\\d{4}-\\d{2}-\\d{2}$/;\n\nfunction parseDateInput(input: string | Date): Date | null {\n  const value = input instanceof Date\n    ? input\n    : DATE_ONLY_RE.test(input)\n      ? new Date(`${input}T12:00:00Z`)\n      : new Date(input);\n  return Number.isNaN(value.getTime()) ? null : value;\n}\n\nexport function formatTorontoDate(\n  input: string | Date,\n  options: Intl.DateTimeFormatOptions,\n  locale = 'en-CA'\n): string | null {\n  const parsed = parseDateInput(input);\n  if (!parsed) return null;\n  return parsed.toLocaleDateString(locale, { timeZone: TORONTO_TIME_ZONE, ...options });\n}\n\nexport function formatTorontoTime(\n  input: string | Date,\n  options: Intl.DateTimeFormatOptions,\n  locale = 'en-CA'\n): string | null {\n  const parsed = parseDateInput(input);\n  if (!parsed) return null;\n  return parsed.toLocaleTimeString(locale, { timeZone: TORONTO_TIME_ZONE, ...options });\n}\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { formatTorontoDate, formatTorontoTime } from '../utils/datetime';\nimport { StatusIcon } from './components';\nimport { Layout } from './layout';\n\ninterface Message {\n  id: string;\n  source: string;\n  status: string;\n  first_name: string | null;\n  last_name: string | null;\n  email: string | null;\n  phone: string | null;\n  postal_code: string | null;\n  reason: string | null;\n  subject: string | null;\n  body: string | null;\n  metadata: string | null;\n  is_read: number;\n  read_at: string | null;\n  replied_at: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface SmsLogRow {\n  id: string;\n  direction: string;\n  body: string;\n  status: string;\n  created_at: string;\n  segments: number;\n}\n\ninterface Props {\n  message: Message;\n  smsHistory: SmsLogRow[];\n  twilioEnabled: boolean;\n  phoneE164: string | null;\n  jobOptions: Array<{ id: string; label: string }>;\n  selectedJobId: string | null;\n  completedTaskSmsIds: string[];\n  sendResult?: { success: boolean; error?: string } | null;\n  taskResult?: { success: boolean; error?: string; message?: string } | null;\n}\n\ninterface MessageMeta {\n  street_address?: string;\n  apt_suite?: string;\n  city?: string;\n  province?: string;\n  country?: string;\n  company?: string;\n  other?: string;\n}\n\nconst sourceBadge = (source: string) => {\n  const cls: Record<string, string> = {\n    contact: 'uk-label uk-label-primary',\n    newsletter: 'uk-label uk-label-secondary',\n    registration: 'uk-label',\n    sms: 'uk-label uk-label-secondary',\n  };\n  return <span class={cls[source] || 'uk-label'}>{source}</span>;\n};\n\nconst statusBadge = (status: string) => {\n  const cls: Record<string, string> = {\n    new: 'uk-label uk-label-destructive',\n    read: 'uk-label uk-label-secondary',\n    replied: 'uk-label uk-label-primary',\n    archived: 'uk-label',\n  };\n  if (status === 'read') {\n    return <StatusIcon status=\"read\" />;\n  }\n  return <span class={cls[status] || 'uk-label'}>{status}</span>;\n};\n\nconst smsStatusBadge = (status: string) => {\n  if (status === 'sent') {\n    return (\n      <span title=\"sent\" style=\"display:inline-flex;align-items:center;opacity:0.88;color:inherit;\">\n        <svg width=\"13\" height=\"13\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n          <path d=\"M20 6L9 17L4 12\"></path>\n        </svg>\n      </span>\n    );\n  }\n  if (status === 'delivered') {\n    return (\n      <span title=\"delivered\" style=\"display:inline-flex;align-items:center;opacity:0.94;color:inherit;\">\n        <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n          <path d=\"M18 7L9 16L6 13\"></path>\n          <path d=\"M22 7L13 16L12 15\"></path>\n        </svg>\n      </span>\n    );\n  }\n  const map: Record<string, { cls: string; label: string }> = {\n    failed: { cls: 'uk-label uk-label-destructive', label: 'failed' },\n    undelivered: { cls: 'uk-label uk-label-destructive', label: 'undelivered' },\n    queued: { cls: 'uk-label', label: 'queued' },\n    received: { cls: 'uk-label uk-label-secondary', label: 'received' },\n  };\n  const info = map[status] || { cls: 'uk-label', label: status };\n  return <span class={info.cls} style=\"font-size:10px;padding:1px 6px;\">{info.label}</span>;\n};\n\nconst formatDate = (d: string | null) => {\n  if (!d) return '-';\n  return formatTorontoDate(`${d}Z`, { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' }) || '-';\n};\n\nconst formatTime = (d: string) => {\n  return formatTorontoTime(`${d}Z`, { hour: '2-digit', minute: '2-digit' }) || d;\n};\n\nconst smsBodyText = (sms: SmsLogRow) => (typeof sms.body === 'string' ? sms.body.trim() : '');\n\nexport const SmsHistoryList = ({\n  smsHistory,\n  messageId,\n  canCreateTask,\n  jobOptions,\n  selectedJobId,\n  completedTaskSmsIds,\n}: {\n  smsHistory: SmsLogRow[];\n  messageId: string;\n  canCreateTask: boolean;\n  jobOptions: Array<{ id: string; label: string }>;\n  selectedJobId: string | null;\n  completedTaskSmsIds: string[];\n}) => {\n  const completedSet = new Set(completedTaskSmsIds);\n  return (\n    <div style=\"display:flex;flex-direction:column;gap:8px;\">\n      {smsHistory.length > 0 && (\n        smsHistory\n          .filter((sms) => smsBodyText(sms).length > 0)\n          .map((sms) => {\n            const taskCompleted = completedSet.has(sms.id);\n            return (\n              <div key={sms.id} style={`display:flex;${sms.direction === 'outbound' ? 'justify-content:flex-end;' : 'justify-content:flex-start;'}`}>\n                <div style={`max-width:80%;padding:8px 12px;border-radius:12px;display:flex;flex-direction:column;gap:6px;${sms.direction === 'outbound'\n                  ? 'background:var(--brand,#dc8a78);color:var(--on-brand, #1e1e2e);border:1px solid rgba(0,0,0,0.06);border-bottom-right-radius:4px;'\n                  : 'background:var(--surface-elevated,#eff1f5);color:var(--text-primary,#333);border:1px solid var(--border,#ccd0da);border-bottom-left-radius:4px;'}`}>\n                  <div class=\"text-sm\" style=\"white-space:pre-wrap;word-break:break-word;\">{smsBodyText(sms)}</div>\n                  <div style=\"display:flex;align-items:center;justify-content:space-between;gap:8px;\">\n                    <span style={`font-size:11px;opacity:0.7;${sms.direction === 'outbound' ? 'color:#fff;' : ''}`}>{formatTime(sms.created_at)}</span>\n                    <div style=\"display:flex;align-items:center;gap:6px;\">\n                      {sms.direction === 'outbound' && smsStatusBadge(sms.status)}\n                      {sms.direction === 'inbound' && canCreateTask && !taskCompleted && (\n                        <button\n                          type=\"button\"\n                          class=\"uk-btn uk-btn-default uk-btn-small\"\n                          data-sms-task-url={`/admin/inbox/${messageId}/sms-task`}\n                          data-sms-log-id={sms.id}\n                          data-selected-job-id={selectedJobId || ''}\n                          data-job-options={JSON.stringify(jobOptions)}\n                          data-task-suggested-title={smsBodyText(sms).replace(/\\s+/g, ' ').slice(0, 72)}\n                          aria-label=\"Add task to job\"\n                          title=\"Add task to job\"\n                          style=\"padding:0;min-height:24px;min-width:24px;width:24px;height:24px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;\"\n                        >\n                          <svg width=\"13\" height=\"13\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n                            <path d=\"M12 5V19\"></path>\n                            <path d=\"M5 12H19\"></path>\n                          </svg>\n                        </button>\n                      )}\n                      {sms.direction === 'inbound' && canCreateTask && taskCompleted && (\n                        <span\n                          class=\"uk-label uk-label-secondary\"\n                          title=\"Task complete\"\n                          style=\"padding:0;min-width:24px;height:24px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;background:rgba(34,197,94,0.14);color:#15803d;border:1px solid rgba(21,128,61,0.35);\"\n                        >\n                          <svg width=\"13\" height=\"13\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n                            <path d=\"M20 6L9 17L4 12\"></path>\n                          </svg>\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })\n      )}\n    </div>\n  );\n};\n\nexport const SmsThreadPanel = ({ messageId, smsHistory, twilioEnabled, phoneE164, customerName, jobOptions, selectedJobId, completedTaskSmsIds, sendResult, taskResult }: {\n  messageId: string;\n  smsHistory: SmsLogRow[];\n  twilioEnabled: boolean;\n  phoneE164: string | null;\n  customerName?: string | null;\n  jobOptions: Array<{ id: string; label: string }>;\n  selectedJobId: string | null;\n  completedTaskSmsIds: string[];\n  sendResult?: { success: boolean; error?: string } | null;\n  taskResult?: { success: boolean; error?: string; message?: string } | null;\n}) => {\n  if (!twilioEnabled || !phoneE164) return null;\n  const visibleSms = smsHistory.filter((sms) => smsBodyText(sms).length > 0);\n  const lastSms = visibleSms.length > 0 ? visibleSms[visibleSms.length - 1] : null;\n  const canCreateTask = jobOptions.length > 0;\n\n  return (\n  <div id=\"sms-thread-panel\" class=\"uk-card uk-card-body\">\n     <div class=\"flex items-start justify-between gap-3 pb-3 mb-3\" style=\"border-bottom:1px solid var(--border);\" data-sms-thread-header=\"1\">\n      <div class=\"min-w-0\">\n        <p class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Thread</p>\n        {customerName && (\n          <span data-sms-thread-customer-name=\"1\" style=\"display:none;\">{customerName}</span>\n        )}\n        <h3 class=\"text-sm font-semibold truncate\" style=\"margin-top:2px;\" data-sms-thread-phone=\"1\">{phoneE164}</h3>\n        <p class=\"text-xs text-muted-foreground\" style=\"margin-top:2px;\">\n          {visibleSms.length} message{visibleSms.length === 1 ? '' : 's'}\n          {lastSms ? ` \u2022 Last ${formatTime(lastSms.created_at)}` : ''}\n        </p>\n      </div>\n      <div class=\"flex items-center gap-2 shrink-0\">\n        <button\n          type=\"button\"\n          class=\"uk-btn uk-btn-default uk-btn-sm\"\n          data-sms-thread-modal-open=\"move\"\n          data-sms-thread-modal-title={customerName || ''}\n          aria-label=\"Open conversation full screen\"\n          style=\"padding:0 10px;\"\n        >\n          Full screen\n        </button>\n        <span class=\"uk-label uk-label-secondary\">Live</span>\n      </div>\n    </div>\n\n    {sendResult && !sendResult.success && (\n      <div class=\"text-sm mb-3 px-3 py-2 rounded bg-red-50 text-red-700\" data-sms-send-result=\"error\" style=\"background:rgba(239,68,68,0.1);color:#dc2626;\">\n        {`Failed: ${sendResult.error}`}\n      </div>\n    )}\n\n    {taskResult && (\n      <div class={`text-sm mb-3 px-3 py-2 rounded ${taskResult.success ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`}\n           style={taskResult.success ? 'background:rgba(34,197,94,0.1);color:#15803d;' : 'background:rgba(239,68,68,0.1);color:#dc2626;'}>\n        {taskResult.success ? (taskResult.message || 'Task added to job') : `Task not added: ${taskResult.error}`}\n      </div>\n    )}\n\n    {!canCreateTask && (\n      <p class=\"text-xs text-muted-foreground mb-3\" style=\"margin-top:0;\">No jobs found for this customer yet.</p>\n    )}\n\n    <div data-sms-thread-body=\"1\">\n      {(visibleSms.length > 0 || sendResult) && (\n        <div\n          id=\"sms-history-scroll\"\n          style=\"max-height:400px;overflow-y:auto;padding:8px 0;\"\n        >\n          <div\n            id=\"sms-history\"\n            hx-get={`/admin/inbox/${messageId}/sms-thread`}\n            hx-trigger=\"load, every 5s\"\n            hx-vals={`js:{_ts: Date.now()}`}\n            hx-swap=\"innerHTML\"\n          >\n            <SmsHistoryList\n              smsHistory={smsHistory}\n              messageId={messageId}\n              canCreateTask={canCreateTask}\n              jobOptions={jobOptions}\n              selectedJobId={selectedJobId}\n              completedTaskSmsIds={completedTaskSmsIds}\n            />\n          </div>\n        </div>\n      )}\n      <form\n        hx-post={`/admin/inbox/${messageId}/sms-reply`}\n        hx-target=\"#sms-thread-panel\"\n        hx-swap=\"outerHTML\"\n        style=\"margin-top:12px;display:flex;flex-direction:column;gap:8px;\"\n      >\n        <textarea\n          name=\"sms_body\"\n          class=\"uk-textarea\"\n          rows={3}\n          placeholder=\"Write a reply...\"\n          style=\"resize:vertical;min-height:84px;font-size:16px;\"\n          maxlength={1600}\n          oninput=\"var c=this.value.length;var s=c<=160?1:Math.ceil(c/153);var n=this.form&&this.form.querySelector('[data-sms-counter]');if(n){n.textContent=c+' chars \u00B7 '+s+' segment'+(s>1?'s':'');}\"\n        ></textarea>\n        <div class=\"flex items-center justify-between gap-3\" style=\"flex-wrap:wrap;\">\n          <span class=\"text-xs text-muted-foreground\" data-sms-counter>0 chars \u00B7 1 segment</span>\n          <button\n            type=\"submit\"\n            class=\"uk-btn uk-btn-primary uk-btn-sm\"\n            data-sms-send-success={sendResult?.success ? 'true' : 'false'}\n            style={sendResult?.success\n              ? 'min-width:110px;background:#16a34a;border-color:#15803d;color:#fff;'\n              : 'min-width:110px;'}\n          >\n            Send\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n  );\n};\n\nexport const MessageDetailPage = ({ message, smsHistory, twilioEnabled, phoneE164, jobOptions, selectedJobId, completedTaskSmsIds, sendResult, taskResult }: Props) => {\n  let meta: MessageMeta | null = null;\n  if (message.metadata) {\n    try {\n      meta = JSON.parse(message.metadata) as MessageMeta;\n    } catch {\n      meta = null;\n    }\n  }\n  const senderName = [message.first_name, message.last_name].filter(Boolean).join(' ') || message.email || 'Unknown';\n  const showMessageBody = Boolean(message.body && message.body.trim().length > 0);\n  const hasSmsContent = smsHistory.some((sms) => sms.body && sms.body.trim().length > 0);\n  const showSmsPanel = twilioEnabled && !!phoneE164 && (hasSmsContent || !!sendResult || !!taskResult);\n  const hasMetaDetails = Boolean(\n    meta && Object.values(meta).some((val) => typeof val === 'string' && val.trim().length > 0)\n  );\n\n  return (\n    <Layout title={`Message \u2014 ${senderName}`}>\n      <div class=\"page-header\">\n        <div class=\"page-header-info\">\n          <h2 style=\"white-space:normal;word-break:break-word;\">{senderName}</h2>\n        </div>\n        <div class=\"page-header-actions\">\n          {message.status !== 'archived' && (\n            <button\n              type=\"button\"\n              class=\"uk-btn uk-btn-default uk-btn-sm\"\n              hx-post={`/admin/inbox/${message.id}/archive`}\n              hx-target=\"#page-content\"\n              hx-select=\"#page-content\"\n              aria-label=\"Archive message\"\n              title=\"Archive message\"\n              style=\"padding:0 10px;\"\n            >\n              <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n                <rect x=\"3\" y=\"4\" width=\"18\" height=\"4\" rx=\"1\"></rect>\n                <path d=\"M5 8V20H19V8\"></path>\n                <path d=\"M10 12H14\"></path>\n              </svg>\n            </button>\n          )}\n          <a\n            href=\"/admin/inbox\"\n            class=\"uk-btn uk-btn-default uk-btn-sm\"\n            hx-get=\"/admin/inbox\"\n            hx-target=\"#page-content\"\n            hx-select=\"#page-content\"\n            hx-push-url=\"true\"\n            aria-label=\"Back to inbox\"\n            title=\"Back to inbox\"\n            style=\"padding:0 10px;position:relative;\"\n          >\n            <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n              <path d=\"M15 18L9 12L15 6\"></path>\n            </svg>\n            <span style=\"position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;\">Back to inbox</span>\n          </a>\n        </div>\n      </div>\n\n      <div class=\"p-4 md:p-8\" style=\"padding-bottom:96px;\">\n        <div class=\"grid gap-4 md:gap-6\" style=\"max-width: 800px;\">\n\n          <div class=\"uk-card uk-card-body\">\n            <div class=\"flex items-start justify-between gap-3 mb-2\">\n              <div class=\"min-w-0\">\n                <p class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Sender</p>\n                <h3 class=\"text-sm font-semibold leading-tight break-words\" style=\"margin-top:2px;\">{senderName}</h3>\n              </div>\n              <div class=\"flex flex-wrap justify-end items-center gap-1.5 shrink-0\" style=\"max-width:52%;\">\n                {sourceBadge(message.source)}\n                {statusBadge(message.status)}\n              </div>\n            </div>\n            <p class=\"text-xs text-muted-foreground\" style=\"margin-bottom:10px;\">Received {formatDate(message.created_at)}</p>\n\n            <div class=\"grid gap-1.5 text-sm\">\n              {message.first_name && (\n                <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated);\">\n                  <span class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Name</span>\n                  <p class=\"font-medium leading-tight break-words text-right\">{message.first_name} {message.last_name}</p>\n                </div>\n              )}\n              {message.email && (\n                <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated);\">\n                  <span class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Email</span>\n                  <p class=\"font-medium leading-tight text-right\" style=\"max-width:70%;\"><a href={`mailto:${message.email}`} class=\"uk-link break-all\">{message.email}</a></p>\n                </div>\n              )}\n              {message.phone && (\n                <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated);\">\n                  <span class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Phone</span>\n                  <p class=\"font-medium leading-tight text-right\"><a href={`tel:${message.phone}`} class=\"uk-link\">{message.phone}</a></p>\n                </div>\n              )}\n              {message.postal_code && (\n                <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated);\">\n                  <span class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Postal</span>\n                  <p class=\"font-medium leading-tight text-right\">{message.postal_code}</p>\n                </div>\n              )}\n              {message.reason && (\n                <div class=\"flex items-start justify-between gap-3 rounded-md px-2.5 py-1.5\" style=\"background:var(--surface-elevated);\">\n                  <span class=\"text-[11px] uppercase tracking-wide text-muted-foreground\">Reason</span>\n                  <p class=\"font-medium leading-tight text-right\" style=\"text-transform: capitalize;\">{message.reason}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {showMessageBody && (\n            <div class=\"uk-card uk-card-body\">\n              <h3 class=\"text-base font-semibold mb-4\">Message</h3>\n              <div class=\"text-sm leading-relaxed whitespace-pre-wrap\" style=\"color: #333;\">{message.body}</div>\n            </div>\n          )}\n\n          {hasMetaDetails && meta && (\n            <div class=\"uk-card uk-card-body\">\n              <h3 class=\"text-base font-semibold mb-4\">Additional Details</h3>\n              <div class=\"grid gap-3 sm:grid-cols-2 text-sm\">\n                {meta.street_address && (\n                  <div>\n                    <span class=\"text-muted-foreground\">Street Address</span>\n                    <p class=\"font-medium\">{meta.street_address}</p>\n                  </div>\n                )}\n                {meta.apt_suite && (\n                  <div>\n                    <span class=\"text-muted-foreground\">Apt/Suite</span>\n                    <p class=\"font-medium\">{meta.apt_suite}</p>\n                  </div>\n                )}\n                {meta.city && (\n                  <div>\n                    <span class=\"text-muted-foreground\">City</span>\n                    <p class=\"font-medium\">{meta.city}</p>\n                  </div>\n                )}\n                {meta.province && (\n                  <div>\n                    <span class=\"text-muted-foreground\">Province</span>\n                    <p class=\"font-medium\">{meta.province}</p>\n                  </div>\n                )}\n                {meta.country && (\n                  <div>\n                    <span class=\"text-muted-foreground\">Country</span>\n                    <p class=\"font-medium\">{meta.country}</p>\n                  </div>\n                )}\n                {meta.company && (\n                  <div>\n                    <span class=\"text-muted-foreground\">Company</span>\n                    <p class=\"font-medium\">{meta.company}</p>\n                  </div>\n                )}\n                {meta.other && (\n                  <div class=\"sm:col-span-2\">\n                    <span class=\"text-muted-foreground\">Other</span>\n                    <p class=\"font-medium\">{meta.other}</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {showSmsPanel && (\n            <SmsThreadPanel\n              messageId={message.id}\n              smsHistory={smsHistory}\n              twilioEnabled={twilioEnabled}\n              phoneE164={phoneE164}\n              customerName={senderName}\n              jobOptions={jobOptions}\n              selectedJobId={selectedJobId}\n              completedTaskSmsIds={completedTaskSmsIds}\n              sendResult={sendResult}\n              taskResult={taskResult}\n            />\n          )}\n\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { formatTorontoDate } from '../utils/datetime';\n// biome-ignore lint/correctness/noUnusedImports: StatusIcon is reserved for header icons\nimport { StatusBadge, StatusIcon } from './components';\nimport { Layout } from './layout';\n\ninterface DashboardProps {\n  stats: {\n    todayJobs: number;\n    weekJobs: number;\n    totalCustomers: number;\n    activeTerritories: number;\n    activeProviders: number;\n    pendingInvoices: number;\n  };\n  upcomingJobs: Array<{\n    id: string;\n    customer_name: string;\n    service_name?: string;\n    scheduled_date: string;\n    scheduled_start_time: string;\n    status: string;\n  }>;\n  recentBookings: Array<{\n    id: string;\n    customer_name: string;\n    service_name?: string;\n    territory_name?: string;\n    status: string;\n    created_at: string;\n    total_price_cents: number;\n  }>;\n  recentMessages: Array<{\n    id: string;\n    first_name?: string;\n    last_name?: string;\n    email?: string;\n    subject: string;\n    is_read: number;\n    created_at: string;\n  }>;\n}\n\nconst money = (cents: number) => `$${(cents / 100).toFixed(2)}`;\n\nconst shortDate = (input: string) => {\n  return formatTorontoDate(input, { month: 'short', day: 'numeric' }) || input;\n};\n\nconst shortTime = (input: string) => {\n  const [hourText = '', minuteText = ''] = input.split(':');\n  const hour = Number(hourText);\n  const minute = Number(minuteText);\n  if (Number.isNaN(hour) || Number.isNaN(minute)) return input;\n  const period = hour >= 12 ? 'PM' : 'AM';\n  const clockHour = hour % 12 || 12;\n  return `${clockHour}:${String(minute).padStart(2, '0')} ${period}`;\n};\n\nexport const Dashboard = ({ stats, upcomingJobs, recentBookings, recentMessages }: DashboardProps) => {\n  const statCards = [\n    { label: 'Jobs Today', value: stats.todayJobs },\n    { label: 'Jobs This Week', value: stats.weekJobs },\n    { label: 'Total Customers', value: stats.totalCustomers },\n    { label: 'Active Territories', value: stats.activeTerritories },\n    { label: 'Active Providers', value: stats.activeProviders },\n    { label: 'Pending Invoices', value: stats.pendingInvoices },\n  ];\n\n  return (\n    <Layout title=\"Dashboard\">\n      <div class=\"page-header\">\n        <h2>Dashboard</h2>\n        <div class=\"page-header-actions\">\n          <a\n            href=\"/admin/jobs/new\"\n            class=\"uk-btn uk-btn-primary uk-btn-sm\"\n            hx-get=\"/admin/jobs/new\"\n            hx-target=\"#page-content\"\n            hx-select=\"#page-content\"\n            hx-push-url=\"true\"\n          >\n            + New Job\n          </a>\n        </div>\n      </div>\n\n      <div class=\"p-4 md:p-8\">\n        <div class=\"grid gap-4 md:gap-6\">\n          <div class=\"grid grid-cols-2 gap-2.5 md:gap-4 xl:grid-cols-3\">\n            {statCards.map((card) => (\n              <div class=\"uk-card uk-card-body\" key={card.label}>\n                <p class=\"text-2xl md:text-3xl font-semibold leading-none\">{card.value}</p>\n                <p class=\"text-xs md:text-sm text-muted-foreground mt-1.5 md:mt-2\">{card.label}</p>\n              </div>\n            ))}\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <h3 class=\"text-base font-semibold mb-4\">Upcoming Jobs</h3>\n            {upcomingJobs.length === 0 ? (\n              <p class=\"text-sm text-muted-foreground\">No upcoming jobs in the next 7 days.</p>\n            ) : (\n              <>\n                <div class=\"grid gap-2.5 md:hidden\">\n                  {upcomingJobs.map((job) => (\n                    <article class=\"rounded-md border border-border p-3\" key={job.id}>\n                      <div class=\"flex items-start justify-between gap-3\">\n                        <a\n                          href={`/admin/jobs/${job.id}`}\n                          class=\"uk-link font-medium leading-tight min-w-0 flex-1 break-words\"\n                          hx-get={`/admin/jobs/${job.id}`}\n                          hx-target=\"#page-content\"\n                          hx-select=\"#page-content\"\n                          hx-push-url=\"true\"\n                        >\n                          {job.customer_name}\n                        </a>\n                        <span class=\"shrink-0\"><StatusBadge status={job.status} /></span>\n                      </div>\n                      <p class=\"text-xs text-muted-foreground mt-1.5\">\n                        {shortDate(job.scheduled_date)} at {shortTime(job.scheduled_start_time)}\n                      </p>\n                    </article>\n                  ))}\n                </div>\n                <div class=\"uk-overflow-auto hidden md:block\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Customer</th>\n                      <th class=\"text-left\">Service</th>\n                      <th class=\"text-left\">Date</th>\n                      <th class=\"text-left\">Time</th>\n                      <th class=\"text-left\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {upcomingJobs.map((job) => (\n                      <tr key={job.id}>\n                        <td>\n                          <a\n                            href={`/admin/jobs/${job.id}`}\n                            class=\"uk-link font-medium\"\n                            hx-get={`/admin/jobs/${job.id}`}\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                            hx-push-url=\"true\"\n                          >\n                            {job.customer_name}\n                          </a>\n                        </td>\n                        <td>{job.service_name || 'Custom Service'}</td>\n                        <td>{shortDate(job.scheduled_date)}</td>\n                        <td>{job.scheduled_start_time}</td>\n                        <td>\n                          <StatusBadge status={job.status} />\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                </div>\n              </>\n            )}\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <h3 class=\"text-base font-semibold mb-4\">Recent Bookings</h3>\n            {recentBookings.length === 0 ? (\n              <p class=\"text-sm text-muted-foreground\">No recent bookings.</p>\n            ) : (\n              <>\n                <div class=\"grid gap-2.5 md:hidden\">\n                  {recentBookings.map((job) => (\n                    <article class=\"rounded-md border border-border p-3\" key={job.id}>\n                      <div class=\"flex items-start justify-between gap-3\">\n                        <a\n                          href={`/admin/jobs/${job.id}`}\n                          class=\"uk-link font-medium leading-tight min-w-0 flex-1 break-words\"\n                          hx-get={`/admin/jobs/${job.id}`}\n                          hx-target=\"#page-content\"\n                          hx-select=\"#page-content\"\n                          hx-push-url=\"true\"\n                        >\n                          {job.customer_name}\n                        </a>\n                        <span class=\"shrink-0\"><StatusBadge status={job.status} /></span>\n                      </div>\n                      <p class=\"text-xs text-muted-foreground mt-1 truncate\">{job.service_name || 'Custom Service'}</p>\n                      <div class=\"flex items-center justify-between mt-1.5 text-xs text-muted-foreground\">\n                        <span>Booked {shortDate(job.created_at)}</span>\n                        <span class=\"font-medium text-foreground shrink-0 ml-2\">{money(job.total_price_cents)}</span>\n                      </div>\n                    </article>\n                  ))}\n                </div>\n                <div class=\"uk-overflow-auto hidden md:block\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Customer</th>\n                      <th class=\"text-left\">Service</th>\n                      <th class=\"text-left\">Territory</th>\n                      <th class=\"text-left\">Status</th>\n                      <th class=\"text-left\">Booked</th>\n                      <th class=\"text-left\">Total</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {recentBookings.map((job) => (\n                      <tr key={job.id}>\n                        <td>\n                          <a\n                            href={`/admin/jobs/${job.id}`}\n                            class=\"uk-link font-medium\"\n                            hx-get={`/admin/jobs/${job.id}`}\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                            hx-push-url=\"true\"\n                          >\n                            {job.customer_name}\n                          </a>\n                        </td>\n                        <td>{job.service_name || 'Custom Service'}</td>\n                        <td>{job.territory_name || '-'}</td>\n                        <td>\n                          <StatusBadge status={job.status} />\n                        </td>\n                        <td>{shortDate(job.created_at)}</td>\n                        <td>{money(job.total_price_cents)}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                </div>\n              </>\n            )}\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <h3 class=\"text-base font-semibold mb-4\">Recent Messages</h3>\n            {recentMessages.length === 0 ? (\n              <p class=\"text-sm text-muted-foreground\">No recent messages.</p>\n            ) : (\n              <>\n                <div class=\"grid gap-2.5 md:hidden\">\n                  {recentMessages.map((msg) => (\n                    <article class=\"rounded-md border border-border p-3\" key={msg.id}>\n                      <div class=\"flex items-start justify-between gap-3\">\n                        <a\n                          href={`/admin/inbox/${msg.id}`}\n                          class={`uk-link leading-tight min-w-0 flex-1 break-words ${msg.is_read === 0 ? 'font-semibold' : 'font-medium'}`}\n                          hx-get={`/admin/inbox/${msg.id}`}\n                          hx-target=\"#page-content\"\n                          hx-select=\"#page-content\"\n                          hx-push-url=\"true\"\n                        >\n                          {(msg.first_name && msg.last_name) ? `${msg.first_name} ${msg.last_name}` : msg.email || 'Unknown'}\n                        </a>\n                        <span class={`shrink-0 ${msg.is_read === 0 ? 'uk-label' : 'uk-label uk-label-primary'}`}>{msg.is_read === 0 ? 'Unread' : 'Read'}</span>\n                      </div>\n                      <p class=\"text-sm mt-1 truncate min-w-0\">{msg.subject}</p>\n                      <p class=\"text-xs text-muted-foreground mt-1.5\">{shortDate(msg.created_at)}</p>\n                    </article>\n                  ))}\n                </div>\n                <div class=\"uk-overflow-auto hidden md:block\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm w-full text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">From</th>\n                      <th class=\"text-left\">Subject</th>\n                      <th class=\"text-left\">Date</th>\n                      <th class=\"text-left\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {recentMessages.map((msg) => (\n                      <tr key={msg.id} class={msg.is_read === 0 ? 'font-semibold' : ''}>\n                        <td>\n                          <a\n                            href={`/admin/inbox/${msg.id}`}\n                            class=\"uk-link font-medium\"\n                            hx-get={`/admin/inbox/${msg.id}`}\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                            hx-push-url=\"true\"\n                          >\n                            {(msg.first_name && msg.last_name) ? `${msg.first_name} ${msg.last_name}` : msg.email || 'Unknown'}\n                          </a>\n                        </td>\n                        <td class=\"truncate max-w-xs\">{msg.subject}</td>\n                        <td>{shortDate(msg.created_at)}</td>\n                        <td>\n                          <span class={msg.is_read === 0 ? 'uk-label' : 'uk-label uk-label-primary'}>{msg.is_read === 0 ? 'Unread' : 'Read'}</span>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { StatusBadge, StatusIcon } from './components';\nimport { Layout } from './layout';\n\ninterface JobDetailPageProps {\n  job: {\n    id: string;\n    status: string;\n    scheduled_date: string;\n    scheduled_start_time: string;\n    duration_minutes: number;\n    base_price_cents: number;\n    total_price_cents: number;\n    custom_service_name?: string | null;\n    created_at: string;\n  };\n  customer?: { id: string; first_name: string; last_name: string; email?: string; phone?: string };\n  service?: { id: string; name: string; description?: string };\n  territory?: { id: string; name: string };\n  team: Array<{ id: string; first_name: string; last_name: string }>;\n  assignedProviderId: string | null;\n  notes: Array<{\n    text: string;\n    timestamp: string;\n    completed: number;\n    source?: {\n      type?: string;\n      sms_log_id?: string;\n      message_id?: string;\n      excerpt?: string;\n      received_at?: string;\n    };\n  }>;\n  smsThreadMessage: {\n    id: string;\n    is_read: number;\n    updated_at: string;\n    body: string | null;\n  } | null;\n  lineItems: Array<{\n    id: string;\n    parent_id: string | null;\n    kind: 'service' | 'modifier' | 'rule' | 'custom';\n    description: string;\n    quantity: number;\n    unit_price_cents: number;\n    total_cents: number;\n    is_custom: number;\n  }>;\n}\n\nconst STATUS_OPTIONS = ['created', 'assigned', 'enroute', 'in_progress', 'complete', 'cancelled'];\n\nconst TaskSourceContext = ({ source }: { source?: JobDetailPageProps['notes'][number]['source'] }) => {\n  if (!source || source.type !== 'sms' || !source.excerpt) return null;\n  return (\n    <details class=\"mt-1.5\">\n      <summary class=\"text-xs text-muted-foreground cursor-pointer\" style=\"display:inline-flex;align-items:center;gap:6px;\">\n        <span aria-hidden=\"true\">\uD83D\uDCAC</span>\n        Message context\n      </summary>\n      <div class=\"mt-1 rounded-md border border-border p-2\" style=\"background:var(--surface-elevated);\">\n        <p class=\"text-xs\" style=\"margin:0;white-space:pre-wrap;word-break:break-word;\">{source.excerpt}</p>\n        {source.message_id && (\n          <a\n            href={`/admin/inbox/${source.message_id}`}\n            class=\"uk-link text-xs\"\n            hx-get={`/admin/inbox/${source.message_id}`}\n            hx-target=\"#page-content\"\n            hx-select=\"#page-content\"\n            hx-push-url=\"true\"\n            style=\"display:inline-block;margin-top:6px;\"\n          >\n            Open thread\n          </a>\n        )}\n      </div>\n    </details>\n  );\n};\n\nexport const NotesList = ({\n  jobId,\n  notes,\n  listId = 'notes-list',\n}: {\n  jobId: string;\n  notes: JobDetailPageProps['notes'];\n  listId?: string;\n}) => (\n  <div id={listId} data-notes-list=\"1\">\n    {notes.length === 0 ? (\n      <p class=\"text-sm text-muted-foreground\">No tasks yet.</p>\n    ) : (\n      notes.map((note, idx) => (\n        <div key={idx} class={`flex items-start gap-3 p-3 border border-border rounded-md ${note.completed ? 'opacity-60' : ''}`}>\n          <input\n            type=\"checkbox\"\n            class=\"uk-checkbox mt-1\"\n            checked={note.completed ? true : undefined}\n            hx-post={`/admin/jobs/${jobId}/notes/toggle`}\n            hx-vals={JSON.stringify({ noteIndex: idx })}\n            hx-target=\"closest [data-notes-list]\"\n            hx-select=\"#notes-list > *\"\n            hx-swap=\"innerHTML\"\n          />\n          <div class=\"flex-1 min-w-0\">\n            <p class={`text-sm ${note.completed ? 'line-through text-muted-foreground' : ''}`}>{note.text}</p>\n            <p class=\"text-xs text-muted-foreground mt-1\">{new Date(note.timestamp).toLocaleString()}</p>\n            <TaskSourceContext source={note.source} />\n          </div>\n          <button\n            type=\"button\"\n            class=\"delete-btn uk-btn uk-btn-small\"\n            hx-post={`/admin/jobs/${jobId}/notes/delete`}\n            hx-vals={JSON.stringify({ noteIndex: idx })}\n            hx-target=\"closest [data-notes-list]\"\n            hx-select=\"#notes-list > *\"\n            hx-swap=\"innerHTML\"\n            data-confirm=\"arm\"\n          >\n            \u2715\n          </button>\n        </div>\n      ))\n    )}\n  </div>\n);\n\nexport const SmsThreadCard = ({ jobId, smsThreadMessage, customerName }: {\n  jobId: string;\n  smsThreadMessage: JobDetailPageProps['smsThreadMessage'];\n  customerName?: string | null;\n}) => {\n  const hasUnread = !!smsThreadMessage && smsThreadMessage.is_read === 0;\n  const updatedLabel = smsThreadMessage\n    ? new Date(`${smsThreadMessage.updated_at}Z`).toLocaleString('en-CA', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' })\n    : null;\n\n  return (\n    <div\n      id=\"job-sms-thread-card\"\n      class=\"uk-card uk-card-body\"\n      hx-get={`/admin/jobs/${jobId}/sms-thread-card`}\n      hx-trigger=\"every 8s\"\n      hx-swap=\"outerHTML\"\n    >\n      <div class=\"flex items-center justify-between mb-3\">\n        <h3 class=\"text-base font-semibold\">SMS Thread</h3>\n        {hasUnread ? (\n          <span class=\"uk-label uk-label-destructive\" style=\"display:inline-flex;align-items:center;gap:6px;\">\n            <span style=\"width:6px;height:6px;border-radius:999px;background:currentColor;display:inline-block;\"></span>\n            New message\n          </span>\n        ) : (\n          <span class=\"text-xs text-muted-foreground\">Up to date</span>\n        )}\n      </div>\n\n      {smsThreadMessage ? (\n        <div class=\"grid gap-3\">\n          <p class=\"text-sm text-muted-foreground\" style=\"margin:0;\">\n            {smsThreadMessage.body ? `Latest: ${smsThreadMessage.body}` : 'SMS conversation is linked to this job.'}\n          </p>\n          <div class=\"flex items-center justify-between\">\n            <span class=\"text-xs text-muted-foreground\">{updatedLabel ? `Updated ${updatedLabel}` : ''}</span>\n             <button\n               type=\"button\"\n               class=\"uk-btn uk-btn-default uk-btn-sm\"\n               data-sms-thread-modal-open=\"true\"\n               data-sms-thread-modal-title={customerName || ''}\n               hx-get={`/admin/inbox/${smsThreadMessage.id}/sms-thread-panel`}\n               hx-target=\"#sms-thread-modal-body\"\n               hx-swap=\"innerHTML\"\n               hx-indicator=\"#sms-thread-modal-loading\"\n               aria-label=\"View SMS conversation\"\n             >\n               View SMS\n             </button>\n          </div>\n        </div>\n      ) : (\n        <p class=\"text-sm text-muted-foreground\">No SMS conversation linked yet.</p>\n      )}\n    </div>\n  );\n};\n\nconst money = (cents: number) => `$${(cents / 100).toFixed(2)}`;\n\nexport const JobDetailPage = ({ job, customer, service, territory, team, assignedProviderId, notes, smsThreadMessage, lineItems }: JobDetailPageProps) => {\n  const subtotal = lineItems.reduce((sum, line) => sum + line.total_cents, 0);\n  const customerName = customer ? `${customer.first_name} ${customer.last_name}`.trim() : 'Unassigned customer';\n  const serviceName = service?.name || job.custom_service_name || 'Custom Service';\n  const providerName = assignedProviderId\n    ? (() => {\n      const p = team.find(t => t.id === assignedProviderId);\n      return p ? `${p.first_name} ${p.last_name}`.trim() : 'Assigned';\n    })()\n    : 'Unassigned';\n  const dateLabel = (() => {\n    try {\n      const d = new Date(`${job.scheduled_date}T00:00:00`);\n      return d.toLocaleDateString('en-CA', { weekday: 'short', month: 'short', day: 'numeric' });\n    } catch {\n      return job.scheduled_date;\n    }\n  })();\n  const timeLabel = job.scheduled_start_time ? job.scheduled_start_time : '';\n  const scheduleLabel = `${dateLabel}${timeLabel ? ` at ${timeLabel}` : ''}`;\n  const canOpenSms = Boolean(smsThreadMessage);\n  const smsTitle = customer ? `${customer.first_name} ${customer.last_name}`.trim() : '';\n\n  return (\n    <Layout title={`Job ${job.id}`}>\n      <div class=\"page-header page-header--rich\">\n        <div class=\"page-header-info\">\n          <div class=\"flex items-center gap-2\">\n            <h2>{customerName}</h2>\n            <StatusIcon status={job.status} />\n          </div>\n          <div class=\"page-header-meta\">\n            <span>{serviceName}</span>\n            <span>{scheduleLabel}</span>\n            <span>{providerName}</span>\n          </div>\n        </div>\n        <div class=\"page-header-actions\">\n          <button\n            type=\"button\"\n            class=\"uk-btn uk-btn-primary uk-btn-sm\"\n            data-sms-thread-modal-open={canOpenSms ? 'true' : undefined}\n            data-sms-thread-modal-title={canOpenSms ? smsTitle : undefined}\n            hx-get={canOpenSms ? `/admin/inbox/${smsThreadMessage?.id}/sms-thread-panel` : undefined}\n            hx-target={canOpenSms ? '#sms-thread-modal-body' : undefined}\n            hx-swap={canOpenSms ? 'innerHTML' : undefined}\n            hx-indicator={canOpenSms ? '#sms-thread-modal-loading' : undefined}\n            aria-disabled={canOpenSms ? 'false' : 'true'}\n            disabled={canOpenSms ? undefined : true}\n          >\n            Message\n          </button>\n\n          <form\n            hx-post={`/admin/jobs/${job.id}/status`}\n            hx-target=\"#page-content\"\n            hx-select=\"#page-content\"\n            class=\"flex items-center gap-2\"\n          >\n            <select\n              name=\"status\"\n              class=\"uk-select uk-form-small\"\n              aria-label=\"Job status\"\n              style=\"max-width: 160px;\"\n            >\n              {STATUS_OPTIONS.map((status) => (\n                <option value={status} selected={job.status === status} key={status}>\n                  {status.replace('_', ' ')}\n                </option>\n              ))}\n            </select>\n            <button type=\"submit\" class=\"uk-btn uk-btn-default uk-btn-sm\">Update</button>\n          </form>\n\n          <a href=\"/admin/jobs\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/jobs\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n\n      <div class=\"p-4 sm:p-8\" style=\"padding-bottom: calc(24px + var(--safe-bottom));\">\n        <div class=\"mx-auto\" style=\"max-width: 1120px;\">\n          <div class=\"grid gap-4 lg:grid-cols-[1fr,320px] lg:gap-6\">\n            <div class=\"grid gap-4 sm:gap-6\">\n              <div class=\"uk-card uk-card-body\" style=\"background:var(--surface-0);\">\n                <div class=\"flex items-start justify-between gap-3\">\n                  <div class=\"min-w-0\">\n                    <p class=\"text-[10px] uppercase tracking-wide text-muted-foreground\">Job</p>\n                    <p class=\"text-base font-semibold\" style=\"margin:0;\">{job.id.slice(0, 8)}</p>\n                    <p class=\"text-xs text-muted-foreground\" style=\"margin:4px 0 0;\">Created {new Date(`${job.created_at}Z`).toLocaleString()}</p>\n                  </div>\n                  <div class=\"text-right\">\n                    <p class=\"text-[10px] uppercase tracking-wide text-muted-foreground\">Total</p>\n                    <p class=\"text-2xl font-extrabold\" style=\"margin:0;\">{money(job.total_price_cents)}</p>\n                    <p class=\"text-xs text-muted-foreground\" style=\"margin:4px 0 0;\">{lineItems.length} item{lineItems.length === 1 ? '' : 's'}</p>\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"uk-card uk-card-body\" id=\"job-edit-details\" style=\"scroll-margin-top: 96px;\">\n                <section>\n                  <form\n                    class=\"autosave\"\n                    hx-post={`/admin/jobs/${job.id}`}\n                    hx-target=\"#page-content\"\n                    hx-select=\"#page-content\"\n                    hx-swap=\"none\"\n                    hx-trigger=\"input delay:500ms, change\"\n                    hx-sync=\"this:queue last\"\n                  >\n                    <input type=\"hidden\" name=\"_section\" value=\"details\" />\n                    <div class=\"flex items-center justify-between mb-4\">\n                      <div class=\"min-w-0\">\n                        <h3 class=\"text-base font-semibold\" style=\"margin:0;\">Job details</h3>\n                        <p class=\"text-xs text-muted-foreground\" style=\"margin:2px 0 0;\">Edits auto-save.</p>\n                      </div>\n                      <span class=\"save-indicator\"></span>\n                    </div>\n\n                    <div class=\"grid gap-4 sm:grid-cols-2\">\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"scheduled-date\">Date</label>\n                        <input id=\"scheduled-date\" name=\"scheduled_date\" type=\"date\" class=\"uk-input\" value={job.scheduled_date} />\n                      </div>\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"scheduled-time\">Start Time</label>\n                        <input id=\"scheduled-time\" name=\"scheduled_start_time\" type=\"time\" class=\"uk-input\" value={job.scheduled_start_time} />\n                      </div>\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"duration\">Duration (minutes)</label>\n                        <input id=\"duration\" name=\"duration_minutes\" type=\"number\" min={1} class=\"uk-input\" value={job.duration_minutes} />\n                      </div>\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"provider-id\">Assigned Provider</label>\n                        <select id=\"provider-id\" name=\"provider_id\" class=\"uk-select\">\n                          <option value=\"\">Unassigned</option>\n                          {team.map((provider) => (\n                            <option key={provider.id} value={provider.id} selected={assignedProviderId === provider.id}>\n                              {provider.first_name} {provider.last_name}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"base-price\">Base Price ($)</label>\n                        <input id=\"base-price\" name=\"base_price\" type=\"number\" min={0} step={0.01} class=\"uk-input\" value={(job.base_price_cents / 100).toFixed(2)} />\n                      </div>\n                      <div class=\"grid gap-2\">\n                        <label class=\"uk-form-label\" for=\"total-price\">Total Price ($)</label>\n                        <input id=\"total-price\" name=\"total_price\" type=\"number\" min={0} step={0.01} class=\"uk-input\" value={(job.total_price_cents / 100).toFixed(2)} />\n                      </div>\n                    </div>\n                  </form>\n                </section>\n              </div>\n\n              <div class=\"uk-card uk-card-body\" id=\"job-status\" style=\"scroll-margin-top: 96px;\">\n                <section>\n                  <div class=\"flex items-center justify-between mb-4\">\n                    <h3 class=\"text-base font-semibold\" style=\"margin:0;\">Status</h3>\n                    <StatusBadge status={job.status} />\n                  </div>\n                  <form hx-post={`/admin/jobs/${job.id}/status`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-3 sm:flex sm:items-end\">\n                    <div class=\"grid gap-2 flex-1\">\n                      <label class=\"uk-form-label\" for=\"job-status-select\">Job Status</label>\n                      <select id=\"job-status-select\" name=\"status\" class=\"uk-select\">\n                        {STATUS_OPTIONS.map((status) => (\n                          <option value={status} selected={job.status === status} key={status}>{status.replace('_', ' ')}</option>\n                        ))}\n                      </select>\n                    </div>\n                    <button type=\"submit\" class=\"uk-btn uk-btn-default\">Update</button>\n                  </form>\n                  <div class=\"mt-4 rounded-md border border-border p-3\" style=\"background:var(--surface-elevated);\">\n                    <p class=\"text-xs uppercase tracking-wide text-muted-foreground\">Pricing subtotal</p>\n                    <p class=\"text-lg font-semibold\">{money(subtotal)}</p>\n                    <p class=\"text-xs text-muted-foreground\">{lineItems.length} line item{lineItems.length === 1 ? '' : 's'} in job breakdown</p>\n                  </div>\n                </section>\n              </div>\n\n              <div class=\"uk-card uk-card-body hidden sm:block lg:hidden\">\n                <h3 class=\"text-base font-semibold mb-4\">Customer</h3>\n                {customer ? (\n                  <div class=\"grid gap-2 text-sm\">\n                    <p class=\"font-medium\">{customer.first_name} {customer.last_name}</p>\n                    <p class=\"text-muted-foreground\">{customer.email || '-'}</p>\n                    <p class=\"text-muted-foreground\">{customer.phone || '-'}</p>\n                    <div>\n                      <a href={`/admin/customers/${customer.id}/edit`} class=\"uk-link\" hx-get={`/admin/customers/${customer.id}/edit`} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Open customer</a>\n                    </div>\n                  </div>\n                ) : (\n                  <p class=\"text-sm text-muted-foreground\">No customer linked.</p>\n                )}\n              </div>\n\n              <div id=\"job-sms\">\n                <SmsThreadCard\n                  jobId={job.id}\n                  smsThreadMessage={smsThreadMessage}\n                  customerName={customer ? `${customer.first_name} ${customer.last_name}`.trim() : null}\n                />\n              </div>\n\n              <div class=\"uk-card uk-card-body hidden sm:block lg:hidden\">\n                <h3 class=\"text-base font-semibold mb-4\">Service & Territory</h3>\n                <div class=\"grid gap-2 text-sm\">\n                  <div>\n                    <span class=\"text-muted-foreground\">Service:</span>{' '}\n                    <span class=\"font-medium\">{service?.name || job.custom_service_name || 'Custom Service'}</span>\n                  </div>\n                  <div>\n                    <span class=\"text-muted-foreground\">Territory:</span>{' '}\n                    <span class=\"font-medium\">{territory?.name || '-'}</span>\n                  </div>\n                </div>\n              </div>\n\n          <details class=\"uk-card uk-card-body sm:hidden\">\n            <summary class=\"text-base font-semibold cursor-pointer\">Customer</summary>\n            <div class=\"pt-4\">\n              {customer ? (\n                <div class=\"grid gap-2 text-sm\">\n                  <p class=\"font-medium\">{customer.first_name} {customer.last_name}</p>\n                  <p class=\"text-muted-foreground\">{customer.email || '-'}</p>\n                  <p class=\"text-muted-foreground\">{customer.phone || '-'}</p>\n                  <div>\n                    <a href={`/admin/customers/${customer.id}/edit`} class=\"uk-link\" hx-get={`/admin/customers/${customer.id}/edit`} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Open customer</a>\n                  </div>\n                </div>\n              ) : (\n                <p class=\"text-sm text-muted-foreground\">No customer linked.</p>\n              )}\n            </div>\n          </details>\n\n          <details class=\"uk-card uk-card-body sm:hidden\">\n            <summary class=\"text-base font-semibold cursor-pointer\">Service & Territory</summary>\n            <div class=\"grid gap-2 text-sm pt-4\">\n              <div>\n                <span class=\"text-muted-foreground\">Service:</span>{' '}\n                <span class=\"font-medium\">{service?.name || job.custom_service_name || 'Custom Service'}</span>\n              </div>\n              <div>\n                <span class=\"text-muted-foreground\">Territory:</span>{' '}\n                <span class=\"font-medium\">{territory?.name || '-'}</span>\n              </div>\n            </div>\n          </details>\n\n              <div class=\"uk-card uk-card-body\">\n                <section>\n                  <div class=\"flex items-center justify-between mb-4\">\n                    <h3 class=\"text-base font-semibold\" style=\"margin:0;\">Price breakdown</h3>\n                    <span class=\"text-sm font-semibold\">{money(subtotal)}</span>\n                  </div>\n                  <div class=\"grid gap-2 mb-4\">\n                    {lineItems.length === 0 ? (\n                      <p class=\"text-sm text-muted-foreground\">No line items yet.</p>\n                    ) : (\n                      lineItems.map((line) => (\n                        <div class=\"flex items-start gap-3 p-3 border border-border rounded-md\" key={line.id}>\n                          <div class=\"flex-1 min-w-0\" style={line.parent_id ? 'padding-left: 16px;' : ''}>\n                            <div class=\"flex items-center gap-2 flex-wrap\">\n                              <p class=\"text-sm font-medium\">{line.description}</p>\n                              <span class=\"text-xs text-muted-foreground\">{line.kind}</span>\n                            </div>\n                            <p class=\"text-xs text-muted-foreground\">{line.quantity} x {money(line.unit_price_cents)}</p>\n                          </div>\n                          <div class=\"text-right\">\n                            <p class=\"text-sm font-semibold\">{money(line.total_cents)}</p>\n                            {line.is_custom === 1 ? (\n                              <button\n                                type=\"button\"\n                                class=\"delete-btn uk-btn uk-btn-small\"\n                                hx-post={`/admin/jobs/${job.id}/line-items/delete`}\n                                hx-vals={JSON.stringify({ lineId: line.id })}\n                                hx-target=\"#page-content\"\n                                hx-select=\"#page-content\"\n                                data-confirm=\"arm\"\n                              >\n                                Remove\n                              </button>\n                            ) : null}\n                          </div>\n                        </div>\n                      ))\n                    )}\n                  </div>\n\n                  <form hx-post={`/admin/jobs/${job.id}/line-items/add`} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-swap=\"innerHTML\" class=\"grid gap-2 sm:grid-cols-4\">\n                    <input type=\"text\" name=\"description\" class=\"uk-input sm:col-span-2\" placeholder=\"Custom line description\" required />\n                    <input type=\"number\" name=\"quantity\" class=\"uk-input\" min={1} step={1} value=\"1\" required />\n                    <input type=\"number\" name=\"unit_price\" class=\"uk-input\" min={0} step={0.01} placeholder=\"Unit price\" required />\n                    <div class=\"sm:col-span-4 flex justify-end\">\n                      <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add Custom Line</button>\n                    </div>\n                  </form>\n                </section>\n              </div>\n\n              <div class=\"uk-card uk-card-body hidden sm:block\">\n               <section>\n                 <h3 class=\"text-base font-semibold mb-4\">Task Notes</h3>\n                 <div class=\"grid gap-2 mb-4\">\n                   <NotesList jobId={job.id} notes={notes} listId=\"notes-list-desktop\" />\n                 </div>\n\n                  <form\n                    hx-post={`/admin/jobs/${job.id}/notes/add`}\n                    hx-target=\"#notes-list-desktop\"\n                    hx-select=\"#notes-list > *\"\n                    hx-swap=\"innerHTML\"\n                    hx-on=\"htmx:afterRequest: const xhr=event.detail.xhr; if(!xhr||xhr.status<200||xhr.status>=300) return; const input=this.querySelector('input[name=text]'); if(input) input.value=''; const btn=this.querySelector('button[type=submit]'); if(!btn) return; btn.dataset.defaultText=btn.dataset.defaultText||btn.textContent||'Add'; btn.textContent='Task Added'; btn.style.backgroundColor='var(--badge-secondary)'; btn.style.borderColor='var(--badge-secondary)'; btn.style.color='var(--on-brand)'; setTimeout(()=>{ btn.textContent=btn.dataset.defaultText||'Add'; btn.style.backgroundColor=''; btn.style.borderColor=''; btn.style.color=''; }, 1200);\"\n                    class=\"flex gap-2\"\n                  >\n                    <input\n                      type=\"text\"\n                      name=\"text\"\n                      class=\"uk-input flex-1\"\n                      placeholder=\"Add a task...\"\n                      required\n                    />\n                    <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add</button>\n                  </form>\n              </section>\n            </div>\n\n             <details\n               class=\"uk-card uk-card-body sm:hidden\"\n               hx-on=\"htmx:afterSwap: if(event.detail && event.detail.target && event.detail.target.id === 'notes-list-mobile') this.open = true\"\n             >\n               <summary class=\"text-base font-semibold cursor-pointer\">Task Notes</summary>\n               <section class=\"pt-4\">\n                 <div class=\"grid gap-2 mb-4\">\n                   <NotesList jobId={job.id} notes={notes} listId=\"notes-list-mobile\" />\n                 </div>\n \n                   <form\n                     hx-post={`/admin/jobs/${job.id}/notes/add`}\n                     hx-target=\"#notes-list-mobile\"\n                     hx-select=\"#notes-list > *\"\n                     hx-swap=\"innerHTML\"\n                     hx-on=\"htmx:afterRequest: const xhr=event.detail.xhr; if(!xhr||xhr.status<200||xhr.status>=300) return; const input=this.querySelector('input[name=text]'); if(input) input.value=''; const btn=this.querySelector('button[type=submit]'); if(!btn) return; btn.dataset.defaultText=btn.dataset.defaultText||btn.textContent||'Add'; btn.textContent='Task Added'; btn.style.backgroundColor='var(--badge-secondary)'; btn.style.borderColor='var(--badge-secondary)'; btn.style.color='var(--on-brand)'; setTimeout(()=>{ btn.textContent=btn.dataset.defaultText||'Add'; btn.style.backgroundColor=''; btn.style.borderColor=''; btn.style.color=''; }, 1200);\"\n                      class=\"grid gap-2 sm:flex\"\n                    >\n                     <input\n                       type=\"text\"\n                       name=\"text\"\n                       class=\"uk-input flex-1\"\n                       placeholder=\"Add a task...\"\n                       required\n                     />\n                     <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add</button>\n                   </form>\n               </section>\n             </details>\n\n              <details class=\"uk-card uk-card-body hidden sm:block danger-card\">\n                 <summary class=\"text-base font-semibold cursor-pointer\">Danger zone</summary>\n                 <section class=\"pt-4\">\n                   <button\n                    type=\"button\"\n                    class=\"delete-btn\"\n                    hx-post={`/admin/jobs/${job.id}/delete`}\n                    data-confirm=\"arm\"\n                    hx-target=\"#page-content\"\n                  >\n                    Delete Job\n                  </button>\n                </section>\n              </details>\n\n          <details class=\"uk-card uk-card-body sm:hidden\">\n            <summary class=\"text-base font-semibold cursor-pointer\">Delete Job</summary>\n            <section class=\"pt-4\">\n              <button\n                type=\"button\"\n                class=\"delete-btn\"\n                hx-post={`/admin/jobs/${job.id}/delete`}\n                data-confirm=\"arm\"\n                hx-target=\"#page-content\"\n              >\n                Delete Job\n              </button>\n            </section>\n          </details>\n            </div>\n\n            <aside class=\"hidden lg:block\">\n              <div class=\"grid gap-4 lg:sticky\" style=\"top: 92px;\">\n                <div class=\"uk-card uk-card-body\">\n                  <h3 class=\"text-base font-semibold mb-3\">Customer</h3>\n                  {customer ? (\n                    <div class=\"grid gap-2 text-sm\">\n                      <p class=\"font-medium\">{customer.first_name} {customer.last_name}</p>\n                      <p class=\"text-muted-foreground\">{customer.email || '-'}</p>\n                      <p class=\"text-muted-foreground\">{customer.phone || '-'}</p>\n                      <div>\n                        <a href={`/admin/customers/${customer.id}/edit`} class=\"uk-link\" hx-get={`/admin/customers/${customer.id}/edit`} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Open customer</a>\n                      </div>\n                    </div>\n                  ) : (\n                    <p class=\"text-sm text-muted-foreground\">No customer linked.</p>\n                  )}\n                </div>\n\n                <div class=\"uk-card uk-card-body\">\n                  <h3 class=\"text-base font-semibold mb-3\">Service</h3>\n                  <div class=\"grid gap-2 text-sm\">\n                    <div>\n                      <p class=\"text-xs text-muted-foreground\" style=\"margin:0;\">Service</p>\n                      <p class=\"font-medium\" style=\"margin:0;\">{service?.name || job.custom_service_name || 'Custom Service'}</p>\n                    </div>\n                    <div>\n                      <p class=\"text-xs text-muted-foreground\" style=\"margin:0;\">Territory</p>\n                      <p class=\"font-medium\" style=\"margin:0;\">{territory?.name || '-'}</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </aside>\n          </div>\n\n        </div>\n      </div>\n\n    </Layout>\n  );\n};\n", "import { jsx } from 'hono/jsx';\nimport { Layout } from './layout';\nimport { formatTorontoDate } from '../utils/datetime';\n\nexport interface WizardState {\n  customer_id?: string;\n  customer_name?: string;\n  customer_email?: string;\n  address_line1?: string;\n  address_city?: string;\n  address_state?: string;\n  address_postal?: string;\n  address_lat?: string;\n  address_lng?: string;\n  territory_id?: string;\n  territory_name?: string;\n  service_id?: string;\n  service_name?: string;\n  service_price?: string;\n  service_duration?: string;\n  date?: string;\n  time?: string;\n  provider_id?: string;\n}\n\nexport interface NewJobProps {\n  customer?: { id: string; first_name: string; last_name: string; email?: string; phone?: string };\n  territories: Array<{ id: string; name: string }>;\n  services: Array<{ id: string; name: string; description?: string; base_price_cents: number; base_duration_minutes: number }>;\n  dates: string[];\n  timeslots: string[];\n  providers: Array<{ id: string; first_name: string; last_name: string; role: string; is_available: boolean }>;\n  addressLine1?: string;\n  addressCity?: string;\n  addressState?: string;\n  addressPostal?: string;\n  addressLat?: string;\n  addressLng?: string;\n  selectedTerritoryId?: string;\n  selectedServiceId?: string;\n  selectedDate?: string;\n  selectedTime?: string;\n  selectedProviderId?: string;\n  error?: string;\n}\n\ntype WizardFlowProps = {\n  step: number;\n  state: WizardState;\n  customer?: { id: string; first_name: string; last_name: string; email?: string; phone?: string };\n  services?: Array<{ id: string; name: string; description?: string; base_price_cents: number; base_duration_minutes: number }>;\n  timeslots?: Array<{ date: string; start_time: string; available: boolean }>;\n  providers?: Array<{ id: string; first_name: string; last_name: string; role: string; is_available: boolean }>;\n  error?: string;\n};\n\nconst hasStep = (props: NewJobProps | WizardFlowProps): props is WizardFlowProps => {\n  return 'step' in props;\n};\n\nconst formatDateChip = (date: string) => {\n  return formatTorontoDate(date, { weekday: 'short', month: 'short', day: 'numeric' }) || date;\n};\n\nconst queryFromQuickProps = (props: NewJobProps) => {\n  const query = new URLSearchParams();\n  if (props.customer?.id) query.set('customer_id', props.customer.id);\n  if (props.addressLine1) query.set('address_line1', props.addressLine1);\n  if (props.addressCity) query.set('address_city', props.addressCity);\n  if (props.addressState) query.set('address_state', props.addressState);\n  if (props.addressPostal) query.set('address_postal', props.addressPostal);\n  if (props.addressLat) query.set('address_lat', props.addressLat);\n  if (props.addressLng) query.set('address_lng', props.addressLng);\n  if (props.selectedTerritoryId) query.set('territory_id', props.selectedTerritoryId);\n  if (props.selectedServiceId) query.set('service_id', props.selectedServiceId);\n  if (props.selectedDate) query.set('date', props.selectedDate);\n  if (props.selectedTime) query.set('time', props.selectedTime);\n  if (props.selectedProviderId) query.set('provider_id', props.selectedProviderId);\n  return query;\n};\n\nconst statePairs = (state: WizardState) => {\n  const keys: Array<keyof WizardState> = [\n    'customer_id', 'customer_name', 'customer_email',\n    'address_line1', 'address_city', 'address_state', 'address_postal', 'address_lat', 'address_lng',\n    'territory_id', 'territory_name',\n    'service_id', 'service_name', 'service_price', 'service_duration',\n    'date', 'time', 'provider_id',\n  ];\n  return keys.map((key) => ({ key, value: state[key] || '' }));\n};\n\nconst HiddenWizardStateInputs = ({ state }: { state: WizardState }) => {\n  return (\n    <div>\n      {statePairs(state).map((pair) => (\n        <input key={pair.key} type=\"hidden\" name={pair.key} value={pair.value} />\n      ))}\n    </div>\n  );\n};\n\nconst quickCreateBody = (props: NewJobProps) => {\n  const query = queryFromQuickProps(props);\n  const selectedService = props.services.find((s) => s.id === props.selectedServiceId);\n  return (\n    <div class=\"grid gap-6\" style=\"max-width: 980px;\">\n      <div id=\"wizard-error-panel\">\n        {props.error && (\n          <div class=\"uk-card uk-card-body\" style=\"border: 1px solid #fecaca; background: #fff1f2;\">\n            <p class=\"text-sm\" style=\"color: #b91c1c;\">{props.error}</p>\n          </div>\n        )}\n      </div>\n\n      <div id=\"wizard-customer-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">1. Customer</h3>\n        <div class=\"grid gap-3 sm:grid-cols-2 items-end\">\n          <div class=\"grid gap-2 sm:col-span-2\">\n            <label class=\"uk-form-label\" for=\"customer-search\">Find Customer</label>\n            <input id=\"customer-search\" name=\"q\" class=\"uk-input\" placeholder=\"Search name or email\" hx-get=\"/admin/api/customers/search\" hx-trigger=\"input changed delay:300ms\" hx-target=\"#customer-results\" autocomplete=\"off\" inputmode=\"search\" autocapitalize=\"off\" spellcheck=\"false\" />\n            <div id=\"customer-results\"></div>\n          </div>\n          <div class=\"sm:col-span-2 text-sm\">\n            {props.customer ? (\n              <span class=\"uk-label\">{props.customer.first_name} {props.customer.last_name} ({props.customer.email || 'no email'})</span>\n            ) : (\n              <span class=\"text-muted-foreground\">No customer selected.</span>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div id=\"wizard-address-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">2. Address</h3>\n        <form\n          hx-get=\"/admin/jobs/new\"\n          hx-target=\"#page-content\"\n          hx-select=\"#page-content\"\n          hx-push-url=\"true\"\n          class=\"grid gap-3\"\n        >\n          {props.customer?.id && <input type=\"hidden\" name=\"customer_id\" value={props.customer.id} />}\n          {props.selectedTerritoryId && <input type=\"hidden\" name=\"territory_id\" value={props.selectedTerritoryId} />}\n          {props.selectedServiceId && <input type=\"hidden\" name=\"service_id\" value={props.selectedServiceId} />}\n          {props.selectedDate && <input type=\"hidden\" name=\"date\" value={props.selectedDate} />}\n          {props.selectedTime && <input type=\"hidden\" name=\"time\" value={props.selectedTime} />}\n          {props.selectedProviderId && <input type=\"hidden\" name=\"provider_id\" value={props.selectedProviderId} />}\n\n          <div class=\"flex flex-wrap items-center justify-between gap-2\">\n            <label class=\"uk-form-label\" for=\"addr-line1\">Address</label>\n            <button\n              type=\"button\"\n              class=\"uk-btn uk-btn-default uk-btn-sm\"\n              data-address-gps-btn\n              data-address-input=\"#addr-line1\"\n              data-address-results=\"#address-results\"\n              data-address-lat=\"#addr-lat\"\n              data-address-lng=\"#addr-lng\"\n            >\n              Use Current Location\n            </button>\n          </div>\n          <input id=\"addr-line1\" name=\"address_line1\" class=\"uk-input\" value={props.addressLine1 || ''} placeholder=\"Start typing address\" hx-get=\"/admin/api/address/search\" hx-trigger=\"input changed delay:300ms\" hx-target=\"#address-results\" hx-select=\".search-results\" hx-push-url=\"false\" autocomplete=\"address-line1\" />\n          <input id=\"addr-city\" type=\"hidden\" name=\"address_city\" value={props.addressCity || ''} />\n          <input id=\"addr-state\" type=\"hidden\" name=\"address_state\" value={props.addressState || ''} />\n          <input id=\"addr-postal\" type=\"hidden\" name=\"address_postal\" value={props.addressPostal || ''} />\n          <input id=\"addr-lat\" type=\"hidden\" name=\"address_lat\" value={props.addressLat || ''} />\n          <input id=\"addr-lng\" type=\"hidden\" name=\"address_lng\" value={props.addressLng || ''} />\n          <div id=\"address-results\"></div>\n          <button type=\"submit\" class=\"uk-btn uk-btn-default\" style=\"width: fit-content;\">Use Address</button>\n        </form>\n      </div>\n\n      <div id=\"wizard-territory-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">3. Territory</h3>\n        <form hx-get=\"/admin/jobs/new\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\" class=\"grid gap-3\">\n          {props.customer?.id && <input type=\"hidden\" name=\"customer_id\" value={props.customer.id} />}\n          {props.addressLine1 && <input type=\"hidden\" name=\"address_line1\" value={props.addressLine1} />}\n          {props.addressCity && <input type=\"hidden\" name=\"address_city\" value={props.addressCity} />}\n          {props.addressState && <input type=\"hidden\" name=\"address_state\" value={props.addressState} />}\n          {props.addressPostal && <input type=\"hidden\" name=\"address_postal\" value={props.addressPostal} />}\n          {props.addressLat && <input type=\"hidden\" name=\"address_lat\" value={props.addressLat} />}\n          {props.addressLng && <input type=\"hidden\" name=\"address_lng\" value={props.addressLng} />}\n          {props.selectedServiceId && <input type=\"hidden\" name=\"service_id\" value={props.selectedServiceId} />}\n          {props.selectedDate && <input type=\"hidden\" name=\"date\" value={props.selectedDate} />}\n          {props.selectedTime && <input type=\"hidden\" name=\"time\" value={props.selectedTime} />}\n          {props.selectedProviderId && <input type=\"hidden\" name=\"provider_id\" value={props.selectedProviderId} />}\n\n          <select name=\"territory_id\" class=\"uk-select\" required>\n            <option value=\"\">Select territory...</option>\n            {props.territories.map((t) => <option key={t.id} value={t.id} selected={props.selectedTerritoryId === t.id}>{t.name}</option>)}\n          </select>\n          <button type=\"submit\" class=\"uk-btn uk-btn-default\" style=\"width: fit-content;\">Select Territory</button>\n        </form>\n      </div>\n\n      <div id=\"wizard-service-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">4. Service</h3>\n        <form hx-get=\"/admin/jobs/new\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\" class=\"grid gap-3\">\n          {props.customer?.id && <input type=\"hidden\" name=\"customer_id\" value={props.customer.id} />}\n          {props.addressLine1 && <input type=\"hidden\" name=\"address_line1\" value={props.addressLine1} />}\n          {props.addressCity && <input type=\"hidden\" name=\"address_city\" value={props.addressCity} />}\n          {props.addressState && <input type=\"hidden\" name=\"address_state\" value={props.addressState} />}\n          {props.addressPostal && <input type=\"hidden\" name=\"address_postal\" value={props.addressPostal} />}\n          {props.addressLat && <input type=\"hidden\" name=\"address_lat\" value={props.addressLat} />}\n          {props.addressLng && <input type=\"hidden\" name=\"address_lng\" value={props.addressLng} />}\n          {props.selectedTerritoryId && <input type=\"hidden\" name=\"territory_id\" value={props.selectedTerritoryId} />}\n          {props.selectedDate && <input type=\"hidden\" name=\"date\" value={props.selectedDate} />}\n          {props.selectedTime && <input type=\"hidden\" name=\"time\" value={props.selectedTime} />}\n          {props.selectedProviderId && <input type=\"hidden\" name=\"provider_id\" value={props.selectedProviderId} />}\n\n          <select name=\"service_id\" class=\"uk-select\" required>\n            <option value=\"\">Select service...</option>\n            {props.services.map((s) => <option key={s.id} value={s.id} selected={props.selectedServiceId === s.id}>{s.name}</option>)}\n          </select>\n          {selectedService && (\n            <p class=\"text-sm text-muted-foreground\">{selectedService.base_duration_minutes} min \u2022 ${(selectedService.base_price_cents / 100).toFixed(2)}</p>\n          )}\n          <button type=\"submit\" class=\"uk-btn uk-btn-default\" style=\"width: fit-content;\">Select Service</button>\n        </form>\n      </div>\n\n      <div id=\"wizard-date-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">5. Date</h3>\n        <div class=\"flex flex-wrap gap-2\">\n          {props.dates.map((date) => {\n            const q = new URLSearchParams(query);\n            q.set('date', date);\n            q.delete('time');\n            q.delete('provider_id');\n            const active = props.selectedDate === date;\n            return (\n              <a\n                key={date}\n                href={`/admin/jobs/new?${q.toString()}`}\n                class={active ? 'uk-btn uk-btn-primary uk-btn-sm' : 'uk-btn uk-btn-default uk-btn-sm'}\n                hx-get={`/admin/jobs/new?${q.toString()}`}\n                hx-target=\"#page-content\"\n                hx-select=\"#page-content\"\n                hx-push-url=\"true\"\n              >\n                {formatDateChip(date)}\n              </a>\n            );\n          })}\n        </div>\n      </div>\n\n      <div id=\"wizard-time-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">6. Time</h3>\n        {props.timeslots.length === 0 ? (\n          <p class=\"text-sm text-muted-foreground\">Select a service and date first.</p>\n        ) : (\n          <div class=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2\">\n            {props.timeslots.map((time) => {\n              const q = new URLSearchParams(query);\n              q.set('time', time);\n              q.delete('provider_id');\n              const active = props.selectedTime === time;\n              return (\n                <a\n                  key={time}\n                  href={`/admin/jobs/new?${q.toString()}`}\n                  class={active ? 'uk-btn uk-btn-primary uk-btn-sm' : 'uk-btn uk-btn-default uk-btn-sm'}\n                  hx-get={`/admin/jobs/new?${q.toString()}`}\n                  hx-target=\"#page-content\"\n                  hx-select=\"#page-content\"\n                  hx-push-url=\"true\"\n                >\n                  {time}\n                </a>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      <div id=\"wizard-provider-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">7. Provider</h3>\n        <form hx-get=\"/admin/jobs/new\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\" class=\"grid gap-3\">\n          {props.customer?.id && <input type=\"hidden\" name=\"customer_id\" value={props.customer.id} />}\n          {props.addressLine1 && <input type=\"hidden\" name=\"address_line1\" value={props.addressLine1} />}\n          {props.addressCity && <input type=\"hidden\" name=\"address_city\" value={props.addressCity} />}\n          {props.addressState && <input type=\"hidden\" name=\"address_state\" value={props.addressState} />}\n          {props.addressPostal && <input type=\"hidden\" name=\"address_postal\" value={props.addressPostal} />}\n          {props.addressLat && <input type=\"hidden\" name=\"address_lat\" value={props.addressLat} />}\n          {props.addressLng && <input type=\"hidden\" name=\"address_lng\" value={props.addressLng} />}\n          {props.selectedTerritoryId && <input type=\"hidden\" name=\"territory_id\" value={props.selectedTerritoryId} />}\n          {props.selectedServiceId && <input type=\"hidden\" name=\"service_id\" value={props.selectedServiceId} />}\n          {props.selectedDate && <input type=\"hidden\" name=\"date\" value={props.selectedDate} />}\n          {props.selectedTime && <input type=\"hidden\" name=\"time\" value={props.selectedTime} />}\n\n          <select name=\"provider_id\" class=\"uk-select\">\n            <option value=\"\">Auto-assign later</option>\n            {props.providers.map((p) => (\n              <option key={p.id} value={p.id} selected={props.selectedProviderId === p.id}>\n                {p.first_name} {p.last_name} {p.is_available ? '' : '(unavailable)'}\n              </option>\n            ))}\n          </select>\n          <button type=\"submit\" class=\"uk-btn uk-btn-default\" style=\"width: fit-content;\">Select Provider</button>\n        </form>\n      </div>\n\n      <div id=\"wizard-submit-panel\" class=\"uk-card uk-card-body\">\n        <h3 class=\"text-base font-semibold mb-4\">8. Create Job</h3>\n        <form hx-post=\"/admin/jobs/quick-create\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\" class=\"grid gap-3\">\n          <input type=\"hidden\" name=\"customer_id\" value={props.customer?.id || ''} />\n          <input type=\"hidden\" name=\"address_line1\" value={props.addressLine1 || ''} />\n          <input type=\"hidden\" name=\"address_city\" value={props.addressCity || ''} />\n          <input type=\"hidden\" name=\"address_state\" value={props.addressState || ''} />\n          <input type=\"hidden\" name=\"address_postal\" value={props.addressPostal || ''} />\n          <input type=\"hidden\" name=\"address_lat\" value={props.addressLat || ''} />\n          <input type=\"hidden\" name=\"address_lng\" value={props.addressLng || ''} />\n          <input type=\"hidden\" name=\"territory_id\" value={props.selectedTerritoryId || ''} />\n          <input type=\"hidden\" name=\"service_id\" value={props.selectedServiceId || ''} />\n          <input type=\"hidden\" name=\"date\" value={props.selectedDate || ''} />\n          <input type=\"hidden\" name=\"time\" value={props.selectedTime || ''} />\n          <input type=\"hidden\" name=\"provider_id\" value={props.selectedProviderId || ''} />\n          <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Create Job</button>\n        </form>\n      </div>\n\n      <script>{`\n        (function () {\n          if (window.__jobWizardCustomerBind) return;\n          window.__jobWizardCustomerBind = true;\n          document.addEventListener('click', function (e) {\n            var item = e.target.closest('.customer-result');\n            if (!item) return;\n            var data = item.dataset;\n            var params = new URLSearchParams(window.location.search);\n            if (data.id) params.set('customer_id', data.id);\n            if (params.get('error')) params.delete('error');\n            var url = '/admin/jobs/new?' + params.toString();\n            if (window.htmx) {\n              window.htmx.ajax('GET', url, { target: '#page-content', swap: 'innerHTML' });\n              window.history.pushState({}, '', url);\n            } else {\n              window.location.href = url;\n            }\n          });\n        })();\n      `}</script>\n    </div>\n  );\n};\n\nconst wizardFlowBody = (props: WizardFlowProps) => {\n  return (\n    <div class=\"grid gap-6\" style=\"max-width: 800px;\">\n      {props.error && (\n        <div class=\"uk-card uk-card-body\" style=\"border: 1px solid #fecaca; background: #fff1f2;\">\n          <p class=\"text-sm\" style=\"color: #b91c1c;\">{props.error}</p>\n        </div>\n      )}\n\n      {props.step === 1 && (\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-4\">Step 1: Customer & Address</h3>\n          <form hx-post=\"/admin/jobs/wizard/step1-address\" hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-4\">\n            <input type=\"hidden\" name=\"customer_id\" value={props.state.customer_id || props.customer?.id || ''} />\n            <input type=\"hidden\" name=\"customer_name\" value={props.state.customer_name || `${props.customer?.first_name || ''} ${props.customer?.last_name || ''}`.trim()} />\n            <input type=\"hidden\" name=\"customer_email\" value={props.state.customer_email || props.customer?.email || ''} />\n            <div class=\"text-sm\">\n              <span class=\"text-muted-foreground\">Customer:</span>{' '}\n              <span class=\"font-medium\">{props.state.customer_name || `${props.customer?.first_name || ''} ${props.customer?.last_name || ''}`.trim() || 'Unknown'}</span>\n            </div>\n            <div class=\"grid gap-2\">\n              <div class=\"flex flex-wrap items-center justify-between gap-2\">\n                <label class=\"uk-form-label\" for=\"wizard-address\">Address line 1</label>\n                <button\n                  type=\"button\"\n                  class=\"uk-btn uk-btn-default uk-btn-sm\"\n                  data-address-gps-btn\n                  data-address-input=\"#wizard-address\"\n                  data-address-results=\"#address-results\"\n                  data-address-lat=\"#addr-lat\"\n                  data-address-lng=\"#addr-lng\"\n                >\n                  Use Current Location\n                </button>\n              </div>\n              <input id=\"wizard-address\" name=\"address_line1\" class=\"uk-input\" value={props.state.address_line1 || ''} hx-get=\"/admin/api/address/search\" hx-trigger=\"input changed delay:300ms\" hx-target=\"#address-results\" hx-select=\".search-results\" hx-push-url=\"false\" autocomplete=\"address-line1\" />\n              <div id=\"address-results\"></div>\n            </div>\n            <input id=\"addr-city\" type=\"hidden\" name=\"address_city\" value={props.state.address_city || ''} />\n            <input id=\"addr-state\" type=\"hidden\" name=\"address_state\" value={props.state.address_state || ''} />\n            <input id=\"addr-postal\" type=\"hidden\" name=\"address_postal\" value={props.state.address_postal || ''} />\n            <input id=\"addr-lat\" type=\"hidden\" name=\"address_lat\" value={props.state.address_lat || ''} />\n            <input id=\"addr-lng\" type=\"hidden\" name=\"address_lng\" value={props.state.address_lng || ''} />\n            <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Continue</button>\n          </form>\n        </div>\n      )}\n\n      {props.step === 2 && (\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-4\">Step 2: Service</h3>\n          <form hx-post=\"/admin/jobs/wizard/step3\" hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-4\">\n            <HiddenWizardStateInputs state={props.state} />\n            <input id=\"wizard-service-name\" type=\"hidden\" name=\"service_name\" value={props.state.service_name || ''} />\n            <input id=\"wizard-service-price\" type=\"hidden\" name=\"service_price\" value={props.state.service_price || ''} />\n            <input id=\"wizard-service-duration\" type=\"hidden\" name=\"service_duration\" value={props.state.service_duration || ''} />\n            <div class=\"grid gap-2\">\n              <label class=\"uk-form-label\" for=\"wizard-service-id\">Select Service</label>\n              <select id=\"wizard-service-id\" name=\"service_id\" class=\"uk-select\" required>\n                <option value=\"\">Select...</option>\n                {(props.services || []).map((service) => (\n                  <option key={service.id} value={service.id} selected={props.state.service_id === service.id} data-name={service.name} data-price={String(service.base_price_cents)} data-duration={String(service.base_duration_minutes)}>\n                    {service.name} (${(service.base_price_cents / 100).toFixed(2)}, {service.base_duration_minutes}m)\n                  </option>\n                ))}\n              </select>\n            </div>\n            <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Continue</button>\n            <script>{`\n              (function () {\n                var select = document.getElementById('wizard-service-id');\n                var nameEl = document.getElementById('wizard-service-name');\n                var priceEl = document.getElementById('wizard-service-price');\n                var durationEl = document.getElementById('wizard-service-duration');\n                if (!select || !nameEl || !priceEl || !durationEl) return;\n                function sync() {\n                  var opt = select.options[select.selectedIndex];\n                  nameEl.value = opt ? (opt.getAttribute('data-name') || '') : '';\n                  priceEl.value = opt ? (opt.getAttribute('data-price') || '') : '';\n                  durationEl.value = opt ? (opt.getAttribute('data-duration') || '') : '';\n                }\n                select.addEventListener('change', sync);\n                sync();\n              })();\n            `}</script>\n          </form>\n        </div>\n      )}\n\n      {props.step === 3 && (\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-4\">Step 3: Date & Time</h3>\n          <form hx-post=\"/admin/jobs/wizard/step4\" hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-4\">\n            <HiddenWizardStateInputs state={props.state} />\n            <div class=\"grid gap-3 sm:grid-cols-2\">\n              <div class=\"grid gap-2\">\n                <label class=\"uk-form-label\" for=\"wizard-date\">Date</label>\n                <input id=\"wizard-date\" type=\"date\" name=\"date\" class=\"uk-input\" value={props.state.date || ''} required />\n              </div>\n              <div class=\"grid gap-2\">\n                <label class=\"uk-form-label\" for=\"wizard-time\">Time</label>\n                <select id=\"wizard-time\" name=\"time\" class=\"uk-select\" required>\n                  <option value=\"\">Select...</option>\n                  {(props.timeslots || []).map((slot) => (\n                    <option key={`${slot.date}-${slot.start_time}`} value={slot.start_time} selected={props.state.time === slot.start_time}>\n                      {slot.date} {slot.start_time} {slot.available ? '' : '(unavailable)'}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            </div>\n            <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Continue</button>\n          </form>\n        </div>\n      )}\n\n      {props.step === 4 && (\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-4\">Step 4: Provider</h3>\n          <form hx-post=\"/admin/jobs/create\" hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-4\">\n            <HiddenWizardStateInputs state={props.state} />\n            <div class=\"grid gap-2\">\n              <label class=\"uk-form-label\" for=\"wizard-provider\">Provider</label>\n              <select id=\"wizard-provider\" name=\"provider_id\" class=\"uk-select\">\n                <option value=\"\">Auto-assign later</option>\n                {(props.providers || []).map((provider) => (\n                  <option key={provider.id} value={provider.id} selected={props.state.provider_id === provider.id}>\n                    {provider.first_name} {provider.last_name} {provider.is_available ? '' : '(unavailable)'}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Create Job</button>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const JobWizardPage = (props: NewJobProps | WizardFlowProps) => {\n  const title = hasStep(props) ? `New Job - Step ${props.step}` : 'Create Job';\n  return (\n    <Layout title={title}>\n      <div class=\"page-header\">\n        <div class=\"page-header-info\">\n          <h2>{title}</h2>\n          {hasStep(props) && (\n            <div class=\"wizard-progress\" style=\"margin-top:4px;\">\n              {[1, 2, 3, 4].map((s) => (\n                <div key={s} class={`wizard-progress-step${s < (props as WizardFlowProps).step ? ' is-done' : ''}${s === (props as WizardFlowProps).step ? ' is-active' : ''}`} />\n              ))}\n            </div>\n          )}\n        </div>\n        <div class=\"page-header-actions\">\n          <a href=\"/admin/jobs\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/jobs\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n      <div class=\"p-8\">\n        {hasStep(props) ? wizardFlowBody(props) : quickCreateBody(props)}\n      </div>\n    </Layout>\n  );\n};\n\nexport const JobWizardSwapBundle = ({ props, targetId }: { props: NewJobProps | WizardFlowProps; targetId: string }) => {\n  if (hasStep(props)) {\n    return wizardFlowBody(props);\n  }\n\n  const body = quickCreateBody(props);\n  if (targetId === 'wizard-customer-panel') return <div id=\"wizard-customer-panel\">{body}</div>;\n  if (targetId === 'wizard-address-panel') return <div id=\"wizard-address-panel\">{body}</div>;\n  if (targetId === 'wizard-territory-panel') return <div id=\"wizard-territory-panel\">{body}</div>;\n  if (targetId === 'wizard-service-panel') return <div id=\"wizard-service-panel\">{body}</div>;\n  if (targetId === 'wizard-date-panel') return <div id=\"wizard-date-panel\">{body}</div>;\n  if (targetId === 'wizard-time-panel') return <div id=\"wizard-time-panel\">{body}</div>;\n  if (targetId === 'wizard-provider-panel') return <div id=\"wizard-provider-panel\">{body}</div>;\n  if (targetId === 'wizard-submit-panel') return <div id=\"wizard-submit-panel\">{body}</div>;\n  if (targetId === 'wizard-error-panel') return <div id=\"wizard-error-panel\">{body}</div>;\n  return body;\n};\n\nexport const CustomerSearchResults = ({ customers }: { customers: Array<{ id: string; first_name: string; last_name: string; email?: string }> }) => {\n  if (!customers.length) {\n    return <div class=\"search-results\"><div class=\"search-item text-muted-foreground\">No customers found.</div></div>;\n  }\n\n  return (\n    <div class=\"search-results\">\n      {customers.map((customer) => (\n        <div\n          key={customer.id}\n          class=\"search-item customer-result\"\n          data-id={customer.id}\n          data-name={`${customer.first_name} ${customer.last_name}`}\n          data-email={customer.email || ''}\n        >\n          <div class=\"name\">{customer.first_name} {customer.last_name}</div>\n          <div class=\"meta\">{customer.email || 'No email'}</div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport const AddressSearchResults = ({\n  results,\n  targetPrefix,\n}: {\n  results: Array<{ display: string; line1: string; city: string; state: string; postal: string; lat: string; lng: string }>;\n  targetPrefix?: string;\n}) => {\n  if (!results.length) {\n    return <div class=\"search-results\"><div class=\"search-item text-muted-foreground\">No addresses found.</div></div>;\n  }\n\n  return (\n    <div class=\"search-results\">\n      {results.map((result, i) => (\n        <div\n          key={`${result.display}-${i}`}\n          class=\"search-item address-result\"\n          data-prefix={targetPrefix || 'addr'}\n          data-line1={result.line1}\n          data-city={result.city}\n          data-state={result.state}\n          data-postal={result.postal}\n          data-lat={result.lat}\n          data-lng={result.lng}\n        >\n          <div class=\"name\">{result.display || result.line1}</div>\n          <div class=\"meta\">{result.city}{result.state ? `, ${result.state}` : ''} {result.postal}</div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport const parseWizardState = (body: Record<string, unknown>): WizardState => {\n  const get = (key: keyof WizardState) => {\n    const value = body[key as string];\n    return typeof value === 'string' ? value : undefined;\n  };\n\n  return {\n    customer_id: get('customer_id'),\n    customer_name: get('customer_name'),\n    customer_email: get('customer_email'),\n    address_line1: get('address_line1'),\n    address_city: get('address_city'),\n    address_state: get('address_state'),\n    address_postal: get('address_postal'),\n    address_lat: get('address_lat'),\n    address_lng: get('address_lng'),\n    territory_id: get('territory_id'),\n    territory_name: get('territory_name'),\n    service_id: get('service_id'),\n    service_name: get('service_name'),\n    service_price: get('service_price'),\n    service_duration: get('service_duration'),\n    date: get('date'),\n    time: get('time'),\n    provider_id: get('provider_id'),\n  };\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { StatusIcon } from './components';\nimport { Layout } from './layout';\n\ninterface ProviderDetailPageProps {\n  member: {\n    id: string;\n    first_name: string;\n    last_name: string;\n    email: string;\n    phone?: string;\n    role: string;\n    is_active: number;\n    can_be_auto_assigned: number;\n    can_edit_availability: number;\n    auto_assign_priority: number;\n  };\n  weeklyHours: Array<{ day_of_week: number; start_time: string; end_time: string }>;\n  dateOverrides: Array<{ id: string; date: string; is_available: number; start_time?: string; end_time?: string }>;\n  skills: Array<{ id: string; name: string }>;\n  allSkills: Array<{ id: string; name: string }>;\n  territories: Array<{ id: string; name: string; assigned: boolean }>;\n}\n\nconst DAY_LABELS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n\nexport const ProviderDetailPage = ({ member, weeklyHours, dateOverrides, skills, allSkills, territories }: ProviderDetailPageProps) => {\n  const hourMap = new Map<number, { start_time: string; end_time: string }>();\n  for (const row of weeklyHours) hourMap.set(row.day_of_week, { start_time: row.start_time, end_time: row.end_time });\n  const assignedTerritories = territories.filter((t) => t.assigned);\n\n  return (\n    <Layout title={`${member.first_name} ${member.last_name}`}>\n      <div class=\"page-header\">\n        <div class=\"page-header-info\">\n          <div class=\"flex items-center gap-2\">\n            <h2>{member.first_name} {member.last_name}</h2>\n            <StatusIcon status={member.is_active ? 'active' : 'inactive'} />\n          </div>\n        </div>\n        <div class=\"page-header-actions\">\n          <a href=\"/admin/team\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/team\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n\n      <div class=\"p-8\">\n        <div class=\"grid gap-6\" style=\"max-width: 800px;\">\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <form\n                class=\"autosave\"\n                hx-post={`/admin/team/${member.id}`}\n                hx-target=\"#page-content\"\n                hx-select=\"#page-content\"\n                hx-swap=\"none\"\n                hx-trigger=\"input delay:500ms, change\"\n                hx-sync=\"this:queue last\"\n              >\n                <input type=\"hidden\" name=\"_section\" value=\"profile\" />\n                <div class=\"flex items-center justify-between mb-4\">\n                  <h3 class=\"text-base font-semibold\">Profile</h3>\n                  <span class=\"save-indicator\"></span>\n                </div>\n\n                <div class=\"grid gap-4 sm:grid-cols-2\">\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"first_name\">First Name</label>\n                    <input id=\"first_name\" name=\"first_name\" class=\"uk-input\" value={member.first_name} />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"last_name\">Last Name</label>\n                    <input id=\"last_name\" name=\"last_name\" class=\"uk-input\" value={member.last_name} />\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"email\">Email</label>\n                    <input id=\"email\" name=\"email\" type=\"email\" class=\"uk-input\" value={member.email} />\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"phone\">Phone</label>\n                    <input id=\"phone\" name=\"phone\" type=\"tel\" class=\"uk-input\" value={member.phone || ''} />\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"role\">Role</label>\n                    <select id=\"role\" name=\"role\" class=\"uk-select\">\n                      <option value=\"manager\" selected={member.role === 'manager'}>Manager</option>\n                      <option value=\"provider\" selected={member.role === 'provider'}>Provider</option>\n                    </select>\n                  </div>\n                  <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\">\n                    <input type=\"checkbox\" name=\"can_be_auto_assigned\" checked={Boolean(member.can_be_auto_assigned)} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                    Can be auto-assigned\n                  </label>\n                  <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\">\n                    <input type=\"checkbox\" name=\"is_active\" checked={Boolean(member.is_active)} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                    Active\n                  </label>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Weekly Hours</h3>\n              <form hx-post={`/admin/team/${member.id}/hours`} hx-target=\"#page-content\" hx-select=\"#page-content\">\n                <div class=\"grid gap-3\">\n                  {DAY_LABELS.map((label, day) => {\n                    const row = hourMap.get(day);\n                    const enabled = Boolean(row);\n                    return (\n                      <div class=\"grid grid-cols-[60px_1fr_1fr_auto] items-center gap-3\" key={label}>\n                        <span class=\"text-sm text-muted-foreground\">{label}</span>\n                        <input type=\"time\" name={`day_${day}_start`} class=\"uk-input\" value={row?.start_time || '09:00'} />\n                        <input type=\"time\" name={`day_${day}_end`} class=\"uk-input\" value={row?.end_time || '17:00'} />\n                        <label class=\"flex items-center gap-2 text-sm\">\n                          <input type=\"checkbox\" name={`day_${day}_enabled`} class=\"uk-checkbox\" checked={enabled} />\n                          Enabled\n                        </label>\n                      </div>\n                    );\n                  })}\n                </div>\n                <div class=\"mt-4\">\n                  <button type=\"submit\" class=\"uk-btn uk-btn-primary\">Save Hours</button>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Date Overrides</h3>\n              <div class=\"uk-overflow-auto mb-4\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Date</th>\n                      <th class=\"text-left\">Available</th>\n                      <th class=\"text-left\">Hours</th>\n                      <th class=\"text-left\">Action</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {dateOverrides.map((o) => (\n                      <tr key={o.id}>\n                        <td>{o.date}</td>\n                        <td>{o.is_available ? 'Yes' : 'No'}</td>\n                        <td>{o.start_time && o.end_time ? `${o.start_time} - ${o.end_time}` : '-'}</td>\n                        <td>\n                          <button\n                            type=\"button\"\n                            class=\"delete-btn\"\n                            hx-delete={`/admin/team/${member.id}/overrides/${o.id}`}\n                            data-confirm=\"arm\"\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                          >\n                            Delete\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                    {dateOverrides.length === 0 && (\n                      <tr>\n                        <td colspan={4} class=\"text-muted-foreground\">No overrides.</td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n\n              <form hx-post={`/admin/team/${member.id}/overrides`} hx-target=\"#page-content\" hx-select=\"#page-content\">\n                <div class=\"grid gap-3 sm:grid-cols-2\">\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"override-date\">Date</label>\n                    <input id=\"override-date\" name=\"date\" type=\"date\" class=\"uk-input\" required />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"override-available\">Availability</label>\n                    <select id=\"override-available\" name=\"is_available\" class=\"uk-select\">\n                      <option value=\"1\">Available</option>\n                      <option value=\"0\">Unavailable</option>\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"override-start\">Start</label>\n                    <input id=\"override-start\" name=\"start_time\" type=\"time\" class=\"uk-input\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"override-end\">End</label>\n                    <input id=\"override-end\" name=\"end_time\" type=\"time\" class=\"uk-input\" />\n                  </div>\n                </div>\n                <div class=\"mt-4\">\n                  <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add Override</button>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Skills</h3>\n              <div class=\"flex flex-wrap items-center gap-2 mb-4\">\n                {skills.map((skill) => (\n                  <form key={skill.id} hx-post={`/admin/team/${member.id}/skills`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"flex items-center gap-1\">\n                    <input type=\"hidden\" name=\"remove_skill_id\" value={skill.id} />\n                    <span class=\"uk-label\">{skill.name}</span>\n                    <button type=\"submit\" class=\"uk-btn uk-btn-default uk-btn-sm\">x</button>\n                  </form>\n                ))}\n                {skills.length === 0 && <span class=\"text-sm text-muted-foreground\">No skills assigned.</span>}\n              </div>\n\n              <form hx-post={`/admin/team/${member.id}/skills`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"flex items-end gap-3\">\n                {skills.map((skill) => (\n                  <input key={skill.id} type=\"hidden\" name=\"skill_ids\" value={skill.id} />\n                ))}\n                <div class=\"grid gap-2 flex-1\">\n                  <label class=\"uk-form-label\" for=\"add-skill\">Add Skill</label>\n                  <select id=\"add-skill\" name=\"skill_ids\" class=\"uk-select\">\n                    <option value=\"\">Select skill...</option>\n                    {allSkills.map((skill) => (\n                      <option value={skill.id} key={skill.id}>{skill.name}</option>\n                    ))}\n                  </select>\n                </div>\n                <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add</button>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section id=\"provider-territories\">\n              <div class=\"flex items-center justify-between mb-4\">\n                <h3 class=\"text-base font-semibold\">Territories</h3>\n                <span class=\"text-sm text-muted-foreground\" id=\"provider-territories-count\">{assignedTerritories.length} assigned</span>\n                <span class=\"save-indicator\"></span>\n              </div>\n\n              <div class=\"grid gap-2\">\n                {territories.map((t) => (\n                  <form key={t.id}>\n                    {assignedTerritories.filter((a) => !t.assigned || a.id !== t.id).map((a) => (\n                      <input key={a.id} type=\"hidden\" name=\"territory_ids\" value={a.id} />\n                    ))}\n                    <label class=\"flex items-center justify-between gap-3\">\n                      <span class=\"text-sm\">{t.name}</span>\n                      <input\n                        type=\"checkbox\"\n                        class=\"uk-checkbox\"\n                        name=\"territory_ids\"\n                        value={t.id}\n                        checked={t.assigned}\n                        hx-post={`/admin/team/${member.id}/territories`}\n                        hx-target=\"#page-content\"\n                        hx-select=\"#page-content\"\n                        hx-vals={`js:this.checked ? {} : { remove_territory_id: '${t.id}' }`}\n                      />\n                    </label>\n                  </form>\n                ))}\n              </div>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body danger-card\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-3\">Delete</h3>\n              <button\n                type=\"button\"\n                class=\"delete-btn\"\n                hx-post={`/admin/team/${member.id}/delete`}\n                data-confirm=\"arm\"\n                hx-target=\"#page-content\"\n              >\n                Delete Team Member\n              </button>\n            </section>\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { StatusIcon } from './components';\nimport { Layout } from './layout';\n\ninterface ServiceDetailPageProps {\n  service: {\n    id: string;\n    name: string;\n    description?: string | null;\n    category_id?: string | null;\n    base_price_cents: number;\n    base_duration_minutes: number;\n    is_active: number;\n    auto_assign_enabled: number;\n    auto_assign_method: string;\n    required_provider_count: number;\n  };\n  categories: Array<{ id: string; name: string }>;\n  modifiers: Array<{\n    id: string;\n    name: string;\n    description?: string;\n    price_adjustment_cents: number;\n    duration_adjustment_minutes: number;\n    is_required: number;\n    sort_order: number;\n  }>;\n  priceRules: Array<{\n    id: string;\n    rule_type: string;\n    adjustment_type: string;\n    adjustment_value: number;\n    direction: string;\n    days_of_week?: string;\n    start_time?: string;\n    end_time?: string;\n    min_hours_ahead?: number;\n    max_hours_ahead?: number;\n    territory_id?: string;\n    territory_name?: string;\n  }>;\n  requiredSkills: Array<{ id: string; name: string }>;\n  allSkills: Array<{ id: string; name: string }>;\n  territories: Array<{ id: string; name: string }>;\n}\n\nconst formatRuleDetails = (rule: ServiceDetailPageProps['priceRules'][number]) => {\n  if (rule.rule_type === 'time_of_day') return `${rule.start_time || '-'} to ${rule.end_time || '-'}`;\n  if (rule.rule_type === 'day_of_week') return rule.days_of_week || '-';\n  if (rule.rule_type === 'lead_time') return `${rule.min_hours_ahead ?? 0}h - ${rule.max_hours_ahead ?? 'any'}h ahead`;\n  if (rule.rule_type === 'territory') return rule.territory_name || '-';\n  return '-';\n};\n\nexport const ServiceDetailPage = ({ service, categories, modifiers, priceRules, requiredSkills, allSkills, territories }: ServiceDetailPageProps) => {\n  return (\n    <Layout title={service.name || 'Service'}>\n      <div class=\"page-header\">\n        <div class=\"page-header-info\">\n          <div class=\"flex items-center gap-2\">\n            <h2>{service.name || 'Service'}</h2>\n            <StatusIcon status={service.is_active ? 'active' : 'inactive'} />\n          </div>\n        </div>\n        <div class=\"page-header-actions\">\n          <a href=\"/admin/services\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/services\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n\n      <div class=\"p-8\">\n        <div class=\"grid gap-6\" style=\"max-width: 800px;\">\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <form\n                class=\"autosave\"\n                hx-post={`/admin/services/${service.id}`}\n                hx-target=\"#page-content\"\n                hx-select=\"#page-content\"\n                hx-swap=\"none\"\n                hx-trigger=\"input delay:500ms, change\"\n                hx-sync=\"this:queue last\"\n              >\n                <input type=\"hidden\" name=\"_section\" value=\"basic\" />\n                <div class=\"flex items-center justify-between mb-4\">\n                  <h3 class=\"text-base font-semibold\">Basic Info</h3>\n                  <span class=\"save-indicator\"></span>\n                </div>\n\n                <div class=\"grid gap-4 sm:grid-cols-2\">\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"service-name\">Name</label>\n                    <input id=\"service-name\" name=\"name\" class=\"uk-input\" value={service.name} />\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"service-description\">Description</label>\n                    <textarea id=\"service-description\" name=\"description\" class=\"uk-textarea\" rows={3}>{service.description || ''}</textarea>\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"service-category\">Category</label>\n                    <select id=\"service-category\" name=\"category_id\" class=\"uk-select\">\n                      <option value=\"\">Select...</option>\n                      {categories.map((cat) => (\n                        <option value={cat.id} selected={service.category_id === cat.id} key={cat.id}>{cat.name}</option>\n                      ))}\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"service-price\">Base Price ($)</label>\n                    <input id=\"service-price\" name=\"base_price\" type=\"number\" min={0} step={0.01} class=\"uk-input\" value={(service.base_price_cents / 100).toFixed(2)} />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"service-duration\">Duration (minutes)</label>\n                    <input id=\"service-duration\" name=\"base_duration_minutes\" type=\"number\" min={1} class=\"uk-input\" value={service.base_duration_minutes} />\n                  </div>\n                  <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\">\n                    <input type=\"checkbox\" name=\"auto_assign_enabled\" checked={Boolean(service.auto_assign_enabled)} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                    Auto-assign enabled\n                  </label>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"assign-method\">Auto-assign method</label>\n                    <select id=\"assign-method\" name=\"auto_assign_method\" class=\"uk-select\">\n                      <option value=\"balanced\" selected={service.auto_assign_method === 'balanced'}>Balanced</option>\n                      <option value=\"prioritized\" selected={service.auto_assign_method === 'prioritized'}>Prioritized</option>\n                      <option value=\"drive_time\" selected={service.auto_assign_method === 'drive_time'}>Drive time</option>\n                    </select>\n                  </div>\n                  <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\">\n                    <input type=\"checkbox\" name=\"is_active\" checked={Boolean(service.is_active)} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                    Active\n                  </label>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Modifiers</h3>\n              <div class=\"uk-overflow-auto mb-4\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Name</th>\n                      <th class=\"text-left\">Price</th>\n                      <th class=\"text-left\">Duration</th>\n                      <th class=\"text-left\">Required</th>\n                      <th class=\"text-left\">Action</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {modifiers.map((mod) => (\n                      <tr key={mod.id}>\n                        <td>{mod.name}</td>\n                        <td>${(mod.price_adjustment_cents / 100).toFixed(2)}</td>\n                        <td>{mod.duration_adjustment_minutes} min</td>\n                        <td>{mod.is_required ? 'Yes' : 'No'}</td>\n                        <td>\n                          <button\n                            type=\"button\"\n                            class=\"delete-btn\"\n                            hx-post={`/admin/services/${service.id}/modifiers/${mod.id}/delete`}\n                            data-confirm=\"arm\"\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                          >\n                            Delete\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                    {modifiers.length === 0 && (\n                      <tr>\n                        <td colspan={5} class=\"text-muted-foreground\">No modifiers yet.</td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n\n              <form hx-post={`/admin/services/${service.id}/modifiers`} hx-target=\"#page-content\" hx-select=\"#page-content\">\n                <div class=\"grid gap-3 sm:grid-cols-2\">\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"mod-name\">Name</label>\n                    <input id=\"mod-name\" name=\"name\" class=\"uk-input\" required />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"mod-required\">Required</label>\n                    <label class=\"flex items-center gap-2 text-sm\">\n                      <input id=\"mod-required\" name=\"is_required\" type=\"checkbox\" class=\"uk-checkbox\" />\n                      Required\n                    </label>\n                  </div>\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"mod-description\">Description</label>\n                    <input id=\"mod-description\" name=\"description\" class=\"uk-input\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"mod-price\">Price Adjustment ($)</label>\n                    <input id=\"mod-price\" name=\"price_adjustment\" type=\"number\" step={0.01} class=\"uk-input\" value=\"0\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"mod-duration\">Duration adjustment (minutes)</label>\n                    <input id=\"mod-duration\" name=\"duration_adjustment_minutes\" type=\"number\" class=\"uk-input\" value=\"0\" />\n                  </div>\n                </div>\n                <div class=\"mt-4\">\n                  <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add Modifier</button>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Price Rules</h3>\n              <div class=\"uk-overflow-auto mb-4\">\n                <table class=\"uk-table uk-table-divider uk-table-hover uk-table-sm text-sm\">\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Type</th>\n                      <th class=\"text-left\">Adjustment</th>\n                      <th class=\"text-left\">Details</th>\n                      <th class=\"text-left\">Action</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {priceRules.map((rule) => (\n                      <tr key={rule.id}>\n                        <td>{rule.rule_type}</td>\n                        <td>{rule.direction} {rule.adjustment_type === 'percentage' ? `${rule.adjustment_value}%` : `$${(rule.adjustment_value / 100).toFixed(2)}`}</td>\n                        <td>{formatRuleDetails(rule)}</td>\n                        <td>\n                          <button\n                            type=\"button\"\n                            class=\"delete-btn\"\n                            hx-post={`/admin/services/${service.id}/rules/${rule.id}/delete`}\n                            data-confirm=\"arm\"\n                            hx-target=\"#page-content\"\n                            hx-select=\"#page-content\"\n                          >\n                            Delete\n                          </button>\n                        </td>\n                      </tr>\n                    ))}\n                    {priceRules.length === 0 && (\n                      <tr>\n                        <td colspan={4} class=\"text-muted-foreground\">No price rules yet.</td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n\n              <form hx-post={`/admin/services/${service.id}/rules`} hx-target=\"#page-content\" hx-select=\"#page-content\">\n                <div class=\"grid gap-3 sm:grid-cols-2\">\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"rule-type\">Rule Type</label>\n                    <select id=\"rule-type\" name=\"rule_type\" class=\"uk-select\">\n                      <option value=\"time_of_day\">Time of Day</option>\n                      <option value=\"day_of_week\">Day of Week</option>\n                      <option value=\"lead_time\">Lead Time</option>\n                      <option value=\"territory\">Territory</option>\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"adjustment-type\">Adjustment Type</label>\n                    <select id=\"adjustment-type\" name=\"adjustment_type\" class=\"uk-select\">\n                      <option value=\"flat\">Flat</option>\n                      <option value=\"percentage\">Percentage</option>\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"adjustment-value\">Adjustment Value ($ or %)</label>\n                    <input id=\"adjustment-value\" name=\"adjustment_value\" type=\"number\" step={0.01} class=\"uk-input\" value=\"0\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"direction\">Direction</label>\n                    <select id=\"direction\" name=\"direction\" class=\"uk-select\">\n                      <option value=\"surcharge\">Surcharge</option>\n                      <option value=\"discount\">Discount</option>\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"days-of-week\">Days of Week (csv)</label>\n                    <input id=\"days-of-week\" name=\"days_of_week\" class=\"uk-input\" placeholder=\"1,2,3\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"rule-territory\">Territory</label>\n                    <select id=\"rule-territory\" name=\"territory_id\" class=\"uk-select\">\n                      <option value=\"\">Any territory</option>\n                      {territories.map((t) => (\n                        <option value={t.id} key={t.id}>{t.name}</option>\n                      ))}\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"start-time\">Start Time</label>\n                    <input id=\"start-time\" name=\"start_time\" type=\"time\" class=\"uk-input\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"end-time\">End Time</label>\n                    <input id=\"end-time\" name=\"end_time\" type=\"time\" class=\"uk-input\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"min-hours\">Min Hours Ahead</label>\n                    <input id=\"min-hours\" name=\"min_hours_ahead\" type=\"number\" min={0} class=\"uk-input\" />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"max-hours\">Max Hours Ahead</label>\n                    <input id=\"max-hours\" name=\"max_hours_ahead\" type=\"number\" min={0} class=\"uk-input\" />\n                  </div>\n                </div>\n                <div class=\"mt-4\">\n                  <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add Price Rule</button>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Required Skills</h3>\n              <div class=\"flex flex-wrap gap-2 mb-4\">\n                {requiredSkills.map((skill) => {\n                  const keep = requiredSkills.filter((s) => s.id !== skill.id);\n                  return (\n                    <form key={skill.id} hx-post={`/admin/services/${service.id}/skills`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"flex items-center gap-1\">\n                      {keep.map((s) => <input key={s.id} type=\"hidden\" name=\"skill_ids\" value={s.id} />)}\n                      <span class=\"uk-label\">{skill.name}</span>\n                      <button type=\"submit\" class=\"uk-btn uk-btn-default uk-btn-sm\">x</button>\n                    </form>\n                  );\n                })}\n                {requiredSkills.length === 0 && <span class=\"text-sm text-muted-foreground\">No required skills.</span>}\n              </div>\n\n              <form hx-post={`/admin/services/${service.id}/skills`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"flex items-end gap-3\">\n                {requiredSkills.map((skill) => <input key={skill.id} type=\"hidden\" name=\"skill_ids\" value={skill.id} />)}\n                <div class=\"grid gap-2 flex-1\">\n                  <label class=\"uk-form-label\" for=\"skill-id\">Add Skill</label>\n                  <select id=\"skill-id\" name=\"skill_ids\" class=\"uk-select\">\n                    <option value=\"\">Select skill...</option>\n                    {allSkills.map((skill) => <option value={skill.id} key={skill.id}>{skill.name}</option>)}\n                  </select>\n                </div>\n                <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add</button>\n              </form>\n            </section>\n          </div>\n\n          <div class=\"uk-card uk-card-body danger-card\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-3\">Delete</h3>\n              <button\n                type=\"button\"\n                class=\"delete-btn\"\n                hx-post={`/admin/services/${service.id}/delete`}\n                data-confirm=\"arm\"\n                hx-target=\"#page-content\"\n              >\n                Delete Service\n              </button>\n            </section>\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { Layout } from './layout';\n\ninterface TerritoryModel {\n  id: string;\n  name: string;\n  timezone: string;\n  service_area_type: string;\n  service_area_data: string;\n  operating_hours: string;\n  scheduling_policy: string;\n  max_concurrent_jobs?: number;\n  is_active: number;\n}\n\ninterface TerritoryDetailProps {\n  territory: TerritoryModel;\n  services: Array<{ id: string; name: string; assigned: boolean }>;\n  providers: Array<{ id: string; first_name: string; last_name: string; assigned: boolean }>;\n  isNew?: boolean;\n}\n\nconst HOURS = [\n  { key: 'sun', label: 'Sun' },\n  { key: 'mon', label: 'Mon' },\n  { key: 'tue', label: 'Tue' },\n  { key: 'wed', label: 'Wed' },\n  { key: 'thu', label: 'Thu' },\n  { key: 'fri', label: 'Fri' },\n  { key: 'sat', label: 'Sat' },\n];\n\nconst TIMEZONES = ['America/Toronto', 'America/New_York', 'America/Vancouver', 'America/Chicago', 'America/Edmonton', 'UTC'];\n\nconst parseAreaData = (raw: string) => {\n  try {\n    return JSON.parse(raw || '{}') as Record<string, unknown>;\n  } catch {\n    return {};\n  }\n};\n\nconst parseOperatingHours = (raw: string) => {\n  try {\n    const parsed = JSON.parse(raw || '{}') as Record<string, { start: string; end: string } | null>;\n    return parsed;\n  } catch {\n    return {} as Record<string, { start: string; end: string } | null>;\n  }\n};\n\nexport const ZipPanel = ({ tid, zipCodes }: { tid: string; zipCodes: string[] }) => {\n  return (\n    <div>\n      <form class=\"autosave\" hx-post={`/admin/territories/${tid}/area`} hx-swap=\"none\" hx-trigger=\"input delay:800ms, change delay:800ms\">\n        <input type=\"hidden\" name=\"service_area_type\" value=\"zip\" />\n        <div class=\"flex items-center justify-between mb-2\">\n          <label class=\"uk-form-label\" for=\"zip-codes\">ZIP/Postal Codes</label>\n          <span class=\"save-indicator\"></span>\n        </div>\n        <div class=\"grid gap-2\">\n          <textarea id=\"zip-codes\" name=\"zip_codes\" class=\"uk-textarea\" rows={4} placeholder=\"K8N1A1, K8N1A2\">{zipCodes.join(', ')}</textarea>\n          <p class=\"text-sm text-muted-foreground\">Comma-separated list.</p>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport const RadiusPanel = ({ tid, areaData }: { tid: string; areaData: Record<string, unknown> }) => {\n  const center = (areaData.center as { lat?: number; lng?: number } | undefined) || {};\n  const lat = Number(center.lat || 44.1628);\n  const lng = Number(center.lng || -77.3832);\n  const miles = Number(areaData.radius_miles || 10);\n\n  return (\n    <div>\n      <form id=\"radius-form\" class=\"autosave\" hx-post={`/admin/territories/${tid}/area`} hx-swap=\"none\" hx-trigger=\"change delay:500ms\" hx-sync=\"this:queue last\">\n        <input type=\"hidden\" name=\"service_area_type\" value=\"radius\" />\n        <span class=\"save-indicator\"></span>\n        <div class=\"grid gap-3 sm:grid-cols-2 mb-4\">\n          <div class=\"grid gap-2 sm:col-span-2\">\n            <label class=\"uk-form-label\" for=\"center-address-search\">Address Search</label>\n            <input\n              id=\"center-address-search\"\n              name=\"center_address_q\"\n              class=\"uk-input\"\n              placeholder=\"Search address\"\n              hx-get=\"/admin/api/address/search\"\n              hx-trigger=\"input changed delay:300ms\"\n              hx-target=\"#radius-address-results\"\n            />\n            <div id=\"radius-address-results\"></div>\n          </div>\n          <div class=\"grid gap-2\">\n            <label class=\"uk-form-label\" for=\"center-lat\">Center Latitude</label>\n            <input id=\"center-lat\" name=\"center_lat\" class=\"uk-input\" value={lat.toString()} />\n          </div>\n          <div class=\"grid gap-2\">\n            <label class=\"uk-form-label\" for=\"center-lng\">Center Longitude</label>\n            <input id=\"center-lng\" name=\"center_lng\" class=\"uk-input\" value={lng.toString()} />\n          </div>\n          <div class=\"grid gap-2 sm:col-span-2\">\n            <label class=\"uk-form-label\" for=\"radius-miles\">Radius (miles)</label>\n            <input id=\"radius-miles\" name=\"radius_miles\" type=\"number\" min={1} step={0.1} class=\"uk-input\" value={miles.toString()} />\n          </div>\n        </div>\n        <div id=\"radius-map\" style=\"height: 300px; border: 1px solid var(--border); border-radius: 8px;\" data-lat={lat.toString()} data-lng={lng.toString()} data-miles={miles.toString()}></div>\n      </form>\n    </div>\n  );\n};\n\nexport const GeofencePanel = ({ tid, areaData }: { tid: string; areaData: Record<string, unknown> }) => {\n  const polygon = Array.isArray(areaData.polygon) ? areaData.polygon : [];\n\n  return (\n    <div>\n      <form id=\"geofence-form\" class=\"autosave\" hx-post={`/admin/territories/${tid}/area`} hx-swap=\"none\" hx-trigger=\"change delay:500ms\" hx-sync=\"this:queue last\">\n        <input type=\"hidden\" name=\"service_area_type\" value=\"geofence\" />\n        <div class=\"flex items-center gap-2 mb-3\">\n          <button id=\"gf-draw-btn\" type=\"button\" class=\"uk-btn uk-btn-default uk-btn-sm\">Draw Polygon</button>\n          <button id=\"clear-geofence-btn\" type=\"button\" class=\"uk-btn uk-btn-default uk-btn-sm\">Clear</button>\n          <span id=\"gf-count\" class=\"text-sm text-muted-foreground\">{polygon.length} pts</span>\n          <span class=\"save-indicator\"></span>\n        </div>\n        <div id=\"geofence-map\" style=\"height: 320px; border: 1px solid var(--border); border-radius: 8px;\" data-points={JSON.stringify(polygon)}></div>\n        <input id=\"polygon-json-hidden\" type=\"hidden\" name=\"polygon_json\" value={polygon.length ? JSON.stringify(polygon) : ''} />\n      </form>\n    </div>\n  );\n};\n\nexport const TerritoryDetailPage = ({ territory, services, providers, isNew }: TerritoryDetailProps) => {\n  const areaData = parseAreaData(territory.service_area_data);\n  const zipCodes = ((areaData.zip_codes as string[] | undefined) || (areaData.zipCodes as string[] | undefined) || []).filter(Boolean);\n  const operatingHours = parseOperatingHours(territory.operating_hours);\n  const selectedType = territory.service_area_type || 'zip';\n  const submitUrl = isNew ? '/admin/territories' : `/admin/territories/${territory.id}`;\n  const assignedServices = services.filter((s) => s.assigned).length;\n  const assignedProviders = providers.filter((p) => p.assigned).length;\n\n  return (\n    <Layout title={isNew ? 'Create Territory' : territory.name || 'Territory'}>\n      <div class=\"page-header\">\n        <h2>{isNew ? 'Create Territory' : territory.name || 'Territory'}</h2>\n        <div class=\"page-header-actions\">\n          <a href=\"/admin/territories\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/territories\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n\n      <div class=\"p-8\">\n        <div class=\"grid gap-6\" style=\"max-width: 800px;\">\n          <div class=\"uk-card uk-card-body\">\n            <section>\n              <h3 class=\"text-base font-semibold mb-4\">Basic Info</h3>\n              <form hx-post={submitUrl} hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">\n                {!isNew && <input type=\"hidden\" name=\"_section\" value=\"basic\" />}\n                <div class=\"grid gap-4 sm:grid-cols-2\">\n                  <div class=\"grid gap-2 sm:col-span-2\">\n                    <label class=\"uk-form-label\" for=\"territory-name\">Name</label>\n                    <input id=\"territory-name\" name=\"name\" class=\"uk-input\" value={territory.name} required />\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"territory-timezone\">Timezone</label>\n                    <select id=\"territory-timezone\" name=\"timezone\" class=\"uk-select\">\n                      {TIMEZONES.map((tz) => <option value={tz} selected={territory.timezone === tz} key={tz}>{tz}</option>)}\n                    </select>\n                  </div>\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"territory-policy\">Scheduling Policy</label>\n                    <select id=\"territory-policy\" name=\"scheduling_policy\" class=\"uk-select\">\n                      <option value=\"provider_based\" selected={territory.scheduling_policy === 'provider_based'}>Provider based</option>\n                      <option value=\"manual\" selected={territory.scheduling_policy === 'manual'}>Manual</option>\n                    </select>\n                  </div>\n                  <label class=\"uk-form-label flex items-center gap-2 cursor-pointer sm:col-span-2\">\n                    <input type=\"checkbox\" name=\"is_active\" checked={Boolean(territory.is_active)} class=\"uk-toggle-switch uk-toggle-switch-primary\" />\n                    Active\n                  </label>\n                  {isNew && <input type=\"hidden\" name=\"service_area_type\" value={selectedType} />}\n                </div>\n                <div class=\"mt-4\">\n                  <button type=\"submit\" class=\"uk-btn uk-btn-primary\">{isNew ? 'Create' : 'Save'}</button>\n                </div>\n              </form>\n            </section>\n          </div>\n\n          {!isNew && (\n            <div class=\"uk-card uk-card-body\">\n              <section>\n                <h3 class=\"text-base font-semibold mb-4\">Service Area</h3>\n                <div class=\"grid gap-3 sm:grid-cols-2 items-end mb-4\">\n                  <div class=\"grid gap-2\">\n                    <label class=\"uk-form-label\" for=\"area-type\">Service Area Type</label>\n                    <select\n                      id=\"area-type\"\n                      class=\"uk-select\"\n                      name=\"panel_type\"\n                      hx-get={`/admin/territories/${territory.id}/area-panel/${selectedType}`}\n                      hx-target=\"#area-panel\"\n                      hx-swap=\"innerHTML\"\n                      hx-trigger=\"change\"\n                    >\n                      <option value=\"zip\" selected={selectedType === 'zip'}>ZIP / Postal Codes</option>\n                      <option value=\"radius\" selected={selectedType === 'radius'}>Radius</option>\n                      <option value=\"geofence\" selected={selectedType === 'geofence'}>Geofence</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div id=\"area-panel\">\n                  {selectedType === 'radius' && RadiusPanel({ tid: territory.id, areaData })}\n                  {selectedType === 'geofence' && GeofencePanel({ tid: territory.id, areaData })}\n                  {selectedType === 'zip' && ZipPanel({ tid: territory.id, zipCodes })}\n                </div>\n              </section>\n            </div>\n          )}\n\n          {!isNew && (\n            <div class=\"uk-card uk-card-body\">\n              <section>\n                <div class=\"flex items-center justify-between mb-4\">\n                  <h3 class=\"text-base font-semibold\">Operating Hours</h3>\n                  <span class=\"save-indicator\"></span>\n                </div>\n                <form class=\"autosave\" hx-post={`/admin/territories/${territory.id}/hours`} hx-swap=\"none\" hx-trigger=\"change delay:500ms\" hx-sync=\"this:queue last\">\n                  <div class=\"grid gap-3\">\n                    {HOURS.map((d) => {\n                      const row = operatingHours[d.key] || null;\n                      return (\n                        <div class=\"grid grid-cols-[60px_1fr_1fr_auto] gap-3 items-center\" key={d.key}>\n                          <span class=\"text-sm text-muted-foreground\">{d.label}</span>\n                          <input type=\"time\" name={`${d.key}_start`} class=\"uk-input\" value={row?.start || '09:00'} />\n                          <input type=\"time\" name={`${d.key}_end`} class=\"uk-input\" value={row?.end || '17:00'} />\n                          <label class=\"flex items-center gap-2 text-sm\">\n                            <input type=\"checkbox\" name={`${d.key}_enabled`} class=\"uk-checkbox\" checked={Boolean(row)} />\n                            Enabled\n                          </label>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </form>\n              </section>\n            </div>\n          )}\n\n          {!isNew && (\n            <div class=\"uk-card uk-card-body\">\n              <section id=\"territory-services\">\n                <div class=\"flex items-center justify-between mb-4\">\n                  <h3 class=\"text-base font-semibold\">Services</h3>\n                  <span id=\"territory-services-count\" class=\"text-sm text-muted-foreground\">{assignedServices} assigned</span>\n                  <span class=\"save-indicator\"></span>\n                </div>\n                <div class=\"grid gap-2\">\n                  {services.map((s) => (\n                    <label class=\"flex items-center justify-between gap-3\" key={s.id}>\n                      <span class=\"text-sm\">{s.name}</span>\n                      <input\n                        type=\"checkbox\"\n                        class=\"uk-checkbox\"\n                        checked={s.assigned}\n                        hx-post={`/admin/territories/${territory.id}/services/${s.id}/toggle`}\n                        hx-trigger=\"change\"\n                        hx-swap=\"none\"\n                      />\n                    </label>\n                  ))}\n                </div>\n              </section>\n            </div>\n          )}\n\n          {!isNew && (\n            <div class=\"uk-card uk-card-body\">\n              <section id=\"territory-providers\">\n                <div class=\"flex items-center justify-between mb-4\">\n                  <h3 class=\"text-base font-semibold\">Providers</h3>\n                  <span id=\"territory-providers-count\" class=\"text-sm text-muted-foreground\">{assignedProviders} assigned</span>\n                  <span class=\"save-indicator\"></span>\n                </div>\n                <div class=\"grid gap-2\">\n                  {providers.map((p) => (\n                    <label class=\"flex items-center justify-between gap-3\" key={p.id}>\n                      <span class=\"text-sm\">{p.first_name} {p.last_name}</span>\n                      <input\n                        type=\"checkbox\"\n                        class=\"uk-checkbox\"\n                        checked={p.assigned}\n                        hx-post={`/admin/territories/${territory.id}/providers/${p.id}/toggle`}\n                        hx-trigger=\"change\"\n                        hx-swap=\"none\"\n                      />\n                    </label>\n                  ))}\n                </div>\n              </section>\n            </div>\n          )}\n\n          {!isNew && (\n            <div class=\"uk-card uk-card-body danger-card\">\n              <section>\n                <h3 class=\"text-base font-semibold mb-3\">Delete</h3>\n                <button\n                  type=\"button\"\n                  class=\"delete-btn\"\n                  hx-post={`/admin/territories/${territory.id}/delete`}\n                  data-confirm=\"arm\"\n                  hx-target=\"#page-content\"\n                >\n                  Delete Territory\n                </button>\n              </section>\n            </div>\n          )}\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { Layout } from './layout';\n\ninterface TwilioConfigProps {\n  accountSid: string;\n  authToken: string;\n  phoneNumber: string;\n  enabled: boolean;\n}\n\ninterface SmsTemplate {\n  id: string;\n  event_type: string;\n  label: string;\n  body_template: string;\n  is_active: number;\n}\n\ninterface SmsStats {\n  total: number;\n  sent: number;\n  received: number;\n  failed: number;\n  total_segments: number;\n}\n\ninterface Props {\n  config: TwilioConfigProps | null;\n  templates: SmsTemplate[];\n  stats: SmsStats | null;\n}\n\nconst segmentCount = (len: number) => len <= 160 ? 1 : Math.ceil(len / 153);\n\nexport const SmsSettingsPage = ({ config, templates, stats }: Props) => (\n  <Layout title=\"SMS Settings\">\n    <div class=\"page-header\">\n      <h2>SMS Settings</h2>\n    </div>\n    <div class=\"p-4 md:p-8\">\n      <div class=\"grid gap-4 md:gap-6\" style=\"max-width: 800px;\">\n\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-3\">Twilio Configuration</h3>\n          <form hx-post=\"/admin/sms-settings\" hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-3\">\n            <div class=\"grid gap-1\">\n              <label class=\"text-sm font-medium\" for=\"twilio-sid\">Account SID</label>\n              <input type=\"text\" name=\"account_sid\" id=\"twilio-sid\" class=\"uk-input\" value={config?.accountSid || ''} placeholder=\"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" autocomplete=\"off\" autocapitalize=\"off\" spellcheck=\"false\" />\n            </div>\n            <div class=\"grid gap-1\">\n              <label class=\"text-sm font-medium\" for=\"twilio-token\">Auth Token</label>\n              <input type=\"password\" name=\"auth_token\" id=\"twilio-token\" class=\"uk-input\" value={config?.authToken || ''} placeholder=\"Your Twilio auth token\" autocomplete=\"off\" autocapitalize=\"off\" spellcheck=\"false\" />\n            </div>\n            <div class=\"grid gap-1\">\n              <label class=\"text-sm font-medium\" for=\"twilio-phone\">Phone Number (E.164)</label>\n              <input type=\"tel\" name=\"phone_number\" id=\"twilio-phone\" class=\"uk-input\" value={config?.phoneNumber || ''} placeholder=\"+18005551234\" autocomplete=\"tel\" inputmode=\"tel\" />\n            </div>\n            <div class=\"flex items-center gap-2\">\n              <input type=\"checkbox\" name=\"enabled\" id=\"twilio-enabled\" value=\"1\" checked={!!config?.enabled} class=\"uk-checkbox\" />\n              <label for=\"twilio-enabled\" class=\"text-sm\">Enable SMS sending</label>\n            </div>\n            <div>\n              <button type=\"submit\" class=\"uk-btn uk-btn-primary uk-btn-sm\">Save Twilio Config</button>\n            </div>\n          </form>\n        </div>\n\n        {stats && (\n          <div class=\"uk-card uk-card-body\">\n            <h3 class=\"text-base font-semibold mb-4\">SMS Usage</h3>\n            <div class=\"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm\">\n              <div>\n                <span class=\"text-muted-foreground block\">Total</span>\n                <span class=\"font-semibold text-lg\">{stats.total || 0}</span>\n              </div>\n              <div>\n                <span class=\"text-muted-foreground block\">Sent</span>\n                <span class=\"font-semibold text-lg\">{stats.sent || 0}</span>\n              </div>\n              <div>\n                <span class=\"text-muted-foreground block\">Received</span>\n                <span class=\"font-semibold text-lg\">{stats.received || 0}</span>\n              </div>\n              <div>\n                <span class=\"text-muted-foreground block\">Failed</span>\n                <span class=\"font-semibold text-lg\" style=\"color:var(--destructive,#dc2626);\">{stats.failed || 0}</span>\n              </div>\n            </div>\n            {stats.total_segments > 0 && (\n              <p class=\"text-xs text-muted-foreground mt-2\">Total segments: {stats.total_segments} (each segment \u2248 $0.0079 USD)</p>\n            )}\n          </div>\n        )}\n\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-2\">Message Templates</h3>\n          <p class=\"text-sm text-muted-foreground mb-3\">\n            Available variables: {'{{first_name}} {{last_name}} {{service_name}} {{date}} {{time}} {{provider_name}} {{total}}'}\n          </p>\n          <div class=\"grid gap-3\">\n            {templates.map((tpl) => (\n              <form\n                hx-post={`/admin/sms-templates/${tpl.id}`}\n                hx-swap=\"none\"\n                class=\"grid gap-2\"\n                style=\"border-bottom:1px solid var(--border);padding-bottom:12px;\"\n              >\n                <div class=\"flex items-start justify-between gap-2\">\n                  <label class=\"text-sm font-medium leading-tight\" for={`tpl-body-${tpl.id}`}>{tpl.label}</label>\n                  <div class=\"flex items-center gap-1.5 shrink-0\">\n                    <input\n                      type=\"checkbox\"\n                      name=\"is_active\"\n                      value=\"1\"\n                      checked={!!tpl.is_active}\n                      class=\"uk-checkbox\"\n                    />\n                    <span class=\"text-[11px] text-muted-foreground\">{tpl.event_type}</span>\n                  </div>\n                </div>\n                <textarea\n                  name=\"body_template\"\n                  id={`tpl-body-${tpl.id}`}\n                  class=\"uk-textarea text-sm\"\n                  rows={3}\n                  autocapitalize=\"off\"\n                  spellcheck=\"false\"\n                  style=\"font-family:monospace;resize:vertical;\"\n                  oninput={`var c=this.value.length;var s=c<=160?1:Math.ceil(c/153);this.closest('form').querySelector('.tpl-chars').textContent=c+' chars \u00B7 '+s+' segment'+(s>1?'s':'');`}\n                >{tpl.body_template}</textarea>\n                <div class=\"flex items-center justify-between\">\n                  <span class=\"tpl-chars text-[11px] text-muted-foreground\">\n                    {tpl.body_template.length} chars \u00B7 {segmentCount(tpl.body_template.length)} segment{segmentCount(tpl.body_template.length) > 1 ? 's' : ''}\n                  </span>\n                  <button type=\"submit\" class=\"uk-btn uk-btn-default uk-btn-sm\">Save</button>\n                </div>\n              </form>\n            ))}\n          </div>\n        </div>\n\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-2\">Webhook URLs</h3>\n          <p class=\"text-sm text-muted-foreground mb-2\">Configure these in your Twilio phone number settings:</p>\n          <div class=\"grid gap-2 text-sm\">\n            <div>\n              <span class=\"text-muted-foreground block\">Inbound SMS Webhook:</span>\n              <code class=\"block mt-1 break-all\" style=\"font-size:12px;\">https://api.unclebike.xyz/webhooks/twilio/inbound</code>\n            </div>\n            <div>\n              <span class=\"text-muted-foreground block\">Status Callback:</span>\n              <code class=\"block mt-1 break-all\" style=\"font-size:12px;\">https://api.unclebike.xyz/webhooks/twilio/status</code>\n            </div>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </Layout>\n);\n", "// src/jsx/dom/intrinsic-element/components.ts\nimport { useContext } from \"../../context.js\";\nimport { use, useCallback, useMemo, useState } from \"../../hooks/index.js\";\nimport { dataPrecedenceAttr, deDupeKeyMap, domRenderers } from \"../../intrinsic-element/common.js\";\nimport { FormContext, registerAction } from \"../hooks/index.js\";\nimport { createPortal, getNameSpaceContext } from \"../render.js\";\nvar clearCache = () => {\n  blockingPromiseMap = /* @__PURE__ */ Object.create(null);\n  createdElements = /* @__PURE__ */ Object.create(null);\n};\nvar composeRef = (ref, cb) => {\n  return useMemo(\n    () => (e) => {\n      let refCleanup;\n      if (ref) {\n        if (typeof ref === \"function\") {\n          refCleanup = ref(e) || (() => {\n            ref(null);\n          });\n        } else if (ref && \"current\" in ref) {\n          ref.current = e;\n          refCleanup = () => {\n            ref.current = null;\n          };\n        }\n      }\n      const cbCleanup = cb(e);\n      return () => {\n        cbCleanup?.();\n        refCleanup?.();\n      };\n    },\n    [ref]\n  );\n};\nvar blockingPromiseMap = /* @__PURE__ */ Object.create(null);\nvar createdElements = /* @__PURE__ */ Object.create(null);\nvar documentMetadataTag = (tag, props, preserveNodeType, supportSort, supportBlocking) => {\n  if (props?.itemProp) {\n    return {\n      tag,\n      props,\n      type: tag,\n      ref: props.ref\n    };\n  }\n  const head = document.head;\n  let { onLoad, onError, precedence, blocking, ...restProps } = props;\n  let element = null;\n  let created = false;\n  const deDupeKeys = deDupeKeyMap[tag];\n  let existingElements = void 0;\n  if (deDupeKeys.length > 0) {\n    const tags = head.querySelectorAll(tag);\n    LOOP: for (const e of tags) {\n      for (const key of deDupeKeyMap[tag]) {\n        if (e.getAttribute(key) === props[key]) {\n          element = e;\n          break LOOP;\n        }\n      }\n    }\n    if (!element) {\n      const cacheKey = deDupeKeys.reduce(\n        (acc, key) => props[key] === void 0 ? acc : `${acc}-${key}-${props[key]}`,\n        tag\n      );\n      created = !createdElements[cacheKey];\n      element = createdElements[cacheKey] ||= (() => {\n        const e = document.createElement(tag);\n        for (const key of deDupeKeys) {\n          if (props[key] !== void 0) {\n            e.setAttribute(key, props[key]);\n          }\n          if (props.rel) {\n            e.setAttribute(\"rel\", props.rel);\n          }\n        }\n        return e;\n      })();\n    }\n  } else {\n    existingElements = head.querySelectorAll(tag);\n  }\n  precedence = supportSort ? precedence ?? \"\" : void 0;\n  if (supportSort) {\n    restProps[dataPrecedenceAttr] = precedence;\n  }\n  const insert = useCallback(\n    (e) => {\n      if (deDupeKeys.length > 0) {\n        let found = false;\n        for (const existingElement of head.querySelectorAll(tag)) {\n          if (found && existingElement.getAttribute(dataPrecedenceAttr) !== precedence) {\n            head.insertBefore(e, existingElement);\n            return;\n          }\n          if (existingElement.getAttribute(dataPrecedenceAttr) === precedence) {\n            found = true;\n          }\n        }\n        head.appendChild(e);\n      } else if (existingElements) {\n        let found = false;\n        for (const existingElement of existingElements) {\n          if (existingElement === e) {\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          head.insertBefore(\n            e,\n            head.contains(existingElements[0]) ? existingElements[0] : head.querySelector(tag)\n          );\n        }\n        existingElements = void 0;\n      }\n    },\n    [precedence]\n  );\n  const ref = composeRef(props.ref, (e) => {\n    const key = deDupeKeys[0];\n    if (preserveNodeType === 2) {\n      e.innerHTML = \"\";\n    }\n    if (created || existingElements) {\n      insert(e);\n    }\n    if (!onError && !onLoad) {\n      return;\n    }\n    let promise = blockingPromiseMap[e.getAttribute(key)] ||= new Promise(\n      (resolve, reject) => {\n        e.addEventListener(\"load\", resolve);\n        e.addEventListener(\"error\", reject);\n      }\n    );\n    if (onLoad) {\n      promise = promise.then(onLoad);\n    }\n    if (onError) {\n      promise = promise.catch(onError);\n    }\n    promise.catch(() => {\n    });\n  });\n  if (supportBlocking && blocking === \"render\") {\n    const key = deDupeKeyMap[tag][0];\n    if (props[key]) {\n      const value = props[key];\n      const promise = blockingPromiseMap[value] ||= new Promise((resolve, reject) => {\n        insert(element);\n        element.addEventListener(\"load\", resolve);\n        element.addEventListener(\"error\", reject);\n      });\n      use(promise);\n    }\n  }\n  const jsxNode = {\n    tag,\n    type: tag,\n    props: {\n      ...restProps,\n      ref\n    },\n    ref\n  };\n  jsxNode.p = preserveNodeType;\n  if (element) {\n    jsxNode.e = element;\n  }\n  return createPortal(\n    jsxNode,\n    head\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  );\n};\nvar title = (props) => {\n  const nameSpaceContext = getNameSpaceContext();\n  const ns = nameSpaceContext && useContext(nameSpaceContext);\n  if (ns?.endsWith(\"svg\")) {\n    return {\n      tag: \"title\",\n      props,\n      type: \"title\",\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      ref: props.ref\n    };\n  }\n  return documentMetadataTag(\"title\", props, void 0, false, false);\n};\nvar script = (props) => {\n  if (!props || [\"src\", \"async\"].some((k) => !props[k])) {\n    return {\n      tag: \"script\",\n      props,\n      type: \"script\",\n      ref: props.ref\n    };\n  }\n  return documentMetadataTag(\"script\", props, 1, false, true);\n};\nvar style = (props) => {\n  if (!props || ![\"href\", \"precedence\"].every((k) => k in props)) {\n    return {\n      tag: \"style\",\n      props,\n      type: \"style\",\n      ref: props.ref\n    };\n  }\n  props[\"data-href\"] = props.href;\n  delete props.href;\n  return documentMetadataTag(\"style\", props, 2, true, true);\n};\nvar link = (props) => {\n  if (!props || [\"onLoad\", \"onError\"].some((k) => k in props) || props.rel === \"stylesheet\" && (!(\"precedence\" in props) || \"disabled\" in props)) {\n    return {\n      tag: \"link\",\n      props,\n      type: \"link\",\n      ref: props.ref\n    };\n  }\n  return documentMetadataTag(\"link\", props, 1, \"precedence\" in props, true);\n};\nvar meta = (props) => {\n  return documentMetadataTag(\"meta\", props, void 0, false, false);\n};\nvar customEventFormAction = /* @__PURE__ */ Symbol();\nvar form = (props) => {\n  const { action, ...restProps } = props;\n  if (typeof action !== \"function\") {\n    ;\n    restProps.action = action;\n  }\n  const [state, setState] = useState([null, false]);\n  const onSubmit = useCallback(\n    async (ev) => {\n      const currentAction = ev.isTrusted ? action : ev.detail[customEventFormAction];\n      if (typeof currentAction !== \"function\") {\n        return;\n      }\n      ev.preventDefault();\n      const formData = new FormData(ev.target);\n      setState([formData, true]);\n      const actionRes = currentAction(formData);\n      if (actionRes instanceof Promise) {\n        registerAction(actionRes);\n        await actionRes;\n      }\n      setState([null, true]);\n    },\n    []\n  );\n  const ref = composeRef(props.ref, (el) => {\n    el.addEventListener(\"submit\", onSubmit);\n    return () => {\n      el.removeEventListener(\"submit\", onSubmit);\n    };\n  });\n  const [data, isDirty] = state;\n  state[1] = false;\n  return {\n    tag: FormContext,\n    props: {\n      value: {\n        pending: data !== null,\n        data,\n        method: data ? \"post\" : null,\n        action: data ? action : null\n      },\n      children: {\n        tag: \"form\",\n        props: {\n          ...restProps,\n          ref\n        },\n        type: \"form\",\n        ref\n      }\n    },\n    f: isDirty\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  };\n};\nvar formActionableElement = (tag, {\n  formAction,\n  ...props\n}) => {\n  if (typeof formAction === \"function\") {\n    const onClick = useCallback((ev) => {\n      ev.preventDefault();\n      ev.currentTarget.form.dispatchEvent(\n        new CustomEvent(\"submit\", { detail: { [customEventFormAction]: formAction } })\n      );\n    }, []);\n    props.ref = composeRef(props.ref, (el) => {\n      el.addEventListener(\"click\", onClick);\n      return () => {\n        el.removeEventListener(\"click\", onClick);\n      };\n    });\n  }\n  return {\n    tag,\n    props,\n    type: tag,\n    ref: props.ref\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  };\n};\nvar input = (props) => formActionableElement(\"input\", props);\nvar button = (props) => formActionableElement(\"button\", props);\nObject.assign(domRenderers, {\n  title,\n  script,\n  style,\n  link,\n  meta,\n  form,\n  input,\n  button\n});\nexport {\n  button,\n  clearCache,\n  composeRef,\n  form,\n  input,\n  link,\n  meta,\n  script,\n  style,\n  title\n};\n", "// src/jsx/dom/render.ts\nimport { toArray } from \"../children.js\";\nimport {\n  DOM_ERROR_HANDLER,\n  DOM_INTERNAL_TAG,\n  DOM_MEMO,\n  DOM_RENDERER,\n  DOM_STASH\n} from \"../constants.js\";\nimport { globalContexts as globalJSXContexts, useContext } from \"../context.js\";\nimport { STASH_EFFECT } from \"../hooks/index.js\";\nimport { normalizeIntrinsicElementKey, styleObjectForEach } from \"../utils.js\";\nimport { createContext } from \"./context.js\";\nvar HONO_PORTAL_ELEMENT = \"_hp\";\nvar eventAliasMap = {\n  Change: \"Input\",\n  DoubleClick: \"DblClick\"\n};\nvar nameSpaceMap = {\n  svg: \"2000/svg\",\n  math: \"1998/Math/MathML\"\n};\nvar buildDataStack = [];\nvar refCleanupMap = /* @__PURE__ */ new WeakMap();\nvar nameSpaceContext = void 0;\nvar getNameSpaceContext = () => nameSpaceContext;\nvar isNodeString = (node) => \"t\" in node;\nvar eventCache = {\n  // pre-define events that are used very frequently\n  onClick: [\"click\", false]\n};\nvar getEventSpec = (key) => {\n  if (!key.startsWith(\"on\")) {\n    return void 0;\n  }\n  if (eventCache[key]) {\n    return eventCache[key];\n  }\n  const match = key.match(/^on([A-Z][a-zA-Z]+?(?:PointerCapture)?)(Capture)?$/);\n  if (match) {\n    const [, eventName, capture] = match;\n    return eventCache[key] = [(eventAliasMap[eventName] || eventName).toLowerCase(), !!capture];\n  }\n  return void 0;\n};\nvar toAttributeName = (element, key) => nameSpaceContext && element instanceof SVGElement && /[A-Z]/.test(key) && (key in element.style || // Presentation attributes are findable in style object. \"clip-path\", \"font-size\", \"stroke-width\", etc.\nkey.match(/^(?:o|pai|str|u|ve)/)) ? key.replace(/([A-Z])/g, \"-$1\").toLowerCase() : key;\nvar applyProps = (container, attributes, oldAttributes) => {\n  attributes ||= {};\n  for (let key in attributes) {\n    const value = attributes[key];\n    if (key !== \"children\" && (!oldAttributes || oldAttributes[key] !== value)) {\n      key = normalizeIntrinsicElementKey(key);\n      const eventSpec = getEventSpec(key);\n      if (eventSpec) {\n        if (oldAttributes?.[key] !== value) {\n          if (oldAttributes) {\n            container.removeEventListener(eventSpec[0], oldAttributes[key], eventSpec[1]);\n          }\n          if (value != null) {\n            if (typeof value !== \"function\") {\n              throw new Error(`Event handler for \"${key}\" is not a function`);\n            }\n            container.addEventListener(eventSpec[0], value, eventSpec[1]);\n          }\n        }\n      } else if (key === \"dangerouslySetInnerHTML\" && value) {\n        container.innerHTML = value.__html;\n      } else if (key === \"ref\") {\n        let cleanup;\n        if (typeof value === \"function\") {\n          cleanup = value(container) || (() => value(null));\n        } else if (value && \"current\" in value) {\n          value.current = container;\n          cleanup = () => value.current = null;\n        }\n        refCleanupMap.set(container, cleanup);\n      } else if (key === \"style\") {\n        const style = container.style;\n        if (typeof value === \"string\") {\n          style.cssText = value;\n        } else {\n          style.cssText = \"\";\n          if (value != null) {\n            styleObjectForEach(value, style.setProperty.bind(style));\n          }\n        }\n      } else {\n        if (key === \"value\") {\n          const nodeName = container.nodeName;\n          if (nodeName === \"INPUT\" || nodeName === \"TEXTAREA\" || nodeName === \"SELECT\") {\n            ;\n            container.value = value === null || value === void 0 || value === false ? null : value;\n            if (nodeName === \"TEXTAREA\") {\n              container.textContent = value;\n              continue;\n            } else if (nodeName === \"SELECT\") {\n              if (container.selectedIndex === -1) {\n                ;\n                container.selectedIndex = 0;\n              }\n              continue;\n            }\n          }\n        } else if (key === \"checked\" && container.nodeName === \"INPUT\" || key === \"selected\" && container.nodeName === \"OPTION\") {\n          ;\n          container[key] = value;\n        }\n        const k = toAttributeName(container, key);\n        if (value === null || value === void 0 || value === false) {\n          container.removeAttribute(k);\n        } else if (value === true) {\n          container.setAttribute(k, \"\");\n        } else if (typeof value === \"string\" || typeof value === \"number\") {\n          container.setAttribute(k, value);\n        } else {\n          container.setAttribute(k, value.toString());\n        }\n      }\n    }\n  }\n  if (oldAttributes) {\n    for (let key in oldAttributes) {\n      const value = oldAttributes[key];\n      if (key !== \"children\" && !(key in attributes)) {\n        key = normalizeIntrinsicElementKey(key);\n        const eventSpec = getEventSpec(key);\n        if (eventSpec) {\n          container.removeEventListener(eventSpec[0], value, eventSpec[1]);\n        } else if (key === \"ref\") {\n          refCleanupMap.get(container)?.();\n        } else {\n          container.removeAttribute(toAttributeName(container, key));\n        }\n      }\n    }\n  }\n};\nvar invokeTag = (context, node) => {\n  node[DOM_STASH][0] = 0;\n  buildDataStack.push([context, node]);\n  const func = node.tag[DOM_RENDERER] || node.tag;\n  const props = func.defaultProps ? {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ...func.defaultProps,\n    ...node.props\n  } : node.props;\n  try {\n    return [func.call(null, props)];\n  } finally {\n    buildDataStack.pop();\n  }\n};\nvar getNextChildren = (node, container, nextChildren, childrenToRemove, callbacks) => {\n  if (node.vR?.length) {\n    childrenToRemove.push(...node.vR);\n    delete node.vR;\n  }\n  if (typeof node.tag === \"function\") {\n    node[DOM_STASH][1][STASH_EFFECT]?.forEach((data) => callbacks.push(data));\n  }\n  node.vC.forEach((child) => {\n    if (isNodeString(child)) {\n      nextChildren.push(child);\n    } else {\n      if (typeof child.tag === \"function\" || child.tag === \"\") {\n        child.c = container;\n        const currentNextChildrenIndex = nextChildren.length;\n        getNextChildren(child, container, nextChildren, childrenToRemove, callbacks);\n        if (child.s) {\n          for (let i = currentNextChildrenIndex; i < nextChildren.length; i++) {\n            nextChildren[i].s = true;\n          }\n          child.s = false;\n        }\n      } else {\n        nextChildren.push(child);\n        if (child.vR?.length) {\n          childrenToRemove.push(...child.vR);\n          delete child.vR;\n        }\n      }\n    }\n  });\n};\nvar findInsertBefore = (node) => {\n  while (node && (node.tag === HONO_PORTAL_ELEMENT || !node.e)) {\n    node = node.tag === HONO_PORTAL_ELEMENT || !node.vC?.[0] ? node.nN : node.vC[0];\n  }\n  return node?.e;\n};\nvar removeNode = (node) => {\n  if (!isNodeString(node)) {\n    node[DOM_STASH]?.[1][STASH_EFFECT]?.forEach((data) => data[2]?.());\n    refCleanupMap.get(node.e)?.();\n    if (node.p === 2) {\n      node.vC?.forEach((n) => n.p = 2);\n    }\n    node.vC?.forEach(removeNode);\n  }\n  if (!node.p) {\n    node.e?.remove();\n    delete node.e;\n  }\n  if (typeof node.tag === \"function\") {\n    updateMap.delete(node);\n    fallbackUpdateFnArrayMap.delete(node);\n    delete node[DOM_STASH][3];\n    node.a = true;\n  }\n};\nvar apply = (node, container, isNew) => {\n  node.c = container;\n  applyNodeObject(node, container, isNew);\n};\nvar findChildNodeIndex = (childNodes, child) => {\n  if (!child) {\n    return;\n  }\n  for (let i = 0, len = childNodes.length; i < len; i++) {\n    if (childNodes[i] === child) {\n      return i;\n    }\n  }\n  return;\n};\nvar cancelBuild = /* @__PURE__ */ Symbol();\nvar applyNodeObject = (node, container, isNew) => {\n  const next = [];\n  const remove = [];\n  const callbacks = [];\n  getNextChildren(node, container, next, remove, callbacks);\n  remove.forEach(removeNode);\n  const childNodes = isNew ? void 0 : container.childNodes;\n  let offset;\n  let insertBeforeNode = null;\n  if (isNew) {\n    offset = -1;\n  } else if (!childNodes.length) {\n    offset = 0;\n  } else {\n    const offsetByNextNode = findChildNodeIndex(childNodes, findInsertBefore(node.nN));\n    if (offsetByNextNode !== void 0) {\n      insertBeforeNode = childNodes[offsetByNextNode];\n      offset = offsetByNextNode;\n    } else {\n      offset = findChildNodeIndex(childNodes, next.find((n) => n.tag !== HONO_PORTAL_ELEMENT && n.e)?.e) ?? -1;\n    }\n    if (offset === -1) {\n      isNew = true;\n    }\n  }\n  for (let i = 0, len = next.length; i < len; i++, offset++) {\n    const child = next[i];\n    let el;\n    if (child.s && child.e) {\n      el = child.e;\n      child.s = false;\n    } else {\n      const isNewLocal = isNew || !child.e;\n      if (isNodeString(child)) {\n        if (child.e && child.d) {\n          child.e.textContent = child.t;\n        }\n        child.d = false;\n        el = child.e ||= document.createTextNode(child.t);\n      } else {\n        el = child.e ||= child.n ? document.createElementNS(child.n, child.tag) : document.createElement(child.tag);\n        applyProps(el, child.props, child.pP);\n        applyNodeObject(child, el, isNewLocal);\n      }\n    }\n    if (child.tag === HONO_PORTAL_ELEMENT) {\n      offset--;\n    } else if (isNew) {\n      if (!el.parentNode) {\n        container.appendChild(el);\n      }\n    } else if (childNodes[offset] !== el && childNodes[offset - 1] !== el) {\n      if (childNodes[offset + 1] === el) {\n        container.appendChild(childNodes[offset]);\n      } else {\n        container.insertBefore(el, insertBeforeNode || childNodes[offset] || null);\n      }\n    }\n  }\n  if (node.pP) {\n    node.pP = void 0;\n  }\n  if (callbacks.length) {\n    const useLayoutEffectCbs = [];\n    const useEffectCbs = [];\n    callbacks.forEach(([, useLayoutEffectCb, , useEffectCb, useInsertionEffectCb]) => {\n      if (useLayoutEffectCb) {\n        useLayoutEffectCbs.push(useLayoutEffectCb);\n      }\n      if (useEffectCb) {\n        useEffectCbs.push(useEffectCb);\n      }\n      useInsertionEffectCb?.();\n    });\n    useLayoutEffectCbs.forEach((cb) => cb());\n    if (useEffectCbs.length) {\n      requestAnimationFrame(() => {\n        useEffectCbs.forEach((cb) => cb());\n      });\n    }\n  }\n};\nvar isSameContext = (oldContexts, newContexts) => !!(oldContexts && oldContexts.length === newContexts.length && oldContexts.every((ctx, i) => ctx[1] === newContexts[i][1]));\nvar fallbackUpdateFnArrayMap = /* @__PURE__ */ new WeakMap();\nvar build = (context, node, children) => {\n  const buildWithPreviousChildren = !children && node.pC;\n  if (children) {\n    node.pC ||= node.vC;\n  }\n  let foundErrorHandler;\n  try {\n    children ||= typeof node.tag == \"function\" ? invokeTag(context, node) : toArray(node.props.children);\n    if (children[0]?.tag === \"\" && children[0][DOM_ERROR_HANDLER]) {\n      foundErrorHandler = children[0][DOM_ERROR_HANDLER];\n      context[5].push([context, foundErrorHandler, node]);\n    }\n    const oldVChildren = buildWithPreviousChildren ? [...node.pC] : node.vC ? [...node.vC] : void 0;\n    const vChildren = [];\n    let prevNode;\n    for (let i = 0; i < children.length; i++) {\n      if (Array.isArray(children[i])) {\n        children.splice(i, 1, ...children[i].flat());\n      }\n      let child = buildNode(children[i]);\n      if (child) {\n        if (typeof child.tag === \"function\" && // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        !child.tag[DOM_INTERNAL_TAG]) {\n          if (globalJSXContexts.length > 0) {\n            child[DOM_STASH][2] = globalJSXContexts.map((c) => [c, c.values.at(-1)]);\n          }\n          if (context[5]?.length) {\n            child[DOM_STASH][3] = context[5].at(-1);\n          }\n        }\n        let oldChild;\n        if (oldVChildren && oldVChildren.length) {\n          const i2 = oldVChildren.findIndex(\n            isNodeString(child) ? (c) => isNodeString(c) : child.key !== void 0 ? (c) => c.key === child.key && c.tag === child.tag : (c) => c.tag === child.tag\n          );\n          if (i2 !== -1) {\n            oldChild = oldVChildren[i2];\n            oldVChildren.splice(i2, 1);\n          }\n        }\n        if (oldChild) {\n          if (isNodeString(child)) {\n            if (oldChild.t !== child.t) {\n              ;\n              oldChild.t = child.t;\n              oldChild.d = true;\n            }\n            child = oldChild;\n          } else {\n            const pP = oldChild.pP = oldChild.props;\n            oldChild.props = child.props;\n            oldChild.f ||= child.f || node.f;\n            if (typeof child.tag === \"function\") {\n              const oldContexts = oldChild[DOM_STASH][2];\n              oldChild[DOM_STASH][2] = child[DOM_STASH][2] || [];\n              oldChild[DOM_STASH][3] = child[DOM_STASH][3];\n              if (!oldChild.f && ((oldChild.o || oldChild) === child.o || // The code generated by the react compiler is memoized under this condition.\n              oldChild.tag[DOM_MEMO]?.(pP, oldChild.props)) && // The `memo` function is memoized under this condition.\n              isSameContext(oldContexts, oldChild[DOM_STASH][2])) {\n                oldChild.s = true;\n              }\n            }\n            child = oldChild;\n          }\n        } else if (!isNodeString(child) && nameSpaceContext) {\n          const ns = useContext(nameSpaceContext);\n          if (ns) {\n            child.n = ns;\n          }\n        }\n        if (!isNodeString(child) && !child.s) {\n          build(context, child);\n          delete child.f;\n        }\n        vChildren.push(child);\n        if (prevNode && !prevNode.s && !child.s) {\n          for (let p = prevNode; p && !isNodeString(p); p = p.vC?.at(-1)) {\n            p.nN = child;\n          }\n        }\n        prevNode = child;\n      }\n    }\n    node.vR = buildWithPreviousChildren ? [...node.vC, ...oldVChildren || []] : oldVChildren || [];\n    node.vC = vChildren;\n    if (buildWithPreviousChildren) {\n      delete node.pC;\n    }\n  } catch (e) {\n    node.f = true;\n    if (e === cancelBuild) {\n      if (foundErrorHandler) {\n        return;\n      } else {\n        throw e;\n      }\n    }\n    const [errorHandlerContext, errorHandler, errorHandlerNode] = node[DOM_STASH]?.[3] || [];\n    if (errorHandler) {\n      const fallbackUpdateFn = () => update([0, false, context[2]], errorHandlerNode);\n      const fallbackUpdateFnArray = fallbackUpdateFnArrayMap.get(errorHandlerNode) || [];\n      fallbackUpdateFnArray.push(fallbackUpdateFn);\n      fallbackUpdateFnArrayMap.set(errorHandlerNode, fallbackUpdateFnArray);\n      const fallback = errorHandler(e, () => {\n        const fnArray = fallbackUpdateFnArrayMap.get(errorHandlerNode);\n        if (fnArray) {\n          const i = fnArray.indexOf(fallbackUpdateFn);\n          if (i !== -1) {\n            fnArray.splice(i, 1);\n            return fallbackUpdateFn();\n          }\n        }\n      });\n      if (fallback) {\n        if (context[0] === 1) {\n          context[1] = true;\n        } else {\n          build(context, errorHandlerNode, [fallback]);\n          if ((errorHandler.length === 1 || context !== errorHandlerContext) && errorHandlerNode.c) {\n            apply(errorHandlerNode, errorHandlerNode.c, false);\n            return;\n          }\n        }\n        throw cancelBuild;\n      }\n    }\n    throw e;\n  } finally {\n    if (foundErrorHandler) {\n      context[5].pop();\n    }\n  }\n};\nvar buildNode = (node) => {\n  if (node === void 0 || node === null || typeof node === \"boolean\") {\n    return void 0;\n  } else if (typeof node === \"string\" || typeof node === \"number\") {\n    return { t: node.toString(), d: true };\n  } else {\n    if (\"vR\" in node) {\n      node = {\n        tag: node.tag,\n        props: node.props,\n        key: node.key,\n        f: node.f,\n        type: node.tag,\n        ref: node.props.ref,\n        o: node.o || node\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      };\n    }\n    if (typeof node.tag === \"function\") {\n      ;\n      node[DOM_STASH] = [0, []];\n    } else {\n      const ns = nameSpaceMap[node.tag];\n      if (ns) {\n        nameSpaceContext ||= createContext(\"\");\n        node.props.children = [\n          {\n            tag: nameSpaceContext,\n            props: {\n              value: node.n = `http://www.w3.org/${ns}`,\n              children: node.props.children\n            }\n          }\n        ];\n      }\n    }\n    return node;\n  }\n};\nvar replaceContainer = (node, from, to) => {\n  if (node.c === from) {\n    node.c = to;\n    node.vC.forEach((child) => replaceContainer(child, from, to));\n  }\n};\nvar updateSync = (context, node) => {\n  node[DOM_STASH][2]?.forEach(([c, v]) => {\n    c.values.push(v);\n  });\n  try {\n    build(context, node, void 0);\n  } catch {\n    return;\n  }\n  if (node.a) {\n    delete node.a;\n    return;\n  }\n  node[DOM_STASH][2]?.forEach(([c]) => {\n    c.values.pop();\n  });\n  if (context[0] !== 1 || !context[1]) {\n    apply(node, node.c, false);\n  }\n};\nvar updateMap = /* @__PURE__ */ new WeakMap();\nvar currentUpdateSets = [];\nvar update = async (context, node) => {\n  context[5] ||= [];\n  const existing = updateMap.get(node);\n  if (existing) {\n    existing[0](void 0);\n  }\n  let resolve;\n  const promise = new Promise((r) => resolve = r);\n  updateMap.set(node, [\n    resolve,\n    () => {\n      if (context[2]) {\n        context[2](context, node, (context2) => {\n          updateSync(context2, node);\n        }).then(() => resolve(node));\n      } else {\n        updateSync(context, node);\n        resolve(node);\n      }\n    }\n  ]);\n  if (currentUpdateSets.length) {\n    ;\n    currentUpdateSets.at(-1).add(node);\n  } else {\n    await Promise.resolve();\n    const latest = updateMap.get(node);\n    if (latest) {\n      updateMap.delete(node);\n      latest[1]();\n    }\n  }\n  return promise;\n};\nvar renderNode = (node, container) => {\n  const context = [];\n  context[5] = [];\n  context[4] = true;\n  build(context, node, void 0);\n  context[4] = false;\n  const fragment = document.createDocumentFragment();\n  apply(node, fragment, true);\n  replaceContainer(node, fragment, container);\n  container.replaceChildren(fragment);\n};\nvar render = (jsxNode, container) => {\n  renderNode(buildNode({ tag: \"\", props: { children: jsxNode } }), container);\n};\nvar flushSync = (callback) => {\n  const set = /* @__PURE__ */ new Set();\n  currentUpdateSets.push(set);\n  callback();\n  set.forEach((node) => {\n    const latest = updateMap.get(node);\n    if (latest) {\n      updateMap.delete(node);\n      latest[1]();\n    }\n  });\n  currentUpdateSets.pop();\n};\nvar createPortal = (children, container, key) => ({\n  tag: HONO_PORTAL_ELEMENT,\n  props: {\n    children\n  },\n  key,\n  e: container,\n  p: 1\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n});\nexport {\n  build,\n  buildDataStack,\n  buildNode,\n  createPortal,\n  flushSync,\n  getNameSpaceContext,\n  render,\n  renderNode,\n  update\n};\n", "// src/jsx/hooks/index.ts\nimport { DOM_STASH } from \"../constants.js\";\nimport { buildDataStack, update } from \"../dom/render.js\";\nvar STASH_SATE = 0;\nvar STASH_EFFECT = 1;\nvar STASH_CALLBACK = 2;\nvar STASH_MEMO = 3;\nvar STASH_REF = 4;\nvar resolvedPromiseValueMap = /* @__PURE__ */ new WeakMap();\nvar isDepsChanged = (prevDeps, deps) => !prevDeps || !deps || prevDeps.length !== deps.length || deps.some((dep, i) => dep !== prevDeps[i]);\nvar viewTransitionState = void 0;\nvar documentStartViewTransition = (cb) => {\n  if (document?.startViewTransition) {\n    return document.startViewTransition(cb);\n  } else {\n    cb();\n    return { finished: Promise.resolve() };\n  }\n};\nvar updateHook = void 0;\nvar viewTransitionHook = (context, node, cb) => {\n  const state = [true, false];\n  let lastVC = node.vC;\n  return documentStartViewTransition(() => {\n    if (lastVC === node.vC) {\n      viewTransitionState = state;\n      cb(context);\n      viewTransitionState = void 0;\n      lastVC = node.vC;\n    }\n  }).finished.then(() => {\n    if (state[1] && lastVC === node.vC) {\n      state[0] = false;\n      viewTransitionState = state;\n      cb(context);\n      viewTransitionState = void 0;\n    }\n  });\n};\nvar startViewTransition = (callback) => {\n  updateHook = viewTransitionHook;\n  try {\n    callback();\n  } finally {\n    updateHook = void 0;\n  }\n};\nvar useViewTransition = () => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return [false, () => {\n    }];\n  }\n  if (viewTransitionState) {\n    viewTransitionState[1] = true;\n  }\n  return [!!viewTransitionState?.[0], startViewTransition];\n};\nvar pendingStack = [];\nvar runCallback = (type, callback) => {\n  let resolve;\n  const promise = new Promise((r) => resolve = r);\n  pendingStack.push([type, promise]);\n  try {\n    const res = callback();\n    if (res instanceof Promise) {\n      res.then(resolve, resolve);\n    } else {\n      resolve();\n    }\n  } finally {\n    pendingStack.pop();\n  }\n};\nvar startTransition = (callback) => {\n  runCallback(1, callback);\n};\nvar startTransitionHook = (callback) => {\n  runCallback(2, callback);\n};\nvar useTransition = () => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return [false, () => {\n    }];\n  }\n  const [error, setError] = useState();\n  const [state, updateState] = useState();\n  if (error) {\n    throw error[0];\n  }\n  const startTransitionLocalHook = useCallback(\n    (callback) => {\n      startTransitionHook(() => {\n        updateState((state2) => !state2);\n        let res = callback();\n        if (res instanceof Promise) {\n          res = res.catch((e) => {\n            setError([e]);\n          });\n        }\n        return res;\n      });\n    },\n    [state]\n  );\n  const [context] = buildData;\n  return [context[0] === 2, startTransitionLocalHook];\n};\nvar useDeferredValue = (value, ...rest) => {\n  const [values, setValues] = useState(\n    rest.length ? [rest[0], rest[0]] : [value, value]\n  );\n  if (Object.is(values[1], value)) {\n    return values[1];\n  }\n  pendingStack.push([3, Promise.resolve()]);\n  updateHook = async (context, _, cb) => {\n    cb(context);\n    values[0] = value;\n  };\n  setValues([values[0], value]);\n  updateHook = void 0;\n  pendingStack.pop();\n  return values[0];\n};\nvar useState = (initialState) => {\n  const resolveInitialState = () => typeof initialState === \"function\" ? initialState() : initialState;\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return [resolveInitialState(), () => {\n    }];\n  }\n  const [, node] = buildData;\n  const stateArray = node[DOM_STASH][1][STASH_SATE] ||= [];\n  const hookIndex = node[DOM_STASH][0]++;\n  return stateArray[hookIndex] ||= [\n    resolveInitialState(),\n    (newState) => {\n      const localUpdateHook = updateHook;\n      const stateData = stateArray[hookIndex];\n      if (typeof newState === \"function\") {\n        newState = newState(stateData[0]);\n      }\n      if (!Object.is(newState, stateData[0])) {\n        stateData[0] = newState;\n        if (pendingStack.length) {\n          const [pendingType, pendingPromise] = pendingStack.at(-1);\n          Promise.all([\n            pendingType === 3 ? node : update([pendingType, false, localUpdateHook], node),\n            pendingPromise\n          ]).then(([node2]) => {\n            if (!node2 || !(pendingType === 2 || pendingType === 3)) {\n              return;\n            }\n            const lastVC = node2.vC;\n            const addUpdateTask = () => {\n              setTimeout(() => {\n                if (lastVC !== node2.vC) {\n                  return;\n                }\n                update([pendingType === 3 ? 1 : 0, false, localUpdateHook], node2);\n              });\n            };\n            requestAnimationFrame(addUpdateTask);\n          });\n        } else {\n          update([0, false, localUpdateHook], node);\n        }\n      }\n    }\n  ];\n};\nvar useReducer = (reducer, initialArg, init) => {\n  const handler = useCallback(\n    (action) => {\n      setState((state2) => reducer(state2, action));\n    },\n    [reducer]\n  );\n  const [state, setState] = useState(() => init ? init(initialArg) : initialArg);\n  return [state, handler];\n};\nvar useEffectCommon = (index, effect, deps) => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return;\n  }\n  const [, node] = buildData;\n  const effectDepsArray = node[DOM_STASH][1][STASH_EFFECT] ||= [];\n  const hookIndex = node[DOM_STASH][0]++;\n  const [prevDeps, , prevCleanup] = effectDepsArray[hookIndex] ||= [];\n  if (isDepsChanged(prevDeps, deps)) {\n    if (prevCleanup) {\n      prevCleanup();\n    }\n    const runner = () => {\n      data[index] = void 0;\n      data[2] = effect();\n    };\n    const data = [deps, void 0, void 0, void 0, void 0];\n    data[index] = runner;\n    effectDepsArray[hookIndex] = data;\n  }\n};\nvar useEffect = (effect, deps) => useEffectCommon(3, effect, deps);\nvar useLayoutEffect = (effect, deps) => useEffectCommon(1, effect, deps);\nvar useInsertionEffect = (effect, deps) => useEffectCommon(4, effect, deps);\nvar useCallback = (callback, deps) => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return callback;\n  }\n  const [, node] = buildData;\n  const callbackArray = node[DOM_STASH][1][STASH_CALLBACK] ||= [];\n  const hookIndex = node[DOM_STASH][0]++;\n  const prevDeps = callbackArray[hookIndex];\n  if (isDepsChanged(prevDeps?.[1], deps)) {\n    callbackArray[hookIndex] = [callback, deps];\n  } else {\n    callback = callbackArray[hookIndex][0];\n  }\n  return callback;\n};\nvar useRef = (initialValue) => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return { current: initialValue };\n  }\n  const [, node] = buildData;\n  const refArray = node[DOM_STASH][1][STASH_REF] ||= [];\n  const hookIndex = node[DOM_STASH][0]++;\n  return refArray[hookIndex] ||= { current: initialValue };\n};\nvar use = (promise) => {\n  const cachedRes = resolvedPromiseValueMap.get(promise);\n  if (cachedRes) {\n    if (cachedRes.length === 2) {\n      throw cachedRes[1];\n    }\n    return cachedRes[0];\n  }\n  promise.then(\n    (res) => resolvedPromiseValueMap.set(promise, [res]),\n    (e) => resolvedPromiseValueMap.set(promise, [void 0, e])\n  );\n  throw promise;\n};\nvar useMemo = (factory, deps) => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    return factory();\n  }\n  const [, node] = buildData;\n  const memoArray = node[DOM_STASH][1][STASH_MEMO] ||= [];\n  const hookIndex = node[DOM_STASH][0]++;\n  const prevDeps = memoArray[hookIndex];\n  if (isDepsChanged(prevDeps?.[1], deps)) {\n    memoArray[hookIndex] = [factory(), deps];\n  }\n  return memoArray[hookIndex][0];\n};\nvar idCounter = 0;\nvar useId = () => useMemo(() => `:r${(idCounter++).toString(32)}:`, []);\nvar useDebugValue = (_value, _formatter) => {\n};\nvar createRef = () => {\n  return { current: null };\n};\nvar forwardRef = (Component) => {\n  return (props) => {\n    const { ref, ...rest } = props;\n    return Component(rest, ref);\n  };\n};\nvar useImperativeHandle = (ref, createHandle, deps) => {\n  useEffect(() => {\n    ref.current = createHandle();\n    return () => {\n      ref.current = null;\n    };\n  }, deps);\n};\nvar useSyncExternalStore = (subscribe, getSnapshot, getServerSnapshot) => {\n  const buildData = buildDataStack.at(-1);\n  if (!buildData) {\n    if (!getServerSnapshot) {\n      throw new Error(\"getServerSnapshot is required for server side rendering\");\n    }\n    return getServerSnapshot();\n  }\n  const [serverSnapshotIsUsed] = useState(!!(buildData[0][4] && getServerSnapshot));\n  const [state, setState] = useState(\n    () => serverSnapshotIsUsed ? getServerSnapshot() : getSnapshot()\n  );\n  useEffect(() => {\n    if (serverSnapshotIsUsed) {\n      setState(getSnapshot());\n    }\n    return subscribe(() => {\n      setState(getSnapshot());\n    });\n  }, []);\n  return state;\n};\nexport {\n  STASH_EFFECT,\n  createRef,\n  forwardRef,\n  startTransition,\n  startViewTransition,\n  use,\n  useCallback,\n  useDebugValue,\n  useDeferredValue,\n  useEffect,\n  useId,\n  useImperativeHandle,\n  useInsertionEffect,\n  useLayoutEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n  useSyncExternalStore,\n  useTransition,\n  useViewTransition\n};\n", "// src/jsx/dom/hooks/index.ts\nimport { PERMALINK } from \"../../constants.js\";\nimport { useContext } from \"../../context.js\";\nimport { useCallback, useState } from \"../../hooks/index.js\";\nimport { createContext } from \"../context.js\";\nvar FormContext = createContext({\n  pending: false,\n  data: null,\n  method: null,\n  action: null\n});\nvar actions = /* @__PURE__ */ new Set();\nvar registerAction = (action) => {\n  actions.add(action);\n  action.finally(() => actions.delete(action));\n};\nvar useFormStatus = () => {\n  return useContext(FormContext);\n};\nvar useOptimistic = (state, updateState) => {\n  const [optimisticState, setOptimisticState] = useState(state);\n  if (actions.size > 0) {\n    Promise.all(actions).finally(() => {\n      setOptimisticState(state);\n    });\n  } else {\n    setOptimisticState(state);\n  }\n  const cb = useCallback((newData) => {\n    setOptimisticState((currentState) => updateState(currentState, newData));\n  }, []);\n  return [optimisticState, cb];\n};\nvar useActionState = (fn, initialState, permalink) => {\n  const [state, setState] = useState(initialState);\n  const actionState = async (data) => {\n    setState(await fn(state, data));\n  };\n  actionState[PERMALINK] = permalink;\n  return [state, actionState];\n};\nexport {\n  FormContext,\n  registerAction,\n  useActionState,\n  useFormStatus,\n  useOptimistic\n};\n", "// src/jsx/dom/jsx-dev-runtime.ts\nimport * as intrinsicElementTags from \"./intrinsic-element/components.js\";\nvar jsxDEV = (tag, props, key) => {\n  if (typeof tag === \"string\" && intrinsicElementTags[tag]) {\n    tag = intrinsicElementTags[tag];\n  }\n  return {\n    tag,\n    type: tag,\n    props,\n    key,\n    ref: props.ref\n  };\n};\nvar Fragment = (props) => jsxDEV(\"\", props, void 0);\nexport {\n  Fragment,\n  jsxDEV\n};\n", "// src/jsx/dom/components.ts\nimport { DOM_ERROR_HANDLER } from \"../constants.js\";\nimport { Fragment } from \"./jsx-runtime.js\";\nvar ErrorBoundary = (({ children, fallback, fallbackRender, onError }) => {\n  const res = Fragment({ children });\n  res[DOM_ERROR_HANDLER] = (err) => {\n    if (err instanceof Promise) {\n      throw err;\n    }\n    onError?.(err);\n    return fallbackRender?.(err) || fallback;\n  };\n  return res;\n});\nvar Suspense = (({\n  children,\n  fallback\n}) => {\n  const res = Fragment({ children });\n  res[DOM_ERROR_HANDLER] = (err, retry) => {\n    if (!(err instanceof Promise)) {\n      throw err;\n    }\n    err.finally(retry);\n    return fallback;\n  };\n  return res;\n});\nexport {\n  ErrorBoundary,\n  Suspense\n};\n", "// src/jsx/streaming.ts\nimport { raw } from \"../helper/html/index.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"../utils/html.js\";\nimport { JSXNode } from \"./base.js\";\nimport { childrenToString } from \"./components.js\";\nimport { DOM_RENDERER, DOM_STASH } from \"./constants.js\";\nimport { createContext, useContext } from \"./context.js\";\nimport { Suspense as SuspenseDomRenderer } from \"./dom/components.js\";\nimport { buildDataStack } from \"./dom/render.js\";\nvar StreamingContext = createContext(null);\nvar suspenseCounter = 0;\nvar Suspense = async ({\n  children,\n  fallback\n}) => {\n  if (!Array.isArray(children)) {\n    children = [children];\n  }\n  const nonce = useContext(StreamingContext)?.scriptNonce;\n  let resArray = [];\n  const stackNode = { [DOM_STASH]: [0, []] };\n  const popNodeStack = (value) => {\n    buildDataStack.pop();\n    return value;\n  };\n  try {\n    stackNode[DOM_STASH][0] = 0;\n    buildDataStack.push([[], stackNode]);\n    resArray = children.map(\n      (c) => c == null || typeof c === \"boolean\" ? \"\" : c.toString()\n    );\n  } catch (e) {\n    if (e instanceof Promise) {\n      resArray = [\n        e.then(() => {\n          stackNode[DOM_STASH][0] = 0;\n          buildDataStack.push([[], stackNode]);\n          return childrenToString(children).then(popNodeStack);\n        })\n      ];\n    } else {\n      throw e;\n    }\n  } finally {\n    popNodeStack();\n  }\n  if (resArray.some((res) => res instanceof Promise)) {\n    const index = suspenseCounter++;\n    const fallbackStr = await fallback.toString();\n    return raw(`<template id=\"H:${index}\"></template>${fallbackStr}<!--/$-->`, [\n      ...fallbackStr.callbacks || [],\n      ({ phase, buffer, context }) => {\n        if (phase === HtmlEscapedCallbackPhase.BeforeStream) {\n          return;\n        }\n        return Promise.all(resArray).then(async (htmlArray) => {\n          htmlArray = htmlArray.flat();\n          const content = htmlArray.join(\"\");\n          if (buffer) {\n            buffer[0] = buffer[0].replace(\n              new RegExp(`<template id=\"H:${index}\"></template>.*?<!--/\\\\$-->`),\n              content\n            );\n          }\n          let html = buffer ? \"\" : `<template data-hono-target=\"H:${index}\">${content}</template><script${nonce ? ` nonce=\"${nonce}\"` : \"\"}>\n((d,c,n) => {\nc=d.currentScript.previousSibling\nd=d.getElementById('H:${index}')\nif(!d)return\ndo{n=d.nextSibling;n.remove()}while(n.nodeType!=8||n.nodeValue!='/$')\nd.replaceWith(c.content)\n})(document)\n</script>`;\n          const callbacks = htmlArray.map((html2) => html2.callbacks || []).flat();\n          if (!callbacks.length) {\n            return html;\n          }\n          if (phase === HtmlEscapedCallbackPhase.Stream) {\n            html = await resolveCallback(html, HtmlEscapedCallbackPhase.BeforeStream, true, context);\n          }\n          return raw(html, callbacks);\n        });\n      }\n    ]);\n  } else {\n    return raw(resArray.join(\"\"));\n  }\n};\nSuspense[DOM_RENDERER] = SuspenseDomRenderer;\nvar textEncoder = new TextEncoder();\nvar renderToReadableStream = (content, onError = console.trace) => {\n  const reader = new ReadableStream({\n    async start(controller) {\n      try {\n        if (content instanceof JSXNode) {\n          content = content.toString();\n        }\n        const context = typeof content === \"object\" ? content : {};\n        const resolved = await resolveCallback(\n          content,\n          HtmlEscapedCallbackPhase.BeforeStream,\n          true,\n          context\n        );\n        controller.enqueue(textEncoder.encode(resolved));\n        let resolvedCount = 0;\n        const callbacks = [];\n        const then = (promise) => {\n          callbacks.push(\n            promise.catch((err) => {\n              console.log(err);\n              onError(err);\n              return \"\";\n            }).then(async (res) => {\n              res = await resolveCallback(\n                res,\n                HtmlEscapedCallbackPhase.BeforeStream,\n                true,\n                context\n              );\n              res.callbacks?.map((c) => c({ phase: HtmlEscapedCallbackPhase.Stream, context })).filter(Boolean).forEach(then);\n              resolvedCount++;\n              controller.enqueue(textEncoder.encode(res));\n            })\n          );\n        };\n        resolved.callbacks?.map((c) => c({ phase: HtmlEscapedCallbackPhase.Stream, context })).filter(Boolean).forEach(then);\n        while (resolvedCount !== callbacks.length) {\n          await Promise.all(callbacks);\n        }\n      } catch (e) {\n        onError(e);\n      }\n      controller.close();\n    }\n  });\n  return reader;\n};\nexport {\n  StreamingContext,\n  Suspense,\n  renderToReadableStream\n};\n", "// src/jsx/components.ts\nimport { raw } from \"../helper/html/index.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"../utils/html.js\";\nimport { jsx, Fragment } from \"./base.js\";\nimport { DOM_RENDERER } from \"./constants.js\";\nimport { useContext } from \"./context.js\";\nimport { ErrorBoundary as ErrorBoundaryDomRenderer } from \"./dom/components.js\";\nimport { StreamingContext } from \"./streaming.js\";\nvar errorBoundaryCounter = 0;\nvar childrenToString = async (children) => {\n  try {\n    return children.flat().map((c) => c == null || typeof c === \"boolean\" ? \"\" : c.toString());\n  } catch (e) {\n    if (e instanceof Promise) {\n      await e;\n      return childrenToString(children);\n    } else {\n      throw e;\n    }\n  }\n};\nvar resolveChildEarly = (c) => {\n  if (c == null || typeof c === \"boolean\") {\n    return \"\";\n  } else if (typeof c === \"string\") {\n    return c;\n  } else {\n    const str = c.toString();\n    if (!(str instanceof Promise)) {\n      return raw(str);\n    } else {\n      return str;\n    }\n  }\n};\nvar ErrorBoundary = async ({ children, fallback, fallbackRender, onError }) => {\n  if (!children) {\n    return raw(\"\");\n  }\n  if (!Array.isArray(children)) {\n    children = [children];\n  }\n  const nonce = useContext(StreamingContext)?.scriptNonce;\n  let fallbackStr;\n  const resolveFallbackStr = async () => {\n    const awaitedFallback = await fallback;\n    if (typeof awaitedFallback === \"string\") {\n      fallbackStr = awaitedFallback;\n    } else {\n      fallbackStr = await awaitedFallback?.toString();\n      if (typeof fallbackStr === \"string\") {\n        fallbackStr = raw(fallbackStr);\n      }\n    }\n  };\n  const fallbackRes = (error) => {\n    onError?.(error);\n    return fallbackStr || fallbackRender && jsx(Fragment, {}, fallbackRender(error)) || \"\";\n  };\n  let resArray = [];\n  try {\n    resArray = children.map(resolveChildEarly);\n  } catch (e) {\n    await resolveFallbackStr();\n    if (e instanceof Promise) {\n      resArray = [\n        e.then(() => childrenToString(children)).catch((e2) => fallbackRes(e2))\n      ];\n    } else {\n      resArray = [fallbackRes(e)];\n    }\n  }\n  if (resArray.some((res) => res instanceof Promise)) {\n    await resolveFallbackStr();\n    const index = errorBoundaryCounter++;\n    const replaceRe = RegExp(`(<template id=\"E:${index}\"></template>.*?)(.*?)(<!--E:${index}-->)`);\n    const caught = false;\n    const catchCallback = async ({ error: error2, buffer }) => {\n      if (caught) {\n        return \"\";\n      }\n      const fallbackResString = await Fragment({\n        children: fallbackRes(error2)\n      }).toString();\n      if (buffer) {\n        buffer[0] = buffer[0].replace(replaceRe, fallbackResString);\n      }\n      return buffer ? \"\" : `<template data-hono-target=\"E:${index}\">${fallbackResString}</template><script>\n((d,c,n) => {\nc=d.currentScript.previousSibling\nd=d.getElementById('E:${index}')\nif(!d)return\ndo{n=d.nextSibling;n.remove()}while(n.nodeType!=8||n.nodeValue!='E:${index}')\nd.replaceWith(c.content)\n})(document)\n</script>`;\n    };\n    let error;\n    const promiseAll = Promise.all(resArray).catch((e) => error = e);\n    return raw(`<template id=\"E:${index}\"></template><!--E:${index}-->`, [\n      ({ phase, buffer, context }) => {\n        if (phase === HtmlEscapedCallbackPhase.BeforeStream) {\n          return;\n        }\n        return promiseAll.then(async (htmlArray) => {\n          if (error) {\n            throw error;\n          }\n          htmlArray = htmlArray.flat();\n          const content = htmlArray.join(\"\");\n          let html = buffer ? \"\" : `<template data-hono-target=\"E:${index}\">${content}</template><script${nonce ? ` nonce=\"${nonce}\"` : \"\"}>\n((d,c) => {\nc=d.currentScript.previousSibling\nd=d.getElementById('E:${index}')\nif(!d)return\nd.parentElement.insertBefore(c.content,d.nextSibling)\n})(document)\n</script>`;\n          if (htmlArray.every((html2) => !html2.callbacks?.length)) {\n            if (buffer) {\n              buffer[0] = buffer[0].replace(replaceRe, content);\n            }\n            return html;\n          }\n          if (buffer) {\n            buffer[0] = buffer[0].replace(\n              replaceRe,\n              (_all, pre, _, post) => `${pre}${content}${post}`\n            );\n          }\n          const callbacks = htmlArray.map((html2) => html2.callbacks || []).flat();\n          if (phase === HtmlEscapedCallbackPhase.Stream) {\n            html = await resolveCallback(\n              html,\n              HtmlEscapedCallbackPhase.BeforeStream,\n              true,\n              context\n            );\n          }\n          let resolvedCount = 0;\n          const promises = callbacks.map(\n            (c) => (...args) => c(...args)?.then((content2) => {\n              resolvedCount++;\n              if (buffer) {\n                if (resolvedCount === callbacks.length) {\n                  buffer[0] = buffer[0].replace(replaceRe, (_all, _pre, content3) => content3);\n                }\n                buffer[0] += content2;\n                return raw(\"\", content2.callbacks);\n              }\n              return raw(\n                content2 + (resolvedCount !== callbacks.length ? \"\" : `<script>\n((d,c,n) => {\nd=d.getElementById('E:${index}')\nif(!d)return\nn=d.nextSibling\nwhile(n.nodeType!=8||n.nodeValue!='E:${index}'){n=n.nextSibling}\nn.remove()\nd.remove()\n})(document)\n</script>`),\n                content2.callbacks\n              );\n            }).catch((error2) => catchCallback({ error: error2, buffer }))\n          );\n          return raw(html, promises);\n        }).catch((error2) => catchCallback({ error: error2, buffer }));\n      }\n    ]);\n  } else {\n    return Fragment({ children: resArray });\n  }\n};\nErrorBoundary[DOM_RENDERER] = ErrorBoundaryDomRenderer;\nexport {\n  ErrorBoundary,\n  childrenToString\n};\n", "/** @jsx jsx */\nimport { html } from 'hono/html';\nimport { jsx } from 'hono/jsx';\nimport { Layout } from './layout';\n\nvoid jsx;\n\nexport const PUSH_MANIFEST = {\n  name: 'GOATkit Admin',\n  short_name: 'GOATkit',\n  start_url: '/admin',\n  scope: '/admin/',\n  display: 'standalone',\n  background_color: '#eff1f5',\n  // Manifest does not support separate dark theme_color; we set the light base.\n  // HTML <meta name=\"theme-color\"> is updated dynamically for Latte/Mocha.\n  theme_color: '#eff1f5',\n  icons: [\n    {\n      src: '/images/uncle-logo.svg',\n      sizes: '192x192',\n      type: 'image/svg+xml',\n      purpose: 'any',\n    },\n    {\n      src: '/images/uncle-logo.svg',\n      sizes: '512x512',\n      type: 'image/svg+xml',\n      purpose: 'any',\n    },\n  ],\n};\n\nexport const PUSH_SERVICE_WORKER_SCRIPT = `\nself.addEventListener('install', function(event) {\n  event.waitUntil(self.skipWaiting());\n});\n\nself.addEventListener('activate', function(event) {\n  event.waitUntil(self.clients.claim());\n});\n\nasync function fetchPendingPushItems() {\n  const subscription = await self.registration.pushManager.getSubscription();\n  if (!subscription || !subscription.endpoint) return [];\n\n  const response = await fetch('/admin/push/pending?endpoint=' + encodeURIComponent(subscription.endpoint), {\n    method: 'GET',\n    credentials: 'include',\n    headers: {\n      'Accept': 'application/json'\n    }\n  });\n\n  if (!response.ok) return [];\n  const payload = await response.json();\n  if (!payload || !Array.isArray(payload.notifications)) return [];\n  return payload.notifications;\n}\n\nself.addEventListener('push', function(event) {\n  event.waitUntil((async function() {\n    try {\n      var items = await fetchPendingPushItems();\n      if (!items.length) {\n        await self.registration.showNotification('GOATkit update', {\n          body: 'Open the app for the latest activity.',\n          data: { url: '/admin' },\n          tag: 'goatkit-fallback'\n        });\n        return;\n      }\n\n      for (var i = 0; i < items.length; i++) {\n        var item = items[i] || {};\n        await self.registration.showNotification(item.title || 'GOATkit update', {\n          body: item.body || 'Open the app for details.',\n          data: { url: item.url || '/admin' },\n          tag: item.id ? ('goatkit-' + item.id) : undefined,\n          renotify: false,\n        });\n      }\n    } catch (_error) {\n      await self.registration.showNotification('GOATkit update', {\n        body: 'Open the app for the latest activity.',\n        data: { url: '/admin' },\n        tag: 'goatkit-fallback-error'\n      });\n    }\n  })());\n});\n\nself.addEventListener('notificationclick', function(event) {\n  event.notification.close();\n  var target = '/admin';\n  if (event.notification && event.notification.data && typeof event.notification.data.url === 'string') {\n    target = event.notification.data.url;\n  }\n\n  event.waitUntil((async function() {\n    var clientsList = await self.clients.matchAll({ type: 'window', includeUncontrolled: true });\n    for (var i = 0; i < clientsList.length; i++) {\n      var client = clientsList[i];\n      try {\n        var parsed = new URL(client.url);\n        if (parsed.origin === self.location.origin) {\n          if ('focus' in client) {\n            await client.focus();\n          }\n          if ('navigate' in client) {\n            await client.navigate(target);\n          }\n          return;\n        }\n      } catch (_error) {\n      }\n    }\n\n    if (self.clients.openWindow) {\n      await self.clients.openWindow(target);\n    }\n  })());\n});\n`;\n\nexport const PushSettingsPage = () => (\n  <Layout title=\"Push Notifications\">\n    <div class=\"page-header\">\n      <h2>Push Notifications</h2>\n    </div>\n\n    <div class=\"p-4 md:p-8\">\n      <div class=\"grid gap-4 md:gap-6\" style=\"max-width:800px;\">\n        <div class=\"uk-card uk-card-body\">\n          <h3 class=\"text-base font-semibold mb-2\">Staff Device Alerts</h3>\n          <p class=\"text-sm text-muted-foreground mb-3\">\n            Enable browser push on this device so staff get alerted for new jobs and new messages.\n          </p>\n\n          <div id=\"push-status\" class=\"text-sm mb-4 px-3 py-2 rounded\" style=\"background:var(--surface-elevated,#eff1f5);color:var(--text-primary,#333);border:1px solid var(--border,#ccd0da);\">\n            Checking push support...\n          </div>\n\n          <div class=\"grid gap-2 mb-4\">\n            <label class=\"flex items-center gap-2 text-sm\" for=\"push-notify-jobs\">\n              <input id=\"push-notify-jobs\" type=\"checkbox\" class=\"uk-checkbox\" checked />\n              <span>Notify on new jobs</span>\n            </label>\n            <label class=\"flex items-center gap-2 text-sm\" for=\"push-notify-messages\">\n              <input id=\"push-notify-messages\" type=\"checkbox\" class=\"uk-checkbox\" checked />\n              <span>Notify on new messages</span>\n            </label>\n          </div>\n\n          <div class=\"flex items-center gap-2\" style=\"flex-wrap:wrap;\">\n            <button id=\"push-enable-btn\" type=\"button\" class=\"uk-btn uk-btn-primary uk-btn-sm\">Enable on this device</button>\n            <button id=\"push-disable-btn\" type=\"button\" class=\"uk-btn uk-btn-default uk-btn-sm\">Disable on this device</button>\n            <button id=\"push-test-btn\" type=\"button\" class=\"uk-btn uk-btn-default uk-btn-sm\">Send test notification</button>\n          </div>\n\n          <p class=\"text-xs text-muted-foreground mt-3\">\n            Tip: install the admin as a PWA for the most reliable delivery, especially on iOS.\n          </p>\n        </div>\n      </div>\n    </div>\n\n    {html`<script>\n(function() {\n  var statusEl = document.getElementById('push-status');\n  var enableBtn = document.getElementById('push-enable-btn');\n  var disableBtn = document.getElementById('push-disable-btn');\n  var testBtn = document.getElementById('push-test-btn');\n  var jobsCheckbox = document.getElementById('push-notify-jobs');\n  var messagesCheckbox = document.getElementById('push-notify-messages');\n\n  var vapidPublicKey = '';\n\n  function setStatus(message, tone) {\n    if (!statusEl) return;\n    statusEl.textContent = message;\n\n    if (tone === 'ok') {\n      statusEl.style.background = 'rgba(34,197,94,0.1)';\n      statusEl.style.color = '#15803d';\n      statusEl.style.borderColor = 'rgba(21,128,61,0.35)';\n      return;\n    }\n\n    if (tone === 'error') {\n      statusEl.style.background = 'rgba(239,68,68,0.1)';\n      statusEl.style.color = '#dc2626';\n      statusEl.style.borderColor = 'rgba(220,38,38,0.35)';\n      return;\n    }\n\n    if (tone === 'warn') {\n      statusEl.style.background = 'rgba(245,158,11,0.12)';\n      statusEl.style.color = '#b45309';\n      statusEl.style.borderColor = 'rgba(180,83,9,0.35)';\n      return;\n    }\n\n    statusEl.style.background = 'var(--surface-elevated,#eff1f5)';\n    statusEl.style.color = 'var(--text-primary,#333)';\n    statusEl.style.borderColor = 'var(--border,#ccd0da)';\n  }\n\n  function setButtonsEnabled(enabled, isSubscribed) {\n    if (enableBtn) enableBtn.disabled = !enabled;\n    if (disableBtn) disableBtn.disabled = !enabled || !isSubscribed;\n    if (testBtn) testBtn.disabled = !enabled || !isSubscribed;\n  }\n\n  function normalizeErrorMessage(prefix, err) {\n    var message = '';\n    if (err && typeof err.message === 'string') message = err.message;\n    else message = String(err || 'unknown error');\n    message = message.replace(/\\s+/g, ' ').trim();\n    if (prefix) return prefix + ': ' + message;\n    return message;\n  }\n\n  async function safeFetchJson(url, options) {\n    var response = await fetch(url, options || {});\n    var text = '';\n    try {\n      text = await response.clone().text();\n    } catch (_error) {\n      text = '';\n    }\n\n    var json = null;\n    try {\n      json = text ? JSON.parse(text) : null;\n    } catch (_error) {\n      json = null;\n    }\n\n    return {\n      ok: response.ok,\n      status: response.status,\n      text: text,\n      json: json,\n    };\n  }\n\n  function selectedPreferences() {\n    return {\n      notifyNewJobs: jobsCheckbox ? !!jobsCheckbox.checked : true,\n      notifyNewMessages: messagesCheckbox ? !!messagesCheckbox.checked : true,\n    };\n  }\n\n  function base64UrlToUint8Array(base64Url) {\n    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n    var padding = '='.repeat((4 - (base64.length % 4)) % 4);\n    var binary = atob(base64 + padding);\n    var bytes = new Uint8Array(binary.length);\n    for (var i = 0; i < binary.length; i++) {\n      bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes;\n  }\n\n  async function ensureRegistration() {\n    var reg = await navigator.serviceWorker.register('/admin/sw.js', { scope: '/admin/' });\n    try {\n      await navigator.serviceWorker.ready;\n    } catch (_error) {\n    }\n    return reg;\n  }\n\n  async function getCurrentSubscription() {\n    var registration = await ensureRegistration();\n    return registration.pushManager.getSubscription();\n  }\n\n  async function loadServerStatus(endpoint) {\n    var query = endpoint ? ('?endpoint=' + encodeURIComponent(endpoint)) : '';\n    var result = await safeFetchJson('/admin/push/status' + query, {\n      method: 'GET',\n      headers: { Accept: 'application/json' },\n    });\n\n    if (!result.ok) return null;\n    return result.json;\n  }\n\n  async function pushSubscribe(subscription) {\n    var result = await safeFetchJson('/admin/push/subscribe', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      body: JSON.stringify({\n        subscription: subscription.toJSON(),\n        preferences: selectedPreferences(),\n      }),\n    });\n\n    if (!result.ok) {\n      var msg = (result.json && result.json.error) ? result.json.error : (result.text || 'Failed to save subscription');\n      throw new Error('Subscribe failed (' + String(result.status) + '): ' + String(msg));\n    }\n  }\n\n  async function pushUnsubscribe(endpoint) {\n    await safeFetchJson('/admin/push/unsubscribe', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      body: JSON.stringify({ endpoint: endpoint || '' }),\n    });\n  }\n\n  async function sendTestNotification(endpoint) {\n    var result = await safeFetchJson('/admin/push/test', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      body: JSON.stringify({ endpoint: endpoint || '' }),\n    });\n\n    if (!result.ok) {\n      var message = (result.json && result.json.error) ? result.json.error : (result.text || 'Test push failed');\n      throw new Error('Test failed (' + String(result.status) + '): ' + String(message));\n    }\n\n    return result.json;\n  }\n\n  async function syncPreferencesIfSubscribed() {\n    try {\n      var subscription = await getCurrentSubscription();\n      if (!subscription) return;\n      await pushSubscribe(subscription);\n    } catch (_error) {\n    }\n  }\n\n  async function refreshState() {\n    try {\n      setStatus('Checking push support...', '');\n\n      var response = await safeFetchJson('/admin/push/vapid-public-key', {\n        method: 'GET',\n        headers: { Accept: 'application/json' },\n      });\n\n      if (!response.ok) {\n        var msg = (response.json && response.json.error) ? response.json.error : (response.text || 'Could not load VAPID key');\n        throw new Error('VAPID key (' + String(response.status) + '): ' + String(msg));\n      }\n\n      var keyPayload = response.json;\n      vapidPublicKey = keyPayload && typeof keyPayload.publicKey === 'string' ? keyPayload.publicKey : '';\n      if (!vapidPublicKey) throw new Error('VAPID key missing');\n\n      var subscription = await getCurrentSubscription();\n      if (!subscription) {\n        setStatus('Push is disabled on this device.', 'warn');\n        setButtonsEnabled(true, false);\n        return;\n      }\n\n      var serverStatus = await loadServerStatus(subscription.endpoint);\n      if (serverStatus && typeof serverStatus.notifyNewJobs === 'boolean' && jobsCheckbox) {\n        jobsCheckbox.checked = serverStatus.notifyNewJobs;\n      }\n      if (serverStatus && typeof serverStatus.notifyNewMessages === 'boolean' && messagesCheckbox) {\n        messagesCheckbox.checked = serverStatus.notifyNewMessages;\n      }\n\n      setStatus('Push is enabled on this device.', 'ok');\n      setButtonsEnabled(true, true);\n    } catch (error) {\n      setStatus(normalizeErrorMessage('Push setup failed', error), 'error');\n      setButtonsEnabled(false, false);\n    }\n  }\n\n  if (!('serviceWorker' in navigator) || !('PushManager' in window) || !('Notification' in window)) {\n    setStatus('This browser does not support web push notifications.', 'error');\n    setButtonsEnabled(false, false);\n    return;\n  }\n\n  if (enableBtn) {\n    enableBtn.addEventListener('click', async function() {\n      setButtonsEnabled(false, false);\n      try {\n        var permission = await Notification.requestPermission();\n        if (permission !== 'granted') {\n          setStatus('Notification permission was not granted.', 'error');\n          await refreshState();\n          return;\n        }\n\n        var registration = await ensureRegistration();\n        var subscription = await registration.pushManager.getSubscription();\n\n        if (!subscription) {\n          subscription = await registration.pushManager.subscribe({\n            userVisibleOnly: true,\n            applicationServerKey: base64UrlToUint8Array(vapidPublicKey),\n          });\n        }\n\n        await pushSubscribe(subscription);\n\n        try {\n          setStatus('Sending test notification...', 'warn');\n          await sendTestNotification(subscription.endpoint);\n        } catch (_error) {\n        }\n\n        setStatus('Push enabled on this device.', 'ok');\n        setButtonsEnabled(true, true);\n      } catch (error) {\n        setStatus(normalizeErrorMessage('Unable to enable push', error), 'error');\n        setButtonsEnabled(true, false);\n      }\n    });\n  }\n\n  if (testBtn) {\n    testBtn.addEventListener('click', async function() {\n      setButtonsEnabled(false, true);\n      try {\n        var subscription = await getCurrentSubscription();\n        if (!subscription) {\n          setStatus('Push is disabled on this device.', 'warn');\n          setButtonsEnabled(true, false);\n          return;\n        }\n\n        setStatus('Sending test notification...', 'warn');\n        var result = await sendTestNotification(subscription.endpoint);\n        if (result && typeof result.status === 'number') {\n          setStatus('Test sent (push service status ' + String(result.status) + ').', 'ok');\n        } else {\n          setStatus('Test sent.', 'ok');\n        }\n        setButtonsEnabled(true, true);\n      } catch (error) {\n        setStatus(normalizeErrorMessage('Unable to send test', error), 'error');\n        setButtonsEnabled(true, true);\n      }\n    });\n  }\n\n  if (disableBtn) {\n    disableBtn.addEventListener('click', async function() {\n      setButtonsEnabled(false, false);\n      try {\n        var subscription = await getCurrentSubscription();\n        if (subscription) {\n          await pushUnsubscribe(subscription.endpoint);\n          await subscription.unsubscribe();\n        }\n\n        setStatus('Push disabled on this device.', 'warn');\n        setButtonsEnabled(true, false);\n      } catch (error) {\n        setStatus('Unable to disable push: ' + (error && error.message ? error.message : 'unknown error'), 'error');\n        await refreshState();\n      }\n    });\n  }\n\n  if (jobsCheckbox) jobsCheckbox.addEventListener('change', syncPreferencesIfSubscribed);\n  if (messagesCheckbox) messagesCheckbox.addEventListener('change', syncPreferencesIfSubscribed);\n\n  refreshState();\n})();\n    </script>`}\n  </Layout>\n);\n", "// biome-ignore lint/correctness/noUnusedImports: jsx is used by JSX pragma transform\nimport { jsx } from 'hono/jsx';\nimport { StatusIcon } from './components';\nimport { Layout } from './layout';\n\nconst money = (cents: number) => `$${(cents / 100).toFixed(2)}`;\n\ntype InvoiceLine = {\n  id: string;\n  description: string;\n  quantity: number;\n  unit_price_cents: number;\n  total_cents: number;\n  kind: string;\n  parent_id: string | null;\n  is_custom: number;\n};\n\nexport const InvoiceDetailPage = ({\n  invoice,\n  customers,\n  jobs,\n  lineItems,\n}: {\n  invoice: {\n    id: string;\n    invoice_number: string;\n    customer_id: string;\n    job_id: string | null;\n    currency: string;\n    due_date: string | null;\n    status: string;\n    notes: string | null;\n    tax_cents: number;\n    discount_cents: number;\n  };\n  customers: Array<{ id: string; first_name: string; last_name: string }>;\n  jobs: Array<{ id: string; customer_name: string; scheduled_date: string }>;\n  lineItems: InvoiceLine[];\n}) => {\n  const subtotal = lineItems.reduce((sum, line) => sum + line.total_cents, 0);\n  const total = Math.max(0, subtotal + Number(invoice.tax_cents || 0) - Number(invoice.discount_cents || 0));\n  const customerName = (() => {\n    const c = customers.find(cu => cu.id === invoice.customer_id);\n    return c ? `${c.first_name} ${c.last_name}`.trim() : 'Customer';\n  })();\n  const jobLabel = (() => {\n    if (!invoice.job_id) return null;\n    const j = jobs.find(jb => jb.id === invoice.job_id);\n    return j ? `${j.customer_name} - ${j.scheduled_date}` : 'Linked job';\n  })();\n\n  return (\n    <Layout title={`Invoice ${invoice.invoice_number}`}>\n      <div class=\"page-header page-header--rich\">\n        <div class=\"page-header-info\">\n          <div class=\"flex items-center gap-2\">\n            <h2>Invoice {invoice.invoice_number}</h2>\n            <StatusIcon status={invoice.status} />\n          </div>\n          <div class=\"page-header-meta\">\n            <span>{customerName}</span>\n            {jobLabel && <span>{jobLabel}</span>}\n            {invoice.due_date && <span>Due {invoice.due_date}</span>}\n          </div>\n        </div>\n        <div class=\"page-header-actions\">\n          <button type=\"submit\" form=\"invoice-form\" class=\"uk-btn uk-btn-primary uk-btn-sm\">Save</button>\n          <a href=\"/admin/invoices\" class=\"uk-btn uk-btn-default uk-btn-sm\" hx-get=\"/admin/invoices\" hx-target=\"#page-content\" hx-select=\"#page-content\" hx-push-url=\"true\">Back</a>\n        </div>\n      </div>\n\n      <div class=\"p-4 sm:p-8\" style=\"padding-bottom: calc(40px + var(--safe-bottom));\">\n        <div>\n          <div class=\"mx-auto\" style=\"max-width: 1120px;\">\n            <div class=\"grid gap-4 lg:grid-cols-[1fr,360px] lg:gap-6\">\n              <div class=\"grid gap-4\">\n                <div class=\"uk-card uk-card-body\" style=\"background:var(--surface-0);\">\n                  <div class=\"flex items-start justify-between gap-3\">\n                    <div class=\"min-w-0\">\n                      <p class=\"text-[10px] uppercase tracking-wide text-muted-foreground\">Amount due</p>\n                      <p class=\"text-3xl font-extrabold\" style=\"margin:0;\">{money(total)}</p>\n                      <p class=\"text-xs text-muted-foreground\" style=\"margin:6px 0 0;\">Subtotal {money(subtotal)} \u2022 Tax {money(Number(invoice.tax_cents || 0))} \u2022 Discount {money(Number(invoice.discount_cents || 0))}</p>\n                    </div>\n                    <div class=\"text-right\">\n                      <p class=\"text-[10px] uppercase tracking-wide text-muted-foreground\">Status</p>\n                      <StatusIcon status={invoice.status} />\n                      {invoice.due_date ? (\n                        <p class=\"text-xs text-muted-foreground\" style=\"margin:8px 0 0;\">Due {invoice.due_date}</p>\n                      ) : null}\n                    </div>\n                  </div>\n                  <input type=\"hidden\" id=\"total_amount\" name=\"total_amount\" form=\"invoice-form\" value={(total / 100).toFixed(2)} />\n                </div>\n\n                <div class=\"uk-card uk-card-body\">\n                  <div class=\"flex items-center justify-between mb-4\">\n                    <h3 class=\"text-base font-semibold\" style=\"margin:0;\">Line items</h3>\n                    <span class=\"text-sm font-semibold\">{money(subtotal)}</span>\n                  </div>\n                  <div class=\"grid gap-2 mb-4\">\n                    {lineItems.length === 0 ? (\n                      <p class=\"text-sm text-muted-foreground\">No line items.</p>\n                    ) : (\n                      lineItems.map((line) => (\n                        <div key={line.id} class=\"flex items-start gap-3 p-3 border border-border rounded-md\">\n                          <div class=\"flex-1 min-w-0\" style={line.parent_id ? 'padding-left:16px;' : ''}>\n                            <p class=\"text-sm font-medium\" style=\"margin:0;\">{line.description}</p>\n                            <p class=\"text-xs text-muted-foreground\" style=\"margin:4px 0 0;\">{line.kind} \u2022 {line.quantity} x {money(line.unit_price_cents)}</p>\n                          </div>\n                          <div class=\"text-right\">\n                            <p class=\"text-sm font-semibold\" style=\"margin:0;\">{money(line.total_cents)}</p>\n                            {line.is_custom ? (\n                              <button type=\"button\" class=\"delete-btn uk-btn uk-btn-small\" hx-post={`/admin/invoices/${invoice.id}/line-items/delete`} hx-vals={JSON.stringify({ lineId: line.id })} hx-target=\"#page-content\" hx-select=\"#page-content\" data-confirm=\"arm\">Remove</button>\n                            ) : null}\n                          </div>\n                        </div>\n                      ))\n                    )}\n                  </div>\n\n                  <form hx-post={`/admin/invoices/${invoice.id}/line-items/add`} hx-target=\"#page-content\" hx-select=\"#page-content\" class=\"grid gap-2 sm:grid-cols-4\">\n                    <input type=\"text\" name=\"description\" class=\"uk-input sm:col-span-2\" placeholder=\"Custom line description\" required />\n                    <input type=\"number\" name=\"quantity\" class=\"uk-input\" min={1} step={1} value=\"1\" required />\n                    <input type=\"number\" name=\"unit_price\" class=\"uk-input\" min={0} step={0.01} placeholder=\"Unit price\" required />\n                    <div class=\"sm:col-span-4 flex justify-end\">\n                      <button type=\"submit\" class=\"uk-btn uk-btn-default\">Add Custom Line</button>\n                    </div>\n                  </form>\n                </div>\n              </div>\n\n              <aside class=\"grid gap-4 lg:sticky\" style=\"top: 92px;\">\n                <details class=\"uk-card uk-card-body\" open>\n                  <summary class=\"text-base font-semibold cursor-pointer\">Invoice details</summary>\n                  <form\n                    id=\"invoice-form\"\n                    hx-post={`/admin/invoices/${invoice.id}`}\n                    hx-target=\"#page-content\"\n                    hx-select=\"#page-content\"\n                    hx-push-url=\"/admin/invoices\"\n                    class=\"pt-4 grid gap-4\"\n                  >\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"invoice_number\">Invoice Number</label>\n                      <input id=\"invoice_number\" name=\"invoice_number\" class=\"uk-input\" value={invoice.invoice_number} required />\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"currency\">Currency</label>\n                      <select id=\"currency\" name=\"currency\" class=\"uk-select\" required>\n                        <option value=\"CAD\" selected={invoice.currency === 'CAD'}>CAD</option>\n                        <option value=\"USD\" selected={invoice.currency === 'USD'}>USD</option>\n                      </select>\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"customer_id\">Customer</label>\n                      <select id=\"customer_id\" name=\"customer_id\" class=\"uk-select\" required>\n                        {customers.map((customer) => (\n                          <option key={customer.id} value={customer.id} selected={customer.id === invoice.customer_id}>{customer.first_name} {customer.last_name}</option>\n                        ))}\n                      </select>\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"job_id\">Job</label>\n                      <select id=\"job_id\" name=\"job_id\" class=\"uk-select\">\n                        <option value=\"\">None</option>\n                        {jobs.map((job) => (\n                          <option key={job.id} value={job.id} selected={invoice.job_id === job.id}>{job.customer_name} - {job.scheduled_date}</option>\n                        ))}\n                      </select>\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"due_date\">Due Date</label>\n                      <input id=\"due_date\" name=\"due_date\" type=\"date\" class=\"uk-input\" value={invoice.due_date || ''} />\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"status\">Status</label>\n                      <select id=\"status\" name=\"status\" class=\"uk-select\" required>\n                        <option value=\"pending\" selected={invoice.status === 'pending'}>Pending</option>\n                        <option value=\"sent\" selected={invoice.status === 'sent'}>Sent</option>\n                        <option value=\"paid\" selected={invoice.status === 'paid'}>Paid</option>\n                        <option value=\"void\" selected={invoice.status === 'void'}>Void</option>\n                      </select>\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"tax_amount\">Tax ($)</label>\n                      <input id=\"tax_amount\" name=\"tax_amount\" type=\"number\" class=\"uk-input\" step={0.01} min={0} value={(invoice.tax_cents / 100).toFixed(2)} />\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"discount_amount\">Discount ($)</label>\n                      <input id=\"discount_amount\" name=\"discount_amount\" type=\"number\" class=\"uk-input\" step={0.01} min={0} value={(invoice.discount_cents / 100).toFixed(2)} />\n                    </div>\n                    <div class=\"grid gap-2\">\n                      <label class=\"uk-form-label\" for=\"notes\">Notes</label>\n                      <textarea id=\"notes\" name=\"notes\" rows={4} class=\"uk-textarea\">{invoice.notes || ''}</textarea>\n                    </div>\n                  </form>\n                </details>\n\n                <details class=\"uk-card uk-card-body danger-card\">\n                  <summary class=\"text-base font-semibold cursor-pointer\">Danger zone</summary>\n                  <div class=\"pt-4\">\n                    <button type=\"button\" class=\"delete-btn\" hx-post={`/admin/invoices/${invoice.id}/delete`} hx-target=\"#page-content\" data-confirm=\"arm\">Delete invoice</button>\n                  </div>\n                </details>\n              </aside>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n", "type VapidConfig = {\n  publicKey: string;\n  privateKeyJwk: JsonWebKey;\n  subject: string;\n};\n\nexport interface PushSubscriptionInput {\n  endpoint: string;\n  keys: {\n    p256dh: string;\n    auth: string;\n  };\n}\n\nexport interface PushSubscriptionPreferences {\n  notifyNewJobs: boolean;\n  notifyNewMessages: boolean;\n}\n\nexport type PushEvent = {\n  type: 'new_message' | 'new_job' | 'test';\n  title: string;\n  body: string;\n  targetUrl: string;\n};\n\nexport interface PendingPushNotification {\n  id: string;\n  title: string;\n  body: string;\n  url: string;\n  createdAt: string;\n}\n\nfunction base64UrlEncode(bytes: Uint8Array): string {\n  let binary = '';\n  for (let i = 0; i < bytes.length; i++) binary += String.fromCharCode(bytes[i]);\n  const base64 = btoa(binary);\n  return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/g, '');\n}\n\nfunction base64UrlDecode(input: string): Uint8Array {\n  const base64 = input.replace(/-/g, '+').replace(/_/g, '/');\n  const padded = base64 + '='.repeat((4 - (base64.length % 4)) % 4);\n  const binary = atob(padded);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);\n  return bytes;\n}\n\nfunction concatBytes(...chunks: Uint8Array[]): Uint8Array {\n  const total = chunks.reduce((sum, c) => sum + c.length, 0);\n  const out = new Uint8Array(total);\n  let offset = 0;\n  for (const c of chunks) {\n    out.set(c, offset);\n    offset += c.length;\n  }\n  return out;\n}\n\nfunction derToJose(signatureDer: Uint8Array, size = 32): Uint8Array {\n  // Convert ASN.1 DER encoded ECDSA signature to JOSE (raw R||S) format.\n  // DER format: 30 len 02 lenR R 02 lenS S\n  if (signatureDer.length < 8 || signatureDer[0] !== 0x30) {\n    throw new Error('Invalid DER signature');\n  }\n\n  let offset = 2;\n  if (signatureDer[1] & 0x80) {\n    const lenBytes = signatureDer[1] & 0x7f;\n    offset = 2 + lenBytes;\n  }\n\n  if (signatureDer[offset] !== 0x02) throw new Error('Invalid DER signature');\n  const rLen = signatureDer[offset + 1];\n  const r = signatureDer.slice(offset + 2, offset + 2 + rLen);\n  offset = offset + 2 + rLen;\n\n  if (signatureDer[offset] !== 0x02) throw new Error('Invalid DER signature');\n  const sLen = signatureDer[offset + 1];\n  const s = signatureDer.slice(offset + 2, offset + 2 + sLen);\n\n  const rOut = new Uint8Array(size);\n  const sOut = new Uint8Array(size);\n\n  // Trim possible leading 0x00 for positive integer.\n  const rTrim = (r.length > size) ? r.slice(r.length - size) : r;\n  const sTrim = (s.length > size) ? s.slice(s.length - size) : s;\n\n  rOut.set(rTrim, size - rTrim.length);\n  sOut.set(sTrim, size - sTrim.length);\n  return concatBytes(rOut, sOut);\n}\n\nasync function getSetting(db: D1Database, key: string): Promise<string | null> {\n  const row = await db.prepare('SELECT value FROM settings WHERE key = ?').bind(key).first<{ value: string }>();\n  return row?.value ?? null;\n}\n\nasync function setSetting(db: D1Database, key: string, value: string): Promise<void> {\n  await db.prepare(\n    `INSERT INTO settings (key, value, updated_at)\n     VALUES (?, ?, datetime('now'))\n     ON CONFLICT(key) DO UPDATE SET value = excluded.value, updated_at = datetime('now')`\n  ).bind(key, value).run();\n}\n\nasync function ensureVapidConfig(db: D1Database): Promise<VapidConfig> {\n  const existing = await getSetting(db, 'web_push_vapid');\n  if (existing) {\n    try {\n      const parsed = JSON.parse(existing) as unknown;\n      if (parsed && typeof parsed === 'object' && !Array.isArray(parsed)) {\n        const rec = parsed as Record<string, unknown>;\n        if (typeof rec.publicKey === 'string' && rec.privateKeyJwk && typeof rec.subject === 'string') {\n          return {\n            publicKey: rec.publicKey,\n            privateKeyJwk: rec.privateKeyJwk as JsonWebKey,\n            subject: rec.subject,\n          };\n        }\n      }\n    } catch {\n      // fall through to regenerate\n    }\n  }\n\n  const subject = 'mailto:ops@unclebike.xyz';\n  const keyPair = await crypto.subtle.generateKey(\n    { name: 'ECDSA', namedCurve: 'P-256' },\n    true,\n    ['sign', 'verify'],\n  );\n\n  const publicJwk = await crypto.subtle.exportKey('jwk', keyPair.publicKey);\n  const privateJwk = await crypto.subtle.exportKey('jwk', keyPair.privateKey);\n  if (!publicJwk.x || !publicJwk.y) throw new Error('Failed to export VAPID public key');\n\n  // Uncompressed EC point format: 0x04 || X || Y\n  const publicBytes = concatBytes(\n    new Uint8Array([0x04]),\n    base64UrlDecode(publicJwk.x),\n    base64UrlDecode(publicJwk.y),\n  );\n\n  const publicKey = base64UrlEncode(publicBytes);\n\n  const config: VapidConfig = {\n    publicKey,\n    privateKeyJwk: privateJwk,\n    subject,\n  };\n\n  await setSetting(db, 'web_push_vapid', JSON.stringify(config));\n  return config;\n}\n\nasync function createVapidJwt(audOrigin: string, subject: string, privateKeyJwk: JsonWebKey): Promise<string> {\n  const header = { alg: 'ES256', typ: 'JWT' };\n  const exp = Math.floor(Date.now() / 1000) + (12 * 60 * 60);\n  const payload = { aud: audOrigin, exp, sub: subject };\n\n  const headerB64 = base64UrlEncode(new TextEncoder().encode(JSON.stringify(header)));\n  const payloadB64 = base64UrlEncode(new TextEncoder().encode(JSON.stringify(payload)));\n  const signingInput = `${headerB64}.${payloadB64}`;\n\n  const key = await crypto.subtle.importKey(\n    'jwk',\n    privateKeyJwk,\n    { name: 'ECDSA', namedCurve: 'P-256' },\n    false,\n    ['sign'],\n  );\n\n  const sigDer = new Uint8Array(await crypto.subtle.sign(\n    { name: 'ECDSA', hash: 'SHA-256' },\n    key,\n    new TextEncoder().encode(signingInput),\n  ));\n\n  // Cloudflare Workers returns ECDSA signatures in JOSE (raw R||S) format (64 bytes for P-256).\n  // Some runtimes return ASN.1 DER. Support both.\n  let sigJose: Uint8Array;\n  if (sigDer.length === 64) {\n    sigJose = sigDer;\n  } else if (sigDer.length > 0 && sigDer[0] === 0x30) {\n    sigJose = derToJose(sigDer);\n  } else {\n    throw new Error('Unsupported ECDSA signature format');\n  }\n\n  const sigB64 = base64UrlEncode(sigJose);\n  return `${signingInput}.${sigB64}`;\n}\n\nasync function ensurePushTables(db: D1Database): Promise<void> {\n  // Best-effort table creation so deployments don't depend on migrations.\n  // Keep this aligned with `migrations/0010_add_push_notifications.sql`.\n  await db.prepare(\n    `CREATE TABLE IF NOT EXISTS push_subscriptions (\n      id TEXT PRIMARY KEY,\n      user_email TEXT NOT NULL,\n      endpoint TEXT NOT NULL UNIQUE,\n      p256dh TEXT NOT NULL,\n      auth TEXT NOT NULL,\n      notify_new_jobs INTEGER NOT NULL DEFAULT 1,\n      notify_new_messages INTEGER NOT NULL DEFAULT 1,\n      is_active INTEGER NOT NULL DEFAULT 1,\n      last_seen_at TEXT NOT NULL DEFAULT (datetime('now')),\n      created_at TEXT NOT NULL DEFAULT (datetime('now')),\n      updated_at TEXT NOT NULL DEFAULT (datetime('now'))\n    )`\n  ).run();\n\n  await db.prepare(\n    `CREATE TABLE IF NOT EXISTS push_notification_queue (\n      id TEXT PRIMARY KEY,\n      subscription_id TEXT NOT NULL,\n      event_type TEXT NOT NULL CHECK (event_type IN ('new_job', 'new_message')),\n      title TEXT NOT NULL,\n      body TEXT,\n      target_url TEXT NOT NULL,\n      created_at TEXT NOT NULL DEFAULT (datetime('now')),\n      delivered_at TEXT,\n      FOREIGN KEY (subscription_id) REFERENCES push_subscriptions(id) ON DELETE CASCADE\n    )`\n  ).run();\n\n  await db.prepare(\n    'CREATE INDEX IF NOT EXISTS idx_push_subscriptions_user_email ON push_subscriptions(user_email)'\n  ).run();\n  await db.prepare(\n    'CREATE INDEX IF NOT EXISTS idx_push_subscriptions_endpoint ON push_subscriptions(endpoint)'\n  ).run();\n  await db.prepare(\n    'CREATE INDEX IF NOT EXISTS idx_push_queue_subscription_id ON push_notification_queue(subscription_id)'\n  ).run();\n}\n\nasync function pingPushEndpoint(db: D1Database, endpoint: string): Promise<{ ok: boolean; status: number }>{\n  const cfg = await ensureVapidConfig(db);\n  const origin = new URL(endpoint).origin;\n  const jwt = await createVapidJwt(origin, cfg.subject, cfg.privateKeyJwk);\n\n  const response = await fetch(endpoint, {\n    method: 'POST',\n    headers: {\n      TTL: '60',\n      Authorization: `vapid t=${jwt}, k=${cfg.publicKey}`,\n      'Crypto-Key': `p256ecdsa=${cfg.publicKey}`,\n      'Content-Length': '0',\n    },\n  });\n\n  return { ok: response.ok, status: response.status };\n}\n\nexport async function getPushVapidPublicKey(db: D1Database): Promise<string> {\n  const cfg = await ensureVapidConfig(db);\n  return cfg.publicKey;\n}\n\nexport async function upsertPushSubscription(\n  db: D1Database,\n  staffEmail: string,\n  subscription: PushSubscriptionInput,\n  _preferences: PushSubscriptionPreferences,\n): Promise<void> {\n  const endpoint = subscription.endpoint.trim();\n  const auth = subscription.keys.auth.trim();\n  const p256dh = subscription.keys.p256dh.trim();\n  if (!endpoint || !auth || !p256dh) throw new Error('endpoint and keys are required');\n\n  await ensurePushTables(db);\n\n  const userEmail = staffEmail.trim().toLowerCase();\n  const notifyNewJobs = _preferences.notifyNewJobs ? 1 : 0;\n  const notifyNewMessages = _preferences.notifyNewMessages ? 1 : 0;\n\n  await db.prepare(\n    `INSERT INTO push_subscriptions (\n       id, user_email, endpoint, p256dh, auth,\n       notify_new_jobs, notify_new_messages,\n       is_active, last_seen_at, created_at, updated_at\n     )\n     VALUES (?, ?, ?, ?, ?, ?, ?, 1, datetime('now'), datetime('now'), datetime('now'))\n     ON CONFLICT(endpoint) DO UPDATE SET\n       user_email = excluded.user_email,\n       p256dh = excluded.p256dh,\n       auth = excluded.auth,\n       notify_new_jobs = excluded.notify_new_jobs,\n       notify_new_messages = excluded.notify_new_messages,\n       is_active = 1,\n       last_seen_at = datetime('now'),\n       updated_at = datetime('now')`\n  ).bind(\n    crypto.randomUUID(),\n    userEmail,\n    endpoint,\n    p256dh,\n    auth,\n    notifyNewJobs,\n    notifyNewMessages,\n  ).run();\n}\n\nexport async function deactivatePushSubscription(\n  db: D1Database,\n  staffEmail: string,\n  endpoint: string,\n): Promise<void> {\n  const trimmed = endpoint.trim();\n  if (!trimmed) return;\n\n  await ensurePushTables(db);\n\n  const userEmail = staffEmail.trim().toLowerCase();\n  await db.prepare(\n    `UPDATE push_subscriptions\n     SET is_active = 0, updated_at = datetime('now')\n     WHERE user_email = ? AND endpoint = ?`\n  ).bind(userEmail, trimmed).run();\n}\n\nexport async function getPushSubscriptionStatus(\n  db: D1Database,\n  staffEmail: string,\n  endpoint?: string,\n): Promise<{ subscribed: boolean; notifyNewJobs: boolean; notifyNewMessages: boolean }>{\n  await ensurePushTables(db);\n\n  const userEmail = staffEmail.trim().toLowerCase();\n  const endpointTrimmed = (endpoint || '').trim();\n\n  const row = endpointTrimmed\n    ? await db.prepare(\n        `SELECT notify_new_jobs, notify_new_messages\n         FROM push_subscriptions\n         WHERE user_email = ? AND endpoint = ? AND is_active = 1`\n      ).bind(userEmail, endpointTrimmed).first<{ notify_new_jobs: number; notify_new_messages: number }>()\n    : await db.prepare(\n        `SELECT notify_new_jobs, notify_new_messages\n         FROM push_subscriptions\n         WHERE user_email = ? AND is_active = 1\n         ORDER BY datetime(updated_at) DESC\n         LIMIT 1`\n      ).bind(userEmail).first<{ notify_new_jobs: number; notify_new_messages: number }>();\n\n  if (!row) {\n    return { subscribed: false, notifyNewJobs: true, notifyNewMessages: true };\n  }\n\n  return {\n    subscribed: true,\n    notifyNewJobs: row.notify_new_jobs === 1,\n    notifyNewMessages: row.notify_new_messages === 1,\n  };\n}\n\nexport async function pullPendingPushNotifications(\n  db: D1Database,\n  staffEmail: string,\n  endpoint: string,\n  limit = 6,\n): Promise<PendingPushNotification[]> {\n  const trimmed = endpoint.trim();\n  if (!trimmed) return [];\n  await ensurePushTables(db);\n\n  const userEmail = staffEmail.trim().toLowerCase();\n  const limitClamped = Math.max(1, Math.min(20, limit));\n\n  const sub = await db.prepare(\n    `SELECT id\n     FROM push_subscriptions\n     WHERE user_email = ? AND endpoint = ? AND is_active = 1`\n  ).bind(userEmail, trimmed).first<{ id: string }>();\n\n  if (!sub?.id) return [];\n\n  const pending = await db.prepare(\n    `SELECT id, title, body, target_url, created_at\n     FROM push_notification_queue\n     WHERE subscription_id = ?\n       AND delivered_at IS NULL\n     ORDER BY datetime(created_at) ASC\n     LIMIT ?`\n  ).bind(sub.id, limitClamped).all<{ id: string; title: string; body: string | null; target_url: string; created_at: string }>();\n\n  const rows = pending.results || [];\n  if (rows.length) {\n    const ids = rows.map((r) => r.id);\n    await db.prepare(\n      `UPDATE push_notification_queue\n       SET delivered_at = datetime('now')\n       WHERE id IN (${ids.map(() => '?').join(',')})`\n    ).bind(...ids).run();\n  }\n\n  return rows.map((row) => ({\n    id: row.id,\n    title: row.title,\n    body: row.body || '',\n    url: row.target_url,\n    createdAt: row.created_at,\n  }));\n}\n\nexport async function enqueueTestPushNotificationAndPing(\n  db: D1Database,\n  staffEmail: string,\n  endpoint: string,\n): Promise<{ ok: boolean; status: number; queued: boolean }>{\n  const trimmed = endpoint.trim();\n  if (!trimmed) throw new Error('endpoint is required');\n\n  await ensurePushTables(db);\n\n  const userEmail = staffEmail.trim().toLowerCase();\n  const sub = await db.prepare(\n    `SELECT id\n     FROM push_subscriptions\n     WHERE user_email = ? AND endpoint = ? AND is_active = 1`\n  ).bind(userEmail, trimmed).first<{ id: string }>();\n\n  if (!sub?.id) {\n    return { ok: false, status: 404, queued: false };\n  }\n\n  const id = crypto.randomUUID();\n  await db.prepare(\n    `INSERT INTO push_notification_queue (id, subscription_id, event_type, title, body, target_url)\n     VALUES (?, ?, 'new_message', ?, ?, ?)`\n  ).bind(\n    id,\n    sub.id,\n    'GOATkit test notification',\n    'If you can see this, push delivery is working.',\n    '/admin',\n  ).run();\n\n  const delivered = await pingPushEndpoint(db, trimmed);\n  return { ...delivered, queued: true };\n}\n\nexport async function enqueueAndDispatchPushEvent(\n  db: D1Database,\n  event: PushEvent,\n): Promise<void> {\n  await ensurePushTables(db);\n\n  const type = event.type === 'test' ? 'new_message' : event.type;\n  const title = event.title.trim() || 'GOATkit update';\n  const body = (event.body || '').trim() || 'Open the app for details.';\n  const targetUrl = event.targetUrl.trim() || '/admin';\n\n  const subs = await db.prepare(\n    `SELECT id, endpoint\n     FROM push_subscriptions\n     WHERE is_active = 1\n       AND (\n         (? = 'new_job' AND notify_new_jobs = 1)\n         OR (? = 'new_message' AND notify_new_messages = 1)\n       )\n     ORDER BY datetime(updated_at) DESC\n     LIMIT 200`\n  ).bind(type, type).all<{ id: string; endpoint: string }>();\n\n  const rows = (subs.results || [])\n    .map((r) => ({ id: (r.id || '').trim(), endpoint: (r.endpoint || '').trim() }))\n    .filter((r) => r.id && r.endpoint);\n\n  if (!rows.length) return;\n\n  const inserts: D1PreparedStatement[] = [];\n  for (const row of rows) {\n    inserts.push(db.prepare(\n      `INSERT INTO push_notification_queue (id, subscription_id, event_type, title, body, target_url)\n       VALUES (?, ?, ?, ?, ?, ?)`\n    ).bind(\n      crypto.randomUUID(),\n      row.id,\n      type,\n      title,\n      body,\n      targetUrl,\n    ));\n  }\n  await db.batch(inserts);\n\n  await Promise.all(rows.map((row) => pingPushEndpoint(db, row.endpoint).catch(() => null)));\n}\n\nexport async function sendNotification(type: string, data: unknown): Promise<void> {\n  console.log('[notifications] send', { type, data });\n}\n", "type PriceRule = {\n  id: string;\n  service_id: string | null;\n  territory_id: string | null;\n  rule_type: string;\n  adjustment_type: string;\n  adjustment_value: number;\n  direction: string;\n  days_of_week: string | null;\n  start_time: string | null;\n  end_time: string | null;\n  min_hours_ahead: number | null;\n  max_hours_ahead: number | null;\n};\n\nconst toMinutes = (value: string): number => {\n  const [hRaw, mRaw] = value.split(':');\n  const h = Number(hRaw);\n  const m = Number(mRaw ?? 0);\n  return h * 60 + m;\n};\n\nconst parseDaysOfWeek = (days: string | null): number[] => {\n  if (!days) return [];\n  try {\n    const parsed = JSON.parse(days);\n    if (Array.isArray(parsed)) {\n      return parsed.map((v) => Number(v)).filter((v) => Number.isFinite(v));\n    }\n  } catch {\n  }\n  return days\n    .split(',')\n    .map((v) => Number(v.trim()))\n    .filter((v) => Number.isFinite(v));\n};\n\nconst matchTimeWindow = (start: string, ruleStart: string | null, ruleEnd: string | null): boolean => {\n  if (!ruleStart || !ruleEnd) return false;\n  const minute = toMinutes(start);\n  const startMin = toMinutes(ruleStart);\n  const endMin = toMinutes(ruleEnd);\n\n  if (endMin >= startMin) {\n    return minute >= startMin && minute <= endMin;\n  }\n\n  return minute >= startMin || minute <= endMin;\n};\n\nconst isRuleApplicable = (\n  rule: PriceRule,\n  territoryId: string,\n  date: string,\n  startTime: string,\n  bookingDateTime: Date\n): boolean => {\n  if (rule.territory_id && rule.territory_id !== territoryId) {\n    return false;\n  }\n\n  if (rule.rule_type === 'territory') {\n    return true;\n  }\n\n  if (rule.rule_type === 'time_of_day') {\n    return matchTimeWindow(startTime, rule.start_time, rule.end_time);\n  }\n\n  if (rule.rule_type === 'day_of_week') {\n    const day = new Date(`${date}T00:00:00`).getDay();\n    const allowed = parseDaysOfWeek(rule.days_of_week);\n    return allowed.length === 0 ? false : allowed.includes(day);\n  }\n\n  if (rule.rule_type === 'lead_time') {\n    const diffHours = (bookingDateTime.getTime() - Date.now()) / (1000 * 60 * 60);\n    if (rule.min_hours_ahead !== null && diffHours < rule.min_hours_ahead) {\n      return false;\n    }\n    if (rule.max_hours_ahead !== null && diffHours > rule.max_hours_ahead) {\n      return false;\n    }\n    return true;\n  }\n\n  return false;\n};\n\nexport async function calculateAdjustedPrice(\n  db: D1Database,\n  serviceId: string,\n  basePrice: number,\n  territoryId: string,\n  date: string,\n  startTime: string\n): Promise<{ total_price: number; rule_adjustments: unknown[] }> {\n  const rulesResult = await db.prepare(\n    `SELECT id, service_id, territory_id, rule_type, adjustment_type, adjustment_value, direction,\n            days_of_week, start_time, end_time, min_hours_ahead, max_hours_ahead\n     FROM price_adjustment_rules\n     WHERE is_active = 1\n       AND (service_id = ? OR service_id IS NULL)\n       AND (territory_id = ? OR territory_id IS NULL)\n     ORDER BY created_at ASC`\n  ).bind(serviceId, territoryId).all<PriceRule>();\n\n  const bookingDateTime = new Date(`${date}T${startTime}:00`);\n  let runningTotal = basePrice;\n  const applied: Array<Record<string, unknown>> = [];\n\n  for (const rule of rulesResult.results || []) {\n    if (!isRuleApplicable(rule, territoryId, date, startTime, bookingDateTime)) {\n      continue;\n    }\n\n    const directionMultiplier = rule.direction === 'decrease' ? -1 : 1;\n    let delta = 0;\n\n    if (rule.adjustment_type === 'flat') {\n      delta = Math.round(Number(rule.adjustment_value || 0)) * directionMultiplier;\n    } else if (rule.adjustment_type === 'percentage') {\n      const pct = Number(rule.adjustment_value || 0) / 100;\n      delta = Math.round(runningTotal * pct) * directionMultiplier;\n    } else {\n      continue;\n    }\n\n    runningTotal += delta;\n\n    applied.push({\n      id: rule.id,\n      rule_type: rule.rule_type,\n      adjustment_type: rule.adjustment_type,\n      adjustment_value: rule.adjustment_value,\n      direction: rule.direction,\n      delta,\n      total_after_rule: runningTotal,\n    });\n  }\n\n  return {\n    total_price: Math.max(0, Math.round(runningTotal)),\n    rule_adjustments: applied,\n  };\n}\n", "import { Hono } from 'hono';\nimport { checkServiceArea } from '../geo/service-area';\nimport { calculateAdjustedPrice } from '../scheduling/pricing';\nimport { normalizePhoneE164, sendJobSms } from '../services/twilio';\nimport type { TemplateVars } from '../services/twilio';\nimport { buildServiceBaseLine, normalizeLine } from '../utils/line-items';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asStringArray = (value: unknown): string[] => {\n  if (Array.isArray(value)) return value.map((v) => String(v));\n  if (typeof value === 'string' && value) return [value];\n  return [];\n};\n\ntype TerritoryRow = {\n  id: string;\n  service_area_type: string;\n  service_area_data: string;\n};\n\napp.post('/create', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n\n    let territoryId = typeof body.territory_id === 'string' ? body.territory_id : '';\n    if (!territoryId) {\n      const territories = await db.prepare(\n        'SELECT id, service_area_type, service_area_data FROM territories WHERE is_active = 1'\n      ).all<TerritoryRow>();\n\n      for (const territory of territories.results || []) {\n        const result = checkServiceArea(\n          territory.service_area_type,\n          territory.service_area_data,\n          {\n            postalCode: typeof body.postal_code === 'string' ? body.postal_code : undefined,\n            lat: typeof body.lat === 'number' ? body.lat : undefined,\n            lng: typeof body.lng === 'number' ? body.lng : undefined,\n          }\n        );\n        if (result.within) {\n          territoryId = territory.id;\n          break;\n        }\n      }\n    }\n\n    if (!territoryId) {\n      return c.json({ error: 'Address is outside of service area' }, 400);\n    }\n\n    const serviceId = String(body.service_id || '');\n    const service = await db.prepare(\n      `SELECT s.id, s.name, s.base_price_cents, s.base_duration_minutes\n       FROM services s\n       JOIN territory_services ts ON ts.service_id = s.id\n       WHERE s.id = ? AND ts.territory_id = ? AND s.is_active = 1`\n    ).bind(serviceId, territoryId).first<{ id: string; name: string; base_price_cents: number; base_duration_minutes: number }>();\n\n    if (!service) {\n      return c.json({ error: 'Service unavailable for selected territory' }, 400);\n    }\n\n    let customer = null as null | { id: string };\n    if (typeof body.email === 'string' && body.email.trim()) {\n      customer = await db.prepare('SELECT id FROM customers WHERE email = ?').bind(body.email.trim()).first<{ id: string }>();\n    }\n    if (!customer && typeof body.phone === 'string' && body.phone.trim()) {\n      customer = await db.prepare('SELECT id FROM customers WHERE phone = ? ORDER BY created_at DESC LIMIT 1').bind(body.phone.trim()).first<{ id: string }>();\n    }\n\n    const phoneE164 = normalizePhoneE164(typeof body.phone === 'string' ? body.phone : null);\n    const smsConsent = body.sms_consent === true || body.sms_consent === 1 ? 1 : 0;\n\n    let customerId = customer?.id;\n    if (!customerId) {\n      customerId = crypto.randomUUID();\n      await db.prepare(\n        `INSERT INTO customers (id, first_name, last_name, email, phone, phone_e164, sms_consent, sms_consent_at, created_at, updated_at)\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n      ).bind(\n        customerId,\n        body.first_name,\n        body.last_name,\n        body.email || null,\n        body.phone || null,\n        phoneE164,\n        smsConsent,\n        smsConsent ? new Date().toISOString() : null\n      ).run();\n    } else if (smsConsent || phoneE164) {\n      await db.prepare(\n        `UPDATE customers SET\n         phone_e164 = COALESCE(?, phone_e164),\n         sms_consent = CASE WHEN ? = 1 THEN 1 ELSE sms_consent END,\n         sms_consent_at = CASE WHEN ? = 1 AND sms_consent = 0 THEN datetime('now') ELSE sms_consent_at END,\n         updated_at = datetime('now')\n         WHERE id = ?`\n      ).bind(phoneE164, smsConsent, smsConsent, customerId).run();\n    }\n\n    const addressId = crypto.randomUUID();\n    await db.prepare(\n      `INSERT INTO customer_addresses\n       (id, customer_id, line_1, line_2, city, state, postal_code, lat, lng, is_default, created_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`\n    ).bind(\n      addressId,\n      customerId,\n      body.address_line1,\n      body.address_line2 || null,\n      body.city,\n      body.province,\n      body.postal_code,\n      body.lat ?? null,\n      body.lng ?? null,\n      1\n    ).run();\n\n    const selectedModifierIds = asStringArray(body.selected_modifiers);\n    let totalPrice = Number(service.base_price_cents || 0);\n    let totalDuration = Number(body.duration_minutes || service.base_duration_minutes || 60);\n\n    const jobLineItems = [buildServiceBaseLine(service.name, Number(service.base_price_cents || 0))];\n\n    if (selectedModifierIds.length > 0) {\n      const modifierRows = await db.prepare(\n        `SELECT id, name, price_adjustment_cents, duration_adjustment_minutes\n         FROM service_modifiers\n         WHERE service_id = ?\n            AND id IN (${selectedModifierIds.map(() => '?').join(', ')})`\n      ).bind(serviceId, ...selectedModifierIds).all<{ id: string; name: string; price_adjustment_cents: number; duration_adjustment_minutes: number }>();\n\n      for (const modifier of modifierRows.results || []) {\n        const delta = Number(modifier.price_adjustment_cents || 0);\n        totalPrice += delta;\n        totalDuration += Number(modifier.duration_adjustment_minutes || 0);\n        jobLineItems.push(normalizeLine(modifier.name || 'Modifier', 1, delta, 'modifier', jobLineItems[0].id, 0));\n      }\n    }\n\n    const pricing = await calculateAdjustedPrice(\n      db,\n      serviceId,\n      totalPrice,\n      territoryId,\n      String(body.scheduled_date || ''),\n      String(body.scheduled_start_time || ''),\n    );\n    totalPrice = pricing.total_price;\n    for (const adjustment of pricing.rule_adjustments as Array<Record<string, unknown>>) {\n      const delta = Number(adjustment.delta || 0);\n      if (!delta) continue;\n      const kind = String(adjustment.rule_type || 'rule').replace(/_/g, ' ');\n      const direction = delta > 0 ? '+' : '-';\n      jobLineItems.push(normalizeLine(`Rule (${kind}) ${direction}`, 1, delta, 'rule', jobLineItems[0].id, 0));\n    }\n\n    const jobId = crypto.randomUUID();\n    await db.prepare(\n       `INSERT INTO jobs\n        (id, customer_id, service_id, territory_id, customer_address_id, scheduled_date, scheduled_start_time,\n         duration_minutes, base_price_cents, total_price_cents, line_items_json, status, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 'created', datetime('now'), datetime('now'))`\n    ).bind(\n      jobId,\n      customerId,\n      serviceId,\n      territoryId,\n      addressId,\n      body.scheduled_date,\n      body.scheduled_start_time,\n      totalDuration,\n      service.base_price_cents,\n      totalPrice,\n      JSON.stringify(jobLineItems),\n    ).run();\n\n    const job = await db.prepare('SELECT * FROM jobs WHERE id = ?').bind(jobId).first();\n\n    const templateVars: TemplateVars = {\n      first_name: typeof body.first_name === 'string' ? body.first_name : '',\n      last_name: typeof body.last_name === 'string' ? body.last_name : '',\n      service_name: service.name,\n      date: typeof body.scheduled_date === 'string' ? body.scheduled_date : '',\n      time: typeof body.scheduled_start_time === 'string' ? body.scheduled_start_time : '',\n      total: (totalPrice / 100).toFixed(2),\n    };\n\n    const baseUrl = new URL(c.req.url).origin;\n    c.executionCtx.waitUntil(\n      sendJobSms({\n        db,\n        jobId,\n        customerId,\n        eventType: 'booking.confirmed',\n        vars: templateVars,\n        statusCallbackUrl: `${baseUrl}/webhooks/twilio/status`,\n      })\n    );\n\n    return c.json(job, 201);\n  } catch (error) {\n    console.error('booking create error', error);\n    return c.json({ error: 'Failed to create booking' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const categories = await c.env.DB.prepare('SELECT * FROM service_categories ORDER BY sort_order, name').all();\n    return c.json({ categories: categories.results || [] });\n  } catch (error) {\n    console.error('categories list error', error);\n    return c.json({ error: 'Failed to list categories' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const category = await c.env.DB.prepare('SELECT * FROM service_categories WHERE id = ?').bind(c.req.param('id')).first();\n    if (!category) return c.json({ error: 'Not found' }, 404);\n    return c.json(category);\n  } catch (error) {\n    console.error('categories get error', error);\n    return c.json({ error: 'Failed to get category' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO service_categories (id, name, sort_order, created_at)\n       VALUES (?, ?, ?, datetime('now'))`\n    ).bind(id, body.name, body.sort_order || 0).run();\n    const created = await c.env.DB.prepare('SELECT * FROM service_categories WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('categories create error', error);\n    return c.json({ error: 'Failed to create category' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    if (body.name !== undefined) {\n      fields.push('name = ?');\n      values.push(body.name);\n    }\n    if (body.sort_order !== undefined) {\n      fields.push('sort_order = ?');\n      values.push(body.sort_order);\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE service_categories SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM service_categories WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('categories patch error', error);\n    return c.json({ error: 'Failed to update category' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    await c.env.DB.prepare('UPDATE services SET category_id = NULL WHERE category_id = ?').bind(id).run();\n    await c.env.DB.prepare('DELETE FROM service_categories WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('categories delete error', error);\n    return c.json({ error: 'Failed to delete category' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/validate', async (c) => {\n  try {\n    const db = c.env.DB;\n    const code = (c.req.query('code') || '').toUpperCase();\n    const subtotalCents = Number(c.req.query('subtotal_cents') || 0);\n    if (!code) return c.json({ valid: false, message: 'Coupon code is required' }, 400);\n\n    const coupon = await db.prepare(\n      `SELECT * FROM coupons\n       WHERE code = ?\n         AND is_active = 1\n         AND (valid_from IS NULL OR valid_from <= date('now'))\n         AND (valid_until IS NULL OR valid_until >= date('now'))`\n    ).bind(code).first<{\n      id: string;\n      discount_type: string;\n      discount_value: number;\n      max_uses: number | null;\n      current_uses: number;\n    }>();\n\n    if (!coupon) return c.json({ valid: false, message: 'Invalid or expired coupon' }, 404);\n    if (coupon.max_uses !== null && coupon.current_uses >= coupon.max_uses) {\n      return c.json({ valid: false, message: 'Coupon usage limit reached' }, 400);\n    }\n\n    const discount = coupon.discount_type === 'percentage'\n      ? Math.round(subtotalCents * (coupon.discount_value / 100))\n      : Math.round(coupon.discount_value);\n\n    return c.json({\n      valid: true,\n      coupon,\n      discount_cents: Math.max(0, discount),\n      total_cents: Math.max(0, subtotalCents - discount),\n    });\n  } catch (error) {\n    console.error('coupon validate error', error);\n    return c.json({ error: 'Failed to validate coupon' }, 500);\n  }\n});\n\napp.get('/', async (c) => {\n  try {\n    const coupons = await c.env.DB.prepare('SELECT * FROM coupons ORDER BY created_at DESC').all();\n    return c.json({ coupons: coupons.results || [] });\n  } catch (error) {\n    console.error('coupons list error', error);\n    return c.json({ error: 'Failed to list coupons' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const coupon = await c.env.DB.prepare('SELECT * FROM coupons WHERE id = ?').bind(c.req.param('id')).first();\n    if (!coupon) return c.json({ error: 'Not found' }, 404);\n    return c.json(coupon);\n  } catch (error) {\n    console.error('coupons get error', error);\n    return c.json({ error: 'Failed to get coupon' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO coupons\n       (id, code, discount_type, discount_value, max_uses, current_uses, valid_from, valid_until, is_active, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, 0, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      String(body.code || '').toUpperCase(),\n      body.discount_type || 'percentage',\n      body.discount_value || 0,\n      body.max_uses ?? null,\n      body.valid_from || null,\n      body.valid_until || null,\n      body.is_active === false ? 0 : 1\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM coupons WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('coupons create error', error);\n    return c.json({ error: 'Failed to create coupon' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    for (const key of ['code', 'discount_type', 'discount_value', 'max_uses', 'current_uses', 'valid_from', 'valid_until', 'is_active']) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        if (key === 'code') values.push(String(body[key]).toUpperCase());\n        else if (key === 'is_active') values.push(body[key] ? 1 : 0);\n        else values.push(body[key]);\n      }\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n    fields.push(\"updated_at = datetime('now')\");\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE coupons SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM coupons WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('coupons patch error', error);\n    return c.json({ error: 'Failed to update coupon' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM coupons WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('coupons delete error', error);\n    return c.json({ error: 'Failed to delete coupon' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\nimport { normalizePhoneE164 } from '../services/twilio';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asArray = (value: unknown): Array<Record<string, unknown>> => {\n  if (Array.isArray(value)) return value.filter((v): v is Record<string, unknown> => Boolean(v && typeof v === 'object'));\n  return [];\n};\n\nconst normalizeEmail = (value: unknown): string | null => {\n  if (typeof value !== 'string') return null;\n  const trimmed = value.trim().toLowerCase();\n  return trimmed || null;\n};\n\napp.get('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const customers = await db.prepare('SELECT * FROM customers ORDER BY created_at DESC').all();\n    const ids = (customers.results || []).map((cst) => cst.id as string);\n    if (ids.length === 0) return c.json({ customers: [] });\n\n    const addressRows = await db.prepare(\n      `SELECT * FROM customer_addresses\n       WHERE customer_id IN (${ids.map(() => '?').join(', ')})\n       ORDER BY is_default DESC, created_at DESC`\n    ).bind(...ids).all();\n\n    const addressesByCustomer = new Map<string, unknown[]>();\n    for (const row of addressRows.results || []) {\n      const key = row.customer_id as string;\n      const list = addressesByCustomer.get(key) || [];\n      list.push(row);\n      addressesByCustomer.set(key, list);\n    }\n\n    return c.json({\n      customers: (customers.results || []).map((row) => ({\n        ...row,\n        customer_addresses: addressesByCustomer.get(row.id as string) || [],\n      })),\n    });\n  } catch (error) {\n    console.error('customers list error', error);\n    return c.json({ error: 'Failed to list customers' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const customer = await db.prepare('SELECT * FROM customers WHERE id = ?').bind(id).first();\n    if (!customer) return c.json({ error: 'Not found' }, 404);\n    const addresses = await db.prepare('SELECT * FROM customer_addresses WHERE customer_id = ? ORDER BY is_default DESC, created_at DESC').bind(id).all();\n    return c.json({ ...customer, customer_addresses: addresses.results || [] });\n  } catch (error) {\n    console.error('customers get error', error);\n    return c.json({ error: 'Failed to get customer' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    const email = normalizeEmail(body.email);\n    const phone = typeof body.phone === 'string' ? body.phone.trim() : '';\n    const phoneE164 = normalizePhoneE164(phone || null);\n\n    const duplicate = await db.prepare(\n      `SELECT id FROM customers\n       WHERE (? IS NOT NULL AND LOWER(email) = ?)\n          OR (? IS NOT NULL AND phone_e164 = ?)\n       LIMIT 1`\n    ).bind(email, email, phoneE164, phoneE164).first();\n    if (duplicate) return c.json({ error: 'Customer already exists' }, 409);\n\n    await db.prepare(\n      `INSERT INTO customers (id, first_name, last_name, email, phone, phone_e164, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(id, body.first_name, body.last_name, email, phone || null, phoneE164).run();\n\n    for (const address of asArray(body.customer_addresses)) {\n      await db.prepare(\n        `INSERT INTO customer_addresses\n         (id, customer_id, line_1, line_2, city, state, postal_code, lat, lng, is_default, created_at)\n         VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`\n      ).bind(\n        crypto.randomUUID(),\n        id,\n        address.line_1,\n        address.line_2 || null,\n        address.city,\n        address.state,\n        address.postal_code,\n        address.lat ?? null,\n        address.lng ?? null,\n        address.is_default ? 1 : 0\n      ).run();\n    }\n\n    const created = await db.prepare('SELECT * FROM customers WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('customers create error', error);\n    return c.json({ error: 'Failed to create customer' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n\n    const normalizedEmail = body.email !== undefined ? normalizeEmail(body.email) : undefined;\n    const normalizedPhone = body.phone !== undefined && typeof body.phone === 'string' ? body.phone.trim() : undefined;\n    const normalizedPhoneE164 = normalizedPhone !== undefined ? normalizePhoneE164(normalizedPhone || null) : undefined;\n\n    const duplicate = await db.prepare(\n      `SELECT id FROM customers\n       WHERE id != ?\n         AND ((? IS NOT NULL AND LOWER(email) = ?) OR (? IS NOT NULL AND phone_e164 = ?))\n       LIMIT 1`\n    ).bind(\n      id,\n      normalizedEmail !== undefined ? normalizedEmail : null,\n      normalizedEmail !== undefined ? normalizedEmail : null,\n      normalizedPhoneE164 !== undefined ? normalizedPhoneE164 : null,\n      normalizedPhoneE164 !== undefined ? normalizedPhoneE164 : null,\n    ).first();\n    if (duplicate) return c.json({ error: 'Customer already exists' }, 409);\n\n    for (const key of ['first_name', 'last_name', 'email', 'phone']) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        if (key === 'email') values.push(normalizedEmail ?? null);\n        else if (key === 'phone') values.push(normalizedPhone ?? null);\n        else values.push(body[key]);\n      }\n    }\n\n    if (normalizedPhoneE164 !== undefined) {\n      fields.push('phone_e164 = ?');\n      values.push(normalizedPhoneE164);\n    }\n\n    if (fields.length > 0) {\n      fields.push(\"updated_at = datetime('now')\");\n      values.push(id);\n      await db.prepare(`UPDATE customers SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    }\n\n    if (body.customer_addresses !== undefined) {\n      await db.prepare('DELETE FROM customer_addresses WHERE customer_id = ?').bind(id).run();\n      for (const address of asArray(body.customer_addresses)) {\n        await db.prepare(\n          `INSERT INTO customer_addresses\n           (id, customer_id, line_1, line_2, city, state, postal_code, lat, lng, is_default, created_at)\n           VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`\n        ).bind(\n          crypto.randomUUID(),\n          id,\n          address.line_1,\n          address.line_2 || null,\n          address.city,\n          address.state,\n          address.postal_code,\n          address.lat ?? null,\n          address.lng ?? null,\n          address.is_default ? 1 : 0\n        ).run();\n      }\n    }\n\n    const updated = await db.prepare('SELECT * FROM customers WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('customers patch error', error);\n    return c.json({ error: 'Failed to update customer' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    await db.prepare('DELETE FROM customer_addresses WHERE customer_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM customers WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('customers delete error', error);\n    return c.json({ error: 'Failed to delete customer' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\ntype InvoiceLineItem = { description: string; quantity: number; unit_price_cents: number; total_cents: number };\n\nconst parseMoneyToCents = (value: unknown): number => {\n  if (typeof value === 'number' && Number.isFinite(value)) return Math.max(0, Math.round(value));\n  if (typeof value !== 'string') return 0;\n  const cleaned = value.trim().replace(/[$,]/g, '');\n  if (!cleaned) return 0;\n  const parsed = Number.parseFloat(cleaned);\n  if (!Number.isFinite(parsed)) return 0;\n  return Math.max(0, Math.round(parsed * 100));\n};\n\nconst parseCentsInt = (value: unknown): number => {\n  if (typeof value === 'number' && Number.isFinite(value)) return Math.max(0, Math.round(value));\n  if (typeof value !== 'string') return 0;\n  const parsed = Number.parseInt(value.trim(), 10);\n  if (!Number.isFinite(parsed)) return 0;\n  return Math.max(0, parsed);\n};\n\nconst parseLineItems = (value: unknown): InvoiceLineItem[] => {\n  if (!Array.isArray(value)) return [];\n  return value\n    .filter((entry): entry is Record<string, unknown> => Boolean(entry && typeof entry === 'object' && !Array.isArray(entry)))\n    .map((entry) => {\n      const description = typeof entry.description === 'string' && entry.description.trim()\n        ? entry.description.trim()\n        : 'Line item';\n      const quantity = typeof entry.quantity === 'number' ? entry.quantity : Number.parseFloat(String(entry.quantity || 0));\n      const unitPriceCents = typeof entry.unit_price_cents === 'number'\n        ? Math.max(0, Math.round(entry.unit_price_cents))\n        : parseCentsInt(entry.unit_price_cents);\n      const safeQty = Number.isFinite(quantity) && quantity > 0 ? quantity : 1;\n      return {\n        description,\n        quantity: safeQty,\n        unit_price_cents: unitPriceCents,\n        total_cents: Math.round(safeQty * unitPriceCents),\n      };\n    });\n};\n\nconst nextInvoiceNumber = async (db: D1Database) => {\n  const row = await db.prepare(\"SELECT invoice_number FROM invoices WHERE invoice_number LIKE 'INV-%' ORDER BY invoice_number DESC LIMIT 1\")\n    .first<{ invoice_number: string | null }>();\n  const suffix = row?.invoice_number ? Number.parseInt(row.invoice_number.replace('INV-', ''), 10) : 0;\n  const next = Number.isFinite(suffix) ? suffix + 1 : 1;\n  return `INV-${String(next).padStart(6, '0')}`;\n};\n\napp.get('/', async (c) => {\n  try {\n    const invoices = await c.env.DB.prepare('SELECT * FROM invoices ORDER BY created_at DESC').all();\n    return c.json({ invoices: invoices.results || [] });\n  } catch (error) {\n    console.error('invoices list error', error);\n    return c.json({ error: 'Failed to list invoices' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const invoice = await c.env.DB.prepare('SELECT * FROM invoices WHERE id = ?').bind(c.req.param('id')).first();\n    if (!invoice) return c.json({ error: 'Not found' }, 404);\n    return c.json(invoice);\n  } catch (error) {\n    console.error('invoices get error', error);\n    return c.json({ error: 'Failed to get invoice' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    if (typeof body.customer_id !== 'string' || !body.customer_id.trim()) {\n      return c.json({ error: 'customer_id is required' }, 400);\n    }\n\n    const lineItems = parseLineItems(body.line_items);\n    const subtotalCents = lineItems.reduce((sum, item) => sum + item.total_cents, 0);\n    const taxCents = body.tax_cents !== undefined ? parseCentsInt(body.tax_cents) : parseMoneyToCents(body.tax_amount);\n    const discountCents = body.discount_cents !== undefined ? parseCentsInt(body.discount_cents) : parseMoneyToCents(body.discount_amount);\n    const bodyTotalCents = body.total_cents !== undefined\n      ? parseCentsInt(body.total_cents)\n      : (body.amount_cents !== undefined ? parseCentsInt(body.amount_cents) : 0);\n    const computedTotalCents = Math.max(0, subtotalCents + taxCents - discountCents);\n    const totalCents = bodyTotalCents > 0 ? bodyTotalCents : computedTotalCents;\n    const status = typeof body.status === 'string' ? body.status : 'pending';\n    const paidAt = status === 'paid'\n      ? (typeof body.paid_at === 'string' && body.paid_at ? body.paid_at : new Date().toISOString())\n      : null;\n    await c.env.DB.prepare(\n      `INSERT INTO invoices (\n         id, invoice_number, job_id, customer_id, currency,\n         amount_cents, subtotal_cents, tax_cents, discount_cents, total_cents,\n         line_items_json, due_date, status, paid_at, sent_at, notes,\n         external_provider, external_reference, external_sync_status,\n         created_at, updated_at\n       )\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      (typeof body.invoice_number === 'string' && body.invoice_number.trim()) ? body.invoice_number.trim() : await nextInvoiceNumber(c.env.DB),\n      body.job_id || null,\n      body.customer_id,\n      (typeof body.currency === 'string' && body.currency.trim()) ? body.currency.trim().toUpperCase() : 'CAD',\n      totalCents,\n      subtotalCents,\n      taxCents,\n      discountCents,\n      totalCents,\n      JSON.stringify(lineItems),\n      body.due_date || null,\n      status,\n      paidAt,\n      status === 'sent' ? new Date().toISOString() : null,\n      (typeof body.notes === 'string' && body.notes.trim()) ? body.notes.trim() : null,\n      (typeof body.external_provider === 'string' && body.external_provider.trim()) ? body.external_provider.trim() : null,\n      (typeof body.external_reference === 'string' && body.external_reference.trim()) ? body.external_reference.trim() : null,\n      (typeof body.external_sync_status === 'string' && body.external_sync_status.trim()) ? body.external_sync_status.trim() : 'local_only'\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM invoices WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('invoices create error', error);\n    return c.json({ error: 'Failed to create invoice' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const existing = await c.env.DB.prepare('SELECT * FROM invoices WHERE id = ?').bind(id).first<Record<string, unknown>>();\n    if (!existing) return c.json({ error: 'Not found' }, 404);\n\n    const mergedCustomerId = typeof body.customer_id === 'string' ? body.customer_id : String(existing.customer_id || '');\n    if (!mergedCustomerId) return c.json({ error: 'customer_id is required' }, 400);\n\n    let existingLineItemsRaw: unknown = [];\n    try {\n      existingLineItemsRaw = JSON.parse(String(existing.line_items_json || '[]')) as unknown;\n    } catch {\n      existingLineItemsRaw = [];\n    }\n    const lineItems = body.line_items !== undefined\n      ? parseLineItems(body.line_items)\n      : parseLineItems(existingLineItemsRaw);\n\n    const subtotalCents = lineItems.reduce((sum, item) => sum + item.total_cents, 0);\n    const taxCents = body.tax_cents !== undefined\n      ? parseCentsInt(body.tax_cents)\n      : (body.tax_amount !== undefined ? parseMoneyToCents(body.tax_amount) : parseCentsInt(existing.tax_cents));\n    const discountCents = body.discount_cents !== undefined\n      ? parseCentsInt(body.discount_cents)\n      : (body.discount_amount !== undefined ? parseMoneyToCents(body.discount_amount) : parseCentsInt(existing.discount_cents));\n\n    const bodyTotalCents = body.total_cents !== undefined\n      ? parseCentsInt(body.total_cents)\n      : (body.amount_cents !== undefined ? parseCentsInt(body.amount_cents) : 0);\n    const computedTotalCents = Math.max(0, subtotalCents + taxCents - discountCents);\n    const totalCents = bodyTotalCents > 0 ? bodyTotalCents : computedTotalCents;\n\n    const status = typeof body.status === 'string' ? body.status : String(existing.status || 'pending');\n    const paidAt = status === 'paid'\n      ? (typeof body.paid_at === 'string' && body.paid_at ? body.paid_at : String(existing.paid_at || new Date().toISOString()))\n      : null;\n    const sentAt = status === 'sent'\n      ? String(existing.sent_at || new Date().toISOString())\n      : null;\n\n    await c.env.DB.prepare(\n      `UPDATE invoices\n       SET invoice_number = ?,\n           job_id = ?,\n           customer_id = ?,\n           currency = ?,\n           amount_cents = ?,\n           subtotal_cents = ?,\n           tax_cents = ?,\n           discount_cents = ?,\n           total_cents = ?,\n           line_items_json = ?,\n           due_date = ?,\n           status = ?,\n           paid_at = ?,\n           sent_at = ?,\n           notes = ?,\n           external_provider = ?,\n           external_reference = ?,\n           external_sync_status = ?,\n           updated_at = datetime('now')\n       WHERE id = ?`\n    ).bind(\n      (typeof body.invoice_number === 'string' && body.invoice_number.trim()) ? body.invoice_number.trim() : String(existing.invoice_number || await nextInvoiceNumber(c.env.DB)),\n      body.job_id !== undefined ? (body.job_id || null) : (existing.job_id || null),\n      mergedCustomerId,\n      (typeof body.currency === 'string' && body.currency.trim()) ? body.currency.trim().toUpperCase() : String(existing.currency || 'CAD'),\n      totalCents,\n      subtotalCents,\n      taxCents,\n      discountCents,\n      totalCents,\n      JSON.stringify(lineItems),\n      body.due_date !== undefined ? (body.due_date || null) : (existing.due_date || null),\n      status,\n      paidAt,\n      sentAt,\n      body.notes !== undefined ? (body.notes || null) : (existing.notes || null),\n      body.external_provider !== undefined ? (body.external_provider || null) : (existing.external_provider || null),\n      body.external_reference !== undefined ? (body.external_reference || null) : (existing.external_reference || null),\n      body.external_sync_status !== undefined ? (body.external_sync_status || 'local_only') : (existing.external_sync_status || 'local_only'),\n      id,\n    ).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM invoices WHERE id = ?').bind(id).first();\n    return c.json(updated);\n  } catch (error) {\n    console.error('invoices patch error', error);\n    return c.json({ error: 'Failed to update invoice' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM invoices WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('invoices delete error', error);\n    return c.json({ error: 'Failed to delete invoice' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\nimport { buildServiceBaseLine, parsePriceLines, subtotalFromLines } from '../utils/line-items';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asStringArray = (value: unknown): string[] => {\n  if (Array.isArray(value)) return value.map((v) => String(v));\n  if (typeof value === 'string' && value) return [value];\n  return [];\n};\n\nconst maybeAutoCreateInvoice = async (db: D1Database, jobId: string): Promise<void> => {\n  const job = await db.prepare('SELECT customer_id, total_price_cents, line_items_json FROM jobs WHERE id = ?').bind(jobId).first<{ customer_id: string; total_price_cents: number; line_items_json: string | null }>();\n  if (!job) return;\n  const existing = await db.prepare('SELECT id FROM invoices WHERE job_id = ?').bind(jobId).first();\n  if (existing) return;\n\n  const lastInvoice = await db.prepare(\"SELECT invoice_number FROM invoices WHERE invoice_number LIKE 'INV-%' ORDER BY invoice_number DESC LIMIT 1\")\n    .first<{ invoice_number: string | null }>();\n  const lastNumber = lastInvoice?.invoice_number\n    ? Number.parseInt(lastInvoice.invoice_number.replace('INV-', ''), 10)\n    : 0;\n  const invoiceNumber = `INV-${String((Number.isFinite(lastNumber) ? lastNumber : 0) + 1).padStart(6, '0')}`;\n\n  const storedLines = parsePriceLines(job.line_items_json);\n  const effectiveLines = storedLines.length > 0 ? storedLines : [buildServiceBaseLine('Service', job.total_price_cents)];\n  const subtotal = subtotalFromLines(effectiveLines);\n\n  const due = new Date();\n  due.setDate(due.getDate() + 14);\n  await db.prepare(\n    `INSERT INTO invoices (id, invoice_number, job_id, customer_id, currency, amount_cents, subtotal_cents, tax_cents, discount_cents, total_cents, line_items_json, due_date, status, created_at, updated_at)\n     VALUES (?, ?, ?, ?, 'CAD', ?, ?, 0, 0, ?, ?, ?, 'pending', datetime('now'), datetime('now'))`\n  ).bind(\n    crypto.randomUUID(),\n    invoiceNumber,\n    jobId,\n    job.customer_id,\n    subtotal,\n    subtotal,\n    subtotal,\n    JSON.stringify(effectiveLines),\n    due.toISOString().split('T')[0],\n  ).run();\n};\n\napp.get('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const status = c.req.query('status');\n    const clauses: string[] = [];\n    const params: unknown[] = [];\n    if (status) {\n      clauses.push('j.status = ?');\n      params.push(status);\n    }\n\n    const jobs = await (params.length\n      ? db.prepare(\n          `SELECT j.*, c.first_name || ' ' || c.last_name as customer_name, s.name as service_name\n           FROM jobs j\n           JOIN customers c ON c.id = j.customer_id\n           LEFT JOIN services s ON s.id = j.service_id\n           ${clauses.length ? `WHERE ${clauses.join(' AND ')}` : ''}\n           ORDER BY j.scheduled_date DESC, j.scheduled_start_time DESC`\n        ).bind(...params).all()\n      : db.prepare(\n          `SELECT j.*, c.first_name || ' ' || c.last_name as customer_name, s.name as service_name\n           FROM jobs j\n           JOIN customers c ON c.id = j.customer_id\n           LEFT JOIN services s ON s.id = j.service_id\n           ORDER BY j.scheduled_date DESC, j.scheduled_start_time DESC`\n        ).all());\n\n    const ids = (jobs.results || []).map((j) => j.id as string);\n    if (ids.length === 0) return c.json({ jobs: [] });\n\n    const [providers, notes] = await Promise.all([\n      db.prepare(\n        `SELECT jp.job_id, tm.id, tm.first_name, tm.last_name\n         FROM job_providers jp\n         JOIN team_members tm ON tm.id = jp.team_member_id\n         WHERE jp.job_id IN (${ids.map(() => '?').join(', ')})`\n      ).bind(...ids).all(),\n      db.prepare(\n        `SELECT id, job_id, content, created_at\n         FROM job_notes\n         WHERE job_id IN (${ids.map(() => '?').join(', ')})\n         ORDER BY created_at DESC`\n      ).bind(...ids).all(),\n    ]);\n\n    const providersByJob = new Map<string, unknown[]>();\n    for (const row of providers.results || []) {\n      const key = row.job_id as string;\n      const list = providersByJob.get(key) || [];\n      list.push({ id: row.id, first_name: row.first_name, last_name: row.last_name });\n      providersByJob.set(key, list);\n    }\n\n    const notesByJob = new Map<string, unknown[]>();\n    for (const row of notes.results || []) {\n      const key = row.job_id as string;\n      const list = notesByJob.get(key) || [];\n      list.push(row);\n      notesByJob.set(key, list);\n    }\n\n    return c.json({\n      jobs: (jobs.results || []).map((row) => ({\n        ...row,\n        job_providers: providersByJob.get(row.id as string) || [],\n        job_notes: notesByJob.get(row.id as string) || [],\n      })),\n    });\n  } catch (error) {\n    console.error('jobs list error', error);\n    return c.json({ error: 'Failed to list jobs' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const job = await db.prepare('SELECT * FROM jobs WHERE id = ?').bind(id).first();\n    if (!job) return c.json({ error: 'Not found' }, 404);\n\n    const [providers, notes] = await Promise.all([\n      db.prepare(\n        `SELECT tm.id, tm.first_name, tm.last_name\n         FROM job_providers jp\n         JOIN team_members tm ON tm.id = jp.team_member_id\n         WHERE jp.job_id = ?`\n      ).bind(id).all(),\n      db.prepare('SELECT id, content, created_at FROM job_notes WHERE job_id = ? ORDER BY created_at DESC').bind(id).all(),\n    ]);\n\n    return c.json({ ...job, job_providers: providers.results || [], job_notes: notes.results || [] });\n  } catch (error) {\n    console.error('jobs get error', error);\n    return c.json({ error: 'Failed to get job' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await db.prepare(\n      `INSERT INTO jobs\n       (id, customer_id, service_id, territory_id, customer_address_id, scheduled_date, scheduled_start_time,\n        duration_minutes, base_price_cents, total_price_cents, line_items_json, custom_service_name, status, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.customer_id,\n      body.service_id || null,\n      body.territory_id || null,\n      body.customer_address_id || null,\n      body.scheduled_date,\n      body.scheduled_start_time,\n      body.duration_minutes || 60,\n      body.base_price_cents || 0,\n      body.total_price_cents || body.base_price_cents || 0,\n      JSON.stringify([buildServiceBaseLine(String(body.custom_service_name || 'Service'), Number(body.total_price_cents || body.base_price_cents || 0))]),\n      body.custom_service_name || null,\n      body.status || 'created'\n    ).run();\n\n    for (const providerId of asStringArray(body.provider_ids)) {\n      await db.prepare('INSERT INTO job_providers (job_id, team_member_id) VALUES (?, ?)').bind(id, providerId).run();\n    }\n\n    for (const note of asStringArray(body.notes)) {\n      await db.prepare('INSERT INTO job_notes (id, job_id, content, created_at) VALUES (?, ?, ?, datetime(\\'now\\'))').bind(crypto.randomUUID(), id, note).run();\n    }\n\n    if (body.status === 'complete') {\n      await maybeAutoCreateInvoice(db, id);\n    }\n\n    const created = await db.prepare('SELECT * FROM jobs WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('jobs create error', error);\n    return c.json({ error: 'Failed to create job' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    const allowed = [\n      'customer_id',\n      'service_id',\n      'territory_id',\n      'customer_address_id',\n      'scheduled_date',\n      'scheduled_start_time',\n      'duration_minutes',\n      'base_price_cents',\n      'total_price_cents',\n      'custom_service_name',\n      'status',\n      'assigned_at',\n      'started_at',\n      'completed_at',\n      'cancelled_at',\n    ];\n\n    for (const key of allowed) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(body[key]);\n      }\n    }\n\n    if (body.total_price_cents !== undefined || body.custom_service_name !== undefined) {\n      const current = await db.prepare('SELECT total_price_cents, custom_service_name, line_items_json FROM jobs WHERE id = ?').bind(id).first<{\n        total_price_cents: number;\n        custom_service_name: string | null;\n        line_items_json: string | null;\n      }>();\n      if (current) {\n        const customLines = parsePriceLines(current.line_items_json).filter((line) => line.is_custom === 1);\n        const total = body.total_price_cents !== undefined ? Number(body.total_price_cents || 0) : Number(current.total_price_cents || 0);\n        const serviceName = body.custom_service_name !== undefined\n          ? String(body.custom_service_name || 'Service')\n          : (current.custom_service_name || 'Service');\n        fields.push('line_items_json = ?');\n        values.push(JSON.stringify([buildServiceBaseLine(serviceName, total), ...customLines]));\n      }\n    }\n\n    if (fields.length > 0) {\n      fields.push(\"updated_at = datetime('now')\");\n      values.push(id);\n      await db.prepare(`UPDATE jobs SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    }\n\n    if (body.provider_ids !== undefined) {\n      await db.prepare('DELETE FROM job_providers WHERE job_id = ?').bind(id).run();\n      for (const providerId of asStringArray(body.provider_ids)) {\n        await db.prepare('INSERT INTO job_providers (job_id, team_member_id) VALUES (?, ?)').bind(id, providerId).run();\n      }\n    }\n\n    if (body.note !== undefined && typeof body.note === 'string' && body.note.trim()) {\n      await db.prepare('INSERT INTO job_notes (id, job_id, content, created_at) VALUES (?, ?, ?, datetime(\\'now\\'))').bind(crypto.randomUUID(), id, body.note).run();\n    }\n\n    if (body.status === 'complete') {\n      await maybeAutoCreateInvoice(db, id);\n    }\n\n    const updated = await db.prepare('SELECT * FROM jobs WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('jobs patch error', error);\n    return c.json({ error: 'Failed to update job' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const db = c.env.DB;\n    await db.prepare('DELETE FROM job_notes WHERE job_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM job_providers WHERE job_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM invoices WHERE job_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM jobs WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('jobs delete error', error);\n    return c.json({ error: 'Failed to delete job' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const serviceId = c.req.query('service_id');\n    const sql = serviceId\n      ? 'SELECT * FROM service_modifiers WHERE service_id = ? ORDER BY sort_order, name'\n      : 'SELECT * FROM service_modifiers ORDER BY created_at DESC';\n    const result = serviceId\n      ? await c.env.DB.prepare(sql).bind(serviceId).all()\n      : await c.env.DB.prepare(sql).all();\n    return c.json({ modifiers: result.results || [] });\n  } catch (error) {\n    console.error('modifiers list error', error);\n    return c.json({ error: 'Failed to list modifiers' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const modifier = await c.env.DB.prepare('SELECT * FROM service_modifiers WHERE id = ?').bind(c.req.param('id')).first();\n    if (!modifier) return c.json({ error: 'Not found' }, 404);\n    return c.json(modifier);\n  } catch (error) {\n    console.error('modifiers get error', error);\n    return c.json({ error: 'Failed to get modifier' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO service_modifiers\n       (id, service_id, name, description, price_adjustment_cents, duration_adjustment_minutes, is_required, sort_order, created_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`\n    ).bind(\n      id,\n      body.service_id,\n      body.name,\n      body.description || null,\n      body.price_adjustment_cents || 0,\n      body.duration_adjustment_minutes || 0,\n      body.is_required ? 1 : 0,\n      body.sort_order || 0\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM service_modifiers WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('modifiers create error', error);\n    return c.json({ error: 'Failed to create modifier' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    const allowed = [\n      'service_id',\n      'name',\n      'description',\n      'price_adjustment_cents',\n      'duration_adjustment_minutes',\n      'is_required',\n      'sort_order',\n    ];\n    for (const key of allowed) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(key === 'is_required' ? (body[key] ? 1 : 0) : body[key]);\n      }\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE service_modifiers SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM service_modifiers WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('modifiers patch error', error);\n    return c.json({ error: 'Failed to update modifier' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM service_modifiers WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('modifiers delete error', error);\n    return c.json({ error: 'Failed to delete modifier' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const recurring = await c.env.DB.prepare('SELECT * FROM recurring_bookings ORDER BY created_at DESC').all();\n    return c.json({ recurring_bookings: recurring.results || [] });\n  } catch (error) {\n    console.error('recurring list error', error);\n    return c.json({ error: 'Failed to list recurring bookings' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const recurring = await c.env.DB.prepare('SELECT * FROM recurring_bookings WHERE id = ?').bind(c.req.param('id')).first();\n    if (!recurring) return c.json({ error: 'Not found' }, 404);\n    return c.json(recurring);\n  } catch (error) {\n    console.error('recurring get error', error);\n    return c.json({ error: 'Failed to get recurring booking' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO recurring_bookings\n       (id, customer_id, service_id, territory_id, frequency, day_of_week, scheduled_start_time,\n        duration_minutes, base_price_cents, total_price_cents, is_active, next_scheduled_date, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.customer_id,\n      body.service_id,\n      body.territory_id,\n      body.frequency,\n      body.day_of_week ?? null,\n      body.scheduled_start_time || null,\n      body.duration_minutes || 60,\n      body.base_price_cents || 0,\n      body.total_price_cents || body.base_price_cents || 0,\n      body.is_active === false ? 0 : 1,\n      body.next_scheduled_date || null\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM recurring_bookings WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('recurring create error', error);\n    return c.json({ error: 'Failed to create recurring booking' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n\n    const allowed = [\n      'customer_id',\n      'service_id',\n      'territory_id',\n      'frequency',\n      'day_of_week',\n      'scheduled_start_time',\n      'duration_minutes',\n      'base_price_cents',\n      'total_price_cents',\n      'is_active',\n      'next_scheduled_date',\n    ];\n    for (const key of allowed) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(key === 'is_active' ? (body[key] ? 1 : 0) : body[key]);\n      }\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n\n    fields.push(\"updated_at = datetime('now')\");\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE recurring_bookings SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM recurring_bookings WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('recurring patch error', error);\n    return c.json({ error: 'Failed to update recurring booking' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM recurring_bookings WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('recurring delete error', error);\n    return c.json({ error: 'Failed to delete recurring booking' }, 500);\n  }\n});\n\nexport default app;\n", "// src/utils/cookie.ts\nimport { decodeURIComponent_, tryDecode } from \"./url.js\";\nvar algorithm = { name: \"HMAC\", hash: \"SHA-256\" };\nvar getCryptoKey = async (secret) => {\n  const secretBuf = typeof secret === \"string\" ? new TextEncoder().encode(secret) : secret;\n  return await crypto.subtle.importKey(\"raw\", secretBuf, algorithm, false, [\"sign\", \"verify\"]);\n};\nvar makeSignature = async (value, secret) => {\n  const key = await getCryptoKey(secret);\n  const signature = await crypto.subtle.sign(algorithm.name, key, new TextEncoder().encode(value));\n  return btoa(String.fromCharCode(...new Uint8Array(signature)));\n};\nvar verifySignature = async (base64Signature, value, secret) => {\n  try {\n    const signatureBinStr = atob(base64Signature);\n    const signature = new Uint8Array(signatureBinStr.length);\n    for (let i = 0, len = signatureBinStr.length; i < len; i++) {\n      signature[i] = signatureBinStr.charCodeAt(i);\n    }\n    return await crypto.subtle.verify(algorithm, secret, signature, new TextEncoder().encode(value));\n  } catch {\n    return false;\n  }\n};\nvar validCookieNameRegEx = /^[\\w!#$%&'*.^`|~+-]+$/;\nvar validCookieValueRegEx = /^[ !#-:<-[\\]-~]*$/;\nvar parse = (cookie, name) => {\n  if (name && cookie.indexOf(name) === -1) {\n    return {};\n  }\n  const pairs = cookie.trim().split(\";\");\n  const parsedCookie = {};\n  for (let pairStr of pairs) {\n    pairStr = pairStr.trim();\n    const valueStartPos = pairStr.indexOf(\"=\");\n    if (valueStartPos === -1) {\n      continue;\n    }\n    const cookieName = pairStr.substring(0, valueStartPos).trim();\n    if (name && name !== cookieName || !validCookieNameRegEx.test(cookieName)) {\n      continue;\n    }\n    let cookieValue = pairStr.substring(valueStartPos + 1).trim();\n    if (cookieValue.startsWith('\"') && cookieValue.endsWith('\"')) {\n      cookieValue = cookieValue.slice(1, -1);\n    }\n    if (validCookieValueRegEx.test(cookieValue)) {\n      parsedCookie[cookieName] = cookieValue.indexOf(\"%\") !== -1 ? tryDecode(cookieValue, decodeURIComponent_) : cookieValue;\n      if (name) {\n        break;\n      }\n    }\n  }\n  return parsedCookie;\n};\nvar parseSigned = async (cookie, secret, name) => {\n  const parsedCookie = {};\n  const secretKey = await getCryptoKey(secret);\n  for (const [key, value] of Object.entries(parse(cookie, name))) {\n    const signatureStartPos = value.lastIndexOf(\".\");\n    if (signatureStartPos < 1) {\n      continue;\n    }\n    const signedValue = value.substring(0, signatureStartPos);\n    const signature = value.substring(signatureStartPos + 1);\n    if (signature.length !== 44 || !signature.endsWith(\"=\")) {\n      continue;\n    }\n    const isVerified = await verifySignature(signature, signedValue, secretKey);\n    parsedCookie[key] = isVerified ? signedValue : false;\n  }\n  return parsedCookie;\n};\nvar _serialize = (name, value, opt = {}) => {\n  let cookie = `${name}=${value}`;\n  if (name.startsWith(\"__Secure-\") && !opt.secure) {\n    throw new Error(\"__Secure- Cookie must have Secure attributes\");\n  }\n  if (name.startsWith(\"__Host-\")) {\n    if (!opt.secure) {\n      throw new Error(\"__Host- Cookie must have Secure attributes\");\n    }\n    if (opt.path !== \"/\") {\n      throw new Error('__Host- Cookie must have Path attributes with \"/\"');\n    }\n    if (opt.domain) {\n      throw new Error(\"__Host- Cookie must not have Domain attributes\");\n    }\n  }\n  if (opt && typeof opt.maxAge === \"number\" && opt.maxAge >= 0) {\n    if (opt.maxAge > 3456e4) {\n      throw new Error(\n        \"Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.\"\n      );\n    }\n    cookie += `; Max-Age=${opt.maxAge | 0}`;\n  }\n  if (opt.domain && opt.prefix !== \"host\") {\n    cookie += `; Domain=${opt.domain}`;\n  }\n  if (opt.path) {\n    cookie += `; Path=${opt.path}`;\n  }\n  if (opt.expires) {\n    if (opt.expires.getTime() - Date.now() > 3456e7) {\n      throw new Error(\n        \"Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.\"\n      );\n    }\n    cookie += `; Expires=${opt.expires.toUTCString()}`;\n  }\n  if (opt.httpOnly) {\n    cookie += \"; HttpOnly\";\n  }\n  if (opt.secure) {\n    cookie += \"; Secure\";\n  }\n  if (opt.sameSite) {\n    cookie += `; SameSite=${opt.sameSite.charAt(0).toUpperCase() + opt.sameSite.slice(1)}`;\n  }\n  if (opt.priority) {\n    cookie += `; Priority=${opt.priority.charAt(0).toUpperCase() + opt.priority.slice(1)}`;\n  }\n  if (opt.partitioned) {\n    if (!opt.secure) {\n      throw new Error(\"Partitioned Cookie must have Secure attributes\");\n    }\n    cookie += \"; Partitioned\";\n  }\n  return cookie;\n};\nvar serialize = (name, value, opt) => {\n  value = encodeURIComponent(value);\n  return _serialize(name, value, opt);\n};\nvar serializeSigned = async (name, value, secret, opt = {}) => {\n  const signature = await makeSignature(value, secret);\n  value = `${value}.${signature}`;\n  value = encodeURIComponent(value);\n  return _serialize(name, value, opt);\n};\nexport {\n  parse,\n  parseSigned,\n  serialize,\n  serializeSigned\n};\n", "// src/helper/cookie/index.ts\nimport { parse, parseSigned, serialize, serializeSigned } from \"../../utils/cookie.js\";\nvar getCookie = (c, key, prefix) => {\n  const cookie = c.req.raw.headers.get(\"Cookie\");\n  if (typeof key === \"string\") {\n    if (!cookie) {\n      return void 0;\n    }\n    let finalKey = key;\n    if (prefix === \"secure\") {\n      finalKey = \"__Secure-\" + key;\n    } else if (prefix === \"host\") {\n      finalKey = \"__Host-\" + key;\n    }\n    const obj2 = parse(cookie, finalKey);\n    return obj2[finalKey];\n  }\n  if (!cookie) {\n    return {};\n  }\n  const obj = parse(cookie);\n  return obj;\n};\nvar getSignedCookie = async (c, secret, key, prefix) => {\n  const cookie = c.req.raw.headers.get(\"Cookie\");\n  if (typeof key === \"string\") {\n    if (!cookie) {\n      return void 0;\n    }\n    let finalKey = key;\n    if (prefix === \"secure\") {\n      finalKey = \"__Secure-\" + key;\n    } else if (prefix === \"host\") {\n      finalKey = \"__Host-\" + key;\n    }\n    const obj2 = await parseSigned(cookie, secret, finalKey);\n    return obj2[finalKey];\n  }\n  if (!cookie) {\n    return {};\n  }\n  const obj = await parseSigned(cookie, secret);\n  return obj;\n};\nvar generateCookie = (name, value, opt) => {\n  let cookie;\n  if (opt?.prefix === \"secure\") {\n    cookie = serialize(\"__Secure-\" + name, value, { path: \"/\", ...opt, secure: true });\n  } else if (opt?.prefix === \"host\") {\n    cookie = serialize(\"__Host-\" + name, value, {\n      ...opt,\n      path: \"/\",\n      secure: true,\n      domain: void 0\n    });\n  } else {\n    cookie = serialize(name, value, { path: \"/\", ...opt });\n  }\n  return cookie;\n};\nvar setCookie = (c, name, value, opt) => {\n  const cookie = generateCookie(name, value, opt);\n  c.header(\"Set-Cookie\", cookie, { append: true });\n};\nvar generateSignedCookie = async (name, value, secret, opt) => {\n  let cookie;\n  if (opt?.prefix === \"secure\") {\n    cookie = await serializeSigned(\"__Secure-\" + name, value, secret, {\n      path: \"/\",\n      ...opt,\n      secure: true\n    });\n  } else if (opt?.prefix === \"host\") {\n    cookie = await serializeSigned(\"__Host-\" + name, value, secret, {\n      ...opt,\n      path: \"/\",\n      secure: true,\n      domain: void 0\n    });\n  } else {\n    cookie = await serializeSigned(name, value, secret, { path: \"/\", ...opt });\n  }\n  return cookie;\n};\nvar setSignedCookie = async (c, name, value, secret, opt) => {\n  const cookie = await generateSignedCookie(name, value, secret, opt);\n  c.header(\"set-cookie\", cookie, { append: true });\n};\nvar deleteCookie = (c, name, opt) => {\n  const deletedCookie = getCookie(c, name, opt?.prefix);\n  setCookie(c, name, \"\", { ...opt, maxAge: 0 });\n  return deletedCookie;\n};\nexport {\n  deleteCookie,\n  generateCookie,\n  generateSignedCookie,\n  getCookie,\n  getSignedCookie,\n  setCookie,\n  setSignedCookie\n};\n", "// src/utils/buffer.ts\nimport { sha256 } from \"./crypto.js\";\nvar equal = (a, b) => {\n  if (a === b) {\n    return true;\n  }\n  if (a.byteLength !== b.byteLength) {\n    return false;\n  }\n  const va = new DataView(a);\n  const vb = new DataView(b);\n  let i = va.byteLength;\n  while (i--) {\n    if (va.getUint8(i) !== vb.getUint8(i)) {\n      return false;\n    }\n  }\n  return true;\n};\nvar timingSafeEqual = async (a, b, hashFunction) => {\n  if (!hashFunction) {\n    hashFunction = sha256;\n  }\n  const [sa, sb] = await Promise.all([hashFunction(a), hashFunction(b)]);\n  if (!sa || !sb) {\n    return false;\n  }\n  return sa === sb && a === b;\n};\nvar bufferToString = (buffer) => {\n  if (buffer instanceof ArrayBuffer) {\n    const enc = new TextDecoder(\"utf-8\");\n    return enc.decode(buffer);\n  }\n  return buffer;\n};\nvar bufferToFormData = (arrayBuffer, contentType) => {\n  const response = new Response(arrayBuffer, {\n    headers: {\n      \"Content-Type\": contentType\n    }\n  });\n  return response.formData();\n};\nexport {\n  bufferToFormData,\n  bufferToString,\n  equal,\n  timingSafeEqual\n};\n", "// src/validator/validator.ts\nimport { getCookie } from \"../helper/cookie/index.js\";\nimport { HTTPException } from \"../http-exception.js\";\nimport { bufferToFormData } from \"../utils/buffer.js\";\nvar jsonRegex = /^application\\/([a-z-\\.]+\\+)?json(;\\s*[a-zA-Z0-9\\-]+\\=([^;]+))*$/;\nvar multipartRegex = /^multipart\\/form-data(;\\s?boundary=[a-zA-Z0-9'\"()+_,\\-./:=?]+)?$/;\nvar urlencodedRegex = /^application\\/x-www-form-urlencoded(;\\s*[a-zA-Z0-9\\-]+\\=([^;]+))*$/;\nvar validator = (target, validationFunc) => {\n  return async (c, next) => {\n    let value = {};\n    const contentType = c.req.header(\"Content-Type\");\n    switch (target) {\n      case \"json\":\n        if (!contentType || !jsonRegex.test(contentType)) {\n          break;\n        }\n        try {\n          value = await c.req.json();\n        } catch {\n          const message = \"Malformed JSON in request body\";\n          throw new HTTPException(400, { message });\n        }\n        break;\n      case \"form\": {\n        if (!contentType || !(multipartRegex.test(contentType) || urlencodedRegex.test(contentType))) {\n          break;\n        }\n        let formData;\n        if (c.req.bodyCache.formData) {\n          formData = await c.req.bodyCache.formData;\n        } else {\n          try {\n            const arrayBuffer = await c.req.arrayBuffer();\n            formData = await bufferToFormData(arrayBuffer, contentType);\n            c.req.bodyCache.formData = formData;\n          } catch (e) {\n            let message = \"Malformed FormData request.\";\n            message += e instanceof Error ? ` ${e.message}` : ` ${String(e)}`;\n            throw new HTTPException(400, { message });\n          }\n        }\n        const form = {};\n        formData.forEach((value2, key) => {\n          if (key.endsWith(\"[]\")) {\n            ;\n            (form[key] ??= []).push(value2);\n          } else if (Array.isArray(form[key])) {\n            ;\n            form[key].push(value2);\n          } else if (key in form) {\n            form[key] = [form[key], value2];\n          } else {\n            form[key] = value2;\n          }\n        });\n        value = form;\n        break;\n      }\n      case \"query\":\n        value = Object.fromEntries(\n          Object.entries(c.req.queries()).map(([k, v]) => {\n            return v.length === 1 ? [k, v[0]] : [k, v];\n          })\n        );\n        break;\n      case \"param\":\n        value = c.req.param();\n        break;\n      case \"header\":\n        value = c.req.header();\n        break;\n      case \"cookie\":\n        value = getCookie(c);\n        break;\n    }\n    const res = await validationFunc(value, c);\n    if (res instanceof Response) {\n      return res;\n    }\n    c.req.addValidatedData(target, res);\n    return await next();\n  };\n};\nexport {\n  validator\n};\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport type { Context, Env, Input, MiddlewareHandler, TypedResponse, ValidationTargets } from 'hono'\nimport { validator } from 'hono/validator'\nimport type * as v3 from 'zod/v3'\nimport type { ZodSafeParseResult as v4ZodSafeParseResult } from 'zod/v4'\nimport type * as v4 from 'zod/v4/core'\nimport type { InferInput } from './utils'\n\ntype ZodSchema = v3.ZodType | v4.$ZodType\ntype ZodError<T extends ZodSchema> = T extends v4.$ZodType\n  ? v4.$ZodError<v4.output<T>>\n  : v3.ZodError\ntype ZodSafeParseResult<T, T2, T3 extends ZodSchema> = T3 extends v4.$ZodType\n  ? v4ZodSafeParseResult<T>\n  : v3.SafeParseReturnType<T, T2>\ntype zInput<T> = T extends v3.ZodType ? v3.input<T> : T extends v4.$ZodType ? v4.input<T> : never\ntype zOutput<T> = T extends v3.ZodType ? v3.output<T> : T extends v4.$ZodType ? v4.output<T> : never\ntype zInfer<T> = T extends v3.ZodType ? v3.infer<T> : T extends v4.$ZodType ? v4.infer<T> : never\n\nexport type Hook<\n  T,\n  E extends Env,\n  P extends string,\n  Target extends keyof ValidationTargets = keyof ValidationTargets,\n  O = {},\n  Schema extends ZodSchema = any,\n> = (\n  result: ({ success: true; data: T } | { success: false; error: ZodError<Schema>; data: T }) & {\n    target: Target\n  },\n  c: Context<E, P>\n) => Response | void | TypedResponse<O> | Promise<Response | void | TypedResponse<O>>\n\ntype HasUndefined<T> = undefined extends T ? true : false\n\ntype ExtractValidationResponse<VF> = VF extends (value: any, c: any) => infer R\n  ? R extends Promise<infer PR>\n    ? PR extends TypedResponse<infer T, infer S, infer F>\n      ? TypedResponse<T, S, F>\n      : PR extends Response\n        ? PR\n        : PR extends undefined\n          ? never\n          : never\n    : R extends TypedResponse<infer T, infer S, infer F>\n      ? TypedResponse<T, S, F>\n      : R extends Response\n        ? R\n        : R extends undefined\n          ? never\n          : never\n  : never\n\ntype DefaultInput<Target extends keyof ValidationTargets, In, Out> = {\n  in: HasUndefined<In> extends true\n    ? {\n        [K in Target]?: [In] extends [ValidationTargets[K]] ? In : InferInput<In, K>\n      }\n    : {\n        [K in Target]: [In] extends [ValidationTargets[K]] ? In : InferInput<In, K>\n      }\n  out: { [K in Target]: Out }\n}\n\n// without hook and options\nfunction zValidatorFunction<\n  T extends ZodSchema,\n  Target extends keyof ValidationTargets,\n  E extends Env,\n  P extends string,\n  In = zInput<T>,\n  Out = zOutput<T>,\n  I extends Input = DefaultInput<Target, In, Out>,\n  V extends I = I,\n>(target: Target, schema: T): MiddlewareHandler<E, P, V>\n\n// with hook and options\nfunction zValidatorFunction<\n  T extends ZodSchema,\n  Target extends keyof ValidationTargets,\n  E extends Env,\n  P extends string,\n  HookFn extends Hook<InferredValue, E, P, Target, {}, T>,\n  In = zInput<T>,\n  Out = zOutput<T>,\n  I extends Input = DefaultInput<Target, In, Out>,\n  V extends I = I,\n  InferredValue = zInfer<T>,\n>(\n  target: Target,\n  schema: T,\n  hook?: HookFn,\n  options?: {\n    validationFunction: (\n      schema: T,\n      value: ValidationTargets[Target]\n    ) => ZodSafeParseResult<any, any, T> | Promise<ZodSafeParseResult<any, any, T>>\n  }\n): MiddlewareHandler<E, P, V, ExtractValidationResponse<HookFn>>\n\n// implementation\nfunction zValidatorFunction<\n  T extends ZodSchema,\n  Target extends keyof ValidationTargets,\n  E extends Env,\n  P extends string,\n  HookFn extends Hook<InferredValue, E, P, Target, {}, T>,\n  In = zInput<T>,\n  Out = zOutput<T>,\n  I extends Input = DefaultInput<Target, In, Out>,\n  V extends I = I,\n  InferredValue = zInfer<T>,\n>(\n  target: Target,\n  schema: T,\n  hook?: HookFn,\n  options?: {\n    validationFunction: (\n      schema: T,\n      value: ValidationTargets[Target]\n    ) => ZodSafeParseResult<any, any, T> | Promise<ZodSafeParseResult<any, any, T>>\n  }\n): MiddlewareHandler<E, P, V> | MiddlewareHandler<E, P, V, ExtractValidationResponse<HookFn>> {\n  // @ts-expect-error not typed well\n  return validator(target, async (value: ValidationTargets[Target], c) => {\n    let validatorValue = value\n\n    // in case where our `target` === `header`, Hono parses all of the headers into lowercase.\n    // this might not match the Zod schema, so we want to make sure that we account for that when parsing the schema.\n    if ((target === 'header' && '_def' in schema) || (target === 'header' && '_zod' in schema)) {\n      // create an object that maps lowercase schema keys to lowercase\n      // @ts-expect-error the schema is a Zod Schema\n      const schemaKeys = Object.keys('in' in schema ? schema.in.shape : schema.shape)\n      const caseInsensitiveKeymap = Object.fromEntries(\n        schemaKeys.map((key) => [key.toLowerCase(), key])\n      )\n\n      validatorValue = Object.fromEntries(\n        Object.entries(value).map(([key, value]) => [caseInsensitiveKeymap[key] || key, value])\n      )\n    }\n\n    const result =\n      options && options.validationFunction\n        ? await options.validationFunction(schema, validatorValue)\n        : // @ts-expect-error z4.$ZodType has safeParseAsync\n          await schema.safeParseAsync(validatorValue)\n\n    if (hook) {\n      const hookResult = await hook({ data: validatorValue, ...result, target }, c)\n      if (hookResult) {\n        if (hookResult instanceof Response) {\n          return hookResult\n        }\n\n        if ('response' in hookResult) {\n          return hookResult.response\n        }\n      }\n    }\n\n    if (!result.success) {\n      return c.json(result, 400)\n    }\n\n    return result.data as zInfer<T>\n  })\n}\n\nexport const zValidator: typeof zValidatorFunction = zValidatorFunction\n", "export * from \"./errors.js\";\nexport * from \"./helpers/parseUtil.js\";\nexport * from \"./helpers/typeAliases.js\";\nexport * from \"./helpers/util.js\";\nexport * from \"./types.js\";\nexport * from \"./ZodError.js\";\n", "export var util;\n(function (util) {\n    util.assertEqual = (_) => { };\n    function assertIs(_arg) { }\n    util.assertIs = assertIs;\n    function assertNever(_x) {\n        throw new Error();\n    }\n    util.assertNever = assertNever;\n    util.arrayToEnum = (items) => {\n        const obj = {};\n        for (const item of items) {\n            obj[item] = item;\n        }\n        return obj;\n    };\n    util.getValidEnumValues = (obj) => {\n        const validKeys = util.objectKeys(obj).filter((k) => typeof obj[obj[k]] !== \"number\");\n        const filtered = {};\n        for (const k of validKeys) {\n            filtered[k] = obj[k];\n        }\n        return util.objectValues(filtered);\n    };\n    util.objectValues = (obj) => {\n        return util.objectKeys(obj).map(function (e) {\n            return obj[e];\n        });\n    };\n    util.objectKeys = typeof Object.keys === \"function\" // eslint-disable-line ban/ban\n        ? (obj) => Object.keys(obj) // eslint-disable-line ban/ban\n        : (object) => {\n            const keys = [];\n            for (const key in object) {\n                if (Object.prototype.hasOwnProperty.call(object, key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n    util.find = (arr, checker) => {\n        for (const item of arr) {\n            if (checker(item))\n                return item;\n        }\n        return undefined;\n    };\n    util.isInteger = typeof Number.isInteger === \"function\"\n        ? (val) => Number.isInteger(val) // eslint-disable-line ban/ban\n        : (val) => typeof val === \"number\" && Number.isFinite(val) && Math.floor(val) === val;\n    function joinValues(array, separator = \" | \") {\n        return array.map((val) => (typeof val === \"string\" ? `'${val}'` : val)).join(separator);\n    }\n    util.joinValues = joinValues;\n    util.jsonStringifyReplacer = (_, value) => {\n        if (typeof value === \"bigint\") {\n            return value.toString();\n        }\n        return value;\n    };\n})(util || (util = {}));\nexport var objectUtil;\n(function (objectUtil) {\n    objectUtil.mergeShapes = (first, second) => {\n        return {\n            ...first,\n            ...second, // second overwrites first\n        };\n    };\n})(objectUtil || (objectUtil = {}));\nexport const ZodParsedType = util.arrayToEnum([\n    \"string\",\n    \"nan\",\n    \"number\",\n    \"integer\",\n    \"float\",\n    \"boolean\",\n    \"date\",\n    \"bigint\",\n    \"symbol\",\n    \"function\",\n    \"undefined\",\n    \"null\",\n    \"array\",\n    \"object\",\n    \"unknown\",\n    \"promise\",\n    \"void\",\n    \"never\",\n    \"map\",\n    \"set\",\n]);\nexport const getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return ZodParsedType.undefined;\n        case \"string\":\n            return ZodParsedType.string;\n        case \"number\":\n            return Number.isNaN(data) ? ZodParsedType.nan : ZodParsedType.number;\n        case \"boolean\":\n            return ZodParsedType.boolean;\n        case \"function\":\n            return ZodParsedType.function;\n        case \"bigint\":\n            return ZodParsedType.bigint;\n        case \"symbol\":\n            return ZodParsedType.symbol;\n        case \"object\":\n            if (Array.isArray(data)) {\n                return ZodParsedType.array;\n            }\n            if (data === null) {\n                return ZodParsedType.null;\n            }\n            if (data.then && typeof data.then === \"function\" && data.catch && typeof data.catch === \"function\") {\n                return ZodParsedType.promise;\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return ZodParsedType.map;\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return ZodParsedType.set;\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return ZodParsedType.date;\n            }\n            return ZodParsedType.object;\n        default:\n            return ZodParsedType.unknown;\n    }\n};\n", "import { util } from \"./helpers/util.js\";\nexport const ZodIssueCode = util.arrayToEnum([\n    \"invalid_type\",\n    \"invalid_literal\",\n    \"custom\",\n    \"invalid_union\",\n    \"invalid_union_discriminator\",\n    \"invalid_enum_value\",\n    \"unrecognized_keys\",\n    \"invalid_arguments\",\n    \"invalid_return_type\",\n    \"invalid_date\",\n    \"invalid_string\",\n    \"too_small\",\n    \"too_big\",\n    \"invalid_intersection_types\",\n    \"not_multiple_of\",\n    \"not_finite\",\n]);\nexport const quotelessJson = (obj) => {\n    const json = JSON.stringify(obj, null, 2);\n    return json.replace(/\"([^\"]+)\":/g, \"$1:\");\n};\nexport class ZodError extends Error {\n    get errors() {\n        return this.issues;\n    }\n    constructor(issues) {\n        super();\n        this.issues = [];\n        this.addIssue = (sub) => {\n            this.issues = [...this.issues, sub];\n        };\n        this.addIssues = (subs = []) => {\n            this.issues = [...this.issues, ...subs];\n        };\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            // eslint-disable-next-line ban/ban\n            Object.setPrototypeOf(this, actualProto);\n        }\n        else {\n            this.__proto__ = actualProto;\n        }\n        this.name = \"ZodError\";\n        this.issues = issues;\n    }\n    format(_mapper) {\n        const mapper = _mapper ||\n            function (issue) {\n                return issue.message;\n            };\n        const fieldErrors = { _errors: [] };\n        const processError = (error) => {\n            for (const issue of error.issues) {\n                if (issue.code === \"invalid_union\") {\n                    issue.unionErrors.map(processError);\n                }\n                else if (issue.code === \"invalid_return_type\") {\n                    processError(issue.returnTypeError);\n                }\n                else if (issue.code === \"invalid_arguments\") {\n                    processError(issue.argumentsError);\n                }\n                else if (issue.path.length === 0) {\n                    fieldErrors._errors.push(mapper(issue));\n                }\n                else {\n                    let curr = fieldErrors;\n                    let i = 0;\n                    while (i < issue.path.length) {\n                        const el = issue.path[i];\n                        const terminal = i === issue.path.length - 1;\n                        if (!terminal) {\n                            curr[el] = curr[el] || { _errors: [] };\n                            // if (typeof el === \"string\") {\n                            //   curr[el] = curr[el] || { _errors: [] };\n                            // } else if (typeof el === \"number\") {\n                            //   const errorArray: any = [];\n                            //   errorArray._errors = [];\n                            //   curr[el] = curr[el] || errorArray;\n                            // }\n                        }\n                        else {\n                            curr[el] = curr[el] || { _errors: [] };\n                            curr[el]._errors.push(mapper(issue));\n                        }\n                        curr = curr[el];\n                        i++;\n                    }\n                }\n            }\n        };\n        processError(this);\n        return fieldErrors;\n    }\n    static assert(value) {\n        if (!(value instanceof ZodError)) {\n            throw new Error(`Not a ZodError: ${value}`);\n        }\n    }\n    toString() {\n        return this.message;\n    }\n    get message() {\n        return JSON.stringify(this.issues, util.jsonStringifyReplacer, 2);\n    }\n    get isEmpty() {\n        return this.issues.length === 0;\n    }\n    flatten(mapper = (issue) => issue.message) {\n        const fieldErrors = {};\n        const formErrors = [];\n        for (const sub of this.issues) {\n            if (sub.path.length > 0) {\n                const firstEl = sub.path[0];\n                fieldErrors[firstEl] = fieldErrors[firstEl] || [];\n                fieldErrors[firstEl].push(mapper(sub));\n            }\n            else {\n                formErrors.push(mapper(sub));\n            }\n        }\n        return { formErrors, fieldErrors };\n    }\n    get formErrors() {\n        return this.flatten();\n    }\n}\nZodError.create = (issues) => {\n    const error = new ZodError(issues);\n    return error;\n};\n", "import { ZodIssueCode } from \"../ZodError.js\";\nimport { util, ZodParsedType } from \"../helpers/util.js\";\nconst errorMap = (issue, _ctx) => {\n    let message;\n    switch (issue.code) {\n        case ZodIssueCode.invalid_type:\n            if (issue.received === ZodParsedType.undefined) {\n                message = \"Required\";\n            }\n            else {\n                message = `Expected ${issue.expected}, received ${issue.received}`;\n            }\n            break;\n        case ZodIssueCode.invalid_literal:\n            message = `Invalid literal value, expected ${JSON.stringify(issue.expected, util.jsonStringifyReplacer)}`;\n            break;\n        case ZodIssueCode.unrecognized_keys:\n            message = `Unrecognized key(s) in object: ${util.joinValues(issue.keys, \", \")}`;\n            break;\n        case ZodIssueCode.invalid_union:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_union_discriminator:\n            message = `Invalid discriminator value. Expected ${util.joinValues(issue.options)}`;\n            break;\n        case ZodIssueCode.invalid_enum_value:\n            message = `Invalid enum value. Expected ${util.joinValues(issue.options)}, received '${issue.received}'`;\n            break;\n        case ZodIssueCode.invalid_arguments:\n            message = `Invalid function arguments`;\n            break;\n        case ZodIssueCode.invalid_return_type:\n            message = `Invalid function return type`;\n            break;\n        case ZodIssueCode.invalid_date:\n            message = `Invalid date`;\n            break;\n        case ZodIssueCode.invalid_string:\n            if (typeof issue.validation === \"object\") {\n                if (\"includes\" in issue.validation) {\n                    message = `Invalid input: must include \"${issue.validation.includes}\"`;\n                    if (typeof issue.validation.position === \"number\") {\n                        message = `${message} at one or more positions greater than or equal to ${issue.validation.position}`;\n                    }\n                }\n                else if (\"startsWith\" in issue.validation) {\n                    message = `Invalid input: must start with \"${issue.validation.startsWith}\"`;\n                }\n                else if (\"endsWith\" in issue.validation) {\n                    message = `Invalid input: must end with \"${issue.validation.endsWith}\"`;\n                }\n                else {\n                    util.assertNever(issue.validation);\n                }\n            }\n            else if (issue.validation !== \"regex\") {\n                message = `Invalid ${issue.validation}`;\n            }\n            else {\n                message = \"Invalid\";\n            }\n            break;\n        case ZodIssueCode.too_small:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `more than`} ${issue.minimum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `over`} ${issue.minimum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"bigint\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${new Date(Number(issue.minimum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.too_big:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `less than`} ${issue.maximum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `under`} ${issue.maximum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"bigint\")\n                message = `BigInt must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly` : issue.inclusive ? `smaller than or equal to` : `smaller than`} ${new Date(Number(issue.maximum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.custom:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_intersection_types:\n            message = `Intersection results could not be merged`;\n            break;\n        case ZodIssueCode.not_multiple_of:\n            message = `Number must be a multiple of ${issue.multipleOf}`;\n            break;\n        case ZodIssueCode.not_finite:\n            message = \"Number must be finite\";\n            break;\n        default:\n            message = _ctx.defaultError;\n            util.assertNever(issue);\n    }\n    return { message };\n};\nexport default errorMap;\n", "import defaultErrorMap from \"./locales/en.js\";\nlet overrideErrorMap = defaultErrorMap;\nexport { defaultErrorMap };\nexport function setErrorMap(map) {\n    overrideErrorMap = map;\n}\nexport function getErrorMap() {\n    return overrideErrorMap;\n}\n", "import { getErrorMap } from \"../errors.js\";\nimport defaultErrorMap from \"../locales/en.js\";\nexport const makeIssue = (params) => {\n    const { data, path, errorMaps, issueData } = params;\n    const fullPath = [...path, ...(issueData.path || [])];\n    const fullIssue = {\n        ...issueData,\n        path: fullPath,\n    };\n    if (issueData.message !== undefined) {\n        return {\n            ...issueData,\n            path: fullPath,\n            message: issueData.message,\n        };\n    }\n    let errorMessage = \"\";\n    const maps = errorMaps\n        .filter((m) => !!m)\n        .slice()\n        .reverse();\n    for (const map of maps) {\n        errorMessage = map(fullIssue, { data, defaultError: errorMessage }).message;\n    }\n    return {\n        ...issueData,\n        path: fullPath,\n        message: errorMessage,\n    };\n};\nexport const EMPTY_PATH = [];\nexport function addIssueToContext(ctx, issueData) {\n    const overrideMap = getErrorMap();\n    const issue = makeIssue({\n        issueData: issueData,\n        data: ctx.data,\n        path: ctx.path,\n        errorMaps: [\n            ctx.common.contextualErrorMap, // contextual error map is first priority\n            ctx.schemaErrorMap, // then schema-bound map if available\n            overrideMap, // then global override map\n            overrideMap === defaultErrorMap ? undefined : defaultErrorMap, // then global default map\n        ].filter((x) => !!x),\n    });\n    ctx.common.issues.push(issue);\n}\nexport class ParseStatus {\n    constructor() {\n        this.value = \"valid\";\n    }\n    dirty() {\n        if (this.value === \"valid\")\n            this.value = \"dirty\";\n    }\n    abort() {\n        if (this.value !== \"aborted\")\n            this.value = \"aborted\";\n    }\n    static mergeArray(status, results) {\n        const arrayValue = [];\n        for (const s of results) {\n            if (s.status === \"aborted\")\n                return INVALID;\n            if (s.status === \"dirty\")\n                status.dirty();\n            arrayValue.push(s.value);\n        }\n        return { status: status.value, value: arrayValue };\n    }\n    static async mergeObjectAsync(status, pairs) {\n        const syncPairs = [];\n        for (const pair of pairs) {\n            const key = await pair.key;\n            const value = await pair.value;\n            syncPairs.push({\n                key,\n                value,\n            });\n        }\n        return ParseStatus.mergeObjectSync(status, syncPairs);\n    }\n    static mergeObjectSync(status, pairs) {\n        const finalObject = {};\n        for (const pair of pairs) {\n            const { key, value } = pair;\n            if (key.status === \"aborted\")\n                return INVALID;\n            if (value.status === \"aborted\")\n                return INVALID;\n            if (key.status === \"dirty\")\n                status.dirty();\n            if (value.status === \"dirty\")\n                status.dirty();\n            if (key.value !== \"__proto__\" && (typeof value.value !== \"undefined\" || pair.alwaysSet)) {\n                finalObject[key.value] = value.value;\n            }\n        }\n        return { status: status.value, value: finalObject };\n    }\n}\nexport const INVALID = Object.freeze({\n    status: \"aborted\",\n});\nexport const DIRTY = (value) => ({ status: \"dirty\", value });\nexport const OK = (value) => ({ status: \"valid\", value });\nexport const isAborted = (x) => x.status === \"aborted\";\nexport const isDirty = (x) => x.status === \"dirty\";\nexport const isValid = (x) => x.status === \"valid\";\nexport const isAsync = (x) => typeof Promise !== \"undefined\" && x instanceof Promise;\n", "export var errorUtil;\n(function (errorUtil) {\n    errorUtil.errToObj = (message) => typeof message === \"string\" ? { message } : message || {};\n    // biome-ignore lint:\n    errorUtil.toString = (message) => typeof message === \"string\" ? message : message?.message;\n})(errorUtil || (errorUtil = {}));\n", "import { ZodError, ZodIssueCode, } from \"./ZodError.js\";\nimport { defaultErrorMap, getErrorMap } from \"./errors.js\";\nimport { errorUtil } from \"./helpers/errorUtil.js\";\nimport { DIRTY, INVALID, OK, ParseStatus, addIssueToContext, isAborted, isAsync, isDirty, isValid, makeIssue, } from \"./helpers/parseUtil.js\";\nimport { util, ZodParsedType, getParsedType } from \"./helpers/util.js\";\nclass ParseInputLazyPath {\n    constructor(parent, value, path, key) {\n        this._cachedPath = [];\n        this.parent = parent;\n        this.data = value;\n        this._path = path;\n        this._key = key;\n    }\n    get path() {\n        if (!this._cachedPath.length) {\n            if (Array.isArray(this._key)) {\n                this._cachedPath.push(...this._path, ...this._key);\n            }\n            else {\n                this._cachedPath.push(...this._path, this._key);\n            }\n        }\n        return this._cachedPath;\n    }\n}\nconst handleResult = (ctx, result) => {\n    if (isValid(result)) {\n        return { success: true, data: result.value };\n    }\n    else {\n        if (!ctx.common.issues.length) {\n            throw new Error(\"Validation failed but no issues detected.\");\n        }\n        return {\n            success: false,\n            get error() {\n                if (this._error)\n                    return this._error;\n                const error = new ZodError(ctx.common.issues);\n                this._error = error;\n                return this._error;\n            },\n        };\n    }\n};\nfunction processCreateParams(params) {\n    if (!params)\n        return {};\n    const { errorMap, invalid_type_error, required_error, description } = params;\n    if (errorMap && (invalid_type_error || required_error)) {\n        throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);\n    }\n    if (errorMap)\n        return { errorMap: errorMap, description };\n    const customMap = (iss, ctx) => {\n        const { message } = params;\n        if (iss.code === \"invalid_enum_value\") {\n            return { message: message ?? ctx.defaultError };\n        }\n        if (typeof ctx.data === \"undefined\") {\n            return { message: message ?? required_error ?? ctx.defaultError };\n        }\n        if (iss.code !== \"invalid_type\")\n            return { message: ctx.defaultError };\n        return { message: message ?? invalid_type_error ?? ctx.defaultError };\n    };\n    return { errorMap: customMap, description };\n}\nexport class ZodType {\n    get description() {\n        return this._def.description;\n    }\n    _getType(input) {\n        return getParsedType(input.data);\n    }\n    _getOrReturnCtx(input, ctx) {\n        return (ctx || {\n            common: input.parent.common,\n            data: input.data,\n            parsedType: getParsedType(input.data),\n            schemaErrorMap: this._def.errorMap,\n            path: input.path,\n            parent: input.parent,\n        });\n    }\n    _processInputParams(input) {\n        return {\n            status: new ParseStatus(),\n            ctx: {\n                common: input.parent.common,\n                data: input.data,\n                parsedType: getParsedType(input.data),\n                schemaErrorMap: this._def.errorMap,\n                path: input.path,\n                parent: input.parent,\n            },\n        };\n    }\n    _parseSync(input) {\n        const result = this._parse(input);\n        if (isAsync(result)) {\n            throw new Error(\"Synchronous parse encountered promise.\");\n        }\n        return result;\n    }\n    _parseAsync(input) {\n        const result = this._parse(input);\n        return Promise.resolve(result);\n    }\n    parse(data, params) {\n        const result = this.safeParse(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    safeParse(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: params?.async ?? false,\n                contextualErrorMap: params?.errorMap,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const result = this._parseSync({ data, path: ctx.path, parent: ctx });\n        return handleResult(ctx, result);\n    }\n    \"~validate\"(data) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: !!this[\"~standard\"].async,\n            },\n            path: [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        if (!this[\"~standard\"].async) {\n            try {\n                const result = this._parseSync({ data, path: [], parent: ctx });\n                return isValid(result)\n                    ? {\n                        value: result.value,\n                    }\n                    : {\n                        issues: ctx.common.issues,\n                    };\n            }\n            catch (err) {\n                if (err?.message?.toLowerCase()?.includes(\"encountered\")) {\n                    this[\"~standard\"].async = true;\n                }\n                ctx.common = {\n                    issues: [],\n                    async: true,\n                };\n            }\n        }\n        return this._parseAsync({ data, path: [], parent: ctx }).then((result) => isValid(result)\n            ? {\n                value: result.value,\n            }\n            : {\n                issues: ctx.common.issues,\n            });\n    }\n    async parseAsync(data, params) {\n        const result = await this.safeParseAsync(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    async safeParseAsync(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                contextualErrorMap: params?.errorMap,\n                async: true,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const maybeAsyncResult = this._parse({ data, path: ctx.path, parent: ctx });\n        const result = await (isAsync(maybeAsyncResult) ? maybeAsyncResult : Promise.resolve(maybeAsyncResult));\n        return handleResult(ctx, result);\n    }\n    refine(check, message) {\n        const getIssueProperties = (val) => {\n            if (typeof message === \"string\" || typeof message === \"undefined\") {\n                return { message };\n            }\n            else if (typeof message === \"function\") {\n                return message(val);\n            }\n            else {\n                return message;\n            }\n        };\n        return this._refinement((val, ctx) => {\n            const result = check(val);\n            const setError = () => ctx.addIssue({\n                code: ZodIssueCode.custom,\n                ...getIssueProperties(val),\n            });\n            if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n                return result.then((data) => {\n                    if (!data) {\n                        setError();\n                        return false;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n            }\n            if (!result) {\n                setError();\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    refinement(check, refinementData) {\n        return this._refinement((val, ctx) => {\n            if (!check(val)) {\n                ctx.addIssue(typeof refinementData === \"function\" ? refinementData(val, ctx) : refinementData);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    _refinement(refinement) {\n        return new ZodEffects({\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"refinement\", refinement },\n        });\n    }\n    superRefine(refinement) {\n        return this._refinement(refinement);\n    }\n    constructor(def) {\n        /** Alias of safeParseAsync */\n        this.spa = this.safeParseAsync;\n        this._def = def;\n        this.parse = this.parse.bind(this);\n        this.safeParse = this.safeParse.bind(this);\n        this.parseAsync = this.parseAsync.bind(this);\n        this.safeParseAsync = this.safeParseAsync.bind(this);\n        this.spa = this.spa.bind(this);\n        this.refine = this.refine.bind(this);\n        this.refinement = this.refinement.bind(this);\n        this.superRefine = this.superRefine.bind(this);\n        this.optional = this.optional.bind(this);\n        this.nullable = this.nullable.bind(this);\n        this.nullish = this.nullish.bind(this);\n        this.array = this.array.bind(this);\n        this.promise = this.promise.bind(this);\n        this.or = this.or.bind(this);\n        this.and = this.and.bind(this);\n        this.transform = this.transform.bind(this);\n        this.brand = this.brand.bind(this);\n        this.default = this.default.bind(this);\n        this.catch = this.catch.bind(this);\n        this.describe = this.describe.bind(this);\n        this.pipe = this.pipe.bind(this);\n        this.readonly = this.readonly.bind(this);\n        this.isNullable = this.isNullable.bind(this);\n        this.isOptional = this.isOptional.bind(this);\n        this[\"~standard\"] = {\n            version: 1,\n            vendor: \"zod\",\n            validate: (data) => this[\"~validate\"](data),\n        };\n    }\n    optional() {\n        return ZodOptional.create(this, this._def);\n    }\n    nullable() {\n        return ZodNullable.create(this, this._def);\n    }\n    nullish() {\n        return this.nullable().optional();\n    }\n    array() {\n        return ZodArray.create(this);\n    }\n    promise() {\n        return ZodPromise.create(this, this._def);\n    }\n    or(option) {\n        return ZodUnion.create([this, option], this._def);\n    }\n    and(incoming) {\n        return ZodIntersection.create(this, incoming, this._def);\n    }\n    transform(transform) {\n        return new ZodEffects({\n            ...processCreateParams(this._def),\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"transform\", transform },\n        });\n    }\n    default(def) {\n        const defaultValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodDefault({\n            ...processCreateParams(this._def),\n            innerType: this,\n            defaultValue: defaultValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodDefault,\n        });\n    }\n    brand() {\n        return new ZodBranded({\n            typeName: ZodFirstPartyTypeKind.ZodBranded,\n            type: this,\n            ...processCreateParams(this._def),\n        });\n    }\n    catch(def) {\n        const catchValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodCatch({\n            ...processCreateParams(this._def),\n            innerType: this,\n            catchValue: catchValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodCatch,\n        });\n    }\n    describe(description) {\n        const This = this.constructor;\n        return new This({\n            ...this._def,\n            description,\n        });\n    }\n    pipe(target) {\n        return ZodPipeline.create(this, target);\n    }\n    readonly() {\n        return ZodReadonly.create(this);\n    }\n    isOptional() {\n        return this.safeParse(undefined).success;\n    }\n    isNullable() {\n        return this.safeParse(null).success;\n    }\n}\nconst cuidRegex = /^c[^\\s-]{8,}$/i;\nconst cuid2Regex = /^[0-9a-z]+$/;\nconst ulidRegex = /^[0-9A-HJKMNP-TV-Z]{26}$/i;\n// const uuidRegex =\n//   /^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i;\nconst uuidRegex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i;\nconst nanoidRegex = /^[a-z0-9_-]{21}$/i;\nconst jwtRegex = /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/;\nconst durationRegex = /^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/;\n// from https://stackoverflow.com/a/46181/1550155\n// old version: too slow, didn't support unicode\n// const emailRegex = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n//old email regex\n// const emailRegex = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@((?!-)([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{1,})[^-<>()[\\].,;:\\s@\"]$/i;\n// eslint-disable-next-line\n// const emailRegex =\n//   /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$/;\n// const emailRegex =\n//   /^[a-zA-Z0-9\\.\\!\\#\\$\\%\\&\\'\\*\\+\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// const emailRegex =\n//   /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\nconst emailRegex = /^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;\n// const emailRegex =\n//   /^[a-z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-z0-9-]+(?:\\.[a-z0-9\\-]+)*$/i;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emojiRegex = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nlet emojiRegex;\n// faster, simpler, safer\nconst ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;\nconst ipv4CidrRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/;\n// const ipv6Regex =\n// /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;\nconst ipv6Regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;\nconst ipv6CidrRegex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/;\n// https://stackoverflow.com/questions/7860392/determine-if-string-is-in-base64-using-javascript\nconst base64Regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;\n// https://base64.guru/standards/base64url\nconst base64urlRegex = /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/;\n// simple\n// const dateRegexSource = `\\\\d{4}-\\\\d{2}-\\\\d{2}`;\n// no leap year validation\n// const dateRegexSource = `\\\\d{4}-((0[13578]|10|12)-31|(0[13-9]|1[0-2])-30|(0[1-9]|1[0-2])-(0[1-9]|1\\\\d|2\\\\d))`;\n// with leap year validation\nconst dateRegexSource = `((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))`;\nconst dateRegex = new RegExp(`^${dateRegexSource}$`);\nfunction timeRegexSource(args) {\n    let secondsRegexSource = `[0-5]\\\\d`;\n    if (args.precision) {\n        secondsRegexSource = `${secondsRegexSource}\\\\.\\\\d{${args.precision}}`;\n    }\n    else if (args.precision == null) {\n        secondsRegexSource = `${secondsRegexSource}(\\\\.\\\\d+)?`;\n    }\n    const secondsQuantifier = args.precision ? \"+\" : \"?\"; // require seconds if precision is nonzero\n    return `([01]\\\\d|2[0-3]):[0-5]\\\\d(:${secondsRegexSource})${secondsQuantifier}`;\n}\nfunction timeRegex(args) {\n    return new RegExp(`^${timeRegexSource(args)}$`);\n}\n// Adapted from https://stackoverflow.com/a/3143231\nexport function datetimeRegex(args) {\n    let regex = `${dateRegexSource}T${timeRegexSource(args)}`;\n    const opts = [];\n    opts.push(args.local ? `Z?` : `Z`);\n    if (args.offset)\n        opts.push(`([+-]\\\\d{2}:?\\\\d{2})`);\n    regex = `${regex}(${opts.join(\"|\")})`;\n    return new RegExp(`^${regex}$`);\n}\nfunction isValidIP(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4Regex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6Regex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nfunction isValidJWT(jwt, alg) {\n    if (!jwtRegex.test(jwt))\n        return false;\n    try {\n        const [header] = jwt.split(\".\");\n        if (!header)\n            return false;\n        // Convert base64url to base64\n        const base64 = header\n            .replace(/-/g, \"+\")\n            .replace(/_/g, \"/\")\n            .padEnd(header.length + ((4 - (header.length % 4)) % 4), \"=\");\n        const decoded = JSON.parse(atob(base64));\n        if (typeof decoded !== \"object\" || decoded === null)\n            return false;\n        if (\"typ\" in decoded && decoded?.typ !== \"JWT\")\n            return false;\n        if (!decoded.alg)\n            return false;\n        if (alg && decoded.alg !== alg)\n            return false;\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nfunction isValidCidr(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4CidrRegex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6CidrRegex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nexport class ZodString extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = String(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.string) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.string,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.length < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.length > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"length\") {\n                const tooBig = input.data.length > check.value;\n                const tooSmall = input.data.length < check.value;\n                if (tooBig || tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    if (tooBig) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_big,\n                            maximum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    else if (tooSmall) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_small,\n                            minimum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"email\") {\n                if (!emailRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"email\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"emoji\") {\n                if (!emojiRegex) {\n                    emojiRegex = new RegExp(_emojiRegex, \"u\");\n                }\n                if (!emojiRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"emoji\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"uuid\") {\n                if (!uuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"uuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"nanoid\") {\n                if (!nanoidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"nanoid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid\") {\n                if (!cuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid2\") {\n                if (!cuid2Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid2\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ulid\") {\n                if (!ulidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ulid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"url\") {\n                try {\n                    new URL(input.data);\n                }\n                catch {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"regex\") {\n                check.regex.lastIndex = 0;\n                const testResult = check.regex.test(input.data);\n                if (!testResult) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"regex\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"trim\") {\n                input.data = input.data.trim();\n            }\n            else if (check.kind === \"includes\") {\n                if (!input.data.includes(check.value, check.position)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { includes: check.value, position: check.position },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"toLowerCase\") {\n                input.data = input.data.toLowerCase();\n            }\n            else if (check.kind === \"toUpperCase\") {\n                input.data = input.data.toUpperCase();\n            }\n            else if (check.kind === \"startsWith\") {\n                if (!input.data.startsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { startsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"endsWith\") {\n                if (!input.data.endsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { endsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"datetime\") {\n                const regex = datetimeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"datetime\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"date\") {\n                const regex = dateRegex;\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"date\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"time\") {\n                const regex = timeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"time\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"duration\") {\n                if (!durationRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"duration\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ip\") {\n                if (!isValidIP(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ip\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"jwt\") {\n                if (!isValidJWT(input.data, check.alg)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"jwt\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cidr\") {\n                if (!isValidCidr(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cidr\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64\") {\n                if (!base64Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64url\") {\n                if (!base64urlRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _regex(regex, validation, message) {\n        return this.refinement((data) => regex.test(data), {\n            validation,\n            code: ZodIssueCode.invalid_string,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    _addCheck(check) {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    email(message) {\n        return this._addCheck({ kind: \"email\", ...errorUtil.errToObj(message) });\n    }\n    url(message) {\n        return this._addCheck({ kind: \"url\", ...errorUtil.errToObj(message) });\n    }\n    emoji(message) {\n        return this._addCheck({ kind: \"emoji\", ...errorUtil.errToObj(message) });\n    }\n    uuid(message) {\n        return this._addCheck({ kind: \"uuid\", ...errorUtil.errToObj(message) });\n    }\n    nanoid(message) {\n        return this._addCheck({ kind: \"nanoid\", ...errorUtil.errToObj(message) });\n    }\n    cuid(message) {\n        return this._addCheck({ kind: \"cuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid2(message) {\n        return this._addCheck({ kind: \"cuid2\", ...errorUtil.errToObj(message) });\n    }\n    ulid(message) {\n        return this._addCheck({ kind: \"ulid\", ...errorUtil.errToObj(message) });\n    }\n    base64(message) {\n        return this._addCheck({ kind: \"base64\", ...errorUtil.errToObj(message) });\n    }\n    base64url(message) {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return this._addCheck({\n            kind: \"base64url\",\n            ...errorUtil.errToObj(message),\n        });\n    }\n    jwt(options) {\n        return this._addCheck({ kind: \"jwt\", ...errorUtil.errToObj(options) });\n    }\n    ip(options) {\n        return this._addCheck({ kind: \"ip\", ...errorUtil.errToObj(options) });\n    }\n    cidr(options) {\n        return this._addCheck({ kind: \"cidr\", ...errorUtil.errToObj(options) });\n    }\n    datetime(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"datetime\",\n                precision: null,\n                offset: false,\n                local: false,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"datetime\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            offset: options?.offset ?? false,\n            local: options?.local ?? false,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    date(message) {\n        return this._addCheck({ kind: \"date\", message });\n    }\n    time(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"time\",\n                precision: null,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"time\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    duration(message) {\n        return this._addCheck({ kind: \"duration\", ...errorUtil.errToObj(message) });\n    }\n    regex(regex, message) {\n        return this._addCheck({\n            kind: \"regex\",\n            regex: regex,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    includes(value, options) {\n        return this._addCheck({\n            kind: \"includes\",\n            value: value,\n            position: options?.position,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    startsWith(value, message) {\n        return this._addCheck({\n            kind: \"startsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    endsWith(value, message) {\n        return this._addCheck({\n            kind: \"endsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    min(minLength, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    max(maxLength, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    length(len, message) {\n        return this._addCheck({\n            kind: \"length\",\n            value: len,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    /**\n     * Equivalent to `.min(1)`\n     */\n    nonempty(message) {\n        return this.min(1, errorUtil.errToObj(message));\n    }\n    trim() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"trim\" }],\n        });\n    }\n    toLowerCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toLowerCase\" }],\n        });\n    }\n    toUpperCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toUpperCase\" }],\n        });\n    }\n    get isDatetime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"datetime\");\n    }\n    get isDate() {\n        return !!this._def.checks.find((ch) => ch.kind === \"date\");\n    }\n    get isTime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"time\");\n    }\n    get isDuration() {\n        return !!this._def.checks.find((ch) => ch.kind === \"duration\");\n    }\n    get isEmail() {\n        return !!this._def.checks.find((ch) => ch.kind === \"email\");\n    }\n    get isURL() {\n        return !!this._def.checks.find((ch) => ch.kind === \"url\");\n    }\n    get isEmoji() {\n        return !!this._def.checks.find((ch) => ch.kind === \"emoji\");\n    }\n    get isUUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"uuid\");\n    }\n    get isNANOID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"nanoid\");\n    }\n    get isCUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid\");\n    }\n    get isCUID2() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid2\");\n    }\n    get isULID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ulid\");\n    }\n    get isIP() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ip\");\n    }\n    get isCIDR() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cidr\");\n    }\n    get isBase64() {\n        return !!this._def.checks.find((ch) => ch.kind === \"base64\");\n    }\n    get isBase64url() {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return !!this._def.checks.find((ch) => ch.kind === \"base64url\");\n    }\n    get minLength() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxLength() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodString.create = (params) => {\n    return new ZodString({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodString,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\n// https://stackoverflow.com/questions/3966484/why-does-modulus-operator-return-fractional-number-in-javascript/31711034#31711034\nfunction floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepDecCount = (step.toString().split(\".\")[1] || \"\").length;\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = Number.parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = Number.parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / 10 ** decCount;\n}\nexport class ZodNumber extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n        this.step = this.multipleOf;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Number(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.number) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.number,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"int\") {\n                if (!util.isInteger(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_type,\n                        expected: \"integer\",\n                        received: \"float\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (floatSafeRemainder(input.data, check.value) !== 0) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"finite\") {\n                if (!Number.isFinite(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_finite,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    int(message) {\n        return this._addCheck({\n            kind: \"int\",\n            message: errorUtil.toString(message),\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value: value,\n            message: errorUtil.toString(message),\n        });\n    }\n    finite(message) {\n        return this._addCheck({\n            kind: \"finite\",\n            message: errorUtil.toString(message),\n        });\n    }\n    safe(message) {\n        return this._addCheck({\n            kind: \"min\",\n            inclusive: true,\n            value: Number.MIN_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        })._addCheck({\n            kind: \"max\",\n            inclusive: true,\n            value: Number.MAX_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n    get isInt() {\n        return !!this._def.checks.find((ch) => ch.kind === \"int\" || (ch.kind === \"multipleOf\" && util.isInteger(ch.value)));\n    }\n    get isFinite() {\n        let max = null;\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"finite\" || ch.kind === \"int\" || ch.kind === \"multipleOf\") {\n                return true;\n            }\n            else if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n            else if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return Number.isFinite(min) && Number.isFinite(max);\n    }\n}\nZodNumber.create = (params) => {\n    return new ZodNumber({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodNumber,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBigInt extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            try {\n                input.data = BigInt(input.data);\n            }\n            catch {\n                return this._getInvalidInput(input);\n            }\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.bigint) {\n            return this._getInvalidInput(input);\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        type: \"bigint\",\n                        minimum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        type: \"bigint\",\n                        maximum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (input.data % check.value !== BigInt(0)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _getInvalidInput(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.bigint,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodBigInt.create = (params) => {\n    return new ZodBigInt({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodBigInt,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBoolean extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Boolean(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.boolean) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.boolean,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodBoolean.create = (params) => {\n    return new ZodBoolean({\n        typeName: ZodFirstPartyTypeKind.ZodBoolean,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDate extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = new Date(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.date) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.date,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (Number.isNaN(input.data.getTime())) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_date,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.getTime() < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        minimum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.getTime() > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        maximum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return {\n            status: status.value,\n            value: new Date(input.data.getTime()),\n        };\n    }\n    _addCheck(check) {\n        return new ZodDate({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    min(minDate, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    max(maxDate, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    get minDate() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min != null ? new Date(min) : null;\n    }\n    get maxDate() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max != null ? new Date(max) : null;\n    }\n}\nZodDate.create = (params) => {\n    return new ZodDate({\n        checks: [],\n        coerce: params?.coerce || false,\n        typeName: ZodFirstPartyTypeKind.ZodDate,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSymbol extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.symbol) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.symbol,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodSymbol.create = (params) => {\n    return new ZodSymbol({\n        typeName: ZodFirstPartyTypeKind.ZodSymbol,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUndefined extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.undefined,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodUndefined.create = (params) => {\n    return new ZodUndefined({\n        typeName: ZodFirstPartyTypeKind.ZodUndefined,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNull extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.null) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.null,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodNull.create = (params) => {\n    return new ZodNull({\n        typeName: ZodFirstPartyTypeKind.ZodNull,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodAny extends ZodType {\n    constructor() {\n        super(...arguments);\n        // to prevent instances of other classes from extending ZodAny. this causes issues with catchall in ZodObject.\n        this._any = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodAny.create = (params) => {\n    return new ZodAny({\n        typeName: ZodFirstPartyTypeKind.ZodAny,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnknown extends ZodType {\n    constructor() {\n        super(...arguments);\n        // required\n        this._unknown = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodUnknown.create = (params) => {\n    return new ZodUnknown({\n        typeName: ZodFirstPartyTypeKind.ZodUnknown,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNever extends ZodType {\n    _parse(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.never,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n}\nZodNever.create = (params) => {\n    return new ZodNever({\n        typeName: ZodFirstPartyTypeKind.ZodNever,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodVoid extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.void,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodVoid.create = (params) => {\n    return new ZodVoid({\n        typeName: ZodFirstPartyTypeKind.ZodVoid,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodArray extends ZodType {\n    _parse(input) {\n        const { ctx, status } = this._processInputParams(input);\n        const def = this._def;\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (def.exactLength !== null) {\n            const tooBig = ctx.data.length > def.exactLength.value;\n            const tooSmall = ctx.data.length < def.exactLength.value;\n            if (tooBig || tooSmall) {\n                addIssueToContext(ctx, {\n                    code: tooBig ? ZodIssueCode.too_big : ZodIssueCode.too_small,\n                    minimum: (tooSmall ? def.exactLength.value : undefined),\n                    maximum: (tooBig ? def.exactLength.value : undefined),\n                    type: \"array\",\n                    inclusive: true,\n                    exact: true,\n                    message: def.exactLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.minLength !== null) {\n            if (ctx.data.length < def.minLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxLength !== null) {\n            if (ctx.data.length > def.maxLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.all([...ctx.data].map((item, i) => {\n                return def.type._parseAsync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n            })).then((result) => {\n                return ParseStatus.mergeArray(status, result);\n            });\n        }\n        const result = [...ctx.data].map((item, i) => {\n            return def.type._parseSync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n        });\n        return ParseStatus.mergeArray(status, result);\n    }\n    get element() {\n        return this._def.type;\n    }\n    min(minLength, message) {\n        return new ZodArray({\n            ...this._def,\n            minLength: { value: minLength, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxLength, message) {\n        return new ZodArray({\n            ...this._def,\n            maxLength: { value: maxLength, message: errorUtil.toString(message) },\n        });\n    }\n    length(len, message) {\n        return new ZodArray({\n            ...this._def,\n            exactLength: { value: len, message: errorUtil.toString(message) },\n        });\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodArray.create = (schema, params) => {\n    return new ZodArray({\n        type: schema,\n        minLength: null,\n        maxLength: null,\n        exactLength: null,\n        typeName: ZodFirstPartyTypeKind.ZodArray,\n        ...processCreateParams(params),\n    });\n};\nfunction deepPartialify(schema) {\n    if (schema instanceof ZodObject) {\n        const newShape = {};\n        for (const key in schema.shape) {\n            const fieldSchema = schema.shape[key];\n            newShape[key] = ZodOptional.create(deepPartialify(fieldSchema));\n        }\n        return new ZodObject({\n            ...schema._def,\n            shape: () => newShape,\n        });\n    }\n    else if (schema instanceof ZodArray) {\n        return new ZodArray({\n            ...schema._def,\n            type: deepPartialify(schema.element),\n        });\n    }\n    else if (schema instanceof ZodOptional) {\n        return ZodOptional.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodNullable) {\n        return ZodNullable.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodTuple) {\n        return ZodTuple.create(schema.items.map((item) => deepPartialify(item)));\n    }\n    else {\n        return schema;\n    }\n}\nexport class ZodObject extends ZodType {\n    constructor() {\n        super(...arguments);\n        this._cached = null;\n        /**\n         * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.\n         * If you want to pass through unknown properties, use `.passthrough()` instead.\n         */\n        this.nonstrict = this.passthrough;\n        // extend<\n        //   Augmentation extends ZodRawShape,\n        //   NewOutput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_output\"]\n        //       : k extends keyof Output\n        //       ? Output[k]\n        //       : never;\n        //   }>,\n        //   NewInput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_input\"]\n        //       : k extends keyof Input\n        //       ? Input[k]\n        //       : never;\n        //   }>\n        // >(\n        //   augmentation: Augmentation\n        // ): ZodObject<\n        //   extendShape<T, Augmentation>,\n        //   UnknownKeys,\n        //   Catchall,\n        //   NewOutput,\n        //   NewInput\n        // > {\n        //   return new ZodObject({\n        //     ...this._def,\n        //     shape: () => ({\n        //       ...this._def.shape(),\n        //       ...augmentation,\n        //     }),\n        //   }) as any;\n        // }\n        /**\n         * @deprecated Use `.extend` instead\n         *  */\n        this.augment = this.extend;\n    }\n    _getCached() {\n        if (this._cached !== null)\n            return this._cached;\n        const shape = this._def.shape();\n        const keys = util.objectKeys(shape);\n        this._cached = { shape, keys };\n        return this._cached;\n    }\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.object) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const { status, ctx } = this._processInputParams(input);\n        const { shape, keys: shapeKeys } = this._getCached();\n        const extraKeys = [];\n        if (!(this._def.catchall instanceof ZodNever && this._def.unknownKeys === \"strip\")) {\n            for (const key in ctx.data) {\n                if (!shapeKeys.includes(key)) {\n                    extraKeys.push(key);\n                }\n            }\n        }\n        const pairs = [];\n        for (const key of shapeKeys) {\n            const keyValidator = shape[key];\n            const value = ctx.data[key];\n            pairs.push({\n                key: { status: \"valid\", value: key },\n                value: keyValidator._parse(new ParseInputLazyPath(ctx, value, ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (this._def.catchall instanceof ZodNever) {\n            const unknownKeys = this._def.unknownKeys;\n            if (unknownKeys === \"passthrough\") {\n                for (const key of extraKeys) {\n                    pairs.push({\n                        key: { status: \"valid\", value: key },\n                        value: { status: \"valid\", value: ctx.data[key] },\n                    });\n                }\n            }\n            else if (unknownKeys === \"strict\") {\n                if (extraKeys.length > 0) {\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.unrecognized_keys,\n                        keys: extraKeys,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (unknownKeys === \"strip\") {\n            }\n            else {\n                throw new Error(`Internal ZodObject error: invalid unknownKeys value.`);\n            }\n        }\n        else {\n            // run catchall validation\n            const catchall = this._def.catchall;\n            for (const key of extraKeys) {\n                const value = ctx.data[key];\n                pairs.push({\n                    key: { status: \"valid\", value: key },\n                    value: catchall._parse(new ParseInputLazyPath(ctx, value, ctx.path, key) //, ctx.child(key), value, getParsedType(value)\n                    ),\n                    alwaysSet: key in ctx.data,\n                });\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.resolve()\n                .then(async () => {\n                const syncPairs = [];\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    syncPairs.push({\n                        key,\n                        value,\n                        alwaysSet: pair.alwaysSet,\n                    });\n                }\n                return syncPairs;\n            })\n                .then((syncPairs) => {\n                return ParseStatus.mergeObjectSync(status, syncPairs);\n            });\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get shape() {\n        return this._def.shape();\n    }\n    strict(message) {\n        errorUtil.errToObj;\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strict\",\n            ...(message !== undefined\n                ? {\n                    errorMap: (issue, ctx) => {\n                        const defaultError = this._def.errorMap?.(issue, ctx).message ?? ctx.defaultError;\n                        if (issue.code === \"unrecognized_keys\")\n                            return {\n                                message: errorUtil.errToObj(message).message ?? defaultError,\n                            };\n                        return {\n                            message: defaultError,\n                        };\n                    },\n                }\n                : {}),\n        });\n    }\n    strip() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strip\",\n        });\n    }\n    passthrough() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"passthrough\",\n        });\n    }\n    // const AugmentFactory =\n    //   <Def extends ZodObjectDef>(def: Def) =>\n    //   <Augmentation extends ZodRawShape>(\n    //     augmentation: Augmentation\n    //   ): ZodObject<\n    //     extendShape<ReturnType<Def[\"shape\"]>, Augmentation>,\n    //     Def[\"unknownKeys\"],\n    //     Def[\"catchall\"]\n    //   > => {\n    //     return new ZodObject({\n    //       ...def,\n    //       shape: () => ({\n    //         ...def.shape(),\n    //         ...augmentation,\n    //       }),\n    //     }) as any;\n    //   };\n    extend(augmentation) {\n        return new ZodObject({\n            ...this._def,\n            shape: () => ({\n                ...this._def.shape(),\n                ...augmentation,\n            }),\n        });\n    }\n    /**\n     * Prior to zod@1.0.12 there was a bug in the\n     * inferred type of merged objects. Please\n     * upgrade if you are experiencing issues.\n     */\n    merge(merging) {\n        const merged = new ZodObject({\n            unknownKeys: merging._def.unknownKeys,\n            catchall: merging._def.catchall,\n            shape: () => ({\n                ...this._def.shape(),\n                ...merging._def.shape(),\n            }),\n            typeName: ZodFirstPartyTypeKind.ZodObject,\n        });\n        return merged;\n    }\n    // merge<\n    //   Incoming extends AnyZodObject,\n    //   Augmentation extends Incoming[\"shape\"],\n    //   NewOutput extends {\n    //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_output\"]\n    //       : k extends keyof Output\n    //       ? Output[k]\n    //       : never;\n    //   },\n    //   NewInput extends {\n    //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_input\"]\n    //       : k extends keyof Input\n    //       ? Input[k]\n    //       : never;\n    //   }\n    // >(\n    //   merging: Incoming\n    // ): ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"],\n    //   NewOutput,\n    //   NewInput\n    // > {\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    setKey(key, schema) {\n        return this.augment({ [key]: schema });\n    }\n    // merge<Incoming extends AnyZodObject>(\n    //   merging: Incoming\n    // ): //ZodObject<T & Incoming[\"_shape\"], UnknownKeys, Catchall> = (merging) => {\n    // ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"]\n    // > {\n    //   // const mergedShape = objectUtil.mergeShapes(\n    //   //   this._def.shape(),\n    //   //   merging._def.shape()\n    //   // );\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    catchall(index) {\n        return new ZodObject({\n            ...this._def,\n            catchall: index,\n        });\n    }\n    pick(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(mask)) {\n            if (mask[key] && this.shape[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    omit(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (!mask[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    /**\n     * @deprecated\n     */\n    deepPartial() {\n        return deepPartialify(this);\n    }\n    partial(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            const fieldSchema = this.shape[key];\n            if (mask && !mask[key]) {\n                newShape[key] = fieldSchema;\n            }\n            else {\n                newShape[key] = fieldSchema.optional();\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    required(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (mask && !mask[key]) {\n                newShape[key] = this.shape[key];\n            }\n            else {\n                const fieldSchema = this.shape[key];\n                let newField = fieldSchema;\n                while (newField instanceof ZodOptional) {\n                    newField = newField._def.innerType;\n                }\n                newShape[key] = newField;\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    keyof() {\n        return createZodEnum(util.objectKeys(this.shape));\n    }\n}\nZodObject.create = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.strictCreate = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strict\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.lazycreate = (shape, params) => {\n    return new ZodObject({\n        shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const options = this._def.options;\n        function handleResults(results) {\n            // return first issue-free validation if it exists\n            for (const result of results) {\n                if (result.result.status === \"valid\") {\n                    return result.result;\n                }\n            }\n            for (const result of results) {\n                if (result.result.status === \"dirty\") {\n                    // add issues from dirty option\n                    ctx.common.issues.push(...result.ctx.common.issues);\n                    return result.result;\n                }\n            }\n            // return invalid\n            const unionErrors = results.map((result) => new ZodError(result.ctx.common.issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return Promise.all(options.map(async (option) => {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                return {\n                    result: await option._parseAsync({\n                        data: ctx.data,\n                        path: ctx.path,\n                        parent: childCtx,\n                    }),\n                    ctx: childCtx,\n                };\n            })).then(handleResults);\n        }\n        else {\n            let dirty = undefined;\n            const issues = [];\n            for (const option of options) {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                const result = option._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: childCtx,\n                });\n                if (result.status === \"valid\") {\n                    return result;\n                }\n                else if (result.status === \"dirty\" && !dirty) {\n                    dirty = { result, ctx: childCtx };\n                }\n                if (childCtx.common.issues.length) {\n                    issues.push(childCtx.common.issues);\n                }\n            }\n            if (dirty) {\n                ctx.common.issues.push(...dirty.ctx.common.issues);\n                return dirty.result;\n            }\n            const unionErrors = issues.map((issues) => new ZodError(issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n    }\n    get options() {\n        return this._def.options;\n    }\n}\nZodUnion.create = (types, params) => {\n    return new ZodUnion({\n        options: types,\n        typeName: ZodFirstPartyTypeKind.ZodUnion,\n        ...processCreateParams(params),\n    });\n};\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\n//////////                                 //////////\n//////////      ZodDiscriminatedUnion      //////////\n//////////                                 //////////\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\nconst getDiscriminator = (type) => {\n    if (type instanceof ZodLazy) {\n        return getDiscriminator(type.schema);\n    }\n    else if (type instanceof ZodEffects) {\n        return getDiscriminator(type.innerType());\n    }\n    else if (type instanceof ZodLiteral) {\n        return [type.value];\n    }\n    else if (type instanceof ZodEnum) {\n        return type.options;\n    }\n    else if (type instanceof ZodNativeEnum) {\n        // eslint-disable-next-line ban/ban\n        return util.objectValues(type.enum);\n    }\n    else if (type instanceof ZodDefault) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else if (type instanceof ZodUndefined) {\n        return [undefined];\n    }\n    else if (type instanceof ZodNull) {\n        return [null];\n    }\n    else if (type instanceof ZodOptional) {\n        return [undefined, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodNullable) {\n        return [null, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodBranded) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodReadonly) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodCatch) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else {\n        return [];\n    }\n};\nexport class ZodDiscriminatedUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const discriminator = this.discriminator;\n        const discriminatorValue = ctx.data[discriminator];\n        const option = this.optionsMap.get(discriminatorValue);\n        if (!option) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union_discriminator,\n                options: Array.from(this.optionsMap.keys()),\n                path: [discriminator],\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return option._parseAsync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n        else {\n            return option._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n    }\n    get discriminator() {\n        return this._def.discriminator;\n    }\n    get options() {\n        return this._def.options;\n    }\n    get optionsMap() {\n        return this._def.optionsMap;\n    }\n    /**\n     * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.\n     * However, it only allows a union of objects, all of which need to share a discriminator property. This property must\n     * have a different value for each object in the union.\n     * @param discriminator the name of the discriminator property\n     * @param types an array of object schemas\n     * @param params\n     */\n    static create(discriminator, options, params) {\n        // Get all the valid discriminator values\n        const optionsMap = new Map();\n        // try {\n        for (const type of options) {\n            const discriminatorValues = getDiscriminator(type.shape[discriminator]);\n            if (!discriminatorValues.length) {\n                throw new Error(`A discriminator value for key \\`${discriminator}\\` could not be extracted from all schema options`);\n            }\n            for (const value of discriminatorValues) {\n                if (optionsMap.has(value)) {\n                    throw new Error(`Discriminator property ${String(discriminator)} has duplicate value ${String(value)}`);\n                }\n                optionsMap.set(value, type);\n            }\n        }\n        return new ZodDiscriminatedUnion({\n            typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion,\n            discriminator,\n            options,\n            optionsMap,\n            ...processCreateParams(params),\n        });\n    }\n}\nfunction mergeValues(a, b) {\n    const aType = getParsedType(a);\n    const bType = getParsedType(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    else if (aType === ZodParsedType.object && bType === ZodParsedType.object) {\n        const bKeys = util.objectKeys(b);\n        const sharedKeys = util.objectKeys(a).filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    else if (aType === ZodParsedType.array && bType === ZodParsedType.array) {\n        if (a.length !== b.length) {\n            return { valid: false };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    else if (aType === ZodParsedType.date && bType === ZodParsedType.date && +a === +b) {\n        return { valid: true, data: a };\n    }\n    else {\n        return { valid: false };\n    }\n}\nexport class ZodIntersection extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const handleParsed = (parsedLeft, parsedRight) => {\n            if (isAborted(parsedLeft) || isAborted(parsedRight)) {\n                return INVALID;\n            }\n            const merged = mergeValues(parsedLeft.value, parsedRight.value);\n            if (!merged.valid) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.invalid_intersection_types,\n                });\n                return INVALID;\n            }\n            if (isDirty(parsedLeft) || isDirty(parsedRight)) {\n                status.dirty();\n            }\n            return { status: status.value, value: merged.data };\n        };\n        if (ctx.common.async) {\n            return Promise.all([\n                this._def.left._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n                this._def.right._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n            ]).then(([left, right]) => handleParsed(left, right));\n        }\n        else {\n            return handleParsed(this._def.left._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }), this._def.right._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }));\n        }\n    }\n}\nZodIntersection.create = (left, right, params) => {\n    return new ZodIntersection({\n        left: left,\n        right: right,\n        typeName: ZodFirstPartyTypeKind.ZodIntersection,\n        ...processCreateParams(params),\n    });\n};\n// type ZodTupleItems = [ZodTypeAny, ...ZodTypeAny[]];\nexport class ZodTuple extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (ctx.data.length < this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_small,\n                minimum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            return INVALID;\n        }\n        const rest = this._def.rest;\n        if (!rest && ctx.data.length > this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_big,\n                maximum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            status.dirty();\n        }\n        const items = [...ctx.data]\n            .map((item, itemIndex) => {\n            const schema = this._def.items[itemIndex] || this._def.rest;\n            if (!schema)\n                return null;\n            return schema._parse(new ParseInputLazyPath(ctx, item, ctx.path, itemIndex));\n        })\n            .filter((x) => !!x); // filter nulls\n        if (ctx.common.async) {\n            return Promise.all(items).then((results) => {\n                return ParseStatus.mergeArray(status, results);\n            });\n        }\n        else {\n            return ParseStatus.mergeArray(status, items);\n        }\n    }\n    get items() {\n        return this._def.items;\n    }\n    rest(rest) {\n        return new ZodTuple({\n            ...this._def,\n            rest,\n        });\n    }\n}\nZodTuple.create = (schemas, params) => {\n    if (!Array.isArray(schemas)) {\n        throw new Error(\"You must pass an array of schemas to z.tuple([ ... ])\");\n    }\n    return new ZodTuple({\n        items: schemas,\n        typeName: ZodFirstPartyTypeKind.ZodTuple,\n        rest: null,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodRecord extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const pairs = [];\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        for (const key in ctx.data) {\n            pairs.push({\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, key)),\n                value: valueType._parse(new ParseInputLazyPath(ctx, ctx.data[key], ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (ctx.common.async) {\n            return ParseStatus.mergeObjectAsync(status, pairs);\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get element() {\n        return this._def.valueType;\n    }\n    static create(first, second, third) {\n        if (second instanceof ZodType) {\n            return new ZodRecord({\n                keyType: first,\n                valueType: second,\n                typeName: ZodFirstPartyTypeKind.ZodRecord,\n                ...processCreateParams(third),\n            });\n        }\n        return new ZodRecord({\n            keyType: ZodString.create(),\n            valueType: first,\n            typeName: ZodFirstPartyTypeKind.ZodRecord,\n            ...processCreateParams(second),\n        });\n    }\n}\nexport class ZodMap extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.map) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.map,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        const pairs = [...ctx.data.entries()].map(([key, value], index) => {\n            return {\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, [index, \"key\"])),\n                value: valueType._parse(new ParseInputLazyPath(ctx, value, ctx.path, [index, \"value\"])),\n            };\n        });\n        if (ctx.common.async) {\n            const finalMap = new Map();\n            return Promise.resolve().then(async () => {\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    if (key.status === \"aborted\" || value.status === \"aborted\") {\n                        return INVALID;\n                    }\n                    if (key.status === \"dirty\" || value.status === \"dirty\") {\n                        status.dirty();\n                    }\n                    finalMap.set(key.value, value.value);\n                }\n                return { status: status.value, value: finalMap };\n            });\n        }\n        else {\n            const finalMap = new Map();\n            for (const pair of pairs) {\n                const key = pair.key;\n                const value = pair.value;\n                if (key.status === \"aborted\" || value.status === \"aborted\") {\n                    return INVALID;\n                }\n                if (key.status === \"dirty\" || value.status === \"dirty\") {\n                    status.dirty();\n                }\n                finalMap.set(key.value, value.value);\n            }\n            return { status: status.value, value: finalMap };\n        }\n    }\n}\nZodMap.create = (keyType, valueType, params) => {\n    return new ZodMap({\n        valueType,\n        keyType,\n        typeName: ZodFirstPartyTypeKind.ZodMap,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSet extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.set) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.set,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const def = this._def;\n        if (def.minSize !== null) {\n            if (ctx.data.size < def.minSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minSize.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxSize !== null) {\n            if (ctx.data.size > def.maxSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxSize.message,\n                });\n                status.dirty();\n            }\n        }\n        const valueType = this._def.valueType;\n        function finalizeSet(elements) {\n            const parsedSet = new Set();\n            for (const element of elements) {\n                if (element.status === \"aborted\")\n                    return INVALID;\n                if (element.status === \"dirty\")\n                    status.dirty();\n                parsedSet.add(element.value);\n            }\n            return { status: status.value, value: parsedSet };\n        }\n        const elements = [...ctx.data.values()].map((item, i) => valueType._parse(new ParseInputLazyPath(ctx, item, ctx.path, i)));\n        if (ctx.common.async) {\n            return Promise.all(elements).then((elements) => finalizeSet(elements));\n        }\n        else {\n            return finalizeSet(elements);\n        }\n    }\n    min(minSize, message) {\n        return new ZodSet({\n            ...this._def,\n            minSize: { value: minSize, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxSize, message) {\n        return new ZodSet({\n            ...this._def,\n            maxSize: { value: maxSize, message: errorUtil.toString(message) },\n        });\n    }\n    size(size, message) {\n        return this.min(size, message).max(size, message);\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodSet.create = (valueType, params) => {\n    return new ZodSet({\n        valueType,\n        minSize: null,\n        maxSize: null,\n        typeName: ZodFirstPartyTypeKind.ZodSet,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodFunction extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.validate = this.implement;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.function) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.function,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        function makeArgsIssue(args, error) {\n            return makeIssue({\n                data: args,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_arguments,\n                    argumentsError: error,\n                },\n            });\n        }\n        function makeReturnsIssue(returns, error) {\n            return makeIssue({\n                data: returns,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_return_type,\n                    returnTypeError: error,\n                },\n            });\n        }\n        const params = { errorMap: ctx.common.contextualErrorMap };\n        const fn = ctx.data;\n        if (this._def.returns instanceof ZodPromise) {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(async function (...args) {\n                const error = new ZodError([]);\n                const parsedArgs = await me._def.args.parseAsync(args, params).catch((e) => {\n                    error.addIssue(makeArgsIssue(args, e));\n                    throw error;\n                });\n                const result = await Reflect.apply(fn, this, parsedArgs);\n                const parsedReturns = await me._def.returns._def.type\n                    .parseAsync(result, params)\n                    .catch((e) => {\n                    error.addIssue(makeReturnsIssue(result, e));\n                    throw error;\n                });\n                return parsedReturns;\n            });\n        }\n        else {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(function (...args) {\n                const parsedArgs = me._def.args.safeParse(args, params);\n                if (!parsedArgs.success) {\n                    throw new ZodError([makeArgsIssue(args, parsedArgs.error)]);\n                }\n                const result = Reflect.apply(fn, this, parsedArgs.data);\n                const parsedReturns = me._def.returns.safeParse(result, params);\n                if (!parsedReturns.success) {\n                    throw new ZodError([makeReturnsIssue(result, parsedReturns.error)]);\n                }\n                return parsedReturns.data;\n            });\n        }\n    }\n    parameters() {\n        return this._def.args;\n    }\n    returnType() {\n        return this._def.returns;\n    }\n    args(...items) {\n        return new ZodFunction({\n            ...this._def,\n            args: ZodTuple.create(items).rest(ZodUnknown.create()),\n        });\n    }\n    returns(returnType) {\n        return new ZodFunction({\n            ...this._def,\n            returns: returnType,\n        });\n    }\n    implement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    strictImplement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    static create(args, returns, params) {\n        return new ZodFunction({\n            args: (args ? args : ZodTuple.create([]).rest(ZodUnknown.create())),\n            returns: returns || ZodUnknown.create(),\n            typeName: ZodFirstPartyTypeKind.ZodFunction,\n            ...processCreateParams(params),\n        });\n    }\n}\nexport class ZodLazy extends ZodType {\n    get schema() {\n        return this._def.getter();\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const lazySchema = this._def.getter();\n        return lazySchema._parse({ data: ctx.data, path: ctx.path, parent: ctx });\n    }\n}\nZodLazy.create = (getter, params) => {\n    return new ZodLazy({\n        getter: getter,\n        typeName: ZodFirstPartyTypeKind.ZodLazy,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodLiteral extends ZodType {\n    _parse(input) {\n        if (input.data !== this._def.value) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_literal,\n                expected: this._def.value,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n    get value() {\n        return this._def.value;\n    }\n}\nZodLiteral.create = (value, params) => {\n    return new ZodLiteral({\n        value: value,\n        typeName: ZodFirstPartyTypeKind.ZodLiteral,\n        ...processCreateParams(params),\n    });\n};\nfunction createZodEnum(values, params) {\n    return new ZodEnum({\n        values,\n        typeName: ZodFirstPartyTypeKind.ZodEnum,\n        ...processCreateParams(params),\n    });\n}\nexport class ZodEnum extends ZodType {\n    _parse(input) {\n        if (typeof input.data !== \"string\") {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(this._def.values);\n        }\n        if (!this._cache.has(input.data)) {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get options() {\n        return this._def.values;\n    }\n    get enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Values() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    extract(values, newDef = this._def) {\n        return ZodEnum.create(values, {\n            ...this._def,\n            ...newDef,\n        });\n    }\n    exclude(values, newDef = this._def) {\n        return ZodEnum.create(this.options.filter((opt) => !values.includes(opt)), {\n            ...this._def,\n            ...newDef,\n        });\n    }\n}\nZodEnum.create = createZodEnum;\nexport class ZodNativeEnum extends ZodType {\n    _parse(input) {\n        const nativeEnumValues = util.getValidEnumValues(this._def.values);\n        const ctx = this._getOrReturnCtx(input);\n        if (ctx.parsedType !== ZodParsedType.string && ctx.parsedType !== ZodParsedType.number) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(util.getValidEnumValues(this._def.values));\n        }\n        if (!this._cache.has(input.data)) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get enum() {\n        return this._def.values;\n    }\n}\nZodNativeEnum.create = (values, params) => {\n    return new ZodNativeEnum({\n        values: values,\n        typeName: ZodFirstPartyTypeKind.ZodNativeEnum,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodPromise extends ZodType {\n    unwrap() {\n        return this._def.type;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.promise && ctx.common.async === false) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.promise,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const promisified = ctx.parsedType === ZodParsedType.promise ? ctx.data : Promise.resolve(ctx.data);\n        return OK(promisified.then((data) => {\n            return this._def.type.parseAsync(data, {\n                path: ctx.path,\n                errorMap: ctx.common.contextualErrorMap,\n            });\n        }));\n    }\n}\nZodPromise.create = (schema, params) => {\n    return new ZodPromise({\n        type: schema,\n        typeName: ZodFirstPartyTypeKind.ZodPromise,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodEffects extends ZodType {\n    innerType() {\n        return this._def.schema;\n    }\n    sourceType() {\n        return this._def.schema._def.typeName === ZodFirstPartyTypeKind.ZodEffects\n            ? this._def.schema.sourceType()\n            : this._def.schema;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const effect = this._def.effect || null;\n        const checkCtx = {\n            addIssue: (arg) => {\n                addIssueToContext(ctx, arg);\n                if (arg.fatal) {\n                    status.abort();\n                }\n                else {\n                    status.dirty();\n                }\n            },\n            get path() {\n                return ctx.path;\n            },\n        };\n        checkCtx.addIssue = checkCtx.addIssue.bind(checkCtx);\n        if (effect.type === \"preprocess\") {\n            const processed = effect.transform(ctx.data, checkCtx);\n            if (ctx.common.async) {\n                return Promise.resolve(processed).then(async (processed) => {\n                    if (status.value === \"aborted\")\n                        return INVALID;\n                    const result = await this._def.schema._parseAsync({\n                        data: processed,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                    if (result.status === \"aborted\")\n                        return INVALID;\n                    if (result.status === \"dirty\")\n                        return DIRTY(result.value);\n                    if (status.value === \"dirty\")\n                        return DIRTY(result.value);\n                    return result;\n                });\n            }\n            else {\n                if (status.value === \"aborted\")\n                    return INVALID;\n                const result = this._def.schema._parseSync({\n                    data: processed,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (result.status === \"aborted\")\n                    return INVALID;\n                if (result.status === \"dirty\")\n                    return DIRTY(result.value);\n                if (status.value === \"dirty\")\n                    return DIRTY(result.value);\n                return result;\n            }\n        }\n        if (effect.type === \"refinement\") {\n            const executeRefinement = (acc) => {\n                const result = effect.refinement(acc, checkCtx);\n                if (ctx.common.async) {\n                    return Promise.resolve(result);\n                }\n                if (result instanceof Promise) {\n                    throw new Error(\"Async refinement encountered during synchronous parse operation. Use .parseAsync instead.\");\n                }\n                return acc;\n            };\n            if (ctx.common.async === false) {\n                const inner = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inner.status === \"aborted\")\n                    return INVALID;\n                if (inner.status === \"dirty\")\n                    status.dirty();\n                // return value is ignored\n                executeRefinement(inner.value);\n                return { status: status.value, value: inner.value };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((inner) => {\n                    if (inner.status === \"aborted\")\n                        return INVALID;\n                    if (inner.status === \"dirty\")\n                        status.dirty();\n                    return executeRefinement(inner.value).then(() => {\n                        return { status: status.value, value: inner.value };\n                    });\n                });\n            }\n        }\n        if (effect.type === \"transform\") {\n            if (ctx.common.async === false) {\n                const base = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (!isValid(base))\n                    return INVALID;\n                const result = effect.transform(base.value, checkCtx);\n                if (result instanceof Promise) {\n                    throw new Error(`Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.`);\n                }\n                return { status: status.value, value: result };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((base) => {\n                    if (!isValid(base))\n                        return INVALID;\n                    return Promise.resolve(effect.transform(base.value, checkCtx)).then((result) => ({\n                        status: status.value,\n                        value: result,\n                    }));\n                });\n            }\n        }\n        util.assertNever(effect);\n    }\n}\nZodEffects.create = (schema, effect, params) => {\n    return new ZodEffects({\n        schema,\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        effect,\n        ...processCreateParams(params),\n    });\n};\nZodEffects.createWithPreprocess = (preprocess, schema, params) => {\n    return new ZodEffects({\n        schema,\n        effect: { type: \"preprocess\", transform: preprocess },\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        ...processCreateParams(params),\n    });\n};\nexport { ZodEffects as ZodTransformer };\nexport class ZodOptional extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.undefined) {\n            return OK(undefined);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodOptional.create = (type, params) => {\n    return new ZodOptional({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodOptional,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNullable extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.null) {\n            return OK(null);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodNullable.create = (type, params) => {\n    return new ZodNullable({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodNullable,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDefault extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        let data = ctx.data;\n        if (ctx.parsedType === ZodParsedType.undefined) {\n            data = this._def.defaultValue();\n        }\n        return this._def.innerType._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    removeDefault() {\n        return this._def.innerType;\n    }\n}\nZodDefault.create = (type, params) => {\n    return new ZodDefault({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodDefault,\n        defaultValue: typeof params.default === \"function\" ? params.default : () => params.default,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodCatch extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        // newCtx is used to not collect issues from inner types in ctx\n        const newCtx = {\n            ...ctx,\n            common: {\n                ...ctx.common,\n                issues: [],\n            },\n        };\n        const result = this._def.innerType._parse({\n            data: newCtx.data,\n            path: newCtx.path,\n            parent: {\n                ...newCtx,\n            },\n        });\n        if (isAsync(result)) {\n            return result.then((result) => {\n                return {\n                    status: \"valid\",\n                    value: result.status === \"valid\"\n                        ? result.value\n                        : this._def.catchValue({\n                            get error() {\n                                return new ZodError(newCtx.common.issues);\n                            },\n                            input: newCtx.data,\n                        }),\n                };\n            });\n        }\n        else {\n            return {\n                status: \"valid\",\n                value: result.status === \"valid\"\n                    ? result.value\n                    : this._def.catchValue({\n                        get error() {\n                            return new ZodError(newCtx.common.issues);\n                        },\n                        input: newCtx.data,\n                    }),\n            };\n        }\n    }\n    removeCatch() {\n        return this._def.innerType;\n    }\n}\nZodCatch.create = (type, params) => {\n    return new ZodCatch({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodCatch,\n        catchValue: typeof params.catch === \"function\" ? params.catch : () => params.catch,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNaN extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.nan) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.nan,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n}\nZodNaN.create = (params) => {\n    return new ZodNaN({\n        typeName: ZodFirstPartyTypeKind.ZodNaN,\n        ...processCreateParams(params),\n    });\n};\nexport const BRAND = Symbol(\"zod_brand\");\nexport class ZodBranded extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const data = ctx.data;\n        return this._def.type._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    unwrap() {\n        return this._def.type;\n    }\n}\nexport class ZodPipeline extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.common.async) {\n            const handleAsync = async () => {\n                const inResult = await this._def.in._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inResult.status === \"aborted\")\n                    return INVALID;\n                if (inResult.status === \"dirty\") {\n                    status.dirty();\n                    return DIRTY(inResult.value);\n                }\n                else {\n                    return this._def.out._parseAsync({\n                        data: inResult.value,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                }\n            };\n            return handleAsync();\n        }\n        else {\n            const inResult = this._def.in._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n            if (inResult.status === \"aborted\")\n                return INVALID;\n            if (inResult.status === \"dirty\") {\n                status.dirty();\n                return {\n                    status: \"dirty\",\n                    value: inResult.value,\n                };\n            }\n            else {\n                return this._def.out._parseSync({\n                    data: inResult.value,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n    }\n    static create(a, b) {\n        return new ZodPipeline({\n            in: a,\n            out: b,\n            typeName: ZodFirstPartyTypeKind.ZodPipeline,\n        });\n    }\n}\nexport class ZodReadonly extends ZodType {\n    _parse(input) {\n        const result = this._def.innerType._parse(input);\n        const freeze = (data) => {\n            if (isValid(data)) {\n                data.value = Object.freeze(data.value);\n            }\n            return data;\n        };\n        return isAsync(result) ? result.then((data) => freeze(data)) : freeze(result);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodReadonly.create = (type, params) => {\n    return new ZodReadonly({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodReadonly,\n        ...processCreateParams(params),\n    });\n};\n////////////////////////////////////////\n////////////////////////////////////////\n//////////                    //////////\n//////////      z.custom      //////////\n//////////                    //////////\n////////////////////////////////////////\n////////////////////////////////////////\nfunction cleanParams(params, data) {\n    const p = typeof params === \"function\" ? params(data) : typeof params === \"string\" ? { message: params } : params;\n    const p2 = typeof p === \"string\" ? { message: p } : p;\n    return p2;\n}\nexport function custom(check, _params = {}, \n/**\n * @deprecated\n *\n * Pass `fatal` into the params object instead:\n *\n * ```ts\n * z.string().custom((val) => val.length > 5, { fatal: false })\n * ```\n *\n */\nfatal) {\n    if (check)\n        return ZodAny.create().superRefine((data, ctx) => {\n            const r = check(data);\n            if (r instanceof Promise) {\n                return r.then((r) => {\n                    if (!r) {\n                        const params = cleanParams(_params, data);\n                        const _fatal = params.fatal ?? fatal ?? true;\n                        ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n                    }\n                });\n            }\n            if (!r) {\n                const params = cleanParams(_params, data);\n                const _fatal = params.fatal ?? fatal ?? true;\n                ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n            }\n            return;\n        });\n    return ZodAny.create();\n}\nexport { ZodType as Schema, ZodType as ZodSchema };\nexport const late = {\n    object: ZodObject.lazycreate,\n};\nexport var ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n    ZodFirstPartyTypeKind[\"ZodString\"] = \"ZodString\";\n    ZodFirstPartyTypeKind[\"ZodNumber\"] = \"ZodNumber\";\n    ZodFirstPartyTypeKind[\"ZodNaN\"] = \"ZodNaN\";\n    ZodFirstPartyTypeKind[\"ZodBigInt\"] = \"ZodBigInt\";\n    ZodFirstPartyTypeKind[\"ZodBoolean\"] = \"ZodBoolean\";\n    ZodFirstPartyTypeKind[\"ZodDate\"] = \"ZodDate\";\n    ZodFirstPartyTypeKind[\"ZodSymbol\"] = \"ZodSymbol\";\n    ZodFirstPartyTypeKind[\"ZodUndefined\"] = \"ZodUndefined\";\n    ZodFirstPartyTypeKind[\"ZodNull\"] = \"ZodNull\";\n    ZodFirstPartyTypeKind[\"ZodAny\"] = \"ZodAny\";\n    ZodFirstPartyTypeKind[\"ZodUnknown\"] = \"ZodUnknown\";\n    ZodFirstPartyTypeKind[\"ZodNever\"] = \"ZodNever\";\n    ZodFirstPartyTypeKind[\"ZodVoid\"] = \"ZodVoid\";\n    ZodFirstPartyTypeKind[\"ZodArray\"] = \"ZodArray\";\n    ZodFirstPartyTypeKind[\"ZodObject\"] = \"ZodObject\";\n    ZodFirstPartyTypeKind[\"ZodUnion\"] = \"ZodUnion\";\n    ZodFirstPartyTypeKind[\"ZodDiscriminatedUnion\"] = \"ZodDiscriminatedUnion\";\n    ZodFirstPartyTypeKind[\"ZodIntersection\"] = \"ZodIntersection\";\n    ZodFirstPartyTypeKind[\"ZodTuple\"] = \"ZodTuple\";\n    ZodFirstPartyTypeKind[\"ZodRecord\"] = \"ZodRecord\";\n    ZodFirstPartyTypeKind[\"ZodMap\"] = \"ZodMap\";\n    ZodFirstPartyTypeKind[\"ZodSet\"] = \"ZodSet\";\n    ZodFirstPartyTypeKind[\"ZodFunction\"] = \"ZodFunction\";\n    ZodFirstPartyTypeKind[\"ZodLazy\"] = \"ZodLazy\";\n    ZodFirstPartyTypeKind[\"ZodLiteral\"] = \"ZodLiteral\";\n    ZodFirstPartyTypeKind[\"ZodEnum\"] = \"ZodEnum\";\n    ZodFirstPartyTypeKind[\"ZodEffects\"] = \"ZodEffects\";\n    ZodFirstPartyTypeKind[\"ZodNativeEnum\"] = \"ZodNativeEnum\";\n    ZodFirstPartyTypeKind[\"ZodOptional\"] = \"ZodOptional\";\n    ZodFirstPartyTypeKind[\"ZodNullable\"] = \"ZodNullable\";\n    ZodFirstPartyTypeKind[\"ZodDefault\"] = \"ZodDefault\";\n    ZodFirstPartyTypeKind[\"ZodCatch\"] = \"ZodCatch\";\n    ZodFirstPartyTypeKind[\"ZodPromise\"] = \"ZodPromise\";\n    ZodFirstPartyTypeKind[\"ZodBranded\"] = \"ZodBranded\";\n    ZodFirstPartyTypeKind[\"ZodPipeline\"] = \"ZodPipeline\";\n    ZodFirstPartyTypeKind[\"ZodReadonly\"] = \"ZodReadonly\";\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\n// requires TS 4.4+\nclass Class {\n    constructor(..._) { }\n}\nconst instanceOfType = (\n// const instanceOfType = <T extends new (...args: any[]) => any>(\ncls, params = {\n    message: `Input not instance of ${cls.name}`,\n}) => custom((data) => data instanceof cls, params);\nconst stringType = ZodString.create;\nconst numberType = ZodNumber.create;\nconst nanType = ZodNaN.create;\nconst bigIntType = ZodBigInt.create;\nconst booleanType = ZodBoolean.create;\nconst dateType = ZodDate.create;\nconst symbolType = ZodSymbol.create;\nconst undefinedType = ZodUndefined.create;\nconst nullType = ZodNull.create;\nconst anyType = ZodAny.create;\nconst unknownType = ZodUnknown.create;\nconst neverType = ZodNever.create;\nconst voidType = ZodVoid.create;\nconst arrayType = ZodArray.create;\nconst objectType = ZodObject.create;\nconst strictObjectType = ZodObject.strictCreate;\nconst unionType = ZodUnion.create;\nconst discriminatedUnionType = ZodDiscriminatedUnion.create;\nconst intersectionType = ZodIntersection.create;\nconst tupleType = ZodTuple.create;\nconst recordType = ZodRecord.create;\nconst mapType = ZodMap.create;\nconst setType = ZodSet.create;\nconst functionType = ZodFunction.create;\nconst lazyType = ZodLazy.create;\nconst literalType = ZodLiteral.create;\nconst enumType = ZodEnum.create;\nconst nativeEnumType = ZodNativeEnum.create;\nconst promiseType = ZodPromise.create;\nconst effectsType = ZodEffects.create;\nconst optionalType = ZodOptional.create;\nconst nullableType = ZodNullable.create;\nconst preprocessType = ZodEffects.createWithPreprocess;\nconst pipelineType = ZodPipeline.create;\nconst ostring = () => stringType().optional();\nconst onumber = () => numberType().optional();\nconst oboolean = () => booleanType().optional();\nexport const coerce = {\n    string: ((arg) => ZodString.create({ ...arg, coerce: true })),\n    number: ((arg) => ZodNumber.create({ ...arg, coerce: true })),\n    boolean: ((arg) => ZodBoolean.create({\n        ...arg,\n        coerce: true,\n    })),\n    bigint: ((arg) => ZodBigInt.create({ ...arg, coerce: true })),\n    date: ((arg) => ZodDate.create({ ...arg, coerce: true })),\n};\nexport { anyType as any, arrayType as array, bigIntType as bigint, booleanType as boolean, dateType as date, discriminatedUnionType as discriminatedUnion, effectsType as effect, enumType as enum, functionType as function, instanceOfType as instanceof, intersectionType as intersection, lazyType as lazy, literalType as literal, mapType as map, nanType as nan, nativeEnumType as nativeEnum, neverType as never, nullType as null, nullableType as nullable, numberType as number, objectType as object, oboolean, onumber, optionalType as optional, ostring, pipelineType as pipeline, preprocessType as preprocess, promiseType as promise, recordType as record, setType as set, strictObjectType as strictObject, stringType as string, symbolType as symbol, effectsType as transformer, tupleType as tuple, undefinedType as undefined, unionType as union, unknownType as unknown, voidType as void, };\nexport const NEVER = INVALID;\n", "type Timeslot = {\n  date: string;\n  start_time: string;\n  end_time: string;\n  available: boolean;\n  providers?: string[];\n  price?: number;\n  price_adjustment?: unknown;\n};\n\nconst toMinutes = (value: string): number => {\n  const [hRaw, mRaw] = value.split(':');\n  const h = Number(hRaw);\n  const m = Number(mRaw ?? 0);\n  return h * 60 + m;\n};\n\nconst fromMinutes = (total: number): string => {\n  const hours = Math.floor(total / 60);\n  const minutes = total % 60;\n  return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;\n};\n\ntype Provider = { id: string };\ntype WeeklyHour = { team_member_id: string; day_of_week: number; start_time: string; end_time: string };\ntype DateOverride = { team_member_id: string; is_available: number; start_time: string | null; end_time: string | null };\n\nconst slotFitsWindow = (slotStartMin: number, slotEndMin: number, startTime: string, endTime: string): boolean => {\n  const startMin = toMinutes(startTime);\n  const endMin = toMinutes(endTime);\n  return slotStartMin >= startMin && slotEndMin <= endMin;\n};\n\nexport async function generateTimeslots(\n  db: D1Database,\n  territoryId: string,\n  date: string,\n  durationMinutes: number,\n  requiredProviderCount: number,\n  requiredSkills: string[]\n): Promise<Timeslot[]> {\n  const providerRows = await db.prepare(\n    `SELECT tm.id\n     FROM team_members tm\n     JOIN team_member_territories tmt ON tmt.team_member_id = tm.id\n     WHERE tmt.territory_id = ?\n       AND tm.role = 'provider'\n       AND tm.is_active = 1\n       AND tm.can_be_auto_assigned = 1`\n  ).bind(territoryId).all<Provider>();\n\n  let providers = providerRows.results || [];\n\n  if (requiredSkills.length > 0 && providers.length > 0) {\n    const placeholders = requiredSkills.map(() => '?').join(', ');\n    const skillRows = await db.prepare(\n      `SELECT tms.team_member_id, COUNT(DISTINCT tms.skill_id) AS matched_skill_count\n       FROM team_member_skills tms\n       WHERE tms.team_member_id IN (${providers.map(() => '?').join(', ')})\n         AND tms.skill_id IN (${placeholders})\n       GROUP BY tms.team_member_id`\n    ).bind(...providers.map((p) => p.id), ...requiredSkills).all<{ team_member_id: string; matched_skill_count: number }>();\n\n    const qualified = new Set(\n      (skillRows.results || [])\n        .filter((row) => Number(row.matched_skill_count) >= requiredSkills.length)\n        .map((row) => row.team_member_id)\n    );\n    providers = providers.filter((provider) => qualified.has(provider.id));\n  }\n\n  if (providers.length === 0) {\n    const emptySlots: Timeslot[] = [];\n    for (let hour = 8; hour <= 17; hour++) {\n      const start = `${String(hour).padStart(2, '0')}:00`;\n      const end = fromMinutes(hour * 60 + durationMinutes);\n      emptySlots.push({ date, start_time: start, end_time: end, available: false });\n    }\n    return emptySlots;\n  }\n\n  const providerIds = providers.map((provider) => provider.id);\n  const dayOfWeek = new Date(`${date}T00:00:00`).getDay();\n  const weeklyPlaceholders = providerIds.map(() => '?').join(', ');\n\n  const [weeklyRows, overrideRows] = await Promise.all([\n    db.prepare(\n      `SELECT team_member_id, day_of_week, start_time, end_time\n       FROM provider_weekly_hours\n       WHERE team_member_id IN (${weeklyPlaceholders})\n         AND day_of_week = ?`\n    ).bind(...providerIds, dayOfWeek).all<WeeklyHour>(),\n    db.prepare(\n      `SELECT team_member_id, is_available, start_time, end_time\n       FROM provider_date_overrides\n       WHERE team_member_id IN (${weeklyPlaceholders})\n         AND date = ?`\n    ).bind(...providerIds, date).all<DateOverride>(),\n  ]);\n\n  const weeklyByProvider = new Map<string, WeeklyHour[]>();\n  for (const row of weeklyRows.results || []) {\n    const list = weeklyByProvider.get(row.team_member_id) || [];\n    list.push(row);\n    weeklyByProvider.set(row.team_member_id, list);\n  }\n\n  const overrideByProvider = new Map<string, DateOverride>();\n  for (const row of overrideRows.results || []) {\n    overrideByProvider.set(row.team_member_id, row);\n  }\n\n  const slots: Timeslot[] = [];\n\n  for (let hour = 8; hour <= 17; hour++) {\n    const slotStart = hour * 60;\n    const slotEnd = slotStart + durationMinutes;\n    const availableProviderIds: string[] = [];\n\n    for (const provider of providers) {\n      const override = overrideByProvider.get(provider.id);\n      let available = false;\n\n      if (override) {\n        if (override.is_available === 0) {\n          available = false;\n        } else if (override.start_time && override.end_time) {\n          available = slotFitsWindow(slotStart, slotEnd, override.start_time, override.end_time);\n        } else {\n          available = true;\n        }\n      } else {\n        const weeklyWindows = weeklyByProvider.get(provider.id) || [];\n        available = weeklyWindows.some((window) => slotFitsWindow(slotStart, slotEnd, window.start_time, window.end_time));\n      }\n\n      if (available) {\n        availableProviderIds.push(provider.id);\n      }\n    }\n\n    const start_time = fromMinutes(slotStart);\n    const end_time = fromMinutes(slotEnd);\n    const isAvailable = availableProviderIds.length >= requiredProviderCount;\n\n    slots.push({\n      date,\n      start_time,\n      end_time,\n      available: isAvailable,\n      providers: isAvailable ? availableProviderIds.slice(0, requiredProviderCount) : undefined,\n    });\n  }\n\n  return slots;\n}\n", "import { Hono } from 'hono';\nimport { zValidator } from '@hono/zod-validator';\nimport { z } from 'zod';\nimport { checkServiceArea } from '../geo/service-area';\nimport { generateTimeslots } from '../scheduling/timeslots';\nimport { calculateAdjustedPrice } from '../scheduling/pricing';\n\nconst serviceAreaSchema = z.object({\n  postal_code: z.string().optional(),\n  lat: z.coerce.number().optional(),\n  lng: z.coerce.number().optional(),\n  address: z.string().optional()\n});\n\nconst timeslotSchema = z.object({\n  territory_id: z.string(),\n  date_from: z.string(),\n  date_to: z.string(),\n  duration_minutes: z.coerce.number(),\n  service_id: z.string().optional()\n});\n\nconst app = new Hono<{ Bindings: { DB: D1Database; MAPBOX_ACCESS_TOKEN?: string } }>();\n\napp.get('/service_area_check', zValidator('query', serviceAreaSchema), async (c) => {\n  try {\n    const db = c.env?.DB;\n    if (!db) {\n      return c.json({ error: 'Database not available' }, 500);\n    }\n    const { postal_code, lat, lng } = c.req.valid('query');\n\n    let resolvedLat = lat;\n    let resolvedLng = lng;\n    let resolvedCity: string | undefined;\n    let resolvedProvince: string | undefined;\n\n    if (postal_code && (resolvedLat === undefined || resolvedLng === undefined)) {\n      const token = c.env?.MAPBOX_ACCESS_TOKEN;\n      if (token) {\n        try {\n          const res = await fetch(\n            `https://api.mapbox.com/search/geocode/v6/forward?q=${encodeURIComponent(postal_code)}&country=ca&types=postcode,place&limit=1&access_token=${token}`\n          );\n          if (res.ok) {\n            const data = await res.json() as {\n              features?: Array<{\n                geometry: { coordinates: [number, number] };\n                properties: { context?: { place?: { name?: string }; region?: { region_code?: string }; postcode?: { name?: string } } };\n              }>;\n            };\n            if (data.features && data.features.length > 0) {\n              const f = data.features[0];\n              resolvedLng = f.geometry.coordinates[0];\n              resolvedLat = f.geometry.coordinates[1];\n              const ctx = f.properties.context || {};\n              resolvedCity = ctx.place?.name;\n              resolvedProvince = ctx.region?.region_code;\n            }\n          }\n        } catch {}\n      }\n    }\n\n    const territories = await db.prepare('SELECT * FROM territories WHERE is_active = 1').all<{\n      id: string;\n      name: string;\n      service_area_type: string;\n      service_area_data: string;\n    }>();\n\n    let matchingTerritory = null;\n    let closestTerritory = null;\n    let minDistance = Infinity;\n    const postalCodeBufferKm = 5;\n\n    for (const territory of territories.results || []) {\n      const result = checkServiceArea(\n        territory.service_area_type,\n        territory.service_area_data,\n        { postalCode: postal_code, lat: resolvedLat, lng: resolvedLng },\n        postalCodeBufferKm\n      );\n\n      if (result.within) {\n        matchingTerritory = territory;\n        break;\n      }\n\n      if (result.distance !== undefined && result.distance < minDistance) {\n        minDistance = result.distance;\n        closestTerritory = territory;\n      }\n    }\n\n    return c.json({\n      within_service_area: matchingTerritory !== null,\n      territory: matchingTerritory,\n      closest_territory: !matchingTerritory ? closestTerritory : null,\n      distance_km: !matchingTerritory && minDistance !== Infinity ? Math.round(minDistance * 100) / 100 : null,\n      resolved_city: resolvedCity || null,\n      resolved_province: resolvedProvince || null,\n      resolved_lat: resolvedLat ?? null,\n      resolved_lng: resolvedLng ?? null\n    });\n  } catch (error) {\n    console.error('Service area check error:', error);\n    return c.json({ error: 'Service area check failed' }, 500);\n  }\n});\n\napp.get('/timeslots', zValidator('query', timeslotSchema), async (c) => {\n  try {\n    const db = c.env?.DB;\n    if (!db) {\n      return c.json({ error: 'Database not available' }, 500);\n    }\n    const { territory_id, date_from, date_to, duration_minutes, service_id } = c.req.valid('query');\n\n    let requiredProviderCount = 1;\n    let requiredSkills: string[] = [];\n    let serviceBasePrice = 0;\n\n    if (service_id) {\n      const service = await db.prepare(`\n        SELECT required_provider_count, base_price_cents FROM services WHERE id = ?\n      `).bind(service_id).first<{ required_provider_count: number; base_price_cents: number }>();\n\n      if (service) {\n        requiredProviderCount = service.required_provider_count;\n        serviceBasePrice = service.base_price_cents;\n      }\n\n      const skills = await db.prepare(`\n        SELECT skill_id FROM service_required_skills WHERE service_id = ?\n      `).bind(service_id).all<{ skill_id: string }>();\n\n      requiredSkills = (skills.results || []).map(s => s.skill_id);\n    }\n\n    let hasAdjustmentRules = false;\n    if (service_id && serviceBasePrice > 0) {\n      const ruleCount = await db.prepare(\n        'SELECT COUNT(*) as cnt FROM price_adjustment_rules WHERE is_active = 1 AND (service_id = ? OR service_id IS NULL)'\n      ).bind(service_id).first<{ cnt: number }>();\n      hasAdjustmentRules = (ruleCount?.cnt || 0) > 0;\n    }\n\n    const allTimeslots = [];\n    const startDate = new Date(date_from);\n    const endDate = new Date(date_to);\n\n    for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {\n      const dateStr = d.toISOString().split('T')[0];\n      const timeslots = await generateTimeslots(\n        db,\n        territory_id,\n        dateStr,\n        duration_minutes,\n        requiredProviderCount,\n        requiredSkills\n      );\n\n      for (const slot of timeslots) {\n        if (slot.available) {\n          slot.price = serviceBasePrice;\n        }\n      }\n\n      if (service_id && serviceBasePrice > 0 && hasAdjustmentRules) {\n        for (const slot of timeslots) {\n          if (slot.available) {\n            const pricing = await calculateAdjustedPrice(\n              db,\n              service_id,\n              serviceBasePrice,\n              territory_id,\n              dateStr,\n              slot.start_time\n            );\n            slot.price = pricing.total_price;\n            slot.price_adjustment = pricing.rule_adjustments;\n          }\n        }\n      }\n\n      allTimeslots.push(...timeslots);\n    }\n\n    return c.json({ timeslots: allTimeslots });\n  } catch (error) {\n    console.error('Timeslots error:', error);\n    return c.json({ error: 'Timeslots query failed' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asArray = (value: unknown): string[] => {\n  if (Array.isArray(value)) return value.map((v) => String(v));\n  if (typeof value === 'string' && value) return [value];\n  return [];\n};\n\napp.get('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const territoryId = c.req.query('territory_id');\n    const active = c.req.query('active');\n\n    let sql = `SELECT s.*, sc.name as category_name\n               FROM services s\n               LEFT JOIN service_categories sc ON sc.id = s.category_id`;\n    const clauses: string[] = [];\n    const params: unknown[] = [];\n\n    if (territoryId) {\n      sql += ' JOIN territory_services ts ON ts.service_id = s.id';\n      clauses.push('ts.territory_id = ?');\n      params.push(territoryId);\n    }\n    if (active !== undefined) {\n      clauses.push('s.is_active = ?');\n      params.push(active === 'true' ? 1 : 0);\n    }\n    if (clauses.length) sql += ` WHERE ${clauses.join(' AND ')}`;\n    sql += ' ORDER BY s.name';\n\n    const servicesRes = await (params.length ? db.prepare(sql).bind(...params) : db.prepare(sql)).all();\n    const serviceIds = (servicesRes.results || []).map((row) => row.id as string);\n\n    if (serviceIds.length === 0) return c.json({ services: [] });\n\n    const placeholders = serviceIds.map(() => '?').join(', ');\n    const [modifiersRes, skillsRes] = await Promise.all([\n      db.prepare(`SELECT * FROM service_modifiers WHERE service_id IN (${placeholders}) ORDER BY sort_order, name`).bind(...serviceIds).all(),\n      db.prepare(\n        `SELECT srs.service_id, sk.id, sk.name, sk.description\n         FROM service_required_skills srs\n         JOIN skills sk ON sk.id = srs.skill_id\n         WHERE srs.service_id IN (${placeholders})`\n      ).bind(...serviceIds).all(),\n    ]);\n\n    const modifiersByService = new Map<string, unknown[]>();\n    for (const row of modifiersRes.results || []) {\n      const key = row.service_id as string;\n      const list = modifiersByService.get(key) || [];\n      list.push(row);\n      modifiersByService.set(key, list);\n    }\n\n    const skillsByService = new Map<string, unknown[]>();\n    for (const row of skillsRes.results || []) {\n      const key = row.service_id as string;\n      const list = skillsByService.get(key) || [];\n      list.push({ id: row.id, name: row.name, description: row.description });\n      skillsByService.set(key, list);\n    }\n\n    return c.json({\n      services: (servicesRes.results || []).map((row) => ({\n        ...row,\n        modifiers: modifiersByService.get(row.id as string) || [],\n        required_skills: skillsByService.get(row.id as string) || [],\n      })),\n    });\n  } catch (error) {\n    console.error('services list error', error);\n    return c.json({ error: 'Failed to list services' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const service = await db.prepare(\n      `SELECT s.*, sc.name as category_name\n       FROM services s\n       LEFT JOIN service_categories sc ON sc.id = s.category_id\n       WHERE s.id = ?`\n    ).bind(id).first();\n    if (!service) return c.json({ error: 'Not found' }, 404);\n\n    const [modifiers, skills] = await Promise.all([\n      db.prepare('SELECT * FROM service_modifiers WHERE service_id = ? ORDER BY sort_order, name').bind(id).all(),\n      db.prepare(\n        `SELECT sk.id, sk.name, sk.description\n         FROM service_required_skills srs\n         JOIN skills sk ON sk.id = srs.skill_id\n         WHERE srs.service_id = ?`\n      ).bind(id).all(),\n    ]);\n\n    return c.json({\n      ...service,\n      modifiers: modifiers.results || [],\n      required_skills: skills.results || [],\n    });\n  } catch (error) {\n    console.error('services get error', error);\n    return c.json({ error: 'Failed to get service' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    const skillIds = asArray(body.required_skill_ids);\n\n    await db.prepare(\n      `INSERT INTO services\n       (id, name, description, category_id, base_price_cents, base_duration_minutes, required_provider_count, auto_assign_enabled, auto_assign_method, is_active, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.name,\n      body.description || null,\n      body.category_id || null,\n      body.base_price_cents || 0,\n      body.base_duration_minutes || 60,\n      body.required_provider_count || 1,\n      body.auto_assign_enabled ? 1 : 0,\n      body.auto_assign_method || 'balanced',\n      body.is_active === false ? 0 : 1\n    ).run();\n\n    for (const skillId of skillIds) {\n      await db.prepare('INSERT INTO service_required_skills (service_id, skill_id) VALUES (?, ?)').bind(id, skillId).run();\n    }\n\n    const created = await db.prepare('SELECT * FROM services WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('services create error', error);\n    return c.json({ error: 'Failed to create service' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n\n    const allowed = [\n      'name',\n      'description',\n      'category_id',\n      'base_price_cents',\n      'base_duration_minutes',\n      'required_provider_count',\n      'auto_assign_enabled',\n      'auto_assign_method',\n      'is_active',\n    ];\n\n    for (const key of allowed) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        if (key === 'auto_assign_enabled' || key === 'is_active') {\n          values.push(body[key] ? 1 : 0);\n        } else {\n          values.push(body[key]);\n        }\n      }\n    }\n\n    if (fields.length > 0) {\n      fields.push(\"updated_at = datetime('now')\");\n      values.push(id);\n      await db.prepare(`UPDATE services SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    }\n\n    if (body.required_skill_ids !== undefined) {\n      await db.prepare('DELETE FROM service_required_skills WHERE service_id = ?').bind(id).run();\n      for (const skillId of asArray(body.required_skill_ids)) {\n        await db.prepare('INSERT INTO service_required_skills (service_id, skill_id) VALUES (?, ?)').bind(id, skillId).run();\n      }\n    }\n\n    const updated = await db.prepare('SELECT * FROM services WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('services patch error', error);\n    return c.json({ error: 'Failed to update service' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    await db.prepare('DELETE FROM service_required_skills WHERE service_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM service_modifiers WHERE service_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM territory_services WHERE service_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM services WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('services delete error', error);\n    return c.json({ error: 'Failed to delete service' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const skills = await c.env.DB.prepare('SELECT * FROM skills ORDER BY name').all();\n    return c.json({ skills: skills.results || [] });\n  } catch (error) {\n    console.error('skills list error', error);\n    return c.json({ error: 'Failed to list skills' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const skill = await c.env.DB.prepare('SELECT * FROM skills WHERE id = ?').bind(c.req.param('id')).first();\n    if (!skill) return c.json({ error: 'Not found' }, 404);\n    return c.json(skill);\n  } catch (error) {\n    console.error('skills get error', error);\n    return c.json({ error: 'Failed to get skill' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO skills (id, name, description, created_at)\n       VALUES (?, ?, ?, datetime('now'))`\n    ).bind(id, body.name, body.description || null).run();\n    const created = await c.env.DB.prepare('SELECT * FROM skills WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('skills create error', error);\n    return c.json({ error: 'Failed to create skill' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    if (body.name !== undefined) {\n      fields.push('name = ?');\n      values.push(body.name);\n    }\n    if (body.description !== undefined) {\n      fields.push('description = ?');\n      values.push(body.description);\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE skills SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM skills WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('skills patch error', error);\n    return c.json({ error: 'Failed to update skill' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    await c.env.DB.prepare('DELETE FROM service_required_skills WHERE skill_id = ?').bind(id).run();\n    await c.env.DB.prepare('DELETE FROM team_member_skills WHERE skill_id = ?').bind(id).run();\n    await c.env.DB.prepare('DELETE FROM skills WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('skills delete error', error);\n    return c.json({ error: 'Failed to delete skill' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asStringArray = (value: unknown): string[] => {\n  if (Array.isArray(value)) return value.map((v) => String(v));\n  if (typeof value === 'string' && value) return [value];\n  return [];\n};\n\nconst asObjectArray = (value: unknown): Array<Record<string, unknown>> => {\n  if (Array.isArray(value)) return value.filter((v): v is Record<string, unknown> => Boolean(v && typeof v === 'object'));\n  return [];\n};\n\napp.get('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const team = await db.prepare('SELECT * FROM team_members ORDER BY last_name, first_name').all();\n    const ids = (team.results || []).map((m) => m.id as string);\n    if (ids.length === 0) return c.json({ team_members: [] });\n\n    const placeholders = ids.map(() => '?').join(', ');\n    const [hoursRes, skillsRes, territoriesRes] = await Promise.all([\n      db.prepare(`SELECT * FROM provider_weekly_hours WHERE team_member_id IN (${placeholders}) ORDER BY day_of_week`).bind(...ids).all(),\n      db.prepare(\n        `SELECT tms.team_member_id, sk.id, sk.name\n         FROM team_member_skills tms\n         JOIN skills sk ON sk.id = tms.skill_id\n         WHERE tms.team_member_id IN (${placeholders})`\n      ).bind(...ids).all(),\n      db.prepare(\n        `SELECT tmt.team_member_id, t.id, t.name\n         FROM team_member_territories tmt\n         JOIN territories t ON t.id = tmt.territory_id\n         WHERE tmt.team_member_id IN (${placeholders})`\n      ).bind(...ids).all(),\n    ]);\n\n    const byMember = <T extends Record<string, unknown>>(rows: T[], key: string): Map<string, T[]> => {\n      const map = new Map<string, T[]>();\n      for (const row of rows) {\n        const id = String(row[key]);\n        const list = map.get(id) || [];\n        list.push(row);\n        map.set(id, list);\n      }\n      return map;\n    };\n\n    const hoursMap = byMember(hoursRes.results || [], 'team_member_id');\n    const skillsMap = byMember(skillsRes.results || [], 'team_member_id');\n    const territoriesMap = byMember(territoriesRes.results || [], 'team_member_id');\n\n    return c.json({\n      team_members: (team.results || []).map((member) => ({\n        ...member,\n        provider_weekly_hours: hoursMap.get(member.id as string) || [],\n        skills: (skillsMap.get(member.id as string) || []).map((row) => ({ id: row.id, name: row.name })),\n        territories: (territoriesMap.get(member.id as string) || []).map((row) => ({ id: row.id, name: row.name })),\n      })),\n    });\n  } catch (error) {\n    console.error('team list error', error);\n    return c.json({ error: 'Failed to list team members' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const member = await db.prepare('SELECT * FROM team_members WHERE id = ?').bind(id).first();\n    if (!member) return c.json({ error: 'Not found' }, 404);\n\n    const [hours, skills, territories] = await Promise.all([\n      db.prepare('SELECT * FROM provider_weekly_hours WHERE team_member_id = ? ORDER BY day_of_week').bind(id).all(),\n      db.prepare(\n        `SELECT sk.id, sk.name\n         FROM team_member_skills tms\n         JOIN skills sk ON sk.id = tms.skill_id\n         WHERE tms.team_member_id = ?`\n      ).bind(id).all(),\n      db.prepare(\n        `SELECT t.id, t.name\n         FROM team_member_territories tmt\n         JOIN territories t ON t.id = tmt.territory_id\n         WHERE tmt.team_member_id = ?`\n      ).bind(id).all(),\n    ]);\n\n    return c.json({\n      ...member,\n      provider_weekly_hours: hours.results || [],\n      skills: skills.results || [],\n      territories: territories.results || [],\n    });\n  } catch (error) {\n    console.error('team get error', error);\n    return c.json({ error: 'Failed to get team member' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n\n    await db.prepare(\n      `INSERT INTO team_members\n       (id, first_name, last_name, email, phone, role, is_active, can_be_auto_assigned, can_edit_availability, auto_assign_priority, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.first_name,\n      body.last_name,\n      body.email,\n      body.phone || null,\n      body.role || 'provider',\n      body.is_active === false ? 0 : 1,\n      body.can_be_auto_assigned === false ? 0 : 1,\n      body.can_edit_availability ? 1 : 0,\n      body.auto_assign_priority || 100\n    ).run();\n\n    for (const skillId of asStringArray(body.skill_ids)) {\n      await db.prepare('INSERT INTO team_member_skills (team_member_id, skill_id) VALUES (?, ?)').bind(id, skillId).run();\n    }\n    for (const territoryId of asStringArray(body.territory_ids)) {\n      await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(id, territoryId).run();\n    }\n    for (const hour of asObjectArray(body.provider_weekly_hours)) {\n      await db.prepare(\n        `INSERT INTO provider_weekly_hours (id, team_member_id, day_of_week, start_time, end_time)\n         VALUES (?, ?, ?, ?, ?)`\n      ).bind(crypto.randomUUID(), id, hour.day_of_week, hour.start_time, hour.end_time).run();\n    }\n\n    const created = await db.prepare('SELECT * FROM team_members WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('team create error', error);\n    return c.json({ error: 'Failed to create team member' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n\n    const updatable = [\n      'first_name',\n      'last_name',\n      'email',\n      'phone',\n      'role',\n      'is_active',\n      'can_be_auto_assigned',\n      'can_edit_availability',\n      'auto_assign_priority',\n    ];\n\n    for (const key of updatable) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        if (['is_active', 'can_be_auto_assigned', 'can_edit_availability'].includes(key)) {\n          values.push(body[key] ? 1 : 0);\n        } else {\n          values.push(body[key]);\n        }\n      }\n    }\n\n    if (fields.length > 0) {\n      fields.push(\"updated_at = datetime('now')\");\n      values.push(id);\n      await db.prepare(`UPDATE team_members SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    }\n\n    if (body.skill_ids !== undefined) {\n      await db.prepare('DELETE FROM team_member_skills WHERE team_member_id = ?').bind(id).run();\n      for (const skillId of asStringArray(body.skill_ids)) {\n        await db.prepare('INSERT INTO team_member_skills (team_member_id, skill_id) VALUES (?, ?)').bind(id, skillId).run();\n      }\n    }\n\n    if (body.territory_ids !== undefined) {\n      await db.prepare('DELETE FROM team_member_territories WHERE team_member_id = ?').bind(id).run();\n      for (const territoryId of asStringArray(body.territory_ids)) {\n        await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(id, territoryId).run();\n      }\n    }\n\n    if (body.provider_weekly_hours !== undefined) {\n      await db.prepare('DELETE FROM provider_weekly_hours WHERE team_member_id = ?').bind(id).run();\n      for (const hour of asObjectArray(body.provider_weekly_hours)) {\n        await db.prepare(\n          `INSERT INTO provider_weekly_hours (id, team_member_id, day_of_week, start_time, end_time)\n           VALUES (?, ?, ?, ?, ?)`\n        ).bind(crypto.randomUUID(), id, hour.day_of_week, hour.start_time, hour.end_time).run();\n      }\n    }\n\n    const updated = await db.prepare('SELECT * FROM team_members WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('team patch error', error);\n    return c.json({ error: 'Failed to update team member' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    await db.prepare('DELETE FROM provider_weekly_hours WHERE team_member_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM provider_date_overrides WHERE team_member_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM team_member_skills WHERE team_member_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM team_member_territories WHERE team_member_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM team_members WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('team delete error', error);\n    return c.json({ error: 'Failed to delete team member' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst asArray = (value: unknown): string[] => {\n  if (Array.isArray(value)) return value.map((v) => String(v));\n  if (typeof value === 'string' && value) return [value];\n  return [];\n};\n\napp.get('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const active = c.req.query('active');\n    const clauses: string[] = [];\n    const params: unknown[] = [];\n\n    if (active !== undefined) {\n      clauses.push('t.is_active = ?');\n      params.push(active === 'true' ? 1 : 0);\n    }\n\n    const sql = `SELECT * FROM territories t ${clauses.length ? `WHERE ${clauses.join(' AND ')}` : ''} ORDER BY t.name`;\n    const territories = await (params.length ? c.env.DB.prepare(sql).bind(...params) : c.env.DB.prepare(sql)).all();\n\n    const ids = (territories.results || []).map((row) => row.id as string);\n    if (ids.length === 0) return c.json({ territories: [] });\n\n    const placeholders = ids.map(() => '?').join(', ');\n    const [serviceRows, providerRows] = await Promise.all([\n      db.prepare(\n        `SELECT ts.territory_id, s.id as service_id, s.name\n         FROM territory_services ts\n         JOIN services s ON s.id = ts.service_id\n         WHERE ts.territory_id IN (${placeholders})`\n      ).bind(...ids).all<{ territory_id: string; service_id: string; name: string }>(),\n      db.prepare(\n        `SELECT tmt.territory_id, tm.id as team_member_id, tm.first_name, tm.last_name\n         FROM team_member_territories tmt\n         JOIN team_members tm ON tm.id = tmt.team_member_id\n         WHERE tmt.territory_id IN (${placeholders})`\n      ).bind(...ids).all<{ territory_id: string; team_member_id: string; first_name: string; last_name: string }>(),\n    ]);\n\n    const servicesByTerritory = new Map<string, Array<Record<string, unknown>>>();\n    for (const row of serviceRows.results || []) {\n      const list = servicesByTerritory.get(row.territory_id) || [];\n      list.push({ id: row.service_id, name: row.name });\n      servicesByTerritory.set(row.territory_id, list);\n    }\n\n    const providersByTerritory = new Map<string, Array<Record<string, unknown>>>();\n    for (const row of providerRows.results || []) {\n      const list = providersByTerritory.get(row.territory_id) || [];\n      list.push({ id: row.team_member_id, first_name: row.first_name, last_name: row.last_name });\n      providersByTerritory.set(row.territory_id, list);\n    }\n\n    return c.json({\n      territories: (territories.results || []).map((row) => ({\n        ...row,\n        territory_services: servicesByTerritory.get(row.id as string) || [],\n        team_member_territories: providersByTerritory.get(row.id as string) || [],\n      })),\n    });\n  } catch (error) {\n    console.error('territories list error', error);\n    return c.json({ error: 'Failed to list territories' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const territory = await db.prepare('SELECT * FROM territories WHERE id = ?').bind(id).first();\n    if (!territory) return c.json({ error: 'Not found' }, 404);\n\n    const [services, providers] = await Promise.all([\n      db.prepare(\n        `SELECT s.id, s.name\n         FROM territory_services ts\n         JOIN services s ON s.id = ts.service_id\n         WHERE ts.territory_id = ?`\n      ).bind(id).all(),\n      db.prepare(\n        `SELECT tm.id, tm.first_name, tm.last_name\n         FROM team_member_territories tmt\n         JOIN team_members tm ON tm.id = tmt.team_member_id\n         WHERE tmt.territory_id = ?`\n      ).bind(id).all(),\n    ]);\n\n    return c.json({\n      ...territory,\n      territory_services: services.results || [],\n      team_member_territories: providers.results || [],\n    });\n  } catch (error) {\n    console.error('territories get error', error);\n    return c.json({ error: 'Failed to get territory' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const db = c.env.DB;\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    const serviceIds = asArray(body.service_ids);\n    const providerIds = asArray(body.provider_ids);\n\n    await db.prepare(\n      `INSERT INTO territories\n       (id, name, timezone, service_area_type, service_area_data, operating_hours, scheduling_policy, max_concurrent_jobs, is_active, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.name,\n      body.timezone || 'America/Toronto',\n      body.service_area_type || 'zip',\n      body.service_area_data || '{}',\n      body.operating_hours || '{}',\n      body.scheduling_policy || 'provider_based',\n      body.max_concurrent_jobs ?? null,\n      body.is_active === false ? 0 : 1\n    ).run();\n\n    for (const serviceId of serviceIds) {\n      await db.prepare('INSERT INTO territory_services (territory_id, service_id) VALUES (?, ?)').bind(id, serviceId).run();\n    }\n    for (const providerId of providerIds) {\n      await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(providerId, id).run();\n    }\n\n    const created = await db.prepare('SELECT * FROM territories WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('territories create error', error);\n    return c.json({ error: 'Failed to create territory' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n\n    const updatable = [\n      'name',\n      'timezone',\n      'service_area_type',\n      'service_area_data',\n      'operating_hours',\n      'scheduling_policy',\n      'max_concurrent_jobs',\n      'is_active',\n    ];\n\n    for (const key of updatable) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(key === 'is_active' ? (body[key] ? 1 : 0) : body[key]);\n      }\n    }\n\n    if (fields.length > 0) {\n      fields.push(\"updated_at = datetime('now')\");\n      values.push(id);\n      await db.prepare(`UPDATE territories SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    }\n\n    if (body.service_ids !== undefined) {\n      await db.prepare('DELETE FROM territory_services WHERE territory_id = ?').bind(id).run();\n      for (const serviceId of asArray(body.service_ids)) {\n        await db.prepare('INSERT INTO territory_services (territory_id, service_id) VALUES (?, ?)').bind(id, serviceId).run();\n      }\n    }\n\n    if (body.provider_ids !== undefined) {\n      await db.prepare('DELETE FROM team_member_territories WHERE territory_id = ?').bind(id).run();\n      for (const providerId of asArray(body.provider_ids)) {\n        await db.prepare('INSERT INTO team_member_territories (team_member_id, territory_id) VALUES (?, ?)').bind(providerId, id).run();\n      }\n    }\n\n    const updated = await db.prepare('SELECT * FROM territories WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('territories patch error', error);\n    return c.json({ error: 'Failed to update territory' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    const db = c.env.DB;\n    const id = c.req.param('id');\n    await db.prepare('DELETE FROM territory_services WHERE territory_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM team_member_territories WHERE territory_id = ?').bind(id).run();\n    await db.prepare('DELETE FROM territories WHERE id = ?').bind(id).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('territories delete error', error);\n    return c.json({ error: 'Failed to delete territory' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const transactions = await c.env.DB.prepare('SELECT * FROM transactions ORDER BY created_at DESC').all();\n    return c.json({ transactions: transactions.results || [] });\n  } catch (error) {\n    console.error('transactions list error', error);\n    return c.json({ error: 'Failed to list transactions' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const transaction = await c.env.DB.prepare('SELECT * FROM transactions WHERE id = ?').bind(c.req.param('id')).first();\n    if (!transaction) return c.json({ error: 'Not found' }, 404);\n    return c.json(transaction);\n  } catch (error) {\n    console.error('transactions get error', error);\n    return c.json({ error: 'Failed to get transaction' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO transactions\n       (id, invoice_id, customer_id, amount_cents, type, payment_method, reference, created_at)\n       VALUES (?, ?, ?, ?, ?, ?, ?, datetime('now'))`\n    ).bind(\n      id,\n      body.invoice_id || null,\n      body.customer_id || null,\n      body.amount_cents || 0,\n      body.type || 'charge',\n      body.payment_method || null,\n      body.reference || null\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM transactions WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('transactions create error', error);\n    return c.json({ error: 'Failed to create transaction' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    for (const key of ['invoice_id', 'customer_id', 'amount_cents', 'type', 'payment_method', 'reference']) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(body[key]);\n      }\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE transactions SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM transactions WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('transactions patch error', error);\n    return c.json({ error: 'Failed to update transaction' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM transactions WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('transactions delete error', error);\n    return c.json({ error: 'Failed to delete transaction' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\nimport { z } from 'zod';\nimport { zValidator } from '@hono/zod-validator';\nimport { enqueueAndDispatchPushEvent } from '../services/notifications';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst contactSchema = z.object({\n  source: z.literal('contact'),\n  first_name: z.string().min(1),\n  last_name: z.string().min(1),\n  email: z.string().email(),\n  phone: z.string().min(1),\n  postal_code: z.string().min(1),\n  reason: z.enum(['bike fitting', 'repair', 'inquiry', 'other']),\n  body: z.string().min(1),\n});\n\nconst newsletterSchema = z.object({\n  source: z.literal('newsletter'),\n  email: z.string().email(),\n});\n\nconst registrationSchema = z.object({\n  source: z.literal('registration'),\n  first_name: z.string().min(1),\n  last_name: z.string().min(1),\n  email: z.string().email(),\n  phone: z.string().min(1),\n  postal_code: z.string().min(1),\n  metadata: z.object({\n    street_address: z.string().optional(),\n    apt_suite: z.string().optional(),\n    city: z.string().optional(),\n    province: z.string().optional(),\n    country: z.string().optional(),\n    company: z.string().optional(),\n    other: z.string().optional(),\n  }).optional(),\n});\n\nconst messageSchema = z.discriminatedUnion('source', [\n  contactSchema,\n  newsletterSchema,\n  registrationSchema,\n]);\n\napp.post('/submit', zValidator('json', messageSchema), async (c) => {\n  const db = c.env.DB;\n  const data = c.req.valid('json');\n  const id = crypto.randomUUID();\n\n  const subject = data.source === 'contact'\n    ? `${data.reason.charAt(0).toUpperCase() + data.reason.slice(1)} \u2014 ${data.first_name} ${data.last_name}`\n    : data.source === 'newsletter'\n      ? 'Newsletter Signup'\n      : `Registration \u2014 ${data.first_name} ${data.last_name}`;\n\n  await db.prepare(`\n    INSERT INTO messages (id, source, first_name, last_name, email, phone, postal_code, reason, subject, body, metadata)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `).bind(\n    id,\n    data.source,\n    'first_name' in data ? data.first_name : null,\n    'last_name' in data ? data.last_name : null,\n    data.email,\n    'phone' in data ? data.phone : null,\n    'postal_code' in data ? data.postal_code : null,\n    'reason' in data ? data.reason : null,\n    subject,\n    'body' in data ? data.body : null,\n    'metadata' in data && data.metadata ? JSON.stringify(data.metadata) : null,\n  ).run();\n\n  const sourceLabel = data.source.charAt(0).toUpperCase() + data.source.slice(1);\n  const senderLabel = data.source === 'newsletter'\n    ? data.email\n    : [\n      'first_name' in data ? data.first_name : '',\n      'last_name' in data ? data.last_name : '',\n    ].filter(Boolean).join(' ').trim() || data.email;\n\n  const messagePreview = (\n    data.source === 'contact'\n      ? data.body\n      : subject\n  ).replace(/\\s+/g, ' ').trim().slice(0, 160);\n\n  const title = data.source === 'newsletter'\n    ? 'New newsletter signup'\n    : data.source === 'registration'\n      ? `New registration from ${senderLabel}`\n      : `New ${sourceLabel} message from ${senderLabel}`;\n\n  c.executionCtx.waitUntil(\n    enqueueAndDispatchPushEvent(db, {\n      type: 'new_message',\n      title,\n      body: messagePreview || subject,\n      targetUrl: `/admin/inbox/${id}`,\n    })\n  );\n\n  return c.json({ id, message: 'Message received' }, 201);\n});\n\napp.get('/', async (c) => {\n  const db = c.env.DB;\n  const { source, status, cursor, limit = '50' } = c.req.query();\n\n  let sql = 'SELECT * FROM messages WHERE 1=1';\n  const params: unknown[] = [];\n\n  if (source) {\n    sql += ' AND source = ?';\n    params.push(source);\n  }\n  if (status) {\n    sql += ' AND status = ?';\n    params.push(status);\n  }\n  if (cursor) {\n    sql += ' AND created_at < ?';\n    params.push(cursor);\n  }\n\n  sql += ' ORDER BY created_at DESC LIMIT ?';\n  params.push(parseInt(limit, 10));\n\n  const stmt = db.prepare(sql);\n  const result = await (params.length > 0 ? stmt.bind(...params) : stmt).all();\n\n  return c.json({\n    messages: result.results,\n    next_cursor: result.results.length > 0\n      ? (result.results[result.results.length - 1] as { created_at: string }).created_at\n      : null,\n  });\n});\n\napp.get('/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const msg = await db.prepare('SELECT * FROM messages WHERE id = ?').bind(id).first();\n  if (!msg) return c.json({ error: 'Not found' }, 404);\n  return c.json(msg);\n});\n\napp.patch('/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  const body = await c.req.json<{ status?: string; is_read?: boolean }>();\n\n  const fields: string[] = [];\n  const values: unknown[] = [];\n\n  if (body.status) {\n    fields.push('status = ?');\n    values.push(body.status);\n    if (body.status === 'replied') {\n      fields.push('replied_at = datetime(\\'now\\')');\n    }\n  }\n  if (body.is_read !== undefined) {\n    fields.push('is_read = ?');\n    values.push(body.is_read ? 1 : 0);\n    if (body.is_read) {\n      fields.push('read_at = datetime(\\'now\\')');\n      if (!body.status) {\n        fields.push('status = ?');\n        values.push('read');\n      }\n    }\n  }\n\n  if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n\n  fields.push(\"updated_at = datetime('now')\");\n  values.push(id);\n\n  await db.prepare(`UPDATE messages SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n\n  const updated = await db.prepare('SELECT * FROM messages WHERE id = ?').bind(id).first();\n  return c.json(updated);\n});\n\napp.delete('/:id', async (c) => {\n  const db = c.env.DB;\n  const id = c.req.param('id');\n  await db.prepare('DELETE FROM messages WHERE id = ?').bind(id).run();\n  return c.json({ deleted: true });\n});\n\nexport default app;\n", "import { Hono } from 'hono';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\napp.get('/', async (c) => {\n  try {\n    const webhooks = await c.env.DB.prepare('SELECT * FROM webhooks ORDER BY created_at DESC').all();\n    return c.json({ webhooks: webhooks.results || [] });\n  } catch (error) {\n    console.error('webhooks list error', error);\n    return c.json({ error: 'Failed to list webhooks' }, 500);\n  }\n});\n\napp.get('/:id', async (c) => {\n  try {\n    const webhook = await c.env.DB.prepare('SELECT * FROM webhooks WHERE id = ?').bind(c.req.param('id')).first();\n    if (!webhook) return c.json({ error: 'Not found' }, 404);\n    return c.json(webhook);\n  } catch (error) {\n    console.error('webhooks get error', error);\n    return c.json({ error: 'Failed to get webhook' }, 500);\n  }\n});\n\napp.post('/', async (c) => {\n  try {\n    const body = await c.req.json<Record<string, unknown>>();\n    const id = crypto.randomUUID();\n    await c.env.DB.prepare(\n      `INSERT INTO webhooks (id, url, event_type, secret, is_active, created_at, updated_at)\n       VALUES (?, ?, ?, ?, ?, datetime('now'), datetime('now'))`\n    ).bind(\n      id,\n      body.url,\n      body.event_type,\n      body.secret || crypto.randomUUID(),\n      body.is_active === false ? 0 : 1\n    ).run();\n    const created = await c.env.DB.prepare('SELECT * FROM webhooks WHERE id = ?').bind(id).first();\n    return c.json(created, 201);\n  } catch (error) {\n    console.error('webhooks create error', error);\n    return c.json({ error: 'Failed to create webhook' }, 500);\n  }\n});\n\napp.patch('/:id', async (c) => {\n  try {\n    const id = c.req.param('id');\n    const body = await c.req.json<Record<string, unknown>>();\n    const fields: string[] = [];\n    const values: unknown[] = [];\n    for (const key of ['url', 'event_type', 'secret', 'is_active']) {\n      if (body[key] !== undefined) {\n        fields.push(`${key} = ?`);\n        values.push(key === 'is_active' ? (body[key] ? 1 : 0) : body[key]);\n      }\n    }\n    if (fields.length === 0) return c.json({ error: 'No fields to update' }, 400);\n    fields.push(\"updated_at = datetime('now')\");\n    values.push(id);\n    await c.env.DB.prepare(`UPDATE webhooks SET ${fields.join(', ')} WHERE id = ?`).bind(...values).run();\n    const updated = await c.env.DB.prepare('SELECT * FROM webhooks WHERE id = ?').bind(id).first();\n    if (!updated) return c.json({ error: 'Not found' }, 404);\n    return c.json(updated);\n  } catch (error) {\n    console.error('webhooks patch error', error);\n    return c.json({ error: 'Failed to update webhook' }, 500);\n  }\n});\n\napp.delete('/:id', async (c) => {\n  try {\n    await c.env.DB.prepare('DELETE FROM webhooks WHERE id = ?').bind(c.req.param('id')).run();\n    return c.json({ deleted: true });\n  } catch (error) {\n    console.error('webhooks delete error', error);\n    return c.json({ error: 'Failed to delete webhook' }, 500);\n  }\n});\n\nexport default app;\n", "import { Hono } from 'hono';\nimport { enqueueAndDispatchPushEvent } from '../services/notifications';\nimport {\n  ensureSmsInboxMessage,\n  getTwilioConfig,\n  logSms,\n  normalizePhoneE164,\n  touchSmsInboxMessage,\n  updateSmsStatus,\n  validateTwilioSignature,\n} from '../services/twilio';\n\nconst app = new Hono<{ Bindings: { DB: D1Database } }>();\n\nconst parseFormParams = (rawBody: string): Record<string, string> => {\n  const params: Record<string, string> = {};\n  const parsed = new URLSearchParams(rawBody);\n  for (const [key, value] of parsed.entries()) {\n    params[key] = value;\n  }\n  return params;\n};\n\napp.post('/status', async (c) => {\n  const db = c.env.DB;\n  const config = await getTwilioConfig(db);\n  if (!config) return c.text('Not configured', 200);\n\n  const rawBody = await c.req.raw.clone().text();\n  const params = parseFormParams(rawBody);\n\n  const signature = c.req.header('X-Twilio-Signature') || '';\n  const url = new URL(c.req.url);\n  const fullUrl = `${url.origin}${url.pathname}`;\n\n  const valid = await validateTwilioSignature(config.authToken, signature, fullUrl, params);\n  if (!valid) {\n    console.warn('[twilio-webhook] Invalid signature on status callback');\n    return c.text('Invalid signature', 403);\n  }\n\n  const messageSid = params.MessageSid || params.SmsSid;\n  const messageStatus = params.MessageStatus || params.SmsStatus || '';\n  const errorCode = params.ErrorCode || '';\n  const errorMessage = params.ErrorMessage || '';\n\n  if (messageSid && messageStatus) {\n    await updateSmsStatus(db, messageSid, messageStatus, errorCode || undefined, errorMessage || undefined);\n  }\n\n  return c.text('', 200);\n});\n\napp.post('/inbound', async (c) => {\n  const db = c.env.DB;\n  const config = await getTwilioConfig(db);\n  if (!config) return c.text('<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response></Response>', 200, { 'Content-Type': 'text/xml' });\n\n  const rawBody = await c.req.raw.clone().text();\n  const params = parseFormParams(rawBody);\n\n  const signature = c.req.header('X-Twilio-Signature') || '';\n  const url = new URL(c.req.url);\n  const fullUrl = `${url.origin}${url.pathname}`;\n\n  const valid = await validateTwilioSignature(config.authToken, signature, fullUrl, params);\n  if (!valid) {\n    console.warn('[twilio-webhook] Invalid signature on inbound SMS');\n    return c.text('Invalid signature', 403);\n  }\n\n  const from = params.From || '';\n  const to = params.To || '';\n  const body = params.Body || '';\n  const messageSid = params.MessageSid || '';\n  const numSegments = parseInt(params.NumSegments || '1', 10);\n\n  const phoneE164 = normalizePhoneE164(from);\n  if (!phoneE164) {\n    console.warn(`[twilio-webhook] Could not normalize inbound phone: ${from}`);\n    return c.text('<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response></Response>', 200, { 'Content-Type': 'text/xml' });\n  }\n\n  const customer = await db.prepare(\n    'SELECT id, first_name, last_name, email FROM customers WHERE phone_e164 = ? OR phone = ? ORDER BY updated_at DESC LIMIT 1'\n  ).bind(phoneE164, from).first<{ id: string; first_name: string | null; last_name: string | null; email: string | null }>();\n\n  const latestJob = customer?.id\n    ? await db.prepare(\n      `SELECT id FROM jobs\n       WHERE customer_id = ?\n       ORDER BY updated_at DESC\n       LIMIT 1`\n    ).bind(customer.id).first<{ id: string }>()\n    : null;\n\n  const inboxMessageId = await ensureSmsInboxMessage({\n    db,\n    phoneE164,\n    customerId: customer?.id || null,\n    jobId: latestJob?.id || null,\n    firstName: customer?.first_name || null,\n    lastName: customer?.last_name || null,\n    email: customer?.email || null,\n  });\n\n  await touchSmsInboxMessage(db, inboxMessageId, body);\n\n  const upperBody = body.toUpperCase().trim();\n  if (['STOP', 'STOPALL', 'UNSUBSCRIBE', 'CANCEL', 'END', 'QUIT'].includes(upperBody)) {\n    if (customer) {\n      await db.prepare(\n        \"UPDATE customers SET sms_opted_out = 1, sms_opted_out_at = datetime('now'), updated_at = datetime('now') WHERE id = ?\"\n      ).bind(customer.id).run();\n      console.log(`[twilio-webhook] Customer ${customer.id} opted out via ${upperBody}`);\n    }\n  }\n\n  if (['START', 'YES', 'UNSTOP'].includes(upperBody)) {\n    if (customer) {\n      await db.prepare(\n        \"UPDATE customers SET sms_opted_out = 0, sms_opted_out_at = NULL, updated_at = datetime('now') WHERE id = ?\"\n      ).bind(customer.id).run();\n      console.log(`[twilio-webhook] Customer ${customer.id} opted back in via ${upperBody}`);\n    }\n  }\n\n  await logSms(db, {\n    customerId: customer?.id || null,\n    jobId: latestJob?.id || null,\n    messageId: inboxMessageId,\n    direction: 'inbound',\n    phoneTo: to,\n    phoneFrom: phoneE164,\n    body,\n    twilioSid: messageSid,\n    status: 'received',\n    segments: numSegments,\n  });\n\n  const senderLabel = customer\n    ? [customer.first_name || '', customer.last_name || ''].filter(Boolean).join(' ').trim() || phoneE164\n    : phoneE164;\n  const preview = body.replace(/\\s+/g, ' ').trim().slice(0, 160);\n  c.executionCtx.waitUntil(\n    enqueueAndDispatchPushEvent(db, {\n      type: 'new_message',\n      title: `New SMS from ${senderLabel}`,\n      body: preview || 'New inbound SMS received.',\n      targetUrl: `/admin/inbox/${inboxMessageId}`,\n    })\n  );\n\n  return c.text('<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response></Response>', 200, { 'Content-Type': 'text/xml' });\n});\n\nexport default app;\n", "export const BOOKING_WIDGET_JS = `(function() {\n  'use strict';\n\n  var WIDGET_VERSION = '2.0.0';\n\n  function GOATkitWidget(config) {\n    this.apiUrl = config.apiUrl || '';\n    this.apiKey = config.apiKey || '';\n    this.containerId = config.containerId || 'goatkit-widget';\n    this.primaryColor = config.primaryColor || '#2563eb';\n    this.fontFamily = config.fontFamily || \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif\";\n    this.onComplete = config.onComplete || function() {};\n    this.onError = config.onError || function() {};\n    this.onStepChange = config.onStepChange || function() {};\n\n    this.state = {\n      currentStep: 'zip',\n      stepHistory: ['zip'],\n      postalCode: '',\n      territory: null,\n      categories: [],\n      selectedCategory: null,\n      services: [],\n      selectedService: null,\n      serviceDetail: null,\n      modifierSelections: {},\n      timeslots: [],\n      selectedDate: null,\n      selectedTimeslot: null,\n      dateWindowStart: 0,\n      address: { line1: '', line2: '', city: '', province: '', postalCode: '' },\n      contact: { firstName: '', lastName: '', email: '', phone: '' },\n      loading: false,\n      error: null,\n      summaryExpanded: false,\n      smsConsent: false,\n      jobId: null\n    };\n\n    this._acTimer = null;\n    this._acAbort = null;\n    this._prevStep = null;\n    this.init();\n  }\n\n  GOATkitWidget.prototype.init = function() {\n    this.injectStyles();\n    this.render();\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // CSS\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.injectStyles = function() {\n    if (document.getElementById('zbw-styles')) return;\n    var s = document.createElement('style');\n    s.id = 'zbw-styles';\n    s.textContent = this.getCSS();\n    document.head.appendChild(s);\n  };\n\n  GOATkitWidget.prototype.getCSS = function() {\n    var p = this.primaryColor;\n    var f = this.fontFamily;\n    return [\n      ':root{--zbw-p:' + p + ';--zbw-pl:' + p + '14;--zbw-f:' + f + '}',\n\n      '.zbw-root{font-family:var(--zbw-f);color:#1a1a1a;line-height:1.5;box-sizing:border-box;-webkit-font-smoothing:antialiased}',\n      '.zbw-root *,.zbw-root *::before,.zbw-root *::after{box-sizing:inherit}',\n\n      '.zbw-layout{display:flex;flex-direction:column;gap:0;max-width:860px;margin:0 auto}',\n      '@media(min-width:768px){.zbw-layout{flex-direction:row;gap:24px}}',\n\n      '.zbw-main{flex:1;min-width:0}',\n      '.zbw-sidebar{display:none}',\n      '@media(min-width:768px){.zbw-sidebar{display:block;width:280px;flex-shrink:0}}',\n\n      '.zbw-mobile-summary{display:block;margin-bottom:16px}',\n      '@media(min-width:768px){.zbw-mobile-summary{display:none}}',\n      '.zbw-mobile-summary-btn{width:100%;padding:12px 16px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-family:var(--zbw-f);font-size:14px;color:#475569}',\n      '.zbw-mobile-summary-btn strong{color:#1a1a1a}',\n\n      '.zbw-progress{margin-bottom:24px}',\n      '.zbw-progress-bar{height:4px;background:#e2e8f0;border-radius:2px;overflow:hidden}',\n      '.zbw-progress-fill{height:100%;background:var(--zbw-p);border-radius:2px;transition:width .4s ease}',\n      '.zbw-progress-text{font-size:12px;color:#94a3b8;margin-top:6px}',\n\n      '.zbw-step{animation:zbw-fadeIn .25s ease}',\n      '@keyframes zbw-fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}',\n\n      '.zbw-step-title{font-size:22px;font-weight:700;margin:0 0 4px;color:#0f172a}',\n      '.zbw-step-desc{font-size:14px;color:#64748b;margin:0 0 20px}',\n\n      '.zbw-card{padding:16px;border:2px solid #e2e8f0;border-radius:10px;cursor:pointer;transition:all .15s ease;background:#fff}',\n      '.zbw-card:hover{border-color:' + p + '66;box-shadow:0 2px 8px rgba(0,0,0,.06)}',\n      '.zbw-card.selected{border-color:var(--zbw-p);background:' + p + '08}',\n      '.zbw-card-title{font-weight:600;font-size:15px;margin-bottom:2px}',\n      '.zbw-card-desc{font-size:13px;color:#64748b;margin-bottom:8px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}',\n      '.zbw-card-meta{display:flex;justify-content:space-between;align-items:center;font-size:14px}',\n      '.zbw-card-price{font-weight:700;color:var(--zbw-p)}',\n      '.zbw-card-duration{color:#94a3b8;font-size:13px}',\n      '.zbw-cards{display:grid;gap:10px;margin-bottom:16px}',\n\n      '.zbw-modifier-card{padding:20px;border:2px solid #e2e8f0;border-radius:10px;cursor:pointer;transition:all .15s ease;background:#fff;text-align:center}',\n      '.zbw-modifier-card:hover{border-color:' + p + '66}',\n      '.zbw-modifier-card.selected{border-color:var(--zbw-p);background:' + p + '08}',\n      '.zbw-modifier-name{font-weight:600;font-size:16px;margin-bottom:4px}',\n      '.zbw-modifier-desc{font-size:13px;color:#64748b;margin-bottom:8px}',\n      '.zbw-modifier-price{font-weight:700;color:var(--zbw-p);font-size:15px}',\n\n      '.zbw-date-chips{display:flex;align-items:center;gap:6px;margin-bottom:16px;overflow:hidden}',\n      '.zbw-date-chip{flex-shrink:0;padding:10px 14px;border:2px solid #e2e8f0;border-radius:10px;cursor:pointer;text-align:center;transition:all .15s;background:#fff;min-width:64px}',\n      '.zbw-date-chip:hover{border-color:' + p + '66}',\n      '.zbw-date-chip.selected{border-color:var(--zbw-p);background:' + p + '08}',\n      '.zbw-date-chip.empty{opacity:.4;pointer-events:none}',\n      '.zbw-date-day{font-size:12px;color:#64748b;font-weight:500}',\n      '.zbw-date-num{font-size:15px;font-weight:700;margin-top:2px}',\n      '.zbw-date-nav{width:32px;height:32px;border-radius:50%;border:1px solid #e2e8f0;background:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px;color:#475569;transition:all .15s}',\n      '.zbw-date-nav:hover{background:#f1f5f9}',\n      '.zbw-date-nav:disabled{opacity:.3;cursor:not-allowed}',\n\n      '.zbw-timeslots{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:8px;margin-bottom:16px;max-height:280px;overflow-y:auto}',\n      '.zbw-timeslot{padding:12px 8px;border:2px solid #e2e8f0;border-radius:8px;text-align:center;cursor:pointer;transition:all .15s;background:#fff}',\n      '.zbw-timeslot:hover{border-color:' + p + '66}',\n      '.zbw-timeslot.selected{border-color:var(--zbw-p);background:' + p + '08}',\n      '.zbw-timeslot-time{font-weight:600;font-size:14px}',\n      '.zbw-timeslot-price{font-size:12px;color:#64748b;margin-top:2px}',\n\n      '.zbw-form-group{margin-bottom:14px}',\n      '.zbw-form-group label{display:block;font-size:13px;font-weight:600;color:#374151;margin-bottom:5px}',\n'.zbw-input{width:100%;padding:11px 14px;border:1.5px solid #d1d5db;border-radius:8px;font-size:16px;font-family:var(--zbw-f);color:#1a1a1a;background:#fff;transition:border-color .15s,box-shadow .15s;outline:none}',\n      '.zbw-input:focus{border-color:var(--zbw-p);box-shadow:0 0 0 3px ' + p + '1a}',\n      '.zbw-input::placeholder{color:#9ca3af}',\n      '.zbw-input-error{border-color:#ef4444}',\n      'select.zbw-input{appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg width=\\\\'10\\\\' height=\\\\'6\\\\' viewBox=\\\\'0 0 10 6\\\\' fill=\\\\'none\\\\' xmlns=\\\\'http://www.w3.org/2000/svg\\\\'%3E%3Cpath d=\\\\'M1 1L5 5L9 1\\\\' stroke=\\\\'%236b7280\\\\' stroke-width=\\\\'1.5\\\\' stroke-linecap=\\\\'round\\\\' stroke-linejoin=\\\\'round\\\\'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:36px}',\n      '.zbw-ac-wrap{position:relative}',\n      '.zbw-ac-list{position:absolute;top:100%;left:0;right:0;background:#fff;border:1.5px solid #d1d5db;border-top:none;border-radius:0 0 8px 8px;z-index:100;max-height:240px;overflow-y:auto;box-shadow:0 4px 12px rgba(0,0,0,.1)}',\n      '.zbw-ac-list:empty{display:none}',\n      '.zbw-ac-item{padding:10px 14px;cursor:pointer;border-bottom:1px solid #f1f5f9;transition:background .1s}',\n      '.zbw-ac-item:last-child{border-bottom:none}',\n      '.zbw-ac-item:hover{background:#f8fafc}',\n      '.zbw-ac-main{font-size:14px;font-weight:500;color:#1a1a1a}',\n      '.zbw-ac-sub{font-size:12px;color:#64748b;margin-top:1px}',\n      '.zbw-row{display:flex;gap:12px}',\n      '.zbw-row .zbw-form-group{flex:1}',\n\n      '.zbw-btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 24px;border:none;border-radius:8px;font-size:15px;font-weight:600;font-family:var(--zbw-f);cursor:pointer;transition:all .15s;width:100%}',\n      '.zbw-btn-primary{background:var(--zbw-p);color:#fff}',\n      '.zbw-btn-primary:hover{opacity:.92}',\n      '.zbw-btn-primary:disabled{background:#cbd5e1;cursor:not-allowed}',\n      '.zbw-btn-secondary{background:#f1f5f9;color:#475569;margin-top:8px}',\n      '.zbw-btn-secondary:hover{background:#e2e8f0}',\n      '.zbw-btn-back{background:none;border:none;color:#64748b;font-size:14px;font-weight:500;cursor:pointer;padding:8px 0;font-family:var(--zbw-f);display:inline-flex;align-items:center;gap:4px}',\n      '.zbw-btn-back:hover{color:#1a1a1a}',\n\n      '.zbw-error{background:#fef2f2;color:#dc2626;padding:12px 16px;border-radius:8px;margin-bottom:16px;font-size:14px;border:1px solid #fecaca}',\n\n      '.zbw-summary-panel{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:20px;position:sticky;top:24px}',\n      '.zbw-summary-title{font-size:13px;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:.05em;margin-bottom:12px}',\n      '.zbw-summary-service{font-size:16px;font-weight:700;margin-bottom:12px;color:#0f172a}',\n      '.zbw-summary-item{display:flex;justify-content:space-between;font-size:13px;padding:4px 0;color:#475569}',\n      '.zbw-summary-item.mod{color:#64748b}',\n      '.zbw-summary-divider{border:none;border-top:1px solid #e2e8f0;margin:10px 0}',\n      '.zbw-summary-total{display:flex;justify-content:space-between;font-size:16px;font-weight:700;color:#0f172a}',\n      '.zbw-summary-detail{display:flex;align-items:center;gap:8px;font-size:13px;color:#64748b;margin-bottom:6px}',\n      '.zbw-summary-detail svg{flex-shrink:0}',\n\n      '.zbw-success{text-align:center;padding:32px 16px}',\n      '.zbw-success-icon{width:56px;height:56px;border-radius:50%;background:#dcfce7;margin:0 auto 16px;display:flex;align-items:center;justify-content:center}',\n      '.zbw-success-icon svg{color:#16a34a}',\n      '.zbw-success h2{font-size:22px;margin:0 0 8px}',\n      '.zbw-success p{color:#64748b;font-size:14px;margin:4px 0}',\n\n      '.zbw-skeleton{background:linear-gradient(90deg,#f1f5f9 25%,#e2e8f0 50%,#f1f5f9 75%);background-size:200% 100%;animation:zbw-shimmer 1.5s infinite;border-radius:8px}',\n      '@keyframes zbw-shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}',\n      '.zbw-skeleton-card{height:80px;margin-bottom:10px}',\n      '.zbw-skeleton-text{height:14px;margin-bottom:8px;width:60%}',\n      '.zbw-skeleton-chip{height:56px;width:64px;border-radius:10px;flex-shrink:0}',\n\n      '[data-theme=\"dark\"] .zbw-root{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-step-title{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-step-desc{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-card{background:#1e1e2e;border-color:#313244;color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-card:hover{border-color:' + p + '88;box-shadow:0 2px 8px rgba(0,0,0,.3)}',\n      '[data-theme=\"dark\"] .zbw-card.selected{border-color:var(--zbw-p);background:' + p + '18}',\n      '[data-theme=\"dark\"] .zbw-card-title{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-card-desc{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-card-duration{color:#6c7086}',\n      '[data-theme=\"dark\"] .zbw-modifier-card{background:#1e1e2e;border-color:#313244;color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-modifier-card:hover{border-color:' + p + '88}',\n      '[data-theme=\"dark\"] .zbw-modifier-card.selected{border-color:var(--zbw-p);background:' + p + '18}',\n      '[data-theme=\"dark\"] .zbw-modifier-name{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-modifier-desc{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-date-chip{background:#1e1e2e;border-color:#313244;color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-date-chip:hover{border-color:' + p + '88}',\n      '[data-theme=\"dark\"] .zbw-date-chip.selected{border-color:var(--zbw-p);background:' + p + '18}',\n      '[data-theme=\"dark\"] .zbw-date-day{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-date-num{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-date-nav{background:#1e1e2e;border-color:#313244;color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-date-nav:hover{background:#313244}',\n      '[data-theme=\"dark\"] .zbw-timeslot{background:#1e1e2e;border-color:#313244;color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-timeslot:hover{border-color:' + p + '88}',\n      '[data-theme=\"dark\"] .zbw-timeslot.selected{border-color:var(--zbw-p);background:' + p + '18}',\n      '[data-theme=\"dark\"] .zbw-timeslot-time{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-timeslot-price{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-input{background:#181825;border-color:#313244;color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-input:focus{border-color:var(--zbw-p);box-shadow:0 0 0 3px ' + p + '33}',\n      '[data-theme=\"dark\"] .zbw-input::placeholder{color:#6c7086}',\n      '[data-theme=\"dark\"] .zbw-form-group label{color:#bac2de}',\n      '[data-theme=\"dark\"] .zbw-btn-secondary{background:#313244;color:#bac2de}',\n      '[data-theme=\"dark\"] .zbw-btn-secondary:hover{background:#45475a}',\n      '[data-theme=\"dark\"] .zbw-btn-back{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-btn-back:hover{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-btn-primary:disabled{background:#45475a;color:#6c7086}',\n      '[data-theme=\"dark\"] .zbw-error{background:#45475a;color:#f38ba8;border-color:#f38ba866}',\n      '[data-theme=\"dark\"] .zbw-progress-bar{background:#313244}',\n      '[data-theme=\"dark\"] .zbw-progress-text{color:#6c7086}',\n      '[data-theme=\"dark\"] .zbw-summary-panel{background:#181825;border-color:#313244}',\n      '[data-theme=\"dark\"] .zbw-summary-title{color:#6c7086}',\n      '[data-theme=\"dark\"] .zbw-summary-service{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-summary-item{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-summary-divider{border-color:#313244}',\n      '[data-theme=\"dark\"] .zbw-summary-total{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-summary-detail{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-mobile-summary-btn{background:#181825;border-color:#313244;color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-mobile-summary-btn strong{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-success h2{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-success p{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-ac-list{background:#1e1e2e;border-color:#313244;box-shadow:0 4px 12px rgba(0,0,0,.4)}',\n      '[data-theme=\"dark\"] .zbw-ac-item{border-bottom-color:#313244}',\n      '[data-theme=\"dark\"] .zbw-ac-item:hover{background:#313244}',\n      '[data-theme=\"dark\"] .zbw-ac-main{color:#cdd6f4}',\n      '[data-theme=\"dark\"] .zbw-ac-sub{color:#a6adc8}',\n      '[data-theme=\"dark\"] .zbw-skeleton{background:linear-gradient(90deg,#313244 25%,#45475a 50%,#313244 75%);background-size:200% 100%}'\n    ].join('\\\\n');\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // UTILITIES\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.formatPrice = function(cents) {\n    if (cents == null) return '--';\n    var dollars = Math.abs(cents) / 100;\n    var sign = cents < 0 ? '-' : '';\n    return sign + '\\\\$' + dollars.toFixed(dollars % 1 === 0 ? 0 : 2);\n  };\n\n  GOATkitWidget.prototype.formatPriceDelta = function(cents) {\n    if (!cents) return 'Included';\n    return '+\\\\$' + (Math.abs(cents) / 100).toFixed(cents % 100 === 0 ? 0 : 2);\n  };\n\n  GOATkitWidget.prototype.formatTime = function(time24) {\n    var parts = time24.split(':');\n    var h = parseInt(parts[0], 10);\n    var m = parts[1];\n    var ampm = h >= 12 ? 'PM' : 'AM';\n    return (h % 12 || 12) + ':' + m + ' ' + ampm;\n  };\n\n  GOATkitWidget.prototype.formatDate = function(dateStr) {\n    var d = new Date(dateStr + 'T12:00:00');\n    return d.toLocaleDateString('en-US', { timeZone: 'America/Toronto', weekday: 'short', month: 'short', day: 'numeric' });\n  };\n\n  GOATkitWidget.prototype.formatDateShort = function(dateStr) {\n    var d = new Date(dateStr + 'T12:00:00');\n    return {\n      day: d.toLocaleDateString('en-US', { timeZone: 'America/Toronto', weekday: 'short' }),\n      date: d.toLocaleDateString('en-US', { timeZone: 'America/Toronto', month: 'short', day: 'numeric' })\n    };\n  };\n\n  GOATkitWidget.prototype.formatDuration = function(mins) {\n    if (mins < 60) return mins + ' min';\n    var h = Math.floor(mins / 60);\n    var m = mins % 60;\n    return m ? h + ' hr ' + m + ' min' : h + ' hr';\n  };\n\n  GOATkitWidget.prototype.validatePostalCode = function(code) {\n    return /^[A-Za-z]\\\\d[A-Za-z]\\\\s?\\\\d[A-Za-z]\\\\d$/.test(code.trim());\n  };\n\n  GOATkitWidget.prototype.normalizePostalCode = function(code) {\n    var clean = code.replace(/\\\\s/g, '').toUpperCase();\n    if (clean.length === 6) return clean.substring(0, 3) + ' ' + clean.substring(3);\n    return clean;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STATE & NAVIGATION\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.computeSteps = function() {\n    var steps = ['zip'];\n\n    if (this.state.categories.length > 1) {\n      steps.push('categories');\n    }\n\n    steps.push('services');\n\n    if (this.state.serviceDetail && this.state.serviceDetail.modifiers) {\n      for (var i = 0; i < this.state.serviceDetail.modifiers.length; i++) {\n        steps.push('modifier_' + i);\n      }\n    }\n\n    steps.push('datetime');\n    steps.push('address');\n    steps.push('contact');\n    steps.push('success');\n\n    return steps;\n  };\n\n  GOATkitWidget.prototype.getStepIndex = function() {\n    var steps = this.computeSteps();\n    var idx = steps.indexOf(this.state.currentStep);\n    return idx >= 0 ? idx : 0;\n  };\n\n  GOATkitWidget.prototype.getProgressPercent = function() {\n    var steps = this.computeSteps();\n    var total = steps.length - 1;\n    if (total <= 0) return 0;\n    var idx = steps.indexOf(this.state.currentStep);\n    if (this.state.currentStep === 'success') return 100;\n    return Math.round((idx / (total - 1)) * 100);\n  };\n\n  GOATkitWidget.prototype.goToStep = function(stepId) {\n    this.state.currentStep = stepId;\n    this.state.stepHistory.push(stepId);\n    this.state.error = null;\n    this.onStepChange(stepId, this.getStepIndex());\n    this.render();\n  };\n\n  GOATkitWidget.prototype.goBack = function() {\n    if (this.state.stepHistory.length <= 1) return;\n    this.state.stepHistory.pop();\n    this.state.currentStep = this.state.stepHistory[this.state.stepHistory.length - 1];\n    this.state.error = null;\n    this.render();\n  };\n\n  GOATkitWidget.prototype.getRunningTotal = function() {\n    var svc = this.state.selectedService;\n    if (!svc) return 0;\n    var total = svc.base_price_cents || 0;\n\n    var detail = this.state.serviceDetail;\n    if (detail && detail.modifiers) {\n      for (var i = 0; i < detail.modifiers.length; i++) {\n        var mod = detail.modifiers[i];\n        if (this.state.modifierSelections[mod.id]) {\n          total += (mod.price_adjustment_cents || 0);\n        }\n      }\n    }\n\n    if (this.state.selectedTimeslot && this.state.selectedTimeslot.price) {\n      var priceDiff = this.state.selectedTimeslot.price - (svc.base_price_cents || 0);\n      if (priceDiff !== 0) total += priceDiff;\n    }\n\n    return total;\n  };\n\n  GOATkitWidget.prototype.getEffectiveDuration = function() {\n    var svc = this.state.selectedService;\n    if (!svc) return 0;\n    var dur = svc.base_duration_minutes || 0;\n\n    var detail = this.state.serviceDetail;\n    if (detail && detail.modifiers) {\n      for (var i = 0; i < detail.modifiers.length; i++) {\n        var mod = detail.modifiers[i];\n        if (this.state.modifierSelections[mod.id]) {\n          dur += (mod.duration_adjustment_minutes || 0);\n        }\n      }\n    }\n    return dur;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // API\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.fetchApi = function(endpoint, options) {\n    var self = this;\n    var headers = { 'Content-Type': 'application/json' };\n    if (this.apiKey) headers['Authorization'] = 'Bearer ' + this.apiKey;\n\n    var controller = typeof AbortController !== 'undefined' ? new AbortController() : null;\n    var timeoutId = controller ? setTimeout(function() { controller.abort(); }, 30000) : null;\n\n    var fetchOpts = Object.assign({}, options || {}, { headers: headers });\n    if (controller) fetchOpts.signal = controller.signal;\n\n    return fetch(this.apiUrl + endpoint, fetchOpts)\n      .then(function(res) {\n        if (timeoutId) clearTimeout(timeoutId);\n        if (!res.ok) {\n          return res.json().catch(function() { return { message: 'Request failed' }; }).then(function(err) {\n            var msg = err.message || (typeof err.error === 'string' ? err.error : null) || 'Request failed';\n            throw new Error(msg);\n          });\n        }\n        return res.json();\n      })\n      .catch(function(err) {\n        if (timeoutId) clearTimeout(timeoutId);\n        if (err.name === 'AbortError') throw new Error('Request timed out');\n        throw err;\n      });\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // RENDER CORE\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.render = function() {\n    var el = document.getElementById(this.containerId);\n    if (!el) return;\n\n    if (this.state.currentStep === 'address' && document.getElementById('zbw-addr1')) {\n      this.readAddressFromDOM();\n    }\n    if (this.state.currentStep === 'contact' && document.getElementById('zbw-fname')) {\n      var fn = document.getElementById('zbw-fname');\n      var ln = document.getElementById('zbw-lname');\n      var em = document.getElementById('zbw-email');\n      var ph = document.getElementById('zbw-phone');\n      if (fn) this.state.contact.firstName = fn.value;\n      if (ln) this.state.contact.lastName = ln.value;\n      if (em) this.state.contact.email = em.value;\n      if (ph) this.state.contact.phone = ph.value;\n    }\n\n    var step = this.state.currentStep;\n    var isSuccess = step === 'success';\n\n    var html = '<div class=\"zbw-root\">';\n\n    if (!isSuccess) {\n      html += this.renderProgress();\n    }\n\n    html += '<div class=\"zbw-layout\">';\n    html += '<div class=\"zbw-main\">';\n\n    if (!isSuccess && this.state.selectedService) {\n      html += this.renderMobileSummary();\n    }\n\n    html += this.renderCurrentStep();\n    html += '</div>';\n\n    if (!isSuccess && this.state.selectedService) {\n      html += '<div class=\"zbw-sidebar\">' + this.renderSidebar() + '</div>';\n    }\n\n    html += '</div></div>';\n\n    el.innerHTML = html;\n\n    var _stepChanged = (this.state.currentStep !== this._prevStep);\n    this._prevStep = this.state.currentStep;\n    if (!_stepChanged) {\n      var _s = el.querySelector('.zbw-step');\n      if (_s) _s.style.animation = 'none';\n    }\n\n    this.attachEvents();\n  };\n\n  GOATkitWidget.prototype.renderProgress = function() {\n    var pct = this.getProgressPercent();\n    var steps = this.computeSteps().filter(function(s) { return s !== 'success'; });\n    var idx = this.getStepIndex();\n    var stepNum = Math.min(idx + 1, steps.length);\n\n    return '<div class=\"zbw-progress\">' +\n      '<div class=\"zbw-progress-bar\"><div class=\"zbw-progress-fill\" style=\"width:' + pct + '%\"></div></div>' +\n      '<div class=\"zbw-progress-text\">Step ' + stepNum + ' of ' + steps.length + '</div>' +\n      '</div>';\n  };\n\n  GOATkitWidget.prototype.renderSidebar = function() {\n    var svc = this.state.selectedService;\n    if (!svc) return '';\n\n    var html = '<div class=\"zbw-summary-panel\">';\n    html += '<div class=\"zbw-summary-title\">Order Summary</div>';\n    html += '<div class=\"zbw-summary-service\">' + this.esc(svc.name) + '</div>';\n\n    html += '<div class=\"zbw-summary-item\"><span>Base price</span><span>' + this.formatPrice(svc.base_price_cents) + '</span></div>';\n\n    var detail = this.state.serviceDetail;\n    if (detail && detail.modifiers) {\n      for (var i = 0; i < detail.modifiers.length; i++) {\n        var mod = detail.modifiers[i];\n        if (this.state.modifierSelections[mod.id]) {\n          html += '<div class=\"zbw-summary-item mod\"><span>' + this.esc(mod.name) + '</span><span>' + this.formatPriceDelta(mod.price_adjustment_cents) + '</span></div>';\n        }\n      }\n    }\n\n    if (this.state.selectedTimeslot) {\n      var ts = this.state.selectedTimeslot;\n      html += '<hr class=\"zbw-summary-divider\">';\n      html += '<div class=\"zbw-summary-detail\">' +\n        '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\"/><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"/><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"/><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"/></svg>' +\n        this.formatDate(ts.date) + ' at ' + this.formatTime(ts.start_time) +\n        '</div>';\n    }\n\n    if (this.state.address.line1) {\n      html += '<div class=\"zbw-summary-detail\">' +\n        '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z\"/><circle cx=\"12\" cy=\"10\" r=\"3\"/></svg>' +\n        this.esc(this.state.address.line1) +\n        '</div>';\n    }\n\n    html += '<hr class=\"zbw-summary-divider\">';\n    html += '<div class=\"zbw-summary-item\"><span>Duration</span><span>' + this.formatDuration(this.getEffectiveDuration()) + '</span></div>';\n    html += '<div class=\"zbw-summary-total\"><span>Total</span><span>' + this.formatPrice(this.getRunningTotal()) + '</span></div>';\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.renderMobileSummary = function() {\n    var total = this.formatPrice(this.getRunningTotal());\n    return '<div class=\"zbw-mobile-summary\">' +\n      '<button class=\"zbw-mobile-summary-btn\" data-action=\"toggleSummary\">' +\n      '<span>View Summary</span><strong>' + total + '</strong>' +\n      '</button>' +\n      (this.state.summaryExpanded ? '<div style=\"margin-top:8px\">' + this.renderSidebar() + '</div>' : '') +\n      '</div>';\n  };\n\n  GOATkitWidget.prototype.renderBackButton = function() {\n    return '<button class=\"zbw-btn-back\" data-action=\"back\">' +\n      '<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M19 12H5M12 19l-7-7 7-7\"/></svg>' +\n      'Back</button>';\n  };\n\n  GOATkitWidget.prototype.esc = function(str) {\n    if (!str) return '';\n    var d = document.createElement('div');\n    d.textContent = str;\n    return d.innerHTML;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP ROUTER\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderCurrentStep = function() {\n    var step = this.state.currentStep;\n    if (step === 'zip') return this.renderZipStep();\n    if (step === 'categories') return this.renderCategoriesStep();\n    if (step === 'services') return this.renderServicesStep();\n    if (step.indexOf('modifier_') === 0) {\n      var idx = parseInt(step.split('_')[1], 10);\n      return this.renderModifierStep(idx);\n    }\n    if (step === 'datetime') return this.renderDateTimeStep();\n    if (step === 'address') return this.renderAddressStep();\n    if (step === 'contact') return this.renderContactStep();\n    if (step === 'success') return this.renderSuccessStep();\n    return '';\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 1: ZIP CODE\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderZipStep = function() {\n    var html = '<div class=\"zbw-step\">';\n    html += '<h2 class=\"zbw-step-title\">Book Online</h2>';\n    html += '<p class=\"zbw-step-desc\">Enter your postal code to check availability in your area.</p>';\n\n    if (this.state.error) {\n      html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n    }\n\n    html += '<div class=\"zbw-form-group\">';\n    html += '<label for=\"zbw-postal\">Postal Code</label>';\n    html += '<input type=\"text\" id=\"zbw-postal\" class=\"zbw-input\" maxlength=\"7\" placeholder=\"K8N 1A1\" autocomplete=\"postal-code\" autocapitalize=\"characters\" value=\"' + this.esc(this.state.postalCode) + '\" />';\n    html += '</div>';\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"checkZip\"' + (this.state.loading ? ' disabled' : '') + '>';\n    html += this.state.loading ? 'Checking...' : 'Check Availability';\n    html += '</button>';\n\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.handleCheckZip = function() {\n    var input = document.getElementById('zbw-postal');\n    var code = input ? input.value.trim() : '';\n\n    if (!code) {\n      this.state.error = 'Please enter a postal code.';\n      this.render();\n      return;\n    }\n\n    if (!this.validatePostalCode(code)) {\n      this.state.error = 'Please enter a valid Canadian postal code (e.g. K8N 1A1).';\n      this.render();\n      return;\n    }\n\n    var normalized = this.normalizePostalCode(code);\n    this.state.postalCode = normalized;\n    this.state.address.postalCode = normalized;\n    this.state.loading = true;\n    this.state.error = null;\n    this.render();\n\n    var self = this;\n\n    this.fetchApi('/v1/scheduling/service_area_check?postal_code=' + encodeURIComponent(normalized))\n      .then(function(result) {\n        if (result.within_service_area && result.territory) {\n          self.state.territory = result.territory;\n\n          if (result.resolved_city) self.state.address.city = result.resolved_city;\n          if (result.resolved_province) self.state.address.province = result.resolved_province;\n          if (result.resolved_lat && result.resolved_lng) {\n            self.state.postalLat = result.resolved_lat;\n            self.state.postalLng = result.resolved_lng;\n          }\n\n          return self.loadServices();\n        } else {\n          self.state.loading = false;\n          self.state.error = 'Sorry, we don\\\\u2019t currently service this area.';\n          self.render();\n        }\n      })\n      .catch(function(err) {\n        self.state.loading = false;\n        self.state.error = err.message || 'Something went wrong. Please try again.';\n        self.render();\n        self.onError(err);\n      });\n  };\n\n  GOATkitWidget.prototype.loadServices = function() {\n    var self = this;\n    var tid = this.state.territory.id;\n\n    return this.fetchApi('/v1/services?territory_id=' + tid + '&active=true')\n      .then(function(result) {\n        var services = result.services || result || [];\n        self.state.services = services;\n\n        var catMap = {};\n        for (var i = 0; i < services.length; i++) {\n          var s = services[i];\n          if (s.category_id && s.category_name) {\n            catMap[s.category_id] = s.category_name;\n          }\n        }\n        var cats = [];\n        for (var cid in catMap) {\n          cats.push({ id: cid, name: catMap[cid] });\n        }\n        self.state.categories = cats;\n\n        self.state.loading = false;\n\n        if (cats.length > 1) {\n          self.goToStep('categories');\n        } else {\n          if (cats.length === 1) {\n            self.state.selectedCategory = cats[0].id;\n          }\n          self.goToStep('services');\n        }\n      })\n      .catch(function(err) {\n        self.state.loading = false;\n        self.state.error = err.message;\n        self.render();\n        self.onError(err);\n      });\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 2: CATEGORIES (conditional)\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderCategoriesStep = function() {\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">What do you need?</h2>';\n    html += '<p class=\"zbw-step-desc\">Select a category to view available services.</p>';\n\n    if (this.state.error) html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n\n    html += '<div class=\"zbw-cards\">';\n    for (var i = 0; i < this.state.categories.length; i++) {\n      var cat = this.state.categories[i];\n      var sel = this.state.selectedCategory === cat.id ? ' selected' : '';\n      html += '<div class=\"zbw-card' + sel + '\" data-action=\"selectCategory\" data-id=\"' + cat.id + '\">';\n      html += '<div class=\"zbw-card-title\">' + this.esc(cat.name) + '</div>';\n      html += '</div>';\n    }\n    html += '</div>';\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"confirmCategory\"' + (!this.state.selectedCategory ? ' disabled' : '') + '>Continue</button>';\n    html += '</div>';\n    return html;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 3: SERVICES\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderServicesStep = function() {\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">Select a Service</h2>';\n    html += '<p class=\"zbw-step-desc\">Choose from our available services.</p>';\n\n    if (this.state.error) html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n\n    if (this.state.loading) {\n      html += '<div class=\"zbw-cards\">';\n      for (var k = 0; k < 3; k++) html += '<div class=\"zbw-skeleton zbw-skeleton-card\"></div>';\n      html += '</div>';\n      html += '</div>';\n      return html;\n    }\n\n    var filtered = this.state.services;\n    if (this.state.selectedCategory) {\n      filtered = filtered.filter(function(s) { return s.category_id === this.state.selectedCategory; }.bind(this));\n    }\n\n    html += '<div class=\"zbw-cards\">';\n    for (var i = 0; i < filtered.length; i++) {\n      var svc = filtered[i];\n      var sel = this.state.selectedService && this.state.selectedService.id === svc.id ? ' selected' : '';\n      html += '<div class=\"zbw-card' + sel + '\" data-action=\"selectService\" data-id=\"' + svc.id + '\">';\n      html += '<div class=\"zbw-card-title\">' + this.esc(svc.name) + '</div>';\n      if (svc.description) html += '<div class=\"zbw-card-desc\">' + this.esc(svc.description) + '</div>';\n      html += '<div class=\"zbw-card-meta\">';\n      html += '<span class=\"zbw-card-price\">' + this.formatPrice(svc.base_price_cents) + '</span>';\n      html += '<span class=\"zbw-card-duration\">' + this.formatDuration(svc.base_duration_minutes) + '</span>';\n      html += '</div></div>';\n    }\n    html += '</div>';\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"confirmService\"' + (!this.state.selectedService ? ' disabled' : '') + '>' + (this.state.loading ? 'Loading...' : 'Continue') + '</button>';\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.handleSelectService = function(serviceId) {\n    var svc = this.state.services.find(function(s) { return s.id === serviceId; });\n    if (!svc) return;\n    var hadService = !!this.state.selectedService;\n    this.state.selectedService = svc;\n    this.state.modifierSelections = {};\n    this.state.timeslots = [];\n    this.state.selectedTimeslot = null;\n    this.state.selectedDate = null;\n    if (!hadService) {\n      this.render();\n    } else {\n      this._toggleCards('selectService', serviceId, 'confirmService');\n      this._refreshSidebar();\n    }\n  };\n\n  GOATkitWidget.prototype.handleConfirmService = function() {\n    if (!this.state.selectedService) return;\n    var self = this;\n    this.state.loading = true;\n    this.render();\n\n    this.fetchApi('/v1/services/' + this.state.selectedService.id)\n      .then(function(detail) {\n        self.state.serviceDetail = detail;\n        self.state.loading = false;\n\n        var modifiers = detail.modifiers || [];\n        if (modifiers.length > 0) {\n          self.goToStep('modifier_0');\n        } else {\n          self.goToStep('datetime');\n        }\n      })\n      .catch(function(err) {\n        self.state.loading = false;\n        self.state.error = err.message;\n        self.render();\n      });\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 4: MODIFIERS (1 per screen)\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderModifierStep = function(index) {\n    var detail = this.state.serviceDetail;\n    if (!detail || !detail.modifiers || !detail.modifiers[index]) return '';\n\n    var mod = detail.modifiers[index];\n    var isSelected = !!this.state.modifierSelections[mod.id];\n\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">' + this.esc(mod.name) + '</h2>';\n    if (mod.description) html += '<p class=\"zbw-step-desc\">' + this.esc(mod.description) + '</p>';\n\n    html += '<div class=\"zbw-modifier-card' + (isSelected ? ' selected' : '') + '\" data-action=\"toggleModifier\" data-id=\"' + mod.id + '\">';\n    html += '<div class=\"zbw-modifier-name\">' + this.esc(mod.name) + '</div>';\n    html += '<div class=\"zbw-modifier-price\">' + this.formatPriceDelta(mod.price_adjustment_cents) + '</div>';\n    if (mod.duration_adjustment_minutes) {\n      html += '<div style=\"font-size:13px;color:#64748b;margin-top:4px\">+' + mod.duration_adjustment_minutes + ' min</div>';\n    }\n    html += '</div>';\n\n    var nextStep;\n    if (index + 1 < detail.modifiers.length) {\n      nextStep = 'modifier_' + (index + 1);\n    } else {\n      nextStep = 'datetime';\n    }\n\n    if (mod.is_required && !isSelected) {\n      html += '<button class=\"zbw-btn zbw-btn-primary\" disabled>Select to continue</button>';\n    } else {\n      html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"nextModifier\" data-next=\"' + nextStep + '\">Continue</button>';\n    }\n\n    if (!mod.is_required && !isSelected) {\n      html += '<button class=\"zbw-btn zbw-btn-secondary\" data-action=\"nextModifier\" data-next=\"' + nextStep + '\">Skip</button>';\n    }\n\n    html += '</div>';\n    return html;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 5: DATE & TIME\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderDateTimeStep = function() {\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">Choose a Time</h2>';\n    html += '<p class=\"zbw-step-desc\">Select your preferred appointment date and time.</p>';\n\n    if (this.state.error) html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n\n    if (this.state.loading) {\n      html += '<div class=\"zbw-date-chips\">';\n      for (var k = 0; k < 5; k++) html += '<div class=\"zbw-skeleton zbw-skeleton-chip\"></div>';\n      html += '</div>';\n      html += '<div class=\"zbw-skeleton zbw-skeleton-card\"></div>';\n      html += '<div class=\"zbw-skeleton zbw-skeleton-card\"></div>';\n      html += '</div>';\n      return html;\n    }\n\n    if (this.state.timeslots.length === 0) {\n      this.loadTimeslots();\n      html += '<div style=\"text-align:center;padding:40px;color:#64748b\">Loading available times...</div>';\n      html += '</div>';\n      return html;\n    }\n\n    var allDates = [];\n    var byDate = {};\n    for (var i = 0; i < this.state.timeslots.length; i++) {\n      var t = this.state.timeslots[i];\n      if (!t.available) continue;\n      if (!byDate[t.date]) { byDate[t.date] = []; allDates.push(t.date); }\n      byDate[t.date].push(t);\n    }\n    allDates.sort();\n\n    var ws = this.state.dateWindowStart;\n    var visibleDates = allDates.slice(ws, ws + 7);\n    var selectedDate = this.state.selectedDate || (visibleDates.length > 0 ? visibleDates[0] : null);\n\n    html += '<div class=\"zbw-date-chips\">';\n    html += '<button class=\"zbw-date-nav\" data-action=\"dateNav\" data-dir=\"-1\"' + (ws <= 0 ? ' disabled' : '') + '>&lsaquo;</button>';\n\n    for (var d = 0; d < visibleDates.length; d++) {\n      var ds = this.formatDateShort(visibleDates[d]);\n      var dsel = visibleDates[d] === selectedDate ? ' selected' : '';\n      html += '<div class=\"zbw-date-chip' + dsel + '\" data-action=\"selectDate\" data-date=\"' + visibleDates[d] + '\">';\n      html += '<div class=\"zbw-date-day\">' + ds.day + '</div>';\n      html += '<div class=\"zbw-date-num\">' + ds.date + '</div>';\n      html += '</div>';\n    }\n\n    html += '<button class=\"zbw-date-nav\" data-action=\"dateNav\" data-dir=\"1\"' + (ws + 7 >= allDates.length ? ' disabled' : '') + '>&rsaquo;</button>';\n    html += '</div>';\n\n    var slots = byDate[selectedDate] || [];\n    if (slots.length === 0) {\n      html += '<div style=\"text-align:center;padding:24px;color:#94a3b8;font-size:14px\">No availability on this date.</div>';\n    } else {\n      html += '<div class=\"zbw-timeslots\">';\n      for (var s = 0; s < slots.length; s++) {\n        var sl = slots[s];\n        var ssel = this.state.selectedTimeslot && this.state.selectedTimeslot.date === sl.date && this.state.selectedTimeslot.start_time === sl.start_time ? ' selected' : '';\n        html += '<div class=\"zbw-timeslot' + ssel + '\" data-action=\"selectTimeslot\" data-date=\"' + sl.date + '\" data-time=\"' + sl.start_time + '\" data-price=\"' + (sl.price || 0) + '\">';\n        html += '<div class=\"zbw-timeslot-time\">' + this.formatTime(sl.start_time) + '</div>';\n        if (sl.price) html += '<div class=\"zbw-timeslot-price\">' + this.formatPrice(sl.price) + '</div>';\n        html += '</div>';\n      }\n      html += '</div>';\n    }\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"confirmDatetime\"' + (!this.state.selectedTimeslot ? ' disabled' : '') + '>Continue</button>';\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.loadTimeslots = function() {\n    var self = this;\n    self.state.loading = true;\n    self.render();\n\n    var today = new Date();\n    var dateFrom = today.toISOString().split('T')[0];\n    var end = new Date(today);\n    end.setDate(end.getDate() + 14);\n    var dateTo = end.toISOString().split('T')[0];\n    var dur = this.getEffectiveDuration();\n\n    var params = 'territory_id=' + this.state.territory.id +\n      '&date_from=' + dateFrom +\n      '&date_to=' + dateTo +\n      '&duration_minutes=' + dur +\n      '&service_id=' + this.state.selectedService.id;\n\n    this.fetchApi('/v1/scheduling/timeslots?' + params)\n      .then(function(result) {\n        self.state.timeslots = result.timeslots || [];\n        self.state.loading = false;\n        self.state.selectedDate = null;\n        self.state.selectedTimeslot = null;\n        self.state.dateWindowStart = 0;\n        self.render();\n      })\n      .catch(function(err) {\n        self.state.loading = false;\n        self.state.error = err.message;\n        self.render();\n      });\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 6: ADDRESS\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderAddressStep = function() {\n    var a = this.state.address;\n    var provinces = ['AB','BC','MB','NB','NL','NS','NT','NU','ON','PE','QC','SK','YT'];\n\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">Service Address</h2>';\n    html += '<p class=\"zbw-step-desc\">Where should we come?</p>';\n\n    if (this.state.error) html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n\n    html += '<div class=\"zbw-form-group zbw-ac-wrap\"><label>Street Address *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-addr1\" autocomplete=\"address-line1\" value=\"' + this.esc(a.line1) + '\" placeholder=\"Start typing your address...\" /><div id=\"zbw-ac-list\" class=\"zbw-ac-list\"></div></div>';\n    html += '<div class=\"zbw-form-group\"><label>Apt / Unit</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-addr2\" autocomplete=\"address-line2\" value=\"' + this.esc(a.line2) + '\" /></div>';\n\n    html += '<div class=\"zbw-row\">';\n    html += '<div class=\"zbw-form-group\"><label>City *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-city\" autocomplete=\"address-level2\" value=\"' + this.esc(a.city) + '\" /></div>';\n    html += '<div class=\"zbw-form-group\"><label>Province *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-prov\" autocomplete=\"address-level1\" value=\"' + this.esc(a.province) + '\" placeholder=\"ON\" /></div>';\n    html += '</div>';\n\n    html += '<div class=\"zbw-form-group\"><label>Postal Code *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-postal2\" maxlength=\"7\" autocomplete=\"postal-code\" autocapitalize=\"characters\" value=\"' + this.esc(a.postalCode) + '\" /></div>';\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"confirmAddress\">Continue</button>';\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.readAddressFromDOM = function() {\n    var line1 = (document.getElementById('zbw-addr1') || {}).value;\n    var line2 = (document.getElementById('zbw-addr2') || {}).value;\n    var city = (document.getElementById('zbw-city') || {}).value;\n    var prov = (document.getElementById('zbw-prov') || {}).value;\n    var postal = (document.getElementById('zbw-postal2') || {}).value;\n    if (line1 !== undefined) this.state.address.line1 = line1.trim();\n    if (line2 !== undefined) this.state.address.line2 = line2.trim();\n    if (city !== undefined) this.state.address.city = city.trim();\n    if (prov !== undefined) {\n      var provMap = {'alberta':'AB','british columbia':'BC','manitoba':'MB','new brunswick':'NB','newfoundland and labrador':'NL','nova scotia':'NS','northwest territories':'NT','nunavut':'NU','ontario':'ON','prince edward island':'PE','quebec':'QC','saskatchewan':'SK','yukon':'YT'};\n      var normalized = provMap[prov.toLowerCase().trim()] || prov.trim();\n      this.state.address.province = normalized.length <= 2 ? normalized.toUpperCase() : normalized;\n    }\n    if (postal !== undefined) this.state.address.postalCode = postal.trim();\n  };\n\n  GOATkitWidget.prototype.handleConfirmAddress = function() {\n    this.readAddressFromDOM();\n    var a = this.state.address;\n\n    if (!a.line1 || !a.city || !a.province || !a.postalCode) {\n      this.state.error = 'Please fill in all required fields.';\n      this.render();\n      return;\n    }\n    this.goToStep('contact');\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 7: CONTACT + BOOK\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderContactStep = function() {\n    var c = this.state.contact;\n\n    var html = '<div class=\"zbw-step\">';\n    html += this.renderBackButton();\n    html += '<h2 class=\"zbw-step-title\">Almost Done!</h2>';\n    html += '<p class=\"zbw-step-desc\">Enter your contact info to complete your booking.</p>';\n\n    if (this.state.error) html += '<div class=\"zbw-error\">' + this.esc(this.state.error) + '</div>';\n\n    html += '<div class=\"zbw-row\">';\n    html += '<div class=\"zbw-form-group\"><label>First Name *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-fname\" autocomplete=\"given-name\" value=\"' + this.esc(c.firstName) + '\" /></div>';\n    html += '<div class=\"zbw-form-group\"><label>Last Name *</label><input type=\"text\" class=\"zbw-input\" id=\"zbw-lname\" autocomplete=\"family-name\" value=\"' + this.esc(c.lastName) + '\" /></div>';\n    html += '</div>';\n    html += '<div class=\"zbw-form-group\"><label>Email *</label><input type=\"email\" class=\"zbw-input\" id=\"zbw-email\" autocomplete=\"email\" inputmode=\"email\" autocapitalize=\"off\" spellcheck=\"false\" value=\"' + this.esc(c.email) + '\" placeholder=\"you@example.com\" /></div>';\n    html += '<div class=\"zbw-form-group\"><label>Phone *</label><input type=\"tel\" class=\"zbw-input\" id=\"zbw-phone\" autocomplete=\"tel\" inputmode=\"tel\" value=\"' + this.esc(c.phone) + '\" placeholder=\"(555) 123-4567\" /></div>';\n\n    html += '<div class=\"zbw-form-group\" style=\"margin-top:8px;\">';\n    html += '<label style=\"display:flex;align-items:flex-start;gap:8px;cursor:pointer;font-size:13px;line-height:1.4;\">';\n    html += '<input type=\"checkbox\" id=\"zbw-sms-consent\"' + (this.state.smsConsent ? ' checked' : '') + ' style=\"margin-top:2px;flex-shrink:0;\" />';\n    html += '<span style=\"color:#666;\">I agree to receive SMS updates about my booking (appointment reminders, status changes). Msg & data rates may apply. Reply STOP to opt out.</span>';\n    html += '</label>';\n    html += '</div>';\n\n    html += '<button class=\"zbw-btn zbw-btn-primary\" data-action=\"submitBooking\"' + (this.state.loading ? ' disabled' : '') + '>' + (this.state.loading ? 'Booking...' : 'Book Now') + '</button>';\n    html += '</div>';\n    return html;\n  };\n\n  GOATkitWidget.prototype.handleSubmitBooking = function() {\n    if (this.state.submitting) return;\n\n    var fn = (document.getElementById('zbw-fname') || {}).value || '';\n    var ln = (document.getElementById('zbw-lname') || {}).value || '';\n    var em = (document.getElementById('zbw-email') || {}).value || '';\n    var ph = (document.getElementById('zbw-phone') || {}).value || '';\n    var smsEl = document.getElementById('zbw-sms-consent');\n    var smsConsent = smsEl ? smsEl.checked : false;\n    this.state.smsConsent = smsConsent;\n\n    this.state.contact = { firstName: fn.trim(), lastName: ln.trim(), email: em.trim(), phone: ph.trim() };\n\n    if (!fn.trim() || !ln.trim() || !em.trim() || !ph.trim()) {\n      this.state.error = 'Please fill in all required fields.';\n      this.render();\n      return;\n    }\n\n    if (!/^[^\\\\s@]+@[^\\\\s@]+\\\\.[^\\\\s@]+$/.test(em.trim())) {\n      this.state.error = 'Please enter a valid email address.';\n      this.render();\n      return;\n    }\n\n    this.state.loading = true;\n    this.state.submitting = true;\n    this.state.error = null;\n    this.render();\n\n    var self = this;\n    var svc = this.state.selectedService;\n    var ts = this.state.selectedTimeslot;\n    var a = this.state.address;\n\n    if (!svc || !ts || !ts.date) {\n      this.state.loading = false;\n      this.state.error = 'Please go back and select a service and time.';\n      this.render();\n      return;\n    }\n    if (!a.line1 || !a.city) {\n      this.state.loading = false;\n      this.state.error = 'Please go back and fill in your address.';\n      this.render();\n      return;\n    }\n\n    var selectedModIds = [];\n    if (this.state.serviceDetail && this.state.serviceDetail.modifiers) {\n      for (var i = 0; i < this.state.serviceDetail.modifiers.length; i++) {\n        var mod = this.state.serviceDetail.modifiers[i];\n        if (this.state.modifierSelections[mod.id]) selectedModIds.push(mod.id);\n      }\n    }\n\n    this.fetchApi('/v1/bookings/create', {\n      method: 'POST',\n      body: JSON.stringify({\n        first_name: fn.trim(),\n        last_name: ln.trim(),\n        email: em.trim(),\n        phone: ph.trim() || null,\n        sms_consent: smsConsent,\n        address_line1: a.line1,\n        address_line2: a.line2 || null,\n        city: a.city,\n        province: a.province,\n        postal_code: a.postalCode,\n        territory_id: self.state.territory.id,\n        service_id: svc.id,\n        scheduled_date: ts.date,\n        scheduled_start_time: ts.start_time,\n        duration_minutes: self.getEffectiveDuration(),\n        selected_modifiers: selectedModIds,\n        lat: a.lat || undefined,\n        lng: a.lng || undefined\n      })\n    })\n    .then(function(job) {\n      self.state.jobId = job.id;\n      self.state.loading = false;\n      self.goToStep('success');\n      self.onComplete({ jobId: job.id, service: svc.name, date: ts.date, time: ts.start_time });\n    })\n    .catch(function(err) {\n      self.state.loading = false;\n      self.state.submitting = false;\n      self.state.error = err.message || 'Booking failed. Please try again.';\n      self.render();\n      self.onError(err);\n    });\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // STEP 8: SUCCESS\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.renderSuccessStep = function() {\n    var ts = this.state.selectedTimeslot;\n    var svc = this.state.selectedService;\n    var html = '<div class=\"zbw-success\">';\n    html += '<div class=\"zbw-success-icon\"><svg width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#16a34a\" stroke-width=\"2.5\"><path d=\"M20 6L9 17l-5-5\"/></svg></div>';\n    html += '<h2>Booking Confirmed!</h2>';\n    html += '<p>Your appointment has been scheduled.</p>';\n    if (svc) html += '<p style=\"font-weight:600;margin-top:12px\">' + this.esc(svc.name) + '</p>';\n    if (ts) html += '<p>' + this.formatDate(ts.date) + ' at ' + this.formatTime(ts.start_time) + '</p>';\n    html += '<p style=\"color:#94a3b8;font-size:13px;margin-top:16px\">Booking ID: ' + (this.state.jobId || '') + '</p>';\n    if (this.state.contact.email) {\n      html += '<p style=\"color:#64748b;font-size:13px\">Confirmation sent to ' + this.esc(this.state.contact.email) + '</p>';\n    }\n    html += '</div>';\n    return html;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // TARGETED DOM UPDATES (no full re-render)\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype._toggleCards = function(action, selectedId, confirmAction) {\n    var el = document.getElementById(this.containerId);\n    if (!el) return;\n    var cards = el.querySelectorAll('[data-action=\"' + action + '\"]');\n    for (var i = 0; i < cards.length; i++) {\n      if (cards[i].getAttribute('data-id') === selectedId) cards[i].classList.add('selected');\n      else cards[i].classList.remove('selected');\n    }\n    if (confirmAction) {\n      var btn = el.querySelector('[data-action=\"' + confirmAction + '\"]');\n      if (btn) btn.disabled = !selectedId;\n    }\n  };\n\n  GOATkitWidget.prototype._refreshSidebar = function() {\n    var el = document.getElementById(this.containerId);\n    if (!el) return;\n    var sidebar = el.querySelector('.zbw-sidebar');\n    if (sidebar) sidebar.innerHTML = this.renderSidebar();\n    var mBtn = el.querySelector('.zbw-mobile-summary-btn strong');\n    if (mBtn) mBtn.textContent = this.formatPrice(this.getRunningTotal());\n  };\n\n  GOATkitWidget.prototype._renderSlotsForDate = function(date) {\n    var byDate = {};\n    for (var i = 0; i < this.state.timeslots.length; i++) {\n      var t = this.state.timeslots[i];\n      if (!t.available) continue;\n      if (!byDate[t.date]) byDate[t.date] = [];\n      byDate[t.date].push(t);\n    }\n    var slots = byDate[date] || [];\n    if (slots.length === 0) return '<div style=\"text-align:center;padding:24px;color:#94a3b8;font-size:14px\">No availability on this date.</div>';\n    var html = '<div class=\"zbw-timeslots\">';\n    for (var s = 0; s < slots.length; s++) {\n      var sl = slots[s];\n      html += '<div class=\"zbw-timeslot\" data-action=\"selectTimeslot\" data-date=\"' + sl.date + '\" data-time=\"' + sl.start_time + '\" data-price=\"' + (sl.price || 0) + '\">';\n      html += '<div class=\"zbw-timeslot-time\">' + this.formatTime(sl.start_time) + '</div>';\n      if (sl.price) html += '<div class=\"zbw-timeslot-price\">' + this.formatPrice(sl.price) + '</div>';\n      html += '</div>';\n    }\n    html += '</div>';\n    return html;\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // EVENT HANDLING\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  GOATkitWidget.prototype.attachEvents = function() {\n    var self = this;\n    var container = document.getElementById(this.containerId);\n    if (!container) return;\n\n    container.addEventListener('click', function(e) {\n      var target = e.target.closest('[data-action]');\n      if (!target) return;\n      var action = target.getAttribute('data-action');\n\n      switch (action) {\n        case 'checkZip': self.handleCheckZip(); break;\n        case 'back': self.goBack(); break;\n        case 'toggleSummary':\n          self.state.summaryExpanded = !self.state.summaryExpanded;\n          var sumContent = container.querySelector('.zbw-mobile-summary > div:last-child');\n          if (self.state.summaryExpanded && !sumContent) {\n            var wrap = container.querySelector('.zbw-mobile-summary');\n            if (wrap) { var d = document.createElement('div'); d.style.marginTop = '8px'; d.innerHTML = self.renderSidebar(); wrap.appendChild(d); }\n          } else if (!self.state.summaryExpanded && sumContent) {\n            sumContent.remove();\n          }\n          break;\n        case 'selectCategory':\n          self.state.selectedCategory = target.getAttribute('data-id');\n          self.state.selectedService = null;\n          self.state.serviceDetail = null;\n          self.state.modifierSelections = {};\n          self._toggleCards('selectCategory', self.state.selectedCategory, 'confirmCategory');\n          break;\n        case 'confirmCategory':\n          if (self.state.selectedCategory) self.goToStep('services');\n          break;\n        case 'selectService':\n          self.handleSelectService(target.getAttribute('data-id'));\n          break;\n        case 'confirmService':\n          self.handleConfirmService();\n          break;\n        case 'toggleModifier':\n          var mid = target.getAttribute('data-id');\n          self.state.modifierSelections[mid] = !self.state.modifierSelections[mid];\n          self.render();\n          break;\n        case 'nextModifier':\n          var next = target.getAttribute('data-next');\n          self.goToStep(next);\n          break;\n        case 'dateNav':\n          var dir = parseInt(target.getAttribute('data-dir'), 10);\n          self.state.dateWindowStart = Math.max(0, self.state.dateWindowStart + dir * 7);\n          self.render();\n          break;\n        case 'selectDate':\n          self.state.selectedDate = target.getAttribute('data-date');\n          self.state.selectedTimeslot = null;\n          var allChips = container.querySelectorAll('[data-action=\"selectDate\"]');\n          for (var ci = 0; ci < allChips.length; ci++) {\n            if (allChips[ci].getAttribute('data-date') === self.state.selectedDate) allChips[ci].classList.add('selected');\n            else allChips[ci].classList.remove('selected');\n          }\n          var slotsContainer = container.querySelector('.zbw-timeslots') || container.querySelector('[style*=\"text-align:center\"]');\n          if (slotsContainer) {\n            var wrap = slotsContainer.parentNode;\n            var confirmBtn = container.querySelector('[data-action=\"confirmDatetime\"]');\n            slotsContainer.outerHTML = self._renderSlotsForDate(self.state.selectedDate);\n            if (confirmBtn) confirmBtn.disabled = true;\n          }\n          break;\n        case 'selectTimeslot':\n          self.state.selectedTimeslot = {\n            date: target.getAttribute('data-date'),\n            start_time: target.getAttribute('data-time'),\n            price: parseInt(target.getAttribute('data-price'), 10) || 0\n          };\n          var allSlots = container.querySelectorAll('[data-action=\"selectTimeslot\"]');\n          for (var si = 0; si < allSlots.length; si++) {\n            if (allSlots[si] === target) allSlots[si].classList.add('selected');\n            else allSlots[si].classList.remove('selected');\n          }\n          var dtBtn = container.querySelector('[data-action=\"confirmDatetime\"]');\n          if (dtBtn) dtBtn.disabled = false;\n          self._refreshSidebar();\n          break;\n        case 'confirmDatetime':\n          if (self.state.selectedTimeslot) self.goToStep('address');\n          break;\n        case 'confirmAddress':\n          self.handleConfirmAddress();\n          break;\n        case 'submitBooking':\n          self.handleSubmitBooking();\n          break;\n      }\n    });\n\n    var postalInput = container.querySelector('#zbw-postal');\n    if (postalInput) {\n      postalInput.addEventListener('keypress', function(e) {\n        if (e.key === 'Enter') self.handleCheckZip();\n      });\n      postalInput.focus();\n    }\n\n     var addrInput = container.querySelector('#zbw-addr1');\n     if (addrInput) {\n        addrInput.addEventListener('input', function() {\n          var q = addrInput.value.trim();\n          clearTimeout(self._acTimer);\n          if (self._acAbort) { self._acAbort.abort(); self._acAbort = null; }\n          var list = document.getElementById('zbw-ac-list');\n          if (q.length < 3) { if (list) list.innerHTML = ''; return; }\n          self._acTimer = setTimeout(function() {\n            var ctrl = new AbortController();\n            self._acAbort = ctrl;\n            var prox = (self.state.postalLng && self.state.postalLat) ? self.state.postalLng + ',' + self.state.postalLat : 'ip';\n            var base = String(self.apiUrl || '').replace(/[/]+$/, '');\n            var endpoint = base + '/widget/address/search?q=' + encodeURIComponent(q) + '&proximity=' + encodeURIComponent(prox);\n            fetch(endpoint, { signal: ctrl.signal, headers: { 'Accept': 'application/json' } })\n              .then(function(r) {\n                if (!r.ok) throw new Error('Address lookup failed');\n                return r.json();\n              })\n              .then(function(data) {\n                self._acAbort = null;\n                if (!list) return;\n                var features = Array.isArray(data.features) ? data.features : [];\n                if (!features.length) { list.innerHTML = ''; return; }\n                list.innerHTML = features.map(function(f, i) {\n                  var p = f.properties;\n                  var ctx = p.context || {};\n                  return '<div class=\"zbw-ac-item\" data-ac-idx=\"' + i + '\">' +\n                    '<div class=\"zbw-ac-main\">' + (p.name || '') + '</div>' +\n                    '<div class=\"zbw-ac-sub\">' + (ctx.place ? ctx.place.name + ', ' : '') + (ctx.region ? ctx.region.region_code + ' ' : '') + (ctx.postcode ? ctx.postcode.name : '') + '</div>' +\n                    '</div>';\n                }).join('');\n                self._acFeatures = features;\n              })\n              .catch(function(err) {\n                self._acAbort = null;\n                if (err && err.name === 'AbortError') return;\n                if (list) {\n                  list.innerHTML = '<div class=\"zbw-ac-item\" style=\"pointer-events:none;opacity:.8;\"><div class=\"zbw-ac-main\">Address autocomplete unavailable</div><div class=\"zbw-ac-sub\">Please try again in a moment.</div></div>';\n                }\n              });\n          }, 300);\n        });\n\n      addrInput.addEventListener('blur', function() {\n        setTimeout(function() {\n          var list = document.getElementById('zbw-ac-list');\n          if (list) list.innerHTML = '';\n        }, 200);\n      });\n\n      container.addEventListener('click', function(e) {\n        var item = e.target.closest('.zbw-ac-item');\n        if (!item || !self._acFeatures) return;\n        var idx = parseInt(item.getAttribute('data-ac-idx'), 10);\n        var f = self._acFeatures[idx];\n        if (!f) return;\n        var p = f.properties;\n        var ctx = p.context || {};\n        var addr1 = document.getElementById('zbw-addr1');\n        var city = document.getElementById('zbw-city');\n        var prov = document.getElementById('zbw-prov');\n        var postal = document.getElementById('zbw-postal2');\n        if (addr1) addr1.value = p.name || '';\n        if (city) city.value = ctx.place ? ctx.place.name : '';\n        if (prov) prov.value = ctx.region ? ctx.region.region_code : '';\n        if (postal) postal.value = ctx.postcode ? ctx.postcode.name : '';\n        if (f.geometry && f.geometry.coordinates) {\n          self.state.address.lat = f.geometry.coordinates[1];\n          self.state.address.lng = f.geometry.coordinates[0];\n        }\n        self.readAddressFromDOM();\n        var list = document.getElementById('zbw-ac-list');\n        if (list) list.innerHTML = '';\n      });\n    }\n  };\n\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  // EXPOSE\n  // \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  window.GOATkitWidget = GOATkitWidget;\n\n  if (typeof window.GOATkitConfig !== 'undefined') {\n    window.goatkitInstance = new GOATkitWidget(window.GOATkitConfig);\n  }\n})();`;\n\nexport const BOOKING_WIDGET_POPUP = `(function() {\n  var API_URL = 'https://api.unclebike.xyz';\n  var PRIMARY_COLOR = '#2563eb';\n  var loaded = false;\n  var overlay = null;\n\n  function getConfig() {\n    return window.GOATkitPopupConfig || {};\n  }\n\n  function createOverlay() {\n    if (overlay) return overlay;\n    var cfg = getConfig();\n    var apiUrl = cfg.apiUrl || API_URL;\n    var color = cfg.primaryColor || PRIMARY_COLOR;\n\n    overlay = document.createElement('div');\n    overlay.id = 'zbw-popup-overlay';\n    overlay.innerHTML = '<div id=\"zbw-popup-backdrop\"></div>' +\n      '<div id=\"zbw-popup-container\">' +\n        '<button id=\"zbw-popup-close\" aria-label=\"Close\">&times;</button>' +\n        '<div id=\"zbw-popup-widget\"></div>' +\n      '</div>';\n\n    var style = document.createElement('style');\n    style.textContent = '#zbw-popup-overlay{position:fixed;inset:0;z-index:99999;display:none;align-items:center;justify-content:center}' +\n      '#zbw-popup-overlay.zbw-open{display:flex}' +\n      '#zbw-popup-backdrop{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);backdrop-filter:blur(2px)}' +\n      '#zbw-popup-container{position:relative;width:94vw;max-width:900px;max-height:min(90dvh,calc(100dvh - 24px));background:#fff;border-radius:16px;box-shadow:0 24px 64px rgba(0,0,0,.2);overflow-y:auto;padding:24px;z-index:1}' +\n      '#zbw-popup-close{position:absolute;top:12px;right:16px;background:none;border:none;font-size:28px;cursor:pointer;color:#64748b;z-index:2;line-height:1;padding:4px 8px;border-radius:8px;transition:background .15s}' +\n      '#zbw-popup-close:hover{background:#f1f5f9;color:#0f172a}' +\n      '@media(max-width:640px){#zbw-popup-container{width:100vw;max-width:100vw;height:100dvh;max-height:100dvh;border-radius:0;padding:calc(16px + env(safe-area-inset-top,0px)) calc(12px + env(safe-area-inset-right,0px)) calc(16px + env(safe-area-inset-bottom,0px)) calc(12px + env(safe-area-inset-left,0px))}}' +\n      '[data-theme=\"dark\"] #zbw-popup-backdrop{background:rgba(17,17,27,.7)}' +\n      '[data-theme=\"dark\"] #zbw-popup-container{background:#1e1e2e;box-shadow:0 24px 64px rgba(0,0,0,.5)}' +\n      '[data-theme=\"dark\"] #zbw-popup-close{color:#a6adc8}' +\n      '[data-theme=\"dark\"] #zbw-popup-close:hover{background:#313244;color:#cdd6f4}';\n    document.head.appendChild(style);\n    document.body.appendChild(overlay);\n\n    overlay.querySelector('#zbw-popup-backdrop').addEventListener('click', closePopup);\n    overlay.querySelector('#zbw-popup-close').addEventListener('click', closePopup);\n\n    if (!loaded) {\n      window.GOATkitConfig = {\n        apiUrl: apiUrl,\n        containerId: 'zbw-popup-widget',\n        primaryColor: color,\n        onComplete: function(booking) {\n          if (cfg.onComplete) cfg.onComplete(booking);\n          setTimeout(closePopup, 2500);\n        },\n        onError: function(err) { if (cfg.onError) cfg.onError(err); },\n        onStepChange: function(step, idx) { if (cfg.onStepChange) cfg.onStepChange(step, idx); }\n      };\n      var s = document.createElement('script');\n      s.src = apiUrl + '/widget/booking-widget.js';\n      document.body.appendChild(s);\n      loaded = true;\n    }\n\n    return overlay;\n  }\n\n  function syncPopupViewport() {\n    if (!overlay) return;\n    var vv = window.visualViewport;\n    var viewportHeight = vv ? vv.height : window.innerHeight;\n    var viewportTop = vv ? vv.offsetTop : 0;\n    var keyboardBottomInset = vv ? Math.max(0, window.innerHeight - (vv.height + vv.offsetTop)) : 0;\n    overlay.style.top = viewportTop + 'px';\n    overlay.style.bottom = keyboardBottomInset + 'px';\n    var container = overlay.querySelector('#zbw-popup-container');\n    if (container) {\n      var h = Math.max(260, Math.floor(viewportHeight - 24));\n      container.style.maxHeight = h + 'px';\n    }\n  }\n\n  function openPopup() {\n    var el = createOverlay();\n    el.classList.add('zbw-open');\n    document.body.style.overflow = 'hidden';\n    syncPopupViewport();\n    if (window.visualViewport) {\n      window.visualViewport.addEventListener('resize', syncPopupViewport);\n      window.visualViewport.addEventListener('scroll', syncPopupViewport);\n    }\n    window.addEventListener('orientationchange', syncPopupViewport);\n\n    if (window.goatkitInstance) {\n      window.goatkitInstance.state.currentStep = 'zip';\n      window.goatkitInstance.state.stepHistory = ['zip'];\n      window.goatkitInstance.state.error = null;\n      window.goatkitInstance.state.loading = false;\n      window.goatkitInstance.state.submitting = false;\n      window.goatkitInstance.render();\n    }\n  }\n\n  function closePopup() {\n    if (overlay) {\n      overlay.classList.remove('zbw-open');\n      document.body.style.overflow = '';\n      overlay.style.top = '';\n      overlay.style.bottom = '';\n      if (window.visualViewport) {\n        window.visualViewport.removeEventListener('resize', syncPopupViewport);\n        window.visualViewport.removeEventListener('scroll', syncPopupViewport);\n      }\n      window.removeEventListener('orientationchange', syncPopupViewport);\n    }\n  }\n\n  document.addEventListener('keydown', function(e) {\n    if (e.key === 'Escape') closePopup();\n  });\n\n  document.addEventListener('click', function(e) {\n    var el = e.target.closest('[data-zbw-open], .zbw-book-btn');\n    if (el) { e.preventDefault(); openPopup(); }\n  });\n\n  window.GOATkitPopup = { open: openPopup, close: closePopup };\n\n  var cfg = getConfig();\n  if (cfg.floatingButton !== false) {\n    var ready = function() {\n      var btn = document.createElement('button');\n      btn.id = 'zbw-floating-btn';\n      btn.innerHTML = '<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"/><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"/><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"/></svg> ' + (cfg.floatingButtonText || 'Book Now');\n      var color = cfg.primaryColor || PRIMARY_COLOR;\n      var s = document.createElement('style');\n      s.textContent = '#zbw-floating-btn{position:fixed;bottom:24px;right:24px;z-index:9999;background:' + color + ';color:#fff;border:none;padding:14px 24px;border-radius:50px;font-size:15px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;box-shadow:0 4px 16px rgba(0,0,0,.2);transition:transform .15s,box-shadow .15s}' +\n        '#zbw-floating-btn:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(0,0,0,.25)}' +\n        '#zbw-floating-btn svg{flex-shrink:0}' +\n        '@media(max-width:640px){#zbw-floating-btn{bottom:16px;right:16px;padding:12px 20px;font-size:14px}}' +\n        '[data-theme=\"dark\"] #zbw-floating-btn{box-shadow:0 4px 16px rgba(0,0,0,.4)}' +\n        '[data-theme=\"dark\"] #zbw-floating-btn:hover{box-shadow:0 6px 24px rgba(0,0,0,.5)}';\n      document.head.appendChild(s);\n      document.body.appendChild(btn);\n      btn.addEventListener('click', openPopup);\n    };\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', ready);\n    else ready();\n  }\n})();`;\n\nexport const BOOKING_WIDGET_DEMO = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, viewport-fit=cover, interactive-widget=resizes-content\">\n  <title>Booking Widget Demo</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f1f5f9; min-height: 100vh; min-height: 100dvh; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; }\n    .demo-header { text-align: center; margin-bottom: 32px; }\n    .demo-header h1 { font-size: 28px; color: #0f172a; margin-bottom: 8px; }\n    .demo-header p { color: #64748b; font-size: 15px; }\n    #goatkit-widget { width: 100%; max-width: 900px; background: #fff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,.08); padding: 32px; }\n    .demo-code { max-width: 900px; width: 100%; margin-top: 40px; background: #fff; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,.04); }\n    .demo-code h3 { font-size: 16px; margin-bottom: 12px; color: #0f172a; }\n    .demo-code pre { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; overflow-x: auto; font-size: 13px; line-height: 1.6; }\n  </style>\n</head>\n<body>\n  <div class=\"demo-header\">\n    <h1>Booking Widget</h1>\n    <p>Embeddable booking widget for your website</p>\n  </div>\n\n  <div id=\"goatkit-widget\"></div>\n\n  <div class=\"demo-code\">\n    <h3>Embed on Your Site</h3>\n    <pre><code>&lt;div id=\"goatkit-widget\"&gt;&lt;/div&gt;\n\n&lt;script&gt;\n  window.GOATkitConfig = {\n    apiUrl: 'https://api.unclebike.xyz',\n    containerId: 'goatkit-widget',\n    primaryColor: '#2563eb',\n    onComplete: function(booking) {\n      console.log('Booked:', booking);\n    }\n  };\n&lt;/script&gt;\n&lt;script src=\"https://api.unclebike.xyz/widget/booking-widget.js\"&gt;&lt;/script&gt;</code></pre>\n  </div>\n\n  <script>\n    window.GOATkitConfig = {\n      apiUrl: window.location.origin,\n      containerId: 'goatkit-widget',\n      primaryColor: '#2563eb',\n      onComplete: function(booking) {\n        console.log('Booking completed:', booking);\n      },\n      onError: function(error) {\n        console.error('Booking error:', error);\n      },\n      onStepChange: function(step, index) {\n        console.log('Step:', step, 'Index:', index);\n      }\n    };\n  </script>\n  <script src=\"/widget/booking-widget.js\"></script>\n</body>\n</html>`;\n", "import { Hono } from 'hono';\nimport { cors } from 'hono/cors';\nimport { authMiddleware } from './middleware/auth';\nimport adminRoutes from './routes/admin';\nimport bookingsRoutes from './routes/bookings';\nimport categoriesRoutes from './routes/categories';\nimport couponsRoutes from './routes/coupons';\nimport customersRoutes from './routes/customers';\nimport invoicesRoutes from './routes/invoices';\nimport jobsRoutes from './routes/jobs';\nimport modifiersRoutes from './routes/modifiers';\nimport recurringBookingsRoutes from './routes/recurring-bookings';\nimport schedulingRoutes from './routes/scheduling';\nimport servicesRoutes from './routes/services';\nimport skillsRoutes from './routes/skills';\nimport teamRoutes from './routes/team';\nimport territoriesRoutes from './routes/territories';\nimport transactionsRoutes from './routes/transactions';\nimport messagesRoutes from './routes/messages';\nimport webhooksRoutes from './routes/webhooks';\nimport twilioWebhooksRoutes from './routes/twilio-webhooks';\nimport { BOOKING_WIDGET_DEMO, BOOKING_WIDGET_JS, BOOKING_WIDGET_POPUP } from './widget/embed';\n\nconst app = new Hono<{ Bindings: { DB: D1Database; ASSETS: any; MAPBOX_ACCESS_TOKEN?: string } }>();\n\napp.onError((err, c) => {\n  console.error('Unhandled error:', err.message, err.stack);\n  return c.text(`Error: ${err.message}`, 500);\n});\n\napp.use('/v1/*', cors());\napp.use('/widget/*', cors());\napp.get('/fonts/*', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.get('/images/*', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.get('/admin.js', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.get('/admin.webmanifest', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.get('/admin-sw.js', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.get('/admin-offline.html', (c) => c.env.ASSETS.fetch(c.req.raw));\napp.use('/admin/*', async (c, next) => {\n  await next();\n  c.header('Cache-Control', 'no-cache, no-store, must-revalidate');\n  c.header('Pragma', 'no-cache');\n});\napp.use('*', authMiddleware);\n\napp.get('/health', (c) => {\n  return c.json({ status: 'ok', timestamp: new Date().toISOString() });\n});\n\nconst getWidgetPrimaryColor = async (db: D1Database) => {\n  let primaryColor = '#2563eb';\n  try {\n    const row = await db.prepare(\"SELECT value FROM settings WHERE key = 'widget_branding'\").first<{ value: string }>();\n    if (row) {\n      const branding = JSON.parse(row.value) as { primaryColor?: string };\n      if (branding.primaryColor) primaryColor = branding.primaryColor;\n    }\n  } catch {\n  }\n  return primaryColor;\n};\n\ntype WidgetMapboxFeature = {\n  properties?: {\n    full_address?: string;\n    name?: string;\n    context?: {\n      place?: { name?: string };\n      region?: { region_code?: string };\n      postcode?: { name?: string };\n    };\n  };\n  geometry?: { coordinates?: [number, number] };\n};\n\nconst normalizeWidgetFeature = (f: WidgetMapboxFeature) => {\n  const properties = f.properties || {};\n  const context = properties.context || {};\n  const rawRegion = context.region?.region_code || '';\n  const normalizedRegion = rawRegion.startsWith('CA-') ? rawRegion.slice(3) : rawRegion;\n  return {\n    properties: {\n      full_address: properties.full_address || '',\n      name: properties.name || '',\n      context: {\n        place: { name: context.place?.name || '' },\n        region: { region_code: normalizedRegion },\n        postcode: { name: context.postcode?.name || '' },\n      },\n    },\n    geometry: {\n      coordinates: Array.isArray(f.geometry?.coordinates) ? f.geometry.coordinates : [0, 0],\n    },\n  };\n};\n\nconst normalizeProximity = (raw: string) => {\n  if (!raw) return 'ip';\n  if (raw === 'ip') return 'ip';\n  if (/^-?\\d+(?:\\.\\d+)?,-?\\d+(?:\\.\\d+)?$/.test(raw)) return raw;\n  return 'ip';\n};\n\napp.get('/widget/booking-widget.js', async (c) => {\n  const primaryColor = await getWidgetPrimaryColor(c.env.DB);\n  const js = BOOKING_WIDGET_JS.replace(/'#2563eb'/g, `'${primaryColor}'`);\n  return c.text(js, 200, {\n    'Content-Type': 'application/javascript',\n    'Cache-Control': 'no-cache, must-revalidate',\n  });\n});\n\napp.get('/widget/popup.js', async (c) => {\n  const primaryColor = await getWidgetPrimaryColor(c.env.DB);\n  const js = BOOKING_WIDGET_POPUP.replace(/'#2563eb'/g, `'${primaryColor}'`);\n  return c.text(js, 200, {\n    'Content-Type': 'application/javascript',\n    'Cache-Control': 'no-cache, must-revalidate',\n  });\n});\n\napp.get('/widget/branding.js', async (c) => {\n  const primaryColor = await getWidgetPrimaryColor(c.env.DB);\n  const js = `(function(){var c='${primaryColor}';document.documentElement.style.setProperty('--brand-color',c);window.GOATkitBranding={primaryColor:c};var cfg=window.GOATkitPopupConfig;if(cfg)cfg.primaryColor=c;})();`;\n  return c.text(js, 200, {\n    'Content-Type': 'application/javascript',\n    'Cache-Control': 'no-cache, must-revalidate',\n  });\n});\n\napp.get('/widget/demo', async (c) => {\n  const primaryColor = await getWidgetPrimaryColor(c.env.DB);\n  const html = BOOKING_WIDGET_DEMO.replace(/'#2563eb'/g, `'${primaryColor}'`);\n  return c.html(html);\n});\n\napp.get('/widget/address/search', async (c) => {\n  const q = (c.req.query('q') || '').trim();\n  const proximity = normalizeProximity((c.req.query('proximity') || '').trim());\n  if (q.length < 3) {\n    return c.json({ features: [] });\n  }\n\n  const token = c.env.MAPBOX_ACCESS_TOKEN || '';\n  if (!token) {\n    return c.json({ features: [] });\n  }\n\n  try {\n    const url = `https://api.mapbox.com/search/geocode/v6/forward?q=${encodeURIComponent(q)}&country=ca&types=address&limit=5&proximity=${encodeURIComponent(proximity)}&access_token=${encodeURIComponent(token)}`;\n    const res = await fetch(url);\n    if (!res.ok) {\n      return c.json({ features: [] });\n    }\n    const data = await res.json() as { features?: WidgetMapboxFeature[] };\n    const features = (data.features || []).map(normalizeWidgetFeature);\n    return c.json({ features });\n  } catch {\n    return c.json({ features: [] });\n  }\n});\n\nconst api = new Hono<{ Bindings: { DB: D1Database } }>();\n\napi.route('/territories', territoriesRoutes);\napi.route('/scheduling', schedulingRoutes);\napi.route('/services', servicesRoutes);\napi.route('/categories', categoriesRoutes);\napi.route('/modifiers', modifiersRoutes);\napi.route('/customers', customersRoutes);\napi.route('/team', teamRoutes);\napi.route('/skills', skillsRoutes);\napi.route('/jobs', jobsRoutes);\napi.route('/recurring-bookings', recurringBookingsRoutes);\napi.route('/invoices', invoicesRoutes);\napi.route('/transactions', transactionsRoutes);\napi.route('/coupons', couponsRoutes);\napi.route('/webhooks', webhooksRoutes);\napi.route('/bookings', bookingsRoutes);\napi.route('/messages', messagesRoutes);\n\napp.route('/v1', api);\napp.route('/webhooks/twilio', twilioWebhooksRoutes);\napp.route('/admin', adminRoutes);\n\nasync function sendReminders(db: D1Database) {\n  const { sendJobSms, isTwilioEnabled } = await import('./services/twilio');\n  if (!(await isTwilioEnabled(db))) return;\n\n  const now = new Date();\n  const eastern = new Date(now.toLocaleString('en-US', { timeZone: 'America/Toronto' }));\n  const todayStr = eastern.toISOString().split('T')[0];\n\n  const tomorrow = new Date(eastern);\n  tomorrow.setDate(tomorrow.getDate() + 1);\n  const tomorrowStr = tomorrow.toISOString().split('T')[0];\n\n  const jobs = await db.prepare(\n    `SELECT j.id, j.customer_id, j.scheduled_date, j.scheduled_start_time, j.total_price_cents,\n            c.first_name, c.last_name,\n            COALESCE(s.name, j.custom_service_name, 'Service') as service_name\n     FROM jobs j\n     JOIN customers c ON c.id = j.customer_id\n     LEFT JOIN services s ON s.id = j.service_id\n     WHERE j.status IN ('created', 'assigned')\n       AND j.scheduled_date IN (?, ?)\n       AND c.sms_consent = 1\n       AND c.sms_opted_out = 0\n       AND c.phone_e164 IS NOT NULL`\n  ).bind(todayStr, tomorrowStr).all();\n\n  for (const job of jobs.results || []) {\n    const eventType = job.scheduled_date === todayStr ? 'reminder.morning_of' : 'reminder.day_before';\n    const vars = {\n      first_name: job.first_name as string,\n      last_name: job.last_name as string,\n      service_name: job.service_name as string,\n      date: job.scheduled_date as string,\n      time: job.scheduled_start_time as string,\n      total: ((job.total_price_cents as number) / 100).toFixed(2),\n    };\n\n    await sendJobSms({\n      db,\n      jobId: job.id as string,\n      customerId: job.customer_id as string,\n      eventType,\n      vars,\n      skipQuietHours: true,\n    });\n  }\n}\n\nexport default {\n  fetch: app.fetch,\n  async scheduled(event: ScheduledEvent, env: { DB: D1Database }, ctx: ExecutionContext) {\n    ctx.waitUntil(sendReminders(env.DB));\n  },\n};\n"],
  "mappings": ";;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqDA,eAAsB,gBAAgB,IAA8C;AAClF,MAAI;AACF,UAAM,MAAM,MAAM,GAAG,QAAQ,wDAAwD,EAAE,MAAyB;AAChH,QAAI,CAAC,IAAK,QAAO;AACjB,UAAM,SAAS,KAAK,MAAM,IAAI,KAAK;AACnC,QAAI,CAAC,OAAO,cAAc,CAAC,OAAO,aAAa,CAAC,OAAO,YAAa,QAAO;AAC3E,WAAO;AAAA,EACT,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAEA,eAAsB,gBAAgB,IAAkC;AACtE,QAAM,SAAS,MAAM,gBAAgB,EAAE;AACvC,SAAO,CAAC,CAAC,QAAQ;AACnB;AAeO,SAAS,mBAAmBA,MAA+C;AAChF,MAAI,CAACA,KAAK,QAAO;AAGjB,QAAM,WAAWA,KAAI,QAAQ,WAAW,EAAE;AAC1C,QAAM,SAAS,SAAS,QAAQ,OAAO,EAAE;AAGzC,MAAI,OAAO,WAAW,MAAM,OAAO,WAAW,GAAG,GAAG;AAClD,WAAO,IAAI,MAAM;AAAA,EACnB;AAGA,MAAI,OAAO,WAAW,IAAI;AACxB,WAAO,KAAK,MAAM;AAAA,EACpB;AAGA,MAAI,SAAS,WAAW,IAAI,KAAK,OAAO,WAAW,IAAI;AACrD,WAAO,IAAI,MAAM;AAAA,EACnB;AAEA,SAAO;AACT;AAKO,SAAS,YAAY,OAAwB;AAClD,SAAO,cAAc,KAAK,KAAK;AACjC;AAQO,SAAS,eAAe,UAAkB,MAA4B;AAC3E,SAAO,SAAS,QAAQ,kBAAkB,CAAC,QAAQ,QAAgB;AACjE,WAAO,KAAK,GAAG,KAAK;AAAA,EACtB,CAAC;AACH;AAMO,SAAS,cAAc,MAAsB;AAClD,QAAM,SAAS,qBAAqB,KAAK,IAAI;AAE7C,QAAM,YAAY,SAAS,MAAM;AACjC,QAAM,iBAAiB,SAAS,MAAM;AAEtC,MAAI,KAAK,UAAU,UAAW,QAAO;AACrC,SAAO,KAAK,KAAK,KAAK,SAAS,cAAc;AAC/C;AAQA,eAAsB,QACpB,QACA,IACA,MACA,mBACwB;AACxB,MAAI,CAAC,OAAO,SAAS;AACnB,WAAO,EAAE,SAAS,OAAO,OAAO,wBAAwB;AAAA,EAC1D;AAEA,MAAI,CAAC,YAAY,EAAE,GAAG;AACpB,WAAO,EAAE,SAAS,OAAO,OAAO,yBAAyB,EAAE,GAAG;AAAA,EAChE;AAEA,QAAM,WAAW,8CAA8C,OAAO,UAAU;AAChF,QAAM,SAAS,IAAI,gBAAgB;AAAA,IACjC,IAAI;AAAA,IACJ,MAAM,OAAO;AAAA,IACb,MAAM;AAAA,EACR,CAAC;AAED,MAAI,mBAAmB;AACrB,WAAO,IAAI,kBAAkB,iBAAiB;AAAA,EAChD;AAEA,QAAM,QAAQ,KAAK,GAAG,OAAO,UAAU,IAAI,OAAO,SAAS,EAAE;AAE7D,MAAI;AACF,UAAM,WAAW,MAAM,MAAM,UAAU;AAAA,MACrC,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,eAAe,SAAS,KAAK;AAAA,QAC7B,gBAAgB;AAAA,MAClB;AAAA,MACA,MAAM;AAAA,IACR,CAAC;AAED,UAAM,SAAS,MAAM,SAAS,KAAK;AAEnC,QAAI,CAAC,SAAS,IAAI;AAChB,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAQ,OAAO,WAAsB,QAAQ,SAAS,MAAM;AAAA,QAC5D,WAAW,OAAO,OAAO,QAAQ,EAAE;AAAA,MACrC;AAAA,IACF;AAEA,WAAO;AAAA,MACL,SAAS;AAAA,MACT,WAAW,OAAO;AAAA,IACpB;AAAA,EACF,SAAS,KAAK;AACZ,WAAO;AAAA,MACL,SAAS;AAAA,MACT,OAAO,eAAe,QAAQ,IAAI,UAAU;AAAA,IAC9C;AAAA,EACF;AACF;AA+BA,eAAsB,sBAAsB,QAAsD;AAChG,QAAM,EAAE,IAAI,WAAW,YAAY,OAAO,WAAW,UAAU,MAAM,IAAI;AAEzE,QAAM,gBAAgB,QAClB,MAAM,GAAG;AAAA,IACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EAAE,KAAK,KAAK,EAAE,MAAsB,IAClC;AAEJ,MAAI,eAAe,GAAI,QAAO,cAAc;AAE5C,QAAM,kBAAkB,MAAM,GAAG;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EAAE,KAAK,SAAS,EAAE,MAAsD;AAExE,MAAI,iBAAiB,IAAI;AACvB,UAAM,gBAAgB,gBAAgB,mBAAmB;AACzD,UAAM,kBACH,SAAS,kBAAkB,SAC3B,CAAC,SAAS,CAAC;AAEd,QAAI,CAAC,iBAAiB;AACpB,YAAMC,MAAK,OAAO,WAAW;AAC7B,YAAM,GAAG;AAAA,QACP;AAAA;AAAA;AAAA,MAGF,EAAE;AAAA,QACAA;AAAA,QACA,aAAa;AAAA,QACb,YAAY;AAAA,QACZ,SAAS;AAAA,QACT;AAAA,QACA,gBAAgB,SAAS;AAAA,QACzB;AAAA,QACA,KAAK,UAAU,EAAE,MAAM,cAAc,YAAY,WAAW,aAAa,cAAc,MAAM,QAAQ,SAAS,KAAK,CAAC;AAAA,MACtH,EAAE,IAAI;AACN,aAAOA;AAAA,IACT;AAEA,UAAM,GAAG;AAAA,MACP;AAAA;AAAA;AAAA,IAGF,EAAE;AAAA,MACA,KAAK,UAAU,EAAE,MAAM,cAAc,YAAY,WAAW,aAAa,cAAc,MAAM,QAAQ,SAAS,KAAK,CAAC;AAAA,MACpH,gBAAgB;AAAA,IAClB,EAAE,IAAI;AACN,WAAO,gBAAgB;AAAA,EACzB;AAEA,QAAM,KAAK,OAAO,WAAW;AAC7B,QAAM,GAAG;AAAA,IACP;AAAA;AAAA;AAAA,EAGF,EAAE;AAAA,IACA;AAAA,IACA,aAAa;AAAA,IACb,YAAY;AAAA,IACZ,SAAS;AAAA,IACT;AAAA,IACA,gBAAgB,SAAS;AAAA,IACzB;AAAA,IACA,KAAK,UAAU,EAAE,MAAM,cAAc,YAAY,WAAW,aAAa,cAAc,MAAM,QAAQ,SAAS,KAAK,CAAC;AAAA,EACtH,EAAE,IAAI;AAEN,SAAO;AACT;AAEA,eAAsB,qBAAqB,IAAgB,WAAmB,aAAoC;AAChH,QAAM,GAAG;AAAA,IACP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOF,EAAE,KAAK,aAAa,SAAS,EAAE,IAAI;AACrC;AAEA,eAAsB,OAAO,IAAgB,OAAqC;AAChF,QAAM,KAAK,MAAM,MAAM,OAAO,WAAW;AACzC,QAAM,GAAG;AAAA,IACP;AAAA;AAAA;AAAA,EAGF,EAAE;AAAA,IACA;AAAA,IACA,MAAM,cAAc;AAAA,IACpB,MAAM,SAAS;AAAA,IACf,MAAM,aAAa;AAAA,IACnB,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM;AAAA,IACN,MAAM,iBAAiB;AAAA,IACvB,MAAM,aAAa;AAAA,IACnB,MAAM;AAAA,IACN,MAAM,aAAa;AAAA,IACnB,MAAM,gBAAgB;AAAA,IACtB,MAAM,YAAY;AAAA,EACpB,EAAE,IAAI;AACN,SAAO;AACT;AAEA,eAAsB,gBACpB,IACA,WACA,QACA,WACA,cACe;AACf,QAAM,GAAG;AAAA,IACP;AAAA,EACF,EAAE,KAAK,QAAQ,aAAa,MAAM,gBAAgB,MAAM,SAAS,EAAE,IAAI;AACzE;AAeA,eAAsB,wBACpB,WACA,WACA,KACA,QACkB;AAElB,MAAI,OAAO;AACX,QAAM,aAAa,OAAO,KAAK,MAAM,EAAE,KAAK;AAC5C,aAAWC,QAAO,YAAY;AAC5B,YAAQA,OAAM,OAAOA,IAAG;AAAA,EAC1B;AAEA,QAAM,UAAU,IAAI,YAAY;AAChC,QAAM,MAAM,MAAM,OAAO,OAAO;AAAA,IAC9B;AAAA,IACA,QAAQ,OAAO,SAAS;AAAA,IACxB,EAAE,MAAM,QAAQ,MAAM,QAAQ;AAAA,IAC9B;AAAA,IACA,CAAC,MAAM;AAAA,EACT;AAEA,QAAM,iBAAiB,MAAM,OAAO,OAAO,KAAK,QAAQ,KAAK,QAAQ,OAAO,IAAI,CAAC;AACjF,QAAM,oBAAoB,KAAK,OAAO,aAAa,GAAG,IAAI,WAAW,cAAc,CAAC,CAAC;AAErF,SAAO,sBAAsB;AAC/B;AAQO,SAAS,eAAwB;AACtC,QAAM,MAAM,oBAAI,KAAK;AAErB,QAAM,UAAU,IAAI,KAAK,IAAI,eAAe,SAAS,EAAE,UAAU,kBAAkB,CAAC,CAAC;AACrF,QAAM,OAAO,QAAQ,SAAS;AAC9B,SAAO,OAAO,KAAK,QAAQ;AAC7B;AAUA,eAAsB,qBAAqB,IAAgB,YAAgD;AACzG,QAAM,MAAM,MAAM,GAAG;AAAA,IACnB;AAAA,EACF,EAAE,KAAK,UAAU,EAAE,MAAiF;AAEpG,MAAI,CAAC,KAAK;AACR,WAAO,EAAE,YAAY,OAAO,YAAY,OAAO,WAAW,KAAK;AAAA,EACjE;AAEA,SAAO;AAAA,IACL,YAAY,IAAI,gBAAgB;AAAA,IAChC,YAAY,IAAI,kBAAkB;AAAA,IAClC,WAAW,IAAI;AAAA,EACjB;AACF;AAMO,SAAS,oBAAoB,QAAoC;AACtE,SAAO,OAAO,cAAc,CAAC,OAAO,cAAc,CAAC,CAAC,OAAO;AAC7D;AAqBA,eAAsB,WAAW,QAAkD;AACjF,QAAM,EAAE,IAAI,OAAO,YAAY,WAAW,MAAM,mBAAmB,WAAW,kBAAkB,eAAe,IAAI;AAGnH,QAAM,SAAS,MAAM,gBAAgB,EAAE;AACvC,MAAI,CAAC,QAAQ,SAAS;AACpB,YAAQ,IAAI,iDAAiD,SAAS,EAAE;AACxE,WAAO;AAAA,EACT;AAGA,MAAI,CAAC,kBAAkB;AACrB,UAAM,YAAY,MAAM,qBAAqB,IAAI,UAAU;AAC3D,QAAI,CAAC,oBAAoB,SAAS,GAAG;AACnC,cAAQ,IAAI,kBAAkB,UAAU,kCAAkC,UAAU,UAAU,cAAc,UAAU,UAAU,WAAW,UAAU,SAAS,GAAG;AACjK,aAAO;AAAA,IACT;AAAA,EACF;AAGA,MAAI,CAAC,kBAAkB,aAAa,GAAG;AACrC,YAAQ,IAAI,sCAAsC,SAAS,YAAY,KAAK,EAAE;AAE9E,WAAO;AAAA,EACT;AAGA,QAAM,WAAW,MAAM,GAAG;AAAA,IACxB;AAAA,EACF,EAAE,KAAK,SAAS,EAAE,MAAoD;AAEtE,MAAI,CAAC,YAAY,CAAC,SAAS,WAAW;AACpC,YAAQ,IAAI,kBAAkB,SAAS,wBAAwB;AAC/D,WAAO;AAAA,EACT;AAGA,QAAM,WAAW,MAAM,GAAG;AAAA,IACxB;AAAA,EACF,EAAE,KAAK,UAAU,EAAE,MAA2D;AAE9E,QAAM,UAAU,UAAU,cAAc,mBAAmB,UAAU,KAAK;AAC1E,MAAI,CAAC,SAAS;AACZ,YAAQ,IAAI,qCAAqC,UAAU,EAAE;AAC7D,WAAO;AAAA,EACT;AAGA,QAAM,OAAO,eAAe,SAAS,eAAe,IAAI;AACxD,QAAM,WAAW,cAAc,IAAI;AAGnC,QAAM,SAAS,MAAM,QAAQ,QAAQ,SAAS,MAAM,iBAAiB;AAGrE,QAAM,QAAQ,MAAM,OAAO,IAAI;AAAA,IAC7B;AAAA,IACA;AAAA,IACA,WAAW,aAAa;AAAA,IACxB,WAAW;AAAA,IACX;AAAA,IACA,WAAW,OAAO;AAAA,IAClB;AAAA,IACA,eAAe;AAAA,IACf,WAAW,OAAO,aAAa;AAAA,IAC/B,QAAQ,OAAO,UAAU,SAAS;AAAA,IAClC,WAAW,OAAO,aAAa;AAAA,IAC/B,cAAc,OAAO,SAAS;AAAA,IAC9B;AAAA,EACF,CAAC;AAED,MAAI,CAAC,OAAO,SAAS;AACnB,YAAQ,MAAM,wBAAwB,SAAS,YAAY,KAAK,KAAK,OAAO,KAAK,EAAE;AAAA,EACrF;AAEA,SAAO;AACT;AAkBA,eAAsB,cAAc,QAA2F;AAC7H,QAAM,EAAE,IAAI,IAAI,MAAM,YAAY,OAAO,WAAW,kBAAkB,IAAI;AAE1E,QAAM,SAAS,MAAM,gBAAgB,EAAE;AACvC,MAAI,CAAC,QAAQ,SAAS;AACpB,WAAO,EAAE,OAAO,IAAI,SAAS,OAAO,OAAO,sCAAsC;AAAA,EACnF;AAEA,QAAM,SAAS,MAAM,QAAQ,QAAQ,IAAI,MAAM,iBAAiB;AAChE,QAAM,WAAW,cAAc,IAAI;AAEnC,QAAM,QAAQ,MAAM,OAAO,IAAI;AAAA,IAC7B,YAAY,cAAc;AAAA,IAC1B,OAAO,SAAS;AAAA,IAChB,WAAW,aAAa;AAAA,IACxB,WAAW;AAAA,IACX,SAAS;AAAA,IACT,WAAW,OAAO;AAAA,IAClB;AAAA,IACA,WAAW,OAAO,aAAa;AAAA,IAC/B,QAAQ,OAAO,UAAU,SAAS;AAAA,IAClC,WAAW,OAAO,aAAa;AAAA,IAC/B,cAAc,OAAO,SAAS;AAAA,IAC9B;AAAA,EACF,CAAC;AAED,SAAO,EAAE,OAAO,SAAS,OAAO,SAAS,OAAO,OAAO,MAAM;AAC/D;AA7kBA;AAAA;AAAA;AAqDsB;AAYA;AAkBN;AA4BA;AAUA;AAUA;AAgBM;AAwFA;AA8EA;AAYA;AAyBA;AAyBA;AAkCN;AAgBM;AAoBN;AAuBM;AA8FA;AAAA;AAAA;;;ACjjBtB,IAAI,UAAU,wBAAC,YAAY,SAAS,eAAe;AACjD,SAAO,CAAC,SAAS,SAAS;AACxB,QAAI,QAAQ;AACZ,WAAO,SAAS,CAAC;AACjB,mBAAe,SAAS,GAAG;AACzB,UAAI,KAAK,OAAO;AACd,cAAM,IAAI,MAAM,8BAA8B;AAAA,MAChD;AACA,cAAQ;AACR,UAAI;AACJ,UAAI,UAAU;AACd,UAAI;AACJ,UAAI,WAAW,CAAC,GAAG;AACjB,kBAAU,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC;AAC5B,gBAAQ,IAAI,aAAa;AAAA,MAC3B,OAAO;AACL,kBAAU,MAAM,WAAW,UAAU,QAAQ;AAAA,MAC/C;AACA,UAAI,SAAS;AACX,YAAI;AACF,gBAAM,MAAM,QAAQ,SAAS,MAAM,SAAS,IAAI,CAAC,CAAC;AAAA,QACpD,SAAS,KAAK;AACZ,cAAI,eAAe,SAAS,SAAS;AACnC,oBAAQ,QAAQ;AAChB,kBAAM,MAAM,QAAQ,KAAK,OAAO;AAChC,sBAAU;AAAA,UACZ,OAAO;AACL,kBAAM;AAAA,UACR;AAAA,QACF;AAAA,MACF,OAAO;AACL,YAAI,QAAQ,cAAc,SAAS,YAAY;AAC7C,gBAAM,MAAM,WAAW,OAAO;AAAA,QAChC;AAAA,MACF;AACA,UAAI,QAAQ,QAAQ,cAAc,SAAS,UAAU;AACnD,gBAAQ,MAAM;AAAA,MAChB;AACA,aAAO;AAAA,IACT;AAnCe;AAAA,EAoCjB;AACF,GAzCc;;;ACAd,IAAI,gBAAgB,cAAc,MAAM;AAAA,EADxC,OACwC;AAAA;AAAA;AAAA,EACtC;AAAA,EACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,YAAY,SAAS,KAAK,SAAS;AACjC,UAAM,SAAS,SAAS,EAAE,OAAO,SAAS,MAAM,CAAC;AACjD,SAAK,MAAM,SAAS;AACpB,SAAK,SAAS;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,cAAc;AACZ,QAAI,KAAK,KAAK;AACZ,YAAM,cAAc,IAAI,SAAS,KAAK,IAAI,MAAM;AAAA,QAC9C,QAAQ,KAAK;AAAA,QACb,SAAS,KAAK,IAAI;AAAA,MACpB,CAAC;AACD,aAAO;AAAA,IACT;AACA,WAAO,IAAI,SAAS,KAAK,SAAS;AAAA,MAChC,QAAQ,KAAK;AAAA,IACf,CAAC;AAAA,EACH;AACF;;;AC9BA,IAAI,mBAAmC,uBAAO;;;ACC9C,IAAI,YAAY,8BAAO,SAAS,UAA0B,uBAAO,OAAO,IAAI,MAAM;AAChF,QAAM,EAAE,MAAM,OAAO,MAAM,MAAM,IAAI;AACrC,QAAM,UAAU,mBAAmB,cAAc,QAAQ,IAAI,UAAU,QAAQ;AAC/E,QAAM,cAAc,QAAQ,IAAI,cAAc;AAC9C,MAAI,aAAa,WAAW,qBAAqB,KAAK,aAAa,WAAW,mCAAmC,GAAG;AAClH,WAAO,cAAc,SAAS,EAAE,KAAK,IAAI,CAAC;AAAA,EAC5C;AACA,SAAO,CAAC;AACV,GARgB;AAShB,eAAe,cAAc,SAAS,SAAS;AAC7C,QAAM,WAAW,MAAM,QAAQ,SAAS;AACxC,MAAI,UAAU;AACZ,WAAO,0BAA0B,UAAU,OAAO;AAAA,EACpD;AACA,SAAO,CAAC;AACV;AANe;AAOf,SAAS,0BAA0B,UAAU,SAAS;AACpD,QAAMC,QAAuB,uBAAO,OAAO,IAAI;AAC/C,WAAS,QAAQ,CAAC,OAAO,QAAQ;AAC/B,UAAM,uBAAuB,QAAQ,OAAO,IAAI,SAAS,IAAI;AAC7D,QAAI,CAAC,sBAAsB;AACzB,MAAAA,MAAK,GAAG,IAAI;AAAA,IACd,OAAO;AACL,6BAAuBA,OAAM,KAAK,KAAK;AAAA,IACzC;AAAA,EACF,CAAC;AACD,MAAI,QAAQ,KAAK;AACf,WAAO,QAAQA,KAAI,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AAC7C,YAAM,uBAAuB,IAAI,SAAS,GAAG;AAC7C,UAAI,sBAAsB;AACxB,kCAA0BA,OAAM,KAAK,KAAK;AAC1C,eAAOA,MAAK,GAAG;AAAA,MACjB;AAAA,IACF,CAAC;AAAA,EACH;AACA,SAAOA;AACT;AApBS;AAqBT,IAAI,yBAAyB,wBAACA,OAAM,KAAK,UAAU;AACjD,MAAIA,MAAK,GAAG,MAAM,QAAQ;AACxB,QAAI,MAAM,QAAQA,MAAK,GAAG,CAAC,GAAG;AAC5B;AACA,MAAAA,MAAK,GAAG,EAAE,KAAK,KAAK;AAAA,IACtB,OAAO;AACL,MAAAA,MAAK,GAAG,IAAI,CAACA,MAAK,GAAG,GAAG,KAAK;AAAA,IAC/B;AAAA,EACF,OAAO;AACL,QAAI,CAAC,IAAI,SAAS,IAAI,GAAG;AACvB,MAAAA,MAAK,GAAG,IAAI;AAAA,IACd,OAAO;AACL,MAAAA,MAAK,GAAG,IAAI,CAAC,KAAK;AAAA,IACpB;AAAA,EACF;AACF,GAf6B;AAgB7B,IAAI,4BAA4B,wBAACA,OAAM,KAAK,UAAU;AACpD,MAAI,aAAaA;AACjB,QAAM,OAAO,IAAI,MAAM,GAAG;AAC1B,OAAK,QAAQ,CAAC,MAAM,UAAU;AAC5B,QAAI,UAAU,KAAK,SAAS,GAAG;AAC7B,iBAAW,IAAI,IAAI;AAAA,IACrB,OAAO;AACL,UAAI,CAAC,WAAW,IAAI,KAAK,OAAO,WAAW,IAAI,MAAM,YAAY,MAAM,QAAQ,WAAW,IAAI,CAAC,KAAK,WAAW,IAAI,aAAa,MAAM;AACpI,mBAAW,IAAI,IAAoB,uBAAO,OAAO,IAAI;AAAA,MACvD;AACA,mBAAa,WAAW,IAAI;AAAA,IAC9B;AAAA,EACF,CAAC;AACH,GAbgC;;;ACtDhC,IAAI,YAAY,wBAAC,SAAS;AACxB,QAAM,QAAQ,KAAK,MAAM,GAAG;AAC5B,MAAI,MAAM,CAAC,MAAM,IAAI;AACnB,UAAM,MAAM;AAAA,EACd;AACA,SAAO;AACT,GANgB;AAOhB,IAAI,mBAAmB,wBAAC,cAAc;AACpC,QAAM,EAAE,QAAQ,KAAK,IAAI,sBAAsB,SAAS;AACxD,QAAM,QAAQ,UAAU,IAAI;AAC5B,SAAO,kBAAkB,OAAO,MAAM;AACxC,GAJuB;AAKvB,IAAI,wBAAwB,wBAAC,SAAS;AACpC,QAAM,SAAS,CAAC;AAChB,SAAO,KAAK,QAAQ,cAAc,CAACC,QAAO,UAAU;AAClD,UAAM,OAAO,IAAI,KAAK;AACtB,WAAO,KAAK,CAAC,MAAMA,MAAK,CAAC;AACzB,WAAO;AAAA,EACT,CAAC;AACD,SAAO,EAAE,QAAQ,KAAK;AACxB,GAR4B;AAS5B,IAAI,oBAAoB,wBAAC,OAAO,WAAW;AACzC,WAAS,IAAI,OAAO,SAAS,GAAG,KAAK,GAAG,KAAK;AAC3C,UAAM,CAAC,IAAI,IAAI,OAAO,CAAC;AACvB,aAAS,IAAI,MAAM,SAAS,GAAG,KAAK,GAAG,KAAK;AAC1C,UAAI,MAAM,CAAC,EAAE,SAAS,IAAI,GAAG;AAC3B,cAAM,CAAC,IAAI,MAAM,CAAC,EAAE,QAAQ,MAAM,OAAO,CAAC,EAAE,CAAC,CAAC;AAC9C;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACA,SAAO;AACT,GAXwB;AAYxB,IAAI,eAAe,CAAC;AACpB,IAAI,aAAa,wBAAC,OAAO,SAAS;AAChC,MAAI,UAAU,KAAK;AACjB,WAAO;AAAA,EACT;AACA,QAAMA,SAAQ,MAAM,MAAM,6BAA6B;AACvD,MAAIA,QAAO;AACT,UAAM,WAAW,GAAG,KAAK,IAAI,IAAI;AACjC,QAAI,CAAC,aAAa,QAAQ,GAAG;AAC3B,UAAIA,OAAM,CAAC,GAAG;AACZ,qBAAa,QAAQ,IAAI,QAAQ,KAAK,CAAC,MAAM,OAAO,KAAK,CAAC,MAAM,MAAM,CAAC,UAAUA,OAAM,CAAC,GAAG,IAAI,OAAO,IAAIA,OAAM,CAAC,CAAC,OAAO,IAAI,GAAG,CAAC,IAAI,CAAC,OAAOA,OAAM,CAAC,GAAG,IAAI,OAAO,IAAIA,OAAM,CAAC,CAAC,GAAG,CAAC;AAAA,MACpL,OAAO;AACL,qBAAa,QAAQ,IAAI,CAAC,OAAOA,OAAM,CAAC,GAAG,IAAI;AAAA,MACjD;AAAA,IACF;AACA,WAAO,aAAa,QAAQ;AAAA,EAC9B;AACA,SAAO;AACT,GAjBiB;AAkBjB,IAAI,YAAY,wBAAC,KAAK,YAAY;AAChC,MAAI;AACF,WAAO,QAAQ,GAAG;AAAA,EACpB,QAAQ;AACN,WAAO,IAAI,QAAQ,yBAAyB,CAACA,WAAU;AACrD,UAAI;AACF,eAAO,QAAQA,MAAK;AAAA,MACtB,QAAQ;AACN,eAAOA;AAAA,MACT;AAAA,IACF,CAAC;AAAA,EACH;AACF,GAZgB;AAahB,IAAI,eAAe,wBAAC,QAAQ,UAAU,KAAK,SAAS,GAAjC;AACnB,IAAI,UAAU,wBAAC,YAAY;AACzB,QAAM,MAAM,QAAQ;AACpB,QAAM,QAAQ,IAAI,QAAQ,KAAK,IAAI,QAAQ,GAAG,IAAI,CAAC;AACnD,MAAI,IAAI;AACR,SAAO,IAAI,IAAI,QAAQ,KAAK;AAC1B,UAAM,WAAW,IAAI,WAAW,CAAC;AACjC,QAAI,aAAa,IAAI;AACnB,YAAM,aAAa,IAAI,QAAQ,KAAK,CAAC;AACrC,YAAM,YAAY,IAAI,QAAQ,KAAK,CAAC;AACpC,YAAM,MAAM,eAAe,KAAK,cAAc,KAAK,SAAS,YAAY,cAAc,KAAK,aAAa,KAAK,IAAI,YAAY,SAAS;AACtI,YAAM,OAAO,IAAI,MAAM,OAAO,GAAG;AACjC,aAAO,aAAa,KAAK,SAAS,KAAK,IAAI,KAAK,QAAQ,QAAQ,OAAO,IAAI,IAAI;AAAA,IACjF,WAAW,aAAa,MAAM,aAAa,IAAI;AAC7C;AAAA,IACF;AAAA,EACF;AACA,SAAO,IAAI,MAAM,OAAO,CAAC;AAC3B,GAjBc;AAsBd,IAAI,kBAAkB,wBAAC,YAAY;AACjC,QAAM,SAAS,QAAQ,OAAO;AAC9B,SAAO,OAAO,SAAS,KAAK,OAAO,GAAG,EAAE,MAAM,MAAM,OAAO,MAAM,GAAG,EAAE,IAAI;AAC5E,GAHsB;AAItB,IAAI,YAAY,wBAAC,MAAM,QAAQ,SAAS;AACtC,MAAI,KAAK,QAAQ;AACf,UAAM,UAAU,KAAK,GAAG,IAAI;AAAA,EAC9B;AACA,SAAO,GAAG,OAAO,CAAC,MAAM,MAAM,KAAK,GAAG,GAAG,IAAI,GAAG,QAAQ,MAAM,KAAK,GAAG,MAAM,GAAG,EAAE,MAAM,MAAM,KAAK,GAAG,GAAG,MAAM,CAAC,MAAM,MAAM,IAAI,MAAM,CAAC,IAAI,GAAG,EAAE;AACjJ,GALgB;AAMhB,IAAI,yBAAyB,wBAAC,SAAS;AACrC,MAAI,KAAK,WAAW,KAAK,SAAS,CAAC,MAAM,MAAM,CAAC,KAAK,SAAS,GAAG,GAAG;AAClE,WAAO;AAAA,EACT;AACA,QAAM,WAAW,KAAK,MAAM,GAAG;AAC/B,QAAM,UAAU,CAAC;AACjB,MAAI,WAAW;AACf,WAAS,QAAQ,CAAC,YAAY;AAC5B,QAAI,YAAY,MAAM,CAAC,KAAK,KAAK,OAAO,GAAG;AACzC,kBAAY,MAAM;AAAA,IACpB,WAAW,KAAK,KAAK,OAAO,GAAG;AAC7B,UAAI,KAAK,KAAK,OAAO,GAAG;AACtB,YAAI,QAAQ,WAAW,KAAK,aAAa,IAAI;AAC3C,kBAAQ,KAAK,GAAG;AAAA,QAClB,OAAO;AACL,kBAAQ,KAAK,QAAQ;AAAA,QACvB;AACA,cAAM,kBAAkB,QAAQ,QAAQ,KAAK,EAAE;AAC/C,oBAAY,MAAM;AAClB,gBAAQ,KAAK,QAAQ;AAAA,MACvB,OAAO;AACL,oBAAY,MAAM;AAAA,MACpB;AAAA,IACF;AAAA,EACF,CAAC;AACD,SAAO,QAAQ,OAAO,CAAC,GAAG,GAAG,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC;AACvD,GA1B6B;AA2B7B,IAAI,aAAa,wBAAC,UAAU;AAC1B,MAAI,CAAC,OAAO,KAAK,KAAK,GAAG;AACvB,WAAO;AAAA,EACT;AACA,MAAI,MAAM,QAAQ,GAAG,MAAM,IAAI;AAC7B,YAAQ,MAAM,QAAQ,OAAO,GAAG;AAAA,EAClC;AACA,SAAO,MAAM,QAAQ,GAAG,MAAM,KAAK,UAAU,OAAO,mBAAmB,IAAI;AAC7E,GARiB;AASjB,IAAI,iBAAiB,wBAAC,KAAK,KAAK,aAAa;AAC3C,MAAI;AACJ,MAAI,CAAC,YAAY,OAAO,CAAC,OAAO,KAAK,GAAG,GAAG;AACzC,QAAI,YAAY,IAAI,QAAQ,KAAK,CAAC;AAClC,QAAI,cAAc,IAAI;AACpB,aAAO;AAAA,IACT;AACA,QAAI,CAAC,IAAI,WAAW,KAAK,YAAY,CAAC,GAAG;AACvC,kBAAY,IAAI,QAAQ,IAAI,GAAG,IAAI,YAAY,CAAC;AAAA,IAClD;AACA,WAAO,cAAc,IAAI;AACvB,YAAM,kBAAkB,IAAI,WAAW,YAAY,IAAI,SAAS,CAAC;AACjE,UAAI,oBAAoB,IAAI;AAC1B,cAAM,aAAa,YAAY,IAAI,SAAS;AAC5C,cAAM,WAAW,IAAI,QAAQ,KAAK,UAAU;AAC5C,eAAO,WAAW,IAAI,MAAM,YAAY,aAAa,KAAK,SAAS,QAAQ,CAAC;AAAA,MAC9E,WAAW,mBAAmB,MAAM,MAAM,eAAe,GAAG;AAC1D,eAAO;AAAA,MACT;AACA,kBAAY,IAAI,QAAQ,IAAI,GAAG,IAAI,YAAY,CAAC;AAAA,IAClD;AACA,cAAU,OAAO,KAAK,GAAG;AACzB,QAAI,CAAC,SAAS;AACZ,aAAO;AAAA,IACT;AAAA,EACF;AACA,QAAM,UAAU,CAAC;AACjB,cAAY,OAAO,KAAK,GAAG;AAC3B,MAAI,WAAW,IAAI,QAAQ,KAAK,CAAC;AACjC,SAAO,aAAa,IAAI;AACtB,UAAM,eAAe,IAAI,QAAQ,KAAK,WAAW,CAAC;AAClD,QAAI,aAAa,IAAI,QAAQ,KAAK,QAAQ;AAC1C,QAAI,aAAa,gBAAgB,iBAAiB,IAAI;AACpD,mBAAa;AAAA,IACf;AACA,QAAI,OAAO,IAAI;AAAA,MACb,WAAW;AAAA,MACX,eAAe,KAAK,iBAAiB,KAAK,SAAS,eAAe;AAAA,IACpE;AACA,QAAI,SAAS;AACX,aAAO,WAAW,IAAI;AAAA,IACxB;AACA,eAAW;AACX,QAAI,SAAS,IAAI;AACf;AAAA,IACF;AACA,QAAI;AACJ,QAAI,eAAe,IAAI;AACrB,cAAQ;AAAA,IACV,OAAO;AACL,cAAQ,IAAI,MAAM,aAAa,GAAG,iBAAiB,KAAK,SAAS,YAAY;AAC7E,UAAI,SAAS;AACX,gBAAQ,WAAW,KAAK;AAAA,MAC1B;AAAA,IACF;AACA,QAAI,UAAU;AACZ,UAAI,EAAE,QAAQ,IAAI,KAAK,MAAM,QAAQ,QAAQ,IAAI,CAAC,IAAI;AACpD,gBAAQ,IAAI,IAAI,CAAC;AAAA,MACnB;AACA;AACA,cAAQ,IAAI,EAAE,KAAK,KAAK;AAAA,IAC1B,OAAO;AACL,cAAQ,IAAI,MAAM;AAAA,IACpB;AAAA,EACF;AACA,SAAO,MAAM,QAAQ,GAAG,IAAI;AAC9B,GAlEqB;AAmErB,IAAI,gBAAgB;AACpB,IAAI,iBAAiB,wBAAC,KAAK,QAAQ;AACjC,SAAO,eAAe,KAAK,KAAK,IAAI;AACtC,GAFqB;AAGrB,IAAI,sBAAsB;;;ACzM1B,IAAI,wBAAwB,wBAAC,QAAQ,UAAU,KAAK,mBAAmB,GAA3C;AAC5B,IAAI,cAAc,MAAM;AAAA,EANxB,OAMwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAetB;AAAA,EACA;AAAA;AAAA,EAEA;AAAA,EACA,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAab;AAAA,EACA,YAAY,CAAC;AAAA,EACb,YAAY,SAAS,OAAO,KAAK,cAAc,CAAC,CAAC,CAAC,GAAG;AACnD,SAAK,MAAM;AACX,SAAK,OAAO;AACZ,SAAK,eAAe;AACpB,SAAK,iBAAiB,CAAC;AAAA,EACzB;AAAA,EACA,MAAM,KAAK;AACT,WAAO,MAAM,KAAK,iBAAiB,GAAG,IAAI,KAAK,qBAAqB;AAAA,EACtE;AAAA,EACA,iBAAiB,KAAK;AACpB,UAAM,WAAW,KAAK,aAAa,CAAC,EAAE,KAAK,UAAU,EAAE,CAAC,EAAE,GAAG;AAC7D,UAAM,QAAQ,KAAK,eAAe,QAAQ;AAC1C,WAAO,SAAS,KAAK,KAAK,KAAK,IAAI,sBAAsB,KAAK,IAAI;AAAA,EACpE;AAAA,EACA,uBAAuB;AACrB,UAAM,UAAU,CAAC;AACjB,UAAM,OAAO,OAAO,KAAK,KAAK,aAAa,CAAC,EAAE,KAAK,UAAU,EAAE,CAAC,CAAC;AACjE,eAAW,OAAO,MAAM;AACtB,YAAM,QAAQ,KAAK,eAAe,KAAK,aAAa,CAAC,EAAE,KAAK,UAAU,EAAE,CAAC,EAAE,GAAG,CAAC;AAC/E,UAAI,UAAU,QAAQ;AACpB,gBAAQ,GAAG,IAAI,KAAK,KAAK,KAAK,IAAI,sBAAsB,KAAK,IAAI;AAAA,MACnE;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EACA,eAAe,UAAU;AACvB,WAAO,KAAK,aAAa,CAAC,IAAI,KAAK,aAAa,CAAC,EAAE,QAAQ,IAAI;AAAA,EACjE;AAAA,EACA,MAAM,KAAK;AACT,WAAO,cAAc,KAAK,KAAK,GAAG;AAAA,EACpC;AAAA,EACA,QAAQ,KAAK;AACX,WAAO,eAAe,KAAK,KAAK,GAAG;AAAA,EACrC;AAAA,EACA,OAAO,MAAM;AACX,QAAI,MAAM;AACR,aAAO,KAAK,IAAI,QAAQ,IAAI,IAAI,KAAK;AAAA,IACvC;AACA,UAAM,aAAa,CAAC;AACpB,SAAK,IAAI,QAAQ,QAAQ,CAAC,OAAO,QAAQ;AACvC,iBAAW,GAAG,IAAI;AAAA,IACpB,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EACA,MAAM,UAAU,SAAS;AACvB,WAAO,KAAK,UAAU,eAAe,MAAM,UAAU,MAAM,OAAO;AAAA,EACpE;AAAA,EACA,cAAc,wBAAC,QAAQ;AACrB,UAAM,EAAE,WAAW,KAAAC,KAAI,IAAI;AAC3B,UAAM,aAAa,UAAU,GAAG;AAChC,QAAI,YAAY;AACd,aAAO;AAAA,IACT;AACA,UAAM,eAAe,OAAO,KAAK,SAAS,EAAE,CAAC;AAC7C,QAAI,cAAc;AAChB,aAAO,UAAU,YAAY,EAAE,KAAK,CAAC,SAAS;AAC5C,YAAI,iBAAiB,QAAQ;AAC3B,iBAAO,KAAK,UAAU,IAAI;AAAA,QAC5B;AACA,eAAO,IAAI,SAAS,IAAI,EAAE,GAAG,EAAE;AAAA,MACjC,CAAC;AAAA,IACH;AACA,WAAO,UAAU,GAAG,IAAIA,KAAI,GAAG,EAAE;AAAA,EACnC,GAhBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA6Bd,OAAO;AACL,WAAO,KAAK,YAAY,MAAM,EAAE,KAAK,CAAC,SAAS,KAAK,MAAM,IAAI,CAAC;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,OAAO;AACL,WAAO,KAAK,YAAY,MAAM;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,cAAc;AACZ,WAAO,KAAK,YAAY,aAAa;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,OAAO;AACL,WAAO,KAAK,YAAY,MAAM;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,WAAW;AACT,WAAO,KAAK,YAAY,UAAU;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAAiB,QAAQ,MAAM;AAC7B,SAAK,eAAe,MAAM,IAAI;AAAA,EAChC;AAAA,EACA,MAAM,QAAQ;AACZ,WAAO,KAAK,eAAe,MAAM;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,IAAI,MAAM;AACR,WAAO,KAAK,IAAI;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,IAAI,SAAS;AACX,WAAO,KAAK,IAAI;AAAA,EAClB;AAAA,EACA,KAAK,gBAAgB,IAAI;AACvB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA4BA,IAAI,gBAAgB;AAClB,WAAO,KAAK,aAAa,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,KAAK;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,IAAI,YAAY;AACd,WAAO,KAAK,aAAa,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,KAAK,EAAE,KAAK,UAAU,EAAE;AAAA,EAC3E;AACF;;;AC7QA,IAAI,2BAA2B;AAAA,EAC7B,WAAW;AAAA,EACX,cAAc;AAAA,EACd,QAAQ;AACV;AACA,IAAI,MAAM,wBAAC,OAAO,cAAc;AAC9B,QAAM,gBAAgB,IAAI,OAAO,KAAK;AACtC,gBAAc,YAAY;AAC1B,gBAAc,YAAY;AAC1B,SAAO;AACT,GALU;AAMV,IAAI,WAAW;AACf,IAAI,uBAAuB,8BAAO,QAAQ,cAAc;AACtD,MAAI,MAAM;AACV,gBAAc,CAAC;AACf,QAAM,iBAAiB,MAAM,QAAQ,IAAI,MAAM;AAC/C,WAAS,IAAI,eAAe,SAAS,KAAK,KAAK;AAC7C,WAAO,eAAe,CAAC;AACvB;AACA,QAAI,IAAI,GAAG;AACT;AAAA,IACF;AACA,QAAI,IAAI,eAAe,CAAC;AACxB,QAAI,OAAO,MAAM,UAAU;AACzB,gBAAU,KAAK,GAAG,EAAE,aAAa,CAAC,CAAC;AAAA,IACrC;AACA,UAAM,YAAY,EAAE;AACpB,QAAI,OAAO,OAAO,MAAM,WAAW,EAAE,SAAS,IAAI;AAClD,QAAI,OAAO,MAAM,UAAU;AACzB,gBAAU,KAAK,GAAG,EAAE,aAAa,CAAC,CAAC;AAAA,IACrC;AACA,QAAI,EAAE,aAAa,WAAW;AAC5B,aAAO;AAAA,IACT,OAAO;AACL,YAAM,MAAM,CAAC,GAAG;AAChB,qBAAe,GAAG,GAAG;AACrB,YAAM,IAAI,CAAC;AAAA,IACb;AAAA,EACF;AACA,SAAO,IAAI,KAAK,SAAS;AAC3B,GA5B2B;AA6B3B,IAAI,iBAAiB,wBAAC,KAAK,WAAW;AACpC,QAAMC,SAAQ,IAAI,OAAO,QAAQ;AACjC,MAAIA,WAAU,IAAI;AAChB,WAAO,CAAC,KAAK;AACb;AAAA,EACF;AACA,MAAI;AACJ,MAAI;AACJ,MAAI,YAAY;AAChB,OAAK,QAAQA,QAAO,QAAQ,IAAI,QAAQ,SAAS;AAC/C,YAAQ,IAAI,WAAW,KAAK,GAAG;AAAA,MAC7B,KAAK;AACH,iBAAS;AACT;AAAA,MACF,KAAK;AACH,iBAAS;AACT;AAAA,MACF,KAAK;AACH,iBAAS;AACT;AAAA,MACF,KAAK;AACH,iBAAS;AACT;AAAA,MACF,KAAK;AACH,iBAAS;AACT;AAAA,MACF;AACE;AAAA,IACJ;AACA,WAAO,CAAC,KAAK,IAAI,UAAU,WAAW,KAAK,IAAI;AAC/C,gBAAY,QAAQ;AAAA,EACtB;AACA,SAAO,CAAC,KAAK,IAAI,UAAU,WAAW,KAAK;AAC7C,GAjCqB;AAkCrB,IAAI,sBAAsB,wBAAC,QAAQ;AACjC,QAAM,YAAY,IAAI;AACtB,MAAI,CAAC,WAAW,QAAQ;AACtB,WAAO;AAAA,EACT;AACA,QAAM,SAAS,CAAC,GAAG;AACnB,QAAM,UAAU,CAAC;AACjB,YAAU,QAAQ,CAAC,MAAM,EAAE,EAAE,OAAO,yBAAyB,WAAW,QAAQ,QAAQ,CAAC,CAAC;AAC1F,SAAO,OAAO,CAAC;AACjB,GAT0B;AAU1B,IAAI,kBAAkB,8BAAO,KAAK,OAAO,mBAAmB,SAAS,WAAW;AAC9E,MAAI,OAAO,QAAQ,YAAY,EAAE,eAAe,SAAS;AACvD,QAAI,EAAE,eAAe,UAAU;AAC7B,YAAM,IAAI,SAAS;AAAA,IACrB;AACA,QAAI,eAAe,SAAS;AAC1B,YAAM,MAAM;AAAA,IACd;AAAA,EACF;AACA,QAAM,YAAY,IAAI;AACtB,MAAI,CAAC,WAAW,QAAQ;AACtB,WAAO,QAAQ,QAAQ,GAAG;AAAA,EAC5B;AACA,MAAI,QAAQ;AACV,WAAO,CAAC,KAAK;AAAA,EACf,OAAO;AACL,aAAS,CAAC,GAAG;AAAA,EACf;AACA,QAAM,SAAS,QAAQ,IAAI,UAAU,IAAI,CAAC,MAAM,EAAE,EAAE,OAAO,QAAQ,QAAQ,CAAC,CAAC,CAAC,EAAE;AAAA,IAC9E,CAAC,QAAQ,QAAQ;AAAA,MACf,IAAI,OAAO,OAAO,EAAE,IAAI,CAAC,SAAS,gBAAgB,MAAM,OAAO,OAAO,SAAS,MAAM,CAAC;AAAA,IACxF,EAAE,KAAK,MAAM,OAAO,CAAC,CAAC;AAAA,EACxB;AACA,MAAI,mBAAmB;AACrB,WAAO,IAAI,MAAM,QAAQ,SAAS;AAAA,EACpC,OAAO;AACL,WAAO;AAAA,EACT;AACF,GA5BsB;;;ACnFtB,IAAI,aAAa;AACjB,IAAI,wBAAwB,wBAAC,aAAa,YAAY;AACpD,SAAO;AAAA,IACL,gBAAgB;AAAA,IAChB,GAAG;AAAA,EACL;AACF,GAL4B;AAM5B,IAAI,UAAU,MAAM;AAAA,EAVpB,OAUoB;AAAA;AAAA;AAAA,EAClB;AAAA,EACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,MAAM,CAAC;AAAA,EACP;AAAA,EACA,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,YAAY,KAAK,SAAS;AACxB,SAAK,cAAc;AACnB,QAAI,SAAS;AACX,WAAK,gBAAgB,QAAQ;AAC7B,WAAK,MAAM,QAAQ;AACnB,WAAK,mBAAmB,QAAQ;AAChC,WAAK,QAAQ,QAAQ;AACrB,WAAK,eAAe,QAAQ;AAAA,IAC9B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAIA,IAAI,MAAM;AACR,SAAK,SAAS,IAAI,YAAY,KAAK,aAAa,KAAK,OAAO,KAAK,YAAY;AAC7E,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,IAAI,QAAQ;AACV,QAAI,KAAK,iBAAiB,iBAAiB,KAAK,eAAe;AAC7D,aAAO,KAAK;AAAA,IACd,OAAO;AACL,YAAM,MAAM,gCAAgC;AAAA,IAC9C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,IAAI,eAAe;AACjB,QAAI,KAAK,eAAe;AACtB,aAAO,KAAK;AAAA,IACd,OAAO;AACL,YAAM,MAAM,sCAAsC;AAAA,IACpD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,MAAM;AACR,WAAO,KAAK,SAAS,IAAI,SAAS,MAAM;AAAA,MACtC,SAAS,KAAK,qBAAqB,IAAI,QAAQ;AAAA,IACjD,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,IAAI,IAAI,MAAM;AACZ,QAAI,KAAK,QAAQ,MAAM;AACrB,aAAO,IAAI,SAAS,KAAK,MAAM,IAAI;AACnC,iBAAW,CAAC,GAAG,CAAC,KAAK,KAAK,KAAK,QAAQ,QAAQ,GAAG;AAChD,YAAI,MAAM,gBAAgB;AACxB;AAAA,QACF;AACA,YAAI,MAAM,cAAc;AACtB,gBAAM,UAAU,KAAK,KAAK,QAAQ,aAAa;AAC/C,eAAK,QAAQ,OAAO,YAAY;AAChC,qBAAW,UAAU,SAAS;AAC5B,iBAAK,QAAQ,OAAO,cAAc,MAAM;AAAA,UAC1C;AAAA,QACF,OAAO;AACL,eAAK,QAAQ,IAAI,GAAG,CAAC;AAAA,QACvB;AAAA,MACF;AAAA,IACF;AACA,SAAK,OAAO;AACZ,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,SAAS,2BAAI,SAAS;AACpB,SAAK,cAAc,CAAC,YAAY,KAAK,KAAK,OAAO;AACjD,WAAO,KAAK,UAAU,GAAG,IAAI;AAAA,EAC/B,GAHS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUT,YAAY,wBAAC,WAAW,KAAK,UAAU,QAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMZ,YAAY,6BAAM,KAAK,SAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBZ,cAAc,wBAAC,aAAa;AAC1B,SAAK,YAAY;AAAA,EACnB,GAFc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBd,SAAS,wBAAC,MAAM,OAAO,YAAY;AACjC,QAAI,KAAK,WAAW;AAClB,WAAK,OAAO,IAAI,SAAS,KAAK,KAAK,MAAM,KAAK,IAAI;AAAA,IACpD;AACA,UAAM,UAAU,KAAK,OAAO,KAAK,KAAK,UAAU,KAAK,qBAAqB,IAAI,QAAQ;AACtF,QAAI,UAAU,QAAQ;AACpB,cAAQ,OAAO,IAAI;AAAA,IACrB,WAAW,SAAS,QAAQ;AAC1B,cAAQ,OAAO,MAAM,KAAK;AAAA,IAC5B,OAAO;AACL,cAAQ,IAAI,MAAM,KAAK;AAAA,IACzB;AAAA,EACF,GAZS;AAAA,EAaT,SAAS,wBAAC,WAAW;AACnB,SAAK,UAAU;AAAA,EACjB,GAFS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBT,MAAM,wBAAC,KAAK,UAAU;AACpB,SAAK,SAAyB,oBAAI,IAAI;AACtC,SAAK,KAAK,IAAI,KAAK,KAAK;AAAA,EAC1B,GAHM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBN,MAAM,wBAAC,QAAQ;AACb,WAAO,KAAK,OAAO,KAAK,KAAK,IAAI,GAAG,IAAI;AAAA,EAC1C,GAFM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcN,IAAI,MAAM;AACR,QAAI,CAAC,KAAK,MAAM;AACd,aAAO,CAAC;AAAA,IACV;AACA,WAAO,OAAO,YAAY,KAAK,IAAI;AAAA,EACrC;AAAA,EACA,aAAa,MAAM,KAAK,SAAS;AAC/B,UAAM,kBAAkB,KAAK,OAAO,IAAI,QAAQ,KAAK,KAAK,OAAO,IAAI,KAAK,oBAAoB,IAAI,QAAQ;AAC1G,QAAI,OAAO,QAAQ,YAAY,aAAa,KAAK;AAC/C,YAAM,aAAa,IAAI,mBAAmB,UAAU,IAAI,UAAU,IAAI,QAAQ,IAAI,OAAO;AACzF,iBAAW,CAAC,KAAK,KAAK,KAAK,YAAY;AACrC,YAAI,IAAI,YAAY,MAAM,cAAc;AACtC,0BAAgB,OAAO,KAAK,KAAK;AAAA,QACnC,OAAO;AACL,0BAAgB,IAAI,KAAK,KAAK;AAAA,QAChC;AAAA,MACF;AAAA,IACF;AACA,QAAI,SAAS;AACX,iBAAW,CAAC,GAAG,CAAC,KAAK,OAAO,QAAQ,OAAO,GAAG;AAC5C,YAAI,OAAO,MAAM,UAAU;AACzB,0BAAgB,IAAI,GAAG,CAAC;AAAA,QAC1B,OAAO;AACL,0BAAgB,OAAO,CAAC;AACxB,qBAAW,MAAM,GAAG;AAClB,4BAAgB,OAAO,GAAG,EAAE;AAAA,UAC9B;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,UAAM,SAAS,OAAO,QAAQ,WAAW,MAAM,KAAK,UAAU,KAAK;AACnE,WAAO,IAAI,SAAS,MAAM,EAAE,QAAQ,SAAS,gBAAgB,CAAC;AAAA,EAChE;AAAA,EACA,cAAc,2BAAI,SAAS,KAAK,aAAa,GAAG,IAAI,GAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBd,OAAO,wBAAC,MAAM,KAAK,YAAY,KAAK,aAAa,MAAM,KAAK,OAAO,GAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaP,OAAO,wBAAC,MAAM,KAAK,YAAY;AAC7B,WAAO,CAAC,KAAK,oBAAoB,CAAC,KAAK,WAAW,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,YAAY,IAAI,SAAS,IAAI,IAAI,KAAK;AAAA,MAChH;AAAA,MACA;AAAA,MACA,sBAAsB,YAAY,OAAO;AAAA,IAC3C;AAAA,EACF,GANO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBP,OAAO,wBAAC,QAAQ,KAAK,YAAY;AAC/B,WAAO,KAAK;AAAA,MACV,KAAK,UAAU,MAAM;AAAA,MACrB;AAAA,MACA,sBAAsB,oBAAoB,OAAO;AAAA,IACnD;AAAA,EACF,GANO;AAAA,EAOP,OAAO,wBAACC,OAAM,KAAK,YAAY;AAC7B,UAAM,MAAM,wBAACC,WAAU,KAAK,aAAaA,QAAO,KAAK,sBAAsB,4BAA4B,OAAO,CAAC,GAAnG;AACZ,WAAO,OAAOD,UAAS,WAAW,gBAAgBA,OAAM,yBAAyB,WAAW,OAAO,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI,IAAIA,KAAI;AAAA,EAC7H,GAHO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBP,WAAW,wBAAC,UAAU,WAAW;AAC/B,UAAM,iBAAiB,OAAO,QAAQ;AACtC,SAAK;AAAA,MACH;AAAA;AAAA;AAAA,MAGA,CAAC,eAAe,KAAK,cAAc,IAAI,iBAAiB,UAAU,cAAc;AAAA,IAClF;AACA,WAAO,KAAK,YAAY,MAAM,UAAU,GAAG;AAAA,EAC7C,GATW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBX,WAAW,6BAAM;AACf,SAAK,qBAAqB,MAAM,IAAI,SAAS;AAC7C,WAAO,KAAK,iBAAiB,IAAI;AAAA,EACnC,GAHW;AAIb;;;ACrZA,IAAI,kBAAkB;AACtB,IAAI,4BAA4B;AAChC,IAAI,UAAU,CAAC,OAAO,QAAQ,OAAO,UAAU,WAAW,OAAO;AACjE,IAAI,mCAAmC;AACvC,IAAI,uBAAuB,cAAc,MAAM;AAAA,EAL/C,OAK+C;AAAA;AAAA;AAC/C;;;ACLA,IAAI,mBAAmB;;;ACKvB,IAAI,kBAAkB,wBAAC,MAAM;AAC3B,SAAO,EAAE,KAAK,iBAAiB,GAAG;AACpC,GAFsB;AAGtB,IAAI,eAAe,wBAAC,KAAK,MAAM;AAC7B,MAAI,iBAAiB,KAAK;AACxB,UAAM,MAAM,IAAI,YAAY;AAC5B,WAAO,EAAE,YAAY,IAAI,MAAM,GAAG;AAAA,EACpC;AACA,UAAQ,MAAM,GAAG;AACjB,SAAO,EAAE,KAAK,yBAAyB,GAAG;AAC5C,GAPmB;AAQnB,IAAI,OAAO,MAAM,MAAM;AAAA,EAjBvB,OAiBuB;AAAA;AAAA;AAAA,EACrB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA;AAAA;AAAA;AAAA,EAKA;AAAA,EACA;AAAA;AAAA,EAEA,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,SAAS,CAAC;AAAA,EACV,YAAY,UAAU,CAAC,GAAG;AACxB,UAAM,aAAa,CAAC,GAAG,SAAS,yBAAyB;AACzD,eAAW,QAAQ,CAAC,WAAW;AAC7B,WAAK,MAAM,IAAI,CAAC,UAAU,SAAS;AACjC,YAAI,OAAO,UAAU,UAAU;AAC7B,eAAK,QAAQ;AAAA,QACf,OAAO;AACL,eAAK,UAAU,QAAQ,KAAK,OAAO,KAAK;AAAA,QAC1C;AACA,aAAK,QAAQ,CAAC,YAAY;AACxB,eAAK,UAAU,QAAQ,KAAK,OAAO,OAAO;AAAA,QAC5C,CAAC;AACD,eAAO;AAAA,MACT;AAAA,IACF,CAAC;AACD,SAAK,KAAK,CAAC,QAAQ,SAAS,aAAa;AACvC,iBAAW,KAAK,CAAC,IAAI,EAAE,KAAK,GAAG;AAC7B,aAAK,QAAQ;AACb,mBAAW,KAAK,CAAC,MAAM,EAAE,KAAK,GAAG;AAC/B,mBAAS,IAAI,CAAC,YAAY;AACxB,iBAAK,UAAU,EAAE,YAAY,GAAG,KAAK,OAAO,OAAO;AAAA,UACrD,CAAC;AAAA,QACH;AAAA,MACF;AACA,aAAO;AAAA,IACT;AACA,SAAK,MAAM,CAAC,SAAS,aAAa;AAChC,UAAI,OAAO,SAAS,UAAU;AAC5B,aAAK,QAAQ;AAAA,MACf,OAAO;AACL,aAAK,QAAQ;AACb,iBAAS,QAAQ,IAAI;AAAA,MACvB;AACA,eAAS,QAAQ,CAAC,YAAY;AAC5B,aAAK,UAAU,iBAAiB,KAAK,OAAO,OAAO;AAAA,MACrD,CAAC;AACD,aAAO;AAAA,IACT;AACA,UAAM,EAAE,QAAQ,GAAG,qBAAqB,IAAI;AAC5C,WAAO,OAAO,MAAM,oBAAoB;AACxC,SAAK,UAAU,UAAU,OAAO,QAAQ,WAAW,UAAU;AAAA,EAC/D;AAAA,EACA,SAAS;AACP,UAAM,QAAQ,IAAI,MAAM;AAAA,MACtB,QAAQ,KAAK;AAAA,MACb,SAAS,KAAK;AAAA,IAChB,CAAC;AACD,UAAM,eAAe,KAAK;AAC1B,UAAM,mBAAmB,KAAK;AAC9B,UAAM,SAAS,KAAK;AACpB,WAAO;AAAA,EACT;AAAA,EACA,mBAAmB;AAAA;AAAA,EAEnB,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBf,MAAM,MAAME,OAAK;AACf,UAAM,SAAS,KAAK,SAAS,IAAI;AACjC,IAAAA,MAAI,OAAO,IAAI,CAAC,MAAM;AACpB,UAAI;AACJ,UAAIA,MAAI,iBAAiB,cAAc;AACrC,kBAAU,EAAE;AAAA,MACd,OAAO;AACL,kBAAU,8BAAO,GAAG,UAAU,MAAM,QAAQ,CAAC,GAAGA,MAAI,YAAY,EAAE,GAAG,MAAM,EAAE,QAAQ,GAAG,IAAI,CAAC,GAAG,KAAtF;AACV,gBAAQ,gBAAgB,IAAI,EAAE;AAAA,MAChC;AACA,aAAO,UAAU,EAAE,QAAQ,EAAE,MAAM,OAAO;AAAA,IAC5C,CAAC;AACD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,SAAS,MAAM;AACb,UAAM,SAAS,KAAK,OAAO;AAC3B,WAAO,YAAY,UAAU,KAAK,WAAW,IAAI;AACjD,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,UAAU,wBAAC,YAAY;AACrB,SAAK,eAAe;AACpB,WAAO;AAAA,EACT,GAHU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmBV,WAAW,wBAAC,YAAY;AACtB,SAAK,mBAAmB;AACxB,WAAO;AAAA,EACT,GAHW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoCX,MAAM,MAAM,oBAAoB,SAAS;AACvC,QAAI;AACJ,QAAI;AACJ,QAAI,SAAS;AACX,UAAI,OAAO,YAAY,YAAY;AACjC,wBAAgB;AAAA,MAClB,OAAO;AACL,wBAAgB,QAAQ;AACxB,YAAI,QAAQ,mBAAmB,OAAO;AACpC,2BAAiB,wBAAC,YAAY,SAAb;AAAA,QACnB,OAAO;AACL,2BAAiB,QAAQ;AAAA,QAC3B;AAAA,MACF;AAAA,IACF;AACA,UAAM,aAAa,gBAAgB,CAAC,MAAM;AACxC,YAAM,WAAW,cAAc,CAAC;AAChC,aAAO,MAAM,QAAQ,QAAQ,IAAI,WAAW,CAAC,QAAQ;AAAA,IACvD,IAAI,CAAC,MAAM;AACT,UAAI,mBAAmB;AACvB,UAAI;AACF,2BAAmB,EAAE;AAAA,MACvB,QAAQ;AAAA,MACR;AACA,aAAO,CAAC,EAAE,KAAK,gBAAgB;AAAA,IACjC;AACA,wBAAoB,MAAM;AACxB,YAAM,aAAa,UAAU,KAAK,WAAW,IAAI;AACjD,YAAM,mBAAmB,eAAe,MAAM,IAAI,WAAW;AAC7D,aAAO,CAAC,YAAY;AAClB,cAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,YAAI,WAAW,IAAI,SAAS,MAAM,gBAAgB,KAAK;AACvD,eAAO,IAAI,QAAQ,KAAK,OAAO;AAAA,MACjC;AAAA,IACF,GAAG;AACH,UAAM,UAAU,8BAAO,GAAG,SAAS;AACjC,YAAM,MAAM,MAAM,mBAAmB,eAAe,EAAE,IAAI,GAAG,GAAG,GAAG,WAAW,CAAC,CAAC;AAChF,UAAI,KAAK;AACP,eAAO;AAAA,MACT;AACA,YAAM,KAAK;AAAA,IACb,GANgB;AAOhB,SAAK,UAAU,iBAAiB,UAAU,MAAM,GAAG,GAAG,OAAO;AAC7D,WAAO;AAAA,EACT;AAAA,EACA,UAAU,QAAQ,MAAM,SAAS;AAC/B,aAAS,OAAO,YAAY;AAC5B,WAAO,UAAU,KAAK,WAAW,IAAI;AACrC,UAAM,IAAI,EAAE,UAAU,KAAK,WAAW,MAAM,QAAQ,QAAQ;AAC5D,SAAK,OAAO,IAAI,QAAQ,MAAM,CAAC,SAAS,CAAC,CAAC;AAC1C,SAAK,OAAO,KAAK,CAAC;AAAA,EACpB;AAAA,EACA,aAAa,KAAK,GAAG;AACnB,QAAI,eAAe,OAAO;AACxB,aAAO,KAAK,aAAa,KAAK,CAAC;AAAA,IACjC;AACA,UAAM;AAAA,EACR;AAAA,EACA,UAAU,SAAS,cAAc,KAAK,QAAQ;AAC5C,QAAI,WAAW,QAAQ;AACrB,cAAQ,YAAY,IAAI,SAAS,MAAM,MAAM,KAAK,UAAU,SAAS,cAAc,KAAK,KAAK,CAAC,GAAG;AAAA,IACnG;AACA,UAAM,OAAO,KAAK,QAAQ,SAAS,EAAE,IAAI,CAAC;AAC1C,UAAM,cAAc,KAAK,OAAO,MAAM,QAAQ,IAAI;AAClD,UAAM,IAAI,IAAI,QAAQ,SAAS;AAAA,MAC7B;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,iBAAiB,KAAK;AAAA,IACxB,CAAC;AACD,QAAI,YAAY,CAAC,EAAE,WAAW,GAAG;AAC/B,UAAI;AACJ,UAAI;AACF,cAAM,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,YAAY;AAC3C,YAAE,MAAM,MAAM,KAAK,iBAAiB,CAAC;AAAA,QACvC,CAAC;AAAA,MACH,SAAS,KAAK;AACZ,eAAO,KAAK,aAAa,KAAK,CAAC;AAAA,MACjC;AACA,aAAO,eAAe,UAAU,IAAI;AAAA,QAClC,CAAC,aAAa,aAAa,EAAE,YAAY,EAAE,MAAM,KAAK,iBAAiB,CAAC;AAAA,MAC1E,EAAE,MAAM,CAAC,QAAQ,KAAK,aAAa,KAAK,CAAC,CAAC,IAAI,OAAO,KAAK,iBAAiB,CAAC;AAAA,IAC9E;AACA,UAAM,WAAW,QAAQ,YAAY,CAAC,GAAG,KAAK,cAAc,KAAK,gBAAgB;AACjF,YAAQ,YAAY;AAClB,UAAI;AACF,cAAM,UAAU,MAAM,SAAS,CAAC;AAChC,YAAI,CAAC,QAAQ,WAAW;AACtB,gBAAM,IAAI;AAAA,YACR;AAAA,UACF;AAAA,QACF;AACA,eAAO,QAAQ;AAAA,MACjB,SAAS,KAAK;AACZ,eAAO,KAAK,aAAa,KAAK,CAAC;AAAA,MACjC;AAAA,IACF,GAAG;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,QAAQ,wBAAC,YAAY,SAAS;AAC5B,WAAO,KAAK,UAAU,SAAS,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,QAAQ,MAAM;AAAA,EACjE,GAFQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeR,UAAU,wBAACC,QAAO,aAAa,KAAK,iBAAiB;AACnD,QAAIA,kBAAiB,SAAS;AAC5B,aAAO,KAAK,MAAM,cAAc,IAAI,QAAQA,QAAO,WAAW,IAAIA,QAAO,KAAK,YAAY;AAAA,IAC5F;AACA,IAAAA,SAAQA,OAAM,SAAS;AACvB,WAAO,KAAK;AAAA,MACV,IAAI;AAAA,QACF,eAAe,KAAKA,MAAK,IAAIA,SAAQ,mBAAmB,UAAU,KAAKA,MAAK,CAAC;AAAA,QAC7E;AAAA,MACF;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF,GAbU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA+BV,OAAO,6BAAM;AACX,qBAAiB,SAAS,CAAC,UAAU;AACnC,YAAM,YAAY,KAAK,UAAU,MAAM,SAAS,OAAO,QAAQ,MAAM,QAAQ,MAAM,CAAC;AAAA,IACtF,CAAC;AAAA,EACH,GAJO;AAKT;;;ACpXA,IAAI,aAAa,CAAC;AAClB,SAAS,MAAM,QAAQ,MAAM;AAC3B,QAAM,WAAW,KAAK,iBAAiB;AACvC,QAAM,SAAU,yBAAC,SAAS,UAAU;AAClC,UAAM,UAAU,SAAS,OAAO,KAAK,SAAS,eAAe;AAC7D,UAAM,cAAc,QAAQ,CAAC,EAAE,KAAK;AACpC,QAAI,aAAa;AACf,aAAO;AAAA,IACT;AACA,UAAM,SAAS,MAAM,MAAM,QAAQ,CAAC,CAAC;AACrC,QAAI,CAAC,QAAQ;AACX,aAAO,CAAC,CAAC,GAAG,UAAU;AAAA,IACxB;AACA,UAAM,QAAQ,OAAO,QAAQ,IAAI,CAAC;AAClC,WAAO,CAAC,QAAQ,CAAC,EAAE,KAAK,GAAG,MAAM;AAAA,EACnC,IAZgB;AAahB,OAAK,QAAQ;AACb,SAAO,OAAO,QAAQ,IAAI;AAC5B;AAjBS;;;ACFT,IAAI,oBAAoB;AACxB,IAAI,4BAA4B;AAChC,IAAI,4BAA4B;AAChC,IAAI,aAA6B,uBAAO;AACxC,IAAI,kBAAkB,IAAI,IAAI,aAAa;AAC3C,SAAS,WAAW,GAAG,GAAG;AACxB,MAAI,EAAE,WAAW,GAAG;AAClB,WAAO,EAAE,WAAW,IAAI,IAAI,IAAI,KAAK,IAAI;AAAA,EAC3C;AACA,MAAI,EAAE,WAAW,GAAG;AAClB,WAAO;AAAA,EACT;AACA,MAAI,MAAM,6BAA6B,MAAM,2BAA2B;AACtE,WAAO;AAAA,EACT,WAAW,MAAM,6BAA6B,MAAM,2BAA2B;AAC7E,WAAO;AAAA,EACT;AACA,MAAI,MAAM,mBAAmB;AAC3B,WAAO;AAAA,EACT,WAAW,MAAM,mBAAmB;AAClC,WAAO;AAAA,EACT;AACA,SAAO,EAAE,WAAW,EAAE,SAAS,IAAI,IAAI,KAAK,IAAI,EAAE,SAAS,EAAE;AAC/D;AAlBS;AAmBT,IAAI,OAAO,MAAM,MAAM;AAAA,EAzBvB,OAyBuB;AAAA;AAAA;AAAA,EACrB;AAAA,EACA;AAAA,EACA,YAA4B,uBAAO,OAAO,IAAI;AAAA,EAC9C,OAAO,QAAQ,OAAO,UAAU,SAAS,oBAAoB;AAC3D,QAAI,OAAO,WAAW,GAAG;AACvB,UAAI,KAAK,WAAW,QAAQ;AAC1B,cAAM;AAAA,MACR;AACA,UAAI,oBAAoB;AACtB;AAAA,MACF;AACA,WAAK,SAAS;AACd;AAAA,IACF;AACA,UAAM,CAAC,OAAO,GAAG,UAAU,IAAI;AAC/B,UAAM,UAAU,UAAU,MAAM,WAAW,WAAW,IAAI,CAAC,IAAI,IAAI,yBAAyB,IAAI,CAAC,IAAI,IAAI,iBAAiB,IAAI,UAAU,OAAO,CAAC,IAAI,IAAI,yBAAyB,IAAI,MAAM,MAAM,6BAA6B;AAC9N,QAAI;AACJ,QAAI,SAAS;AACX,YAAM,OAAO,QAAQ,CAAC;AACtB,UAAI,YAAY,QAAQ,CAAC,KAAK;AAC9B,UAAI,QAAQ,QAAQ,CAAC,GAAG;AACtB,YAAI,cAAc,MAAM;AACtB,gBAAM;AAAA,QACR;AACA,oBAAY,UAAU,QAAQ,0BAA0B,KAAK;AAC7D,YAAI,YAAY,KAAK,SAAS,GAAG;AAC/B,gBAAM;AAAA,QACR;AAAA,MACF;AACA,aAAO,KAAK,UAAU,SAAS;AAC/B,UAAI,CAAC,MAAM;AACT,YAAI,OAAO,KAAK,KAAK,SAAS,EAAE;AAAA,UAC9B,CAAC,MAAM,MAAM,6BAA6B,MAAM;AAAA,QAClD,GAAG;AACD,gBAAM;AAAA,QACR;AACA,YAAI,oBAAoB;AACtB;AAAA,QACF;AACA,eAAO,KAAK,UAAU,SAAS,IAAI,IAAI,MAAM;AAC7C,YAAI,SAAS,IAAI;AACf,eAAK,YAAY,QAAQ;AAAA,QAC3B;AAAA,MACF;AACA,UAAI,CAAC,sBAAsB,SAAS,IAAI;AACtC,iBAAS,KAAK,CAAC,MAAM,KAAK,SAAS,CAAC;AAAA,MACtC;AAAA,IACF,OAAO;AACL,aAAO,KAAK,UAAU,KAAK;AAC3B,UAAI,CAAC,MAAM;AACT,YAAI,OAAO,KAAK,KAAK,SAAS,EAAE;AAAA,UAC9B,CAAC,MAAM,EAAE,SAAS,KAAK,MAAM,6BAA6B,MAAM;AAAA,QAClE,GAAG;AACD,gBAAM;AAAA,QACR;AACA,YAAI,oBAAoB;AACtB;AAAA,QACF;AACA,eAAO,KAAK,UAAU,KAAK,IAAI,IAAI,MAAM;AAAA,MAC3C;AAAA,IACF;AACA,SAAK,OAAO,YAAY,OAAO,UAAU,SAAS,kBAAkB;AAAA,EACtE;AAAA,EACA,iBAAiB;AACf,UAAM,YAAY,OAAO,KAAK,KAAK,SAAS,EAAE,KAAK,UAAU;AAC7D,UAAM,UAAU,UAAU,IAAI,CAAC,MAAM;AACnC,YAAM,IAAI,KAAK,UAAU,CAAC;AAC1B,cAAQ,OAAO,EAAE,cAAc,WAAW,IAAI,CAAC,KAAK,EAAE,SAAS,KAAK,gBAAgB,IAAI,CAAC,IAAI,KAAK,CAAC,KAAK,KAAK,EAAE,eAAe;AAAA,IAChI,CAAC;AACD,QAAI,OAAO,KAAK,WAAW,UAAU;AACnC,cAAQ,QAAQ,IAAI,KAAK,MAAM,EAAE;AAAA,IACnC;AACA,QAAI,QAAQ,WAAW,GAAG;AACxB,aAAO;AAAA,IACT;AACA,QAAI,QAAQ,WAAW,GAAG;AACxB,aAAO,QAAQ,CAAC;AAAA,IAClB;AACA,WAAO,QAAQ,QAAQ,KAAK,GAAG,IAAI;AAAA,EACrC;AACF;;;ACxGA,IAAI,OAAO,MAAM;AAAA,EAFjB,OAEiB;AAAA;AAAA;AAAA,EACf,WAAW,EAAE,UAAU,EAAE;AAAA,EACzB,QAAQ,IAAI,KAAK;AAAA,EACjB,OAAO,MAAM,OAAO,oBAAoB;AACtC,UAAM,aAAa,CAAC;AACpB,UAAM,SAAS,CAAC;AAChB,aAAS,IAAI,OAAO;AAClB,UAAI,WAAW;AACf,aAAO,KAAK,QAAQ,cAAc,CAAC,MAAM;AACvC,cAAM,OAAO,MAAM,CAAC;AACpB,eAAO,CAAC,IAAI,CAAC,MAAM,CAAC;AACpB;AACA,mBAAW;AACX,eAAO;AAAA,MACT,CAAC;AACD,UAAI,CAAC,UAAU;AACb;AAAA,MACF;AAAA,IACF;AACA,UAAM,SAAS,KAAK,MAAM,0BAA0B,KAAK,CAAC;AAC1D,aAAS,IAAI,OAAO,SAAS,GAAG,KAAK,GAAG,KAAK;AAC3C,YAAM,CAAC,IAAI,IAAI,OAAO,CAAC;AACvB,eAAS,IAAI,OAAO,SAAS,GAAG,KAAK,GAAG,KAAK;AAC3C,YAAI,OAAO,CAAC,EAAE,QAAQ,IAAI,MAAM,IAAI;AAClC,iBAAO,CAAC,IAAI,OAAO,CAAC,EAAE,QAAQ,MAAM,OAAO,CAAC,EAAE,CAAC,CAAC;AAChD;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,SAAK,MAAM,OAAO,QAAQ,OAAO,YAAY,KAAK,UAAU,kBAAkB;AAC9E,WAAO;AAAA,EACT;AAAA,EACA,cAAc;AACZ,QAAI,SAAS,KAAK,MAAM,eAAe;AACvC,QAAI,WAAW,IAAI;AACjB,aAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AAAA,IACtB;AACA,QAAI,eAAe;AACnB,UAAM,sBAAsB,CAAC;AAC7B,UAAM,sBAAsB,CAAC;AAC7B,aAAS,OAAO,QAAQ,yBAAyB,CAAC,GAAG,cAAc,eAAe;AAChF,UAAI,iBAAiB,QAAQ;AAC3B,4BAAoB,EAAE,YAAY,IAAI,OAAO,YAAY;AACzD,eAAO;AAAA,MACT;AACA,UAAI,eAAe,QAAQ;AACzB,4BAAoB,OAAO,UAAU,CAAC,IAAI,EAAE;AAC5C,eAAO;AAAA,MACT;AACA,aAAO;AAAA,IACT,CAAC;AACD,WAAO,CAAC,IAAI,OAAO,IAAI,MAAM,EAAE,GAAG,qBAAqB,mBAAmB;AAAA,EAC5E;AACF;;;AC7CA,IAAI,cAAc,CAAC,MAAM,CAAC,GAAmB,uBAAO,OAAO,IAAI,CAAC;AAChE,IAAI,sBAAsC,uBAAO,OAAO,IAAI;AAC5D,SAAS,oBAAoB,MAAM;AACjC,SAAO,oBAAoB,IAAI,MAAM,IAAI;AAAA,IACvC,SAAS,MAAM,KAAK,IAAI,KAAK;AAAA,MAC3B;AAAA,MACA,CAAC,GAAG,aAAa,WAAW,KAAK,QAAQ,KAAK;AAAA,IAChD,CAAC;AAAA,EACH;AACF;AAPS;AAQT,SAAS,2BAA2B;AAClC,wBAAsC,uBAAO,OAAO,IAAI;AAC1D;AAFS;AAGT,SAAS,mCAAmC,QAAQ;AAClD,QAAM,OAAO,IAAI,KAAK;AACtB,QAAM,cAAc,CAAC;AACrB,MAAI,OAAO,WAAW,GAAG;AACvB,WAAO;AAAA,EACT;AACA,QAAM,2BAA2B,OAAO;AAAA,IACtC,CAAC,UAAU,CAAC,CAAC,SAAS,KAAK,MAAM,CAAC,CAAC,GAAG,GAAG,KAAK;AAAA,EAChD,EAAE;AAAA,IACA,CAAC,CAAC,WAAW,KAAK,GAAG,CAAC,WAAW,KAAK,MAAM,YAAY,IAAI,YAAY,KAAK,MAAM,SAAS,MAAM;AAAA,EACpG;AACA,QAAM,YAA4B,uBAAO,OAAO,IAAI;AACpD,WAAS,IAAI,GAAG,IAAI,IAAI,MAAM,yBAAyB,QAAQ,IAAI,KAAK,KAAK;AAC3E,UAAM,CAAC,oBAAoB,MAAM,QAAQ,IAAI,yBAAyB,CAAC;AACvE,QAAI,oBAAoB;AACtB,gBAAU,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,GAAmB,uBAAO,OAAO,IAAI,CAAC,CAAC,GAAG,UAAU;AAAA,IAChG,OAAO;AACL;AAAA,IACF;AACA,QAAI;AACJ,QAAI;AACF,mBAAa,KAAK,OAAO,MAAM,GAAG,kBAAkB;AAAA,IACtD,SAAS,GAAG;AACV,YAAM,MAAM,aAAa,IAAI,qBAAqB,IAAI,IAAI;AAAA,IAC5D;AACA,QAAI,oBAAoB;AACtB;AAAA,IACF;AACA,gBAAY,CAAC,IAAI,SAAS,IAAI,CAAC,CAAC,GAAG,UAAU,MAAM;AACjD,YAAM,gBAAgC,uBAAO,OAAO,IAAI;AACxD,oBAAc;AACd,aAAO,cAAc,GAAG,cAAc;AACpC,cAAM,CAAC,KAAK,KAAK,IAAI,WAAW,UAAU;AAC1C,sBAAc,GAAG,IAAI;AAAA,MACvB;AACA,aAAO,CAAC,GAAG,aAAa;AAAA,IAC1B,CAAC;AAAA,EACH;AACA,QAAM,CAAC,QAAQ,qBAAqB,mBAAmB,IAAI,KAAK,YAAY;AAC5E,WAAS,IAAI,GAAG,MAAM,YAAY,QAAQ,IAAI,KAAK,KAAK;AACtD,aAAS,IAAI,GAAG,OAAO,YAAY,CAAC,EAAE,QAAQ,IAAI,MAAM,KAAK;AAC3D,YAAM,MAAM,YAAY,CAAC,EAAE,CAAC,IAAI,CAAC;AACjC,UAAI,CAAC,KAAK;AACR;AAAA,MACF;AACA,YAAM,OAAO,OAAO,KAAK,GAAG;AAC5B,eAAS,IAAI,GAAG,OAAO,KAAK,QAAQ,IAAI,MAAM,KAAK;AACjD,YAAI,KAAK,CAAC,CAAC,IAAI,oBAAoB,IAAI,KAAK,CAAC,CAAC,CAAC;AAAA,MACjD;AAAA,IACF;AAAA,EACF;AACA,QAAM,aAAa,CAAC;AACpB,aAAW,KAAK,qBAAqB;AACnC,eAAW,CAAC,IAAI,YAAY,oBAAoB,CAAC,CAAC;AAAA,EACpD;AACA,SAAO,CAAC,QAAQ,YAAY,SAAS;AACvC;AAxDS;AAyDT,SAAS,eAAe,YAAY,MAAM;AACxC,MAAI,CAAC,YAAY;AACf,WAAO;AAAA,EACT;AACA,aAAW,KAAK,OAAO,KAAK,UAAU,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,EAAE,MAAM,GAAG;AAC3E,QAAI,oBAAoB,CAAC,EAAE,KAAK,IAAI,GAAG;AACrC,aAAO,CAAC,GAAG,WAAW,CAAC,CAAC;AAAA,IAC1B;AAAA,EACF;AACA,SAAO;AACT;AAVS;AAWT,IAAI,eAAe,MAAM;AAAA,EA3FzB,OA2FyB;AAAA;AAAA;AAAA,EACvB,OAAO;AAAA,EACP;AAAA,EACA;AAAA,EACA,cAAc;AACZ,SAAK,cAAc,EAAE,CAAC,eAAe,GAAmB,uBAAO,OAAO,IAAI,EAAE;AAC5E,SAAK,UAAU,EAAE,CAAC,eAAe,GAAmB,uBAAO,OAAO,IAAI,EAAE;AAAA,EAC1E;AAAA,EACA,IAAI,QAAQ,MAAM,SAAS;AACzB,UAAM,aAAa,KAAK;AACxB,UAAM,SAAS,KAAK;AACpB,QAAI,CAAC,cAAc,CAAC,QAAQ;AAC1B,YAAM,IAAI,MAAM,gCAAgC;AAAA,IAClD;AACA,QAAI,CAAC,WAAW,MAAM,GAAG;AACvB;AACA,OAAC,YAAY,MAAM,EAAE,QAAQ,CAAC,eAAe;AAC3C,mBAAW,MAAM,IAAoB,uBAAO,OAAO,IAAI;AACvD,eAAO,KAAK,WAAW,eAAe,CAAC,EAAE,QAAQ,CAAC,MAAM;AACtD,qBAAW,MAAM,EAAE,CAAC,IAAI,CAAC,GAAG,WAAW,eAAe,EAAE,CAAC,CAAC;AAAA,QAC5D,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AACA,QAAI,SAAS,MAAM;AACjB,aAAO;AAAA,IACT;AACA,UAAM,cAAc,KAAK,MAAM,MAAM,KAAK,CAAC,GAAG;AAC9C,QAAI,MAAM,KAAK,IAAI,GAAG;AACpB,YAAM,KAAK,oBAAoB,IAAI;AACnC,UAAI,WAAW,iBAAiB;AAC9B,eAAO,KAAK,UAAU,EAAE,QAAQ,CAAC,MAAM;AACrC,qBAAW,CAAC,EAAE,IAAI,MAAM,eAAe,WAAW,CAAC,GAAG,IAAI,KAAK,eAAe,WAAW,eAAe,GAAG,IAAI,KAAK,CAAC;AAAA,QACvH,CAAC;AAAA,MACH,OAAO;AACL,mBAAW,MAAM,EAAE,IAAI,MAAM,eAAe,WAAW,MAAM,GAAG,IAAI,KAAK,eAAe,WAAW,eAAe,GAAG,IAAI,KAAK,CAAC;AAAA,MACjI;AACA,aAAO,KAAK,UAAU,EAAE,QAAQ,CAAC,MAAM;AACrC,YAAI,WAAW,mBAAmB,WAAW,GAAG;AAC9C,iBAAO,KAAK,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM;AACxC,eAAG,KAAK,CAAC,KAAK,WAAW,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,SAAS,UAAU,CAAC;AAAA,UAC3D,CAAC;AAAA,QACH;AAAA,MACF,CAAC;AACD,aAAO,KAAK,MAAM,EAAE,QAAQ,CAAC,MAAM;AACjC,YAAI,WAAW,mBAAmB,WAAW,GAAG;AAC9C,iBAAO,KAAK,OAAO,CAAC,CAAC,EAAE;AAAA,YACrB,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,OAAO,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,SAAS,UAAU,CAAC;AAAA,UAC9D;AAAA,QACF;AAAA,MACF,CAAC;AACD;AAAA,IACF;AACA,UAAM,QAAQ,uBAAuB,IAAI,KAAK,CAAC,IAAI;AACnD,aAAS,IAAI,GAAG,MAAM,MAAM,QAAQ,IAAI,KAAK,KAAK;AAChD,YAAM,QAAQ,MAAM,CAAC;AACrB,aAAO,KAAK,MAAM,EAAE,QAAQ,CAAC,MAAM;AACjC,YAAI,WAAW,mBAAmB,WAAW,GAAG;AAC9C,iBAAO,CAAC,EAAE,KAAK,MAAM;AAAA,YACnB,GAAG,eAAe,WAAW,CAAC,GAAG,KAAK,KAAK,eAAe,WAAW,eAAe,GAAG,KAAK,KAAK,CAAC;AAAA,UACpG;AACA,iBAAO,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,SAAS,aAAa,MAAM,IAAI,CAAC,CAAC;AAAA,QAC3D;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EACA,QAAQ;AAAA,EACR,mBAAmB;AACjB,UAAM,WAA2B,uBAAO,OAAO,IAAI;AACnD,WAAO,KAAK,KAAK,OAAO,EAAE,OAAO,OAAO,KAAK,KAAK,WAAW,CAAC,EAAE,QAAQ,CAAC,WAAW;AAClF,eAAS,MAAM,MAAM,KAAK,cAAc,MAAM;AAAA,IAChD,CAAC;AACD,SAAK,cAAc,KAAK,UAAU;AAClC,6BAAyB;AACzB,WAAO;AAAA,EACT;AAAA,EACA,cAAc,QAAQ;AACpB,UAAM,SAAS,CAAC;AAChB,QAAI,cAAc,WAAW;AAC7B,KAAC,KAAK,aAAa,KAAK,OAAO,EAAE,QAAQ,CAAC,MAAM;AAC9C,YAAM,WAAW,EAAE,MAAM,IAAI,OAAO,KAAK,EAAE,MAAM,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC;AAC9F,UAAI,SAAS,WAAW,GAAG;AACzB,wBAAgB;AAChB,eAAO,KAAK,GAAG,QAAQ;AAAA,MACzB,WAAW,WAAW,iBAAiB;AACrC,eAAO;AAAA,UACL,GAAG,OAAO,KAAK,EAAE,eAAe,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;AAAA,QACnF;AAAA,MACF;AAAA,IACF,CAAC;AACD,QAAI,CAAC,aAAa;AAChB,aAAO;AAAA,IACT,OAAO;AACL,aAAO,mCAAmC,MAAM;AAAA,IAClD;AAAA,EACF;AACF;;;ACxLA,IAAI,cAAc,MAAM;AAAA,EAFxB,OAEwB;AAAA;AAAA;AAAA,EACtB,OAAO;AAAA,EACP,WAAW,CAAC;AAAA,EACZ,UAAU,CAAC;AAAA,EACX,YAAY,MAAM;AAChB,SAAK,WAAW,KAAK;AAAA,EACvB;AAAA,EACA,IAAI,QAAQ,MAAM,SAAS;AACzB,QAAI,CAAC,KAAK,SAAS;AACjB,YAAM,IAAI,MAAM,gCAAgC;AAAA,IAClD;AACA,SAAK,QAAQ,KAAK,CAAC,QAAQ,MAAM,OAAO,CAAC;AAAA,EAC3C;AAAA,EACA,MAAM,QAAQ,MAAM;AAClB,QAAI,CAAC,KAAK,SAAS;AACjB,YAAM,IAAI,MAAM,aAAa;AAAA,IAC/B;AACA,UAAM,UAAU,KAAK;AACrB,UAAM,SAAS,KAAK;AACpB,UAAM,MAAM,QAAQ;AACpB,QAAI,IAAI;AACR,QAAI;AACJ,WAAO,IAAI,KAAK,KAAK;AACnB,YAAM,SAAS,QAAQ,CAAC;AACxB,UAAI;AACF,iBAAS,KAAK,GAAG,OAAO,OAAO,QAAQ,KAAK,MAAM,MAAM;AACtD,iBAAO,IAAI,GAAG,OAAO,EAAE,CAAC;AAAA,QAC1B;AACA,cAAM,OAAO,MAAM,QAAQ,IAAI;AAAA,MACjC,SAAS,GAAG;AACV,YAAI,aAAa,sBAAsB;AACrC;AAAA,QACF;AACA,cAAM;AAAA,MACR;AACA,WAAK,QAAQ,OAAO,MAAM,KAAK,MAAM;AACrC,WAAK,WAAW,CAAC,MAAM;AACvB,WAAK,UAAU;AACf;AAAA,IACF;AACA,QAAI,MAAM,KAAK;AACb,YAAM,IAAI,MAAM,aAAa;AAAA,IAC/B;AACA,SAAK,OAAO,iBAAiB,KAAK,aAAa,IAAI;AACnD,WAAO;AAAA,EACT;AAAA,EACA,IAAI,eAAe;AACjB,QAAI,KAAK,WAAW,KAAK,SAAS,WAAW,GAAG;AAC9C,YAAM,IAAI,MAAM,2CAA2C;AAAA,IAC7D;AACA,WAAO,KAAK,SAAS,CAAC;AAAA,EACxB;AACF;;;ACnDA,IAAI,cAA8B,uBAAO,OAAO,IAAI;AACpD,IAAIC,QAAO,MAAMC,OAAM;AAAA,EAJvB,OAIuB;AAAA;AAAA;AAAA,EACrB;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAAS;AAAA,EACT,UAAU;AAAA,EACV,YAAY,QAAQ,SAAS,UAAU;AACrC,SAAK,YAAY,YAA4B,uBAAO,OAAO,IAAI;AAC/D,SAAK,WAAW,CAAC;AACjB,QAAI,UAAU,SAAS;AACrB,YAAM,IAAoB,uBAAO,OAAO,IAAI;AAC5C,QAAE,MAAM,IAAI,EAAE,SAAS,cAAc,CAAC,GAAG,OAAO,EAAE;AAClD,WAAK,WAAW,CAAC,CAAC;AAAA,IACpB;AACA,SAAK,YAAY,CAAC;AAAA,EACpB;AAAA,EACA,OAAO,QAAQ,MAAM,SAAS;AAC5B,SAAK,SAAS,EAAE,KAAK;AACrB,QAAI,UAAU;AACd,UAAM,QAAQ,iBAAiB,IAAI;AACnC,UAAM,eAAe,CAAC;AACtB,aAAS,IAAI,GAAG,MAAM,MAAM,QAAQ,IAAI,KAAK,KAAK;AAChD,YAAM,IAAI,MAAM,CAAC;AACjB,YAAM,QAAQ,MAAM,IAAI,CAAC;AACzB,YAAM,UAAU,WAAW,GAAG,KAAK;AACnC,YAAM,MAAM,MAAM,QAAQ,OAAO,IAAI,QAAQ,CAAC,IAAI;AAClD,UAAI,OAAO,QAAQ,WAAW;AAC5B,kBAAU,QAAQ,UAAU,GAAG;AAC/B,YAAI,SAAS;AACX,uBAAa,KAAK,QAAQ,CAAC,CAAC;AAAA,QAC9B;AACA;AAAA,MACF;AACA,cAAQ,UAAU,GAAG,IAAI,IAAIA,OAAM;AACnC,UAAI,SAAS;AACX,gBAAQ,UAAU,KAAK,OAAO;AAC9B,qBAAa,KAAK,QAAQ,CAAC,CAAC;AAAA,MAC9B;AACA,gBAAU,QAAQ,UAAU,GAAG;AAAA,IACjC;AACA,YAAQ,SAAS,KAAK;AAAA,MACpB,CAAC,MAAM,GAAG;AAAA,QACR;AAAA,QACA,cAAc,aAAa,OAAO,CAAC,GAAG,GAAG,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC;AAAA,QACjE,OAAO,KAAK;AAAA,MACd;AAAA,IACF,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EACA,gBAAgB,MAAM,QAAQ,YAAY,QAAQ;AAChD,UAAM,cAAc,CAAC;AACrB,aAAS,IAAI,GAAG,MAAM,KAAK,SAAS,QAAQ,IAAI,KAAK,KAAK;AACxD,YAAM,IAAI,KAAK,SAAS,CAAC;AACzB,YAAM,aAAa,EAAE,MAAM,KAAK,EAAE,eAAe;AACjD,YAAM,eAAe,CAAC;AACtB,UAAI,eAAe,QAAQ;AACzB,mBAAW,SAAyB,uBAAO,OAAO,IAAI;AACtD,oBAAY,KAAK,UAAU;AAC3B,YAAI,eAAe,eAAe,UAAU,WAAW,aAAa;AAClE,mBAAS,KAAK,GAAG,OAAO,WAAW,aAAa,QAAQ,KAAK,MAAM,MAAM;AACvE,kBAAM,MAAM,WAAW,aAAa,EAAE;AACtC,kBAAM,YAAY,aAAa,WAAW,KAAK;AAC/C,uBAAW,OAAO,GAAG,IAAI,SAAS,GAAG,KAAK,CAAC,YAAY,OAAO,GAAG,IAAI,WAAW,GAAG,KAAK,SAAS,GAAG;AACpG,yBAAa,WAAW,KAAK,IAAI;AAAA,UACnC;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EACA,OAAO,QAAQ,MAAM;AACnB,UAAM,cAAc,CAAC;AACrB,SAAK,UAAU;AACf,UAAM,UAAU;AAChB,QAAI,WAAW,CAAC,OAAO;AACvB,UAAM,QAAQ,UAAU,IAAI;AAC5B,UAAM,gBAAgB,CAAC;AACvB,aAAS,IAAI,GAAG,MAAM,MAAM,QAAQ,IAAI,KAAK,KAAK;AAChD,YAAM,OAAO,MAAM,CAAC;AACpB,YAAM,SAAS,MAAM,MAAM;AAC3B,YAAM,YAAY,CAAC;AACnB,eAAS,IAAI,GAAG,OAAO,SAAS,QAAQ,IAAI,MAAM,KAAK;AACrD,cAAM,OAAO,SAAS,CAAC;AACvB,cAAM,WAAW,KAAK,UAAU,IAAI;AACpC,YAAI,UAAU;AACZ,mBAAS,UAAU,KAAK;AACxB,cAAI,QAAQ;AACV,gBAAI,SAAS,UAAU,GAAG,GAAG;AAC3B,0BAAY;AAAA,gBACV,GAAG,KAAK,gBAAgB,SAAS,UAAU,GAAG,GAAG,QAAQ,KAAK,OAAO;AAAA,cACvE;AAAA,YACF;AACA,wBAAY,KAAK,GAAG,KAAK,gBAAgB,UAAU,QAAQ,KAAK,OAAO,CAAC;AAAA,UAC1E,OAAO;AACL,sBAAU,KAAK,QAAQ;AAAA,UACzB;AAAA,QACF;AACA,iBAAS,IAAI,GAAG,OAAO,KAAK,UAAU,QAAQ,IAAI,MAAM,KAAK;AAC3D,gBAAM,UAAU,KAAK,UAAU,CAAC;AAChC,gBAAM,SAAS,KAAK,YAAY,cAAc,CAAC,IAAI,EAAE,GAAG,KAAK,QAAQ;AACrE,cAAI,YAAY,KAAK;AACnB,kBAAM,UAAU,KAAK,UAAU,GAAG;AAClC,gBAAI,SAAS;AACX,0BAAY,KAAK,GAAG,KAAK,gBAAgB,SAAS,QAAQ,KAAK,OAAO,CAAC;AACvE,sBAAQ,UAAU;AAClB,wBAAU,KAAK,OAAO;AAAA,YACxB;AACA;AAAA,UACF;AACA,gBAAM,CAAC,KAAK,MAAM,OAAO,IAAI;AAC7B,cAAI,CAAC,QAAQ,EAAE,mBAAmB,SAAS;AACzC;AAAA,UACF;AACA,gBAAM,QAAQ,KAAK,UAAU,GAAG;AAChC,gBAAM,iBAAiB,MAAM,MAAM,CAAC,EAAE,KAAK,GAAG;AAC9C,cAAI,mBAAmB,QAAQ;AAC7B,kBAAM,IAAI,QAAQ,KAAK,cAAc;AACrC,gBAAI,GAAG;AACL,qBAAO,IAAI,IAAI,EAAE,CAAC;AAClB,0BAAY,KAAK,GAAG,KAAK,gBAAgB,OAAO,QAAQ,KAAK,SAAS,MAAM,CAAC;AAC7E,kBAAI,OAAO,KAAK,MAAM,SAAS,EAAE,QAAQ;AACvC,sBAAM,UAAU;AAChB,sBAAM,iBAAiB,EAAE,CAAC,EAAE,MAAM,IAAI,GAAG,UAAU;AACnD,sBAAM,iBAAiB,cAAc,cAAc,MAAM,CAAC;AAC1D,+BAAe,KAAK,KAAK;AAAA,cAC3B;AACA;AAAA,YACF;AAAA,UACF;AACA,cAAI,YAAY,QAAQ,QAAQ,KAAK,IAAI,GAAG;AAC1C,mBAAO,IAAI,IAAI;AACf,gBAAI,QAAQ;AACV,0BAAY,KAAK,GAAG,KAAK,gBAAgB,OAAO,QAAQ,QAAQ,KAAK,OAAO,CAAC;AAC7E,kBAAI,MAAM,UAAU,GAAG,GAAG;AACxB,4BAAY;AAAA,kBACV,GAAG,KAAK,gBAAgB,MAAM,UAAU,GAAG,GAAG,QAAQ,QAAQ,KAAK,OAAO;AAAA,gBAC5E;AAAA,cACF;AAAA,YACF,OAAO;AACL,oBAAM,UAAU;AAChB,wBAAU,KAAK,KAAK;AAAA,YACtB;AAAA,UACF;AAAA,QACF;AAAA,MACF;AACA,iBAAW,UAAU,OAAO,cAAc,MAAM,KAAK,CAAC,CAAC;AAAA,IACzD;AACA,QAAI,YAAY,SAAS,GAAG;AAC1B,kBAAY,KAAK,CAAC,GAAG,MAAM;AACzB,eAAO,EAAE,QAAQ,EAAE;AAAA,MACrB,CAAC;AAAA,IACH;AACA,WAAO,CAAC,YAAY,IAAI,CAAC,EAAE,SAAS,OAAO,MAAM,CAAC,SAAS,MAAM,CAAC,CAAC;AAAA,EACrE;AACF;;;AC3JA,IAAI,aAAa,MAAM;AAAA,EAHvB,OAGuB;AAAA;AAAA;AAAA,EACrB,OAAO;AAAA,EACP;AAAA,EACA,cAAc;AACZ,SAAK,QAAQ,IAAIC,MAAK;AAAA,EACxB;AAAA,EACA,IAAI,QAAQ,MAAM,SAAS;AACzB,UAAM,UAAU,uBAAuB,IAAI;AAC3C,QAAI,SAAS;AACX,eAAS,IAAI,GAAG,MAAM,QAAQ,QAAQ,IAAI,KAAK,KAAK;AAClD,aAAK,MAAM,OAAO,QAAQ,QAAQ,CAAC,GAAG,OAAO;AAAA,MAC/C;AACA;AAAA,IACF;AACA,SAAK,MAAM,OAAO,QAAQ,MAAM,OAAO;AAAA,EACzC;AAAA,EACA,MAAM,QAAQ,MAAM;AAClB,WAAO,KAAK,MAAM,OAAO,QAAQ,IAAI;AAAA,EACvC;AACF;;;ACjBA,IAAIC,QAAO,cAAc,KAAS;AAAA,EALlC,OAKkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMhC,YAAY,UAAU,CAAC,GAAG;AACxB,UAAM,OAAO;AACb,SAAK,SAAS,QAAQ,UAAU,IAAI,YAAY;AAAA,MAC9C,SAAS,CAAC,IAAI,aAAa,GAAG,IAAI,WAAW,CAAC;AAAA,IAChD,CAAC;AAAA,EACH;AACF;;;AChBA,IAAI,OAAO,wBAAC,YAAY;AACtB,QAAM,WAAW;AAAA,IACf,QAAQ;AAAA,IACR,cAAc,CAAC,OAAO,QAAQ,OAAO,QAAQ,UAAU,OAAO;AAAA,IAC9D,cAAc,CAAC;AAAA,IACf,eAAe,CAAC;AAAA,EAClB;AACA,QAAM,OAAO;AAAA,IACX,GAAG;AAAA,IACH,GAAG;AAAA,EACL;AACA,QAAM,mBAAmB,CAAC,eAAe;AACvC,QAAI,OAAO,eAAe,UAAU;AAClC,UAAI,eAAe,KAAK;AACtB,eAAO,MAAM;AAAA,MACf,OAAO;AACL,eAAO,CAAC,WAAW,eAAe,SAAS,SAAS;AAAA,MACtD;AAAA,IACF,WAAW,OAAO,eAAe,YAAY;AAC3C,aAAO;AAAA,IACT,OAAO;AACL,aAAO,CAAC,WAAW,WAAW,SAAS,MAAM,IAAI,SAAS;AAAA,IAC5D;AAAA,EACF,GAAG,KAAK,MAAM;AACd,QAAM,oBAAoB,CAAC,qBAAqB;AAC9C,QAAI,OAAO,qBAAqB,YAAY;AAC1C,aAAO;AAAA,IACT,WAAW,MAAM,QAAQ,gBAAgB,GAAG;AAC1C,aAAO,MAAM;AAAA,IACf,OAAO;AACL,aAAO,MAAM,CAAC;AAAA,IAChB;AAAA,EACF,GAAG,KAAK,YAAY;AACpB,SAAO,sCAAe,MAAM,GAAG,MAAM;AACnC,aAAS,IAAI,KAAK,OAAO;AACvB,QAAE,IAAI,QAAQ,IAAI,KAAK,KAAK;AAAA,IAC9B;AAFS;AAGT,UAAM,cAAc,MAAM,gBAAgB,EAAE,IAAI,OAAO,QAAQ,KAAK,IAAI,CAAC;AACzE,QAAI,aAAa;AACf,UAAI,+BAA+B,WAAW;AAAA,IAChD;AACA,QAAI,KAAK,aAAa;AACpB,UAAI,oCAAoC,MAAM;AAAA,IAChD;AACA,QAAI,KAAK,eAAe,QAAQ;AAC9B,UAAI,iCAAiC,KAAK,cAAc,KAAK,GAAG,CAAC;AAAA,IACnE;AACA,QAAI,EAAE,IAAI,WAAW,WAAW;AAC9B,UAAI,KAAK,WAAW,KAAK;AACvB,YAAI,QAAQ,QAAQ;AAAA,MACtB;AACA,UAAI,KAAK,UAAU,MAAM;AACvB,YAAI,0BAA0B,KAAK,OAAO,SAAS,CAAC;AAAA,MACtD;AACA,YAAM,eAAe,MAAM,iBAAiB,EAAE,IAAI,OAAO,QAAQ,KAAK,IAAI,CAAC;AAC3E,UAAI,aAAa,QAAQ;AACvB,YAAI,gCAAgC,aAAa,KAAK,GAAG,CAAC;AAAA,MAC5D;AACA,UAAI,UAAU,KAAK;AACnB,UAAI,CAAC,SAAS,QAAQ;AACpB,cAAM,iBAAiB,EAAE,IAAI,OAAO,gCAAgC;AACpE,YAAI,gBAAgB;AAClB,oBAAU,eAAe,MAAM,SAAS;AAAA,QAC1C;AAAA,MACF;AACA,UAAI,SAAS,QAAQ;AACnB,YAAI,gCAAgC,QAAQ,KAAK,GAAG,CAAC;AACrD,UAAE,IAAI,QAAQ,OAAO,QAAQ,gCAAgC;AAAA,MAC/D;AACA,QAAE,IAAI,QAAQ,OAAO,gBAAgB;AACrC,QAAE,IAAI,QAAQ,OAAO,cAAc;AACnC,aAAO,IAAI,SAAS,MAAM;AAAA,QACxB,SAAS,EAAE,IAAI;AAAA,QACf,QAAQ;AAAA,QACR,YAAY;AAAA,MACd,CAAC;AAAA,IACH;AACA,UAAM,KAAK;AACX,QAAI,KAAK,WAAW,KAAK;AACvB,QAAE,OAAO,QAAQ,UAAU,EAAE,QAAQ,KAAK,CAAC;AAAA,IAC7C;AAAA,EACF,GAhDO;AAiDT,GAlFW;;;ACuBX,IAAI,mBAAmB,wBAAC,eAAe,YAAhB;;;ACThB,IAAM,eAAe;AAAA,EAC1B;AAAA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAEA,SAAS,aAAa,MAAuB;AAC3C,SAAO,aAAa,KAAK,CAAC,eAAe;AACvC,QAAI,SAAS,WAAY,QAAO;AAEhC,UAAM,SAAS,WAAW,SAAS,GAAG,IAAI,WAAW,MAAM,GAAG,EAAE,IAAI;AACpE,WAAO,KAAK,WAAW,GAAG,MAAM,GAAG;AAAA,EACrC,CAAC;AACH;AAPS;AAST,eAAe,aAAa,IAAgB,KAA+B;AACzE,MAAI,CAAC,OAAO,IAAI,SAAS,GAAI,QAAO;AAEpC,QAAM,SAAS,IAAI,UAAU,GAAG,CAAC;AACjC,QAAM,SAAS,MAAM,GAAG;AAAA,IACtB;AAAA,EACF,EAAE,KAAK,MAAM,EAAE,MAA4B;AAE3C,MAAI,CAAC,OAAQ,QAAO;AAEpB,QAAM,UAAU,IAAI,YAAY;AAChC,QAAM,OAAO,QAAQ,OAAO,GAAG;AAC/B,QAAM,aAAa,MAAM,OAAO,OAAO,OAAO,WAAW,IAAI;AAC7D,QAAM,YAAY,MAAM,KAAK,IAAI,WAAW,UAAU,CAAC;AACvD,QAAM,UAAU,UAAU,IAAI,OAAK,EAAE,SAAS,EAAE,EAAE,SAAS,GAAG,GAAG,CAAC,EAAE,KAAK,EAAE;AAE3E,QAAMC,WAAU,YAAY,OAAO;AAEnC,MAAIA,UAAS;AACX,UAAM,GAAG;AAAA,MACP;AAAA,IACF,EAAE,KAAK,MAAM,EAAE,IAAI;AAAA,EACrB;AAEA,SAAOA;AACT;AAzBe;AA2Bf,SAAS,gBAAgB,KAAyB;AAChD,QAAM,SAAS,IAAI,QAAQ,MAAM,GAAG,EAAE,QAAQ,MAAM,GAAG;AACvD,QAAM,SAAS,SAAS,IAAI,QAAQ,IAAI,OAAO,SAAS,KAAK,CAAC;AAC9D,QAAM,SAAS,KAAK,MAAM;AAC1B,QAAM,QAAQ,IAAI,WAAW,OAAO,MAAM;AAC1C,WAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,UAAM,CAAC,IAAI,OAAO,WAAW,CAAC;AAAA,EAChC;AACA,SAAO;AACT;AATS;AA0BT,IAAI,aAAwD;AAC5D,IAAM,oBAAoB,KAAK,KAAK;AAEpC,eAAe,QAAQ,YAAoC;AACzD,MAAI,cAAc,KAAK,IAAI,IAAI,WAAW,YAAY,mBAAmB;AACvE,WAAO,WAAW;AAAA,EACpB;AAEA,QAAM,WAAW,WAAW,UAAU;AACtC,QAAM,WAAW,MAAM,MAAM,QAAQ;AACrC,MAAI,CAAC,SAAS,IAAI;AAChB,UAAM,IAAI,MAAM,yBAAyB,SAAS,MAAM,EAAE;AAAA,EAC5D;AAEA,QAAM,OAAO,MAAM,SAAS,KAAK;AACjC,eAAa,EAAE,MAAM,KAAK,MAAM,WAAW,KAAK,IAAI,EAAE;AACtD,SAAO,KAAK;AACd;AAde;AAgBf,eAAe,UAAU,KAA8B;AACrD,SAAO,OAAO,OAAO;AAAA,IACnB;AAAA,IACA;AAAA,IACA,EAAE,MAAM,qBAAqB,MAAM,UAAU;AAAA,IAC7C;AAAA,IACA,CAAC,QAAQ;AAAA,EACX;AACF;AARe;AAUf,SAAS,iBAAiB,MAA8C;AACtE,MAAI;AACF,WAAO,KAAK,MAAM,IAAI,YAAY,EAAE,OAAO,gBAAgB,IAAI,CAAC,CAAC;AAAA,EACnE,QAAQ;AACN,QAAI;AACF,aAAO,KAAK,MAAM,KAAK,IAAI,CAAC;AAAA,IAC9B,QAAQ;AACN,aAAO;AAAA,IACT;AAAA,EACF;AACF;AAVS;AAYT,eAAe,kBACb,OACA,YACA,KACmD;AACnD,MAAI;AACF,UAAM,QAAQ,MAAM,MAAM,GAAG;AAC7B,QAAI,MAAM,WAAW,EAAG,QAAO;AAE/B,UAAM,aAAa,iBAAiB,MAAM,CAAC,CAAC;AAC5C,UAAM,UAAU,iBAAiB,MAAM,CAAC,CAAC;AACzC,QAAI,CAAC,QAAS,QAAO;AAErB,QAAI,QAAQ,OAAQ,QAAQ,MAAiB,MAAO,KAAK,IAAI,GAAG;AAC9D,aAAO;AAAA,IACT;AAEA,QAAI,OAAO,QAAQ,KAAK;AACtB,YAAM,YAAY,MAAM,QAAQ,QAAQ,GAAG,IAAI,QAAQ,MAAM,CAAC,QAAQ,GAAG;AACzE,UAAI,CAAC,UAAU,SAAS,GAAG,GAAG;AAC5B,eAAO;AAAA,MACT;AAAA,IACF;AAEA,QAAI,cAAc,YAAY,KAAK;AACjC,UAAI;AACF,cAAM,OAAO,MAAM,QAAQ,UAAU;AACrC,cAAM,cAAc,KAAK,KAAK,OAAK,EAAE,QAAQ,WAAW,GAAG;AAE3D,YAAI,aAAa;AACf,gBAAM,YAAY,MAAM,UAAU,WAAW;AAC7C,gBAAM,iBAAiB,gBAAgB,MAAM,CAAC,CAAC;AAC/C,gBAAM,YAAY,IAAI,YAAY,EAAE,OAAO,GAAG,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE;AAEpE,gBAAM,QAAQ,MAAM,OAAO,OAAO;AAAA,YAChC;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACF;AAEA,cAAI,CAAC,MAAO,QAAO;AAAA,QACrB;AAAA,MACF,QAAQ;AAAA,MAER;AAAA,IACF;AAEA,QAAI,CAAC,QAAQ,SAAS,CAAC,QAAQ,IAAK,QAAO;AAE3C,WAAO;AAAA,MACL,OAAO,QAAQ;AAAA,MACf,QAAQ,QAAQ;AAAA,IAClB;AAAA,EACF,QAAQ;AACN,WAAO;AAAA,EACT;AACF;AAzDe;AA2DR,IAAM,iBAAiB,iBAAiB,OAAO,GAAY,SAAe;AAC/E,QAAM,OAAO,EAAE,IAAI;AAEnB,MAAI,aAAa,IAAI,GAAG;AACtB,MAAE,IAAI,QAAQ,EAAE,MAAM,UAAU,CAAC;AACjC,WAAO,KAAK;AAAA,EACd;AAEA,QAAM,aAAa,EAAE,KAAK,yBAAyB;AACnD,QAAM,YAAY,EAAE,KAAK,iBAAiB;AAE1C,QAAM,gBAAgB,EAAE,IAAI,OAAO,yBAAyB;AAC5D,MAAI,eAAe;AACjB,UAAM,SAAS,MAAM,kBAAkB,eAAe,YAAY,aAAa,MAAS;AACxF,QAAI,QAAQ;AACV,QAAE,IAAI,QAAQ;AAAA,QACZ,MAAM;AAAA,QACN,OAAO,OAAO;AAAA,QACd,QAAQ,OAAO;AAAA,MACjB,CAAC;AACD,aAAO,KAAK;AAAA,IACd;AAAA,EACF;AAEA,QAAM,aAAa,EAAE,IAAI,OAAO,eAAe;AAE/C,MAAI,YAAY,WAAW,SAAS,GAAG;AACrC,UAAM,QAAQ,WAAW,UAAU,CAAC;AAEpC,UAAM,SAAS,MAAM,kBAAkB,OAAO,YAAY,aAAa,MAAS;AAChF,QAAI,QAAQ;AACV,QAAE,IAAI,QAAQ;AAAA,QACZ,MAAM;AAAA,QACN,OAAO,OAAO;AAAA,QACd,QAAQ,OAAO;AAAA,MACjB,CAAC;AACD,aAAO,KAAK;AAAA,IACd;AAEA,UAAM,KAAK,EAAE,IAAI;AACjB,UAAM,aAAa,MAAM,aAAa,IAAI,KAAK;AAC/C,QAAI,YAAY;AACd,QAAE,IAAI,QAAQ,EAAE,MAAM,UAAU,CAAC;AACjC,aAAO,KAAK;AAAA,IACd;AAAA,EACF;AAEA,SAAO,EAAE,KAAK,EAAE,OAAO,gBAAgB,SAAS,gCAAgC,GAAG,GAAG;AACxF,CAAC;;;ACnOD,IAAM,kBAAkB;AAExB,IAAM,YAAY,wBAAC,UAA2B,QAAQ,KAAK,KAAM,KAA/C;AAElB,IAAM,YAAY,wBAAC,UAA2C;AAC5D,MAAI;AACF,UAAM,SAAS,KAAK,MAAM,KAAK;AAC/B,QAAI,UAAU,OAAO,WAAW,UAAU;AACxC,aAAO;AAAA,IACT;AAAA,EACF,QAAQ;AAAA,EACR;AACA,SAAO,CAAC;AACV,GATkB;AAWlB,IAAM,sBAAsB,wBAAC,eAAgC;AAC3D,MAAI,CAAC,WAAY,QAAO;AACxB,SAAO,WAAW,QAAQ,QAAQ,EAAE,EAAE,YAAY;AACpD,GAH4B;AAK5B,IAAM,aAAa,wBAAC,eAAgC,oBAAoB,UAAU,EAAE,MAAM,GAAG,CAAC,GAA3E;AAEnB,IAAM,cAAc,wBAAC,MAAc,MAAc,MAAc,SAAyB;AACtF,QAAM,OAAO,UAAU,OAAO,IAAI;AAClC,QAAM,OAAO,UAAU,OAAO,IAAI;AAClC,QAAM,IACJ,KAAK,IAAI,OAAO,CAAC,IAAI,KAAK,IAAI,OAAO,CAAC,IACtC,KAAK,IAAI,UAAU,IAAI,CAAC,IAAI,KAAK,IAAI,UAAU,IAAI,CAAC,IAAI,KAAK,IAAI,OAAO,CAAC,IAAI,KAAK,IAAI,OAAO,CAAC;AAChG,QAAM,IAAI,IAAI,KAAK,MAAM,KAAK,KAAK,CAAC,GAAG,KAAK,KAAK,IAAI,CAAC,CAAC;AACvD,SAAO,kBAAkB;AAC3B,GARoB;AAUpB,IAAM,kBAAkB,wBAAC,UAAyC;AAChE,MAAI,MAAM,QAAQ,KAAK,KAAK,MAAM,UAAU,GAAG;AAC7C,UAAM,IAAI,OAAO,MAAM,CAAC,CAAC;AACzB,UAAM,IAAI,OAAO,MAAM,CAAC,CAAC;AACzB,QAAI,OAAO,SAAS,CAAC,KAAK,OAAO,SAAS,CAAC,GAAG;AAK5C,YAAM,OAAO,KAAK,IAAI,CAAC;AACvB,YAAM,OAAO,KAAK,IAAI,CAAC;AAGvB,UAAI,OAAO,MAAM,QAAQ,OAAO,QAAQ,IAAI;AAC1C,eAAO,EAAE,KAAK,GAAG,KAAK,EAAE;AAAA,MAC1B;AACA,UAAI,OAAO,MAAM,QAAQ,OAAO,QAAQ,IAAI;AAC1C,eAAO,EAAE,KAAK,GAAG,KAAK,EAAE;AAAA,MAC1B;AAIA,UAAK,IAAI,KAAK,IAAI,KAAO,IAAI,KAAK,IAAI,GAAI;AACxC,cAAM,MAAM,IAAI,IAAI,IAAI;AACxB,cAAM,MAAM,IAAI,IAAI,IAAI;AACxB,YAAI,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK,IAAI,GAAG,KAAK,KAAK;AAC/C,iBAAO,EAAE,KAAK,IAAI;AAAA,QACpB;AAAA,MACF;AAIA,aAAO,EAAE,KAAK,GAAG,KAAK,EAAE;AAAA,IAC1B;AAAA,EACF;AAEA,MAAI,SAAS,OAAO,UAAU,UAAU;AACtC,UAAM,YAAY;AAClB,UAAM,MAAM,OAAO,UAAU,GAAG;AAChC,UAAM,MAAM,OAAO,UAAU,GAAG;AAChC,QAAI,OAAO,SAAS,GAAG,KAAK,OAAO,SAAS,GAAG,GAAG;AAChD,aAAO,EAAE,KAAK,IAAI;AAAA,IACpB;AAAA,EACF;AAEA,SAAO;AACT,GA9CwB;AAgDxB,IAAM,iBAAiB,wBAAC,OAAsB,YAAsC;AAClF,MAAI,SAAS;AACb,WAAS,IAAI,GAAG,IAAI,QAAQ,SAAS,GAAG,IAAI,QAAQ,QAAQ,IAAI,KAAK;AACnE,UAAM,KAAK,QAAQ,CAAC;AACpB,UAAM,KAAK,QAAQ,CAAC;AAEpB,UAAM,aACH,GAAG,MAAM,MAAM,QAAU,GAAG,MAAM,MAAM,OACzC,MAAM,OAAQ,GAAG,MAAM,GAAG,QAAQ,MAAM,MAAM,GAAG,QAAU,GAAG,MAAM,GAAG,OAAQ,OAAO,WAAW,GAAG;AAEtG,QAAI,WAAY,UAAS,CAAC;AAAA,EAC5B;AACA,SAAO;AACT,GAbuB;AAehB,SAAS,iBACd,UACA,UACA,UACA,YAAY,GACO;AACnB,QAAM,SAAS,UAAU,QAAQ;AAEjC,MAAI,aAAa,OAAO;AACtB,UAAM,iBAAiB,OAAO,aAAa,OAAO;AAClD,UAAM,cAAc,MAAM,QAAQ,cAAc,IAC5C,eAAe,IAAI,CAAC,MAAM,WAAW,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,OAAO,IAC/D,CAAC;AACL,UAAM,iBAAiB,WAAW,SAAS,UAAU;AACrD,QAAI,CAAC,kBAAkB,YAAY,WAAW,GAAG;AAC/C,aAAO,EAAE,QAAQ,MAAM;AAAA,IACzB;AACA,WAAO,EAAE,QAAQ,YAAY,KAAK,CAAC,WAAW,eAAe,WAAW,MAAM,CAAC,EAAE;AAAA,EACnF;AAEA,MAAI,aAAa,UAAU;AACzB,UAAM,aAAa;AACnB,UAAM,YAAY,OAAO,WAAW,QAAQ,GAAG;AAC/C,UAAM,YAAY,OAAO,WAAW,QAAQ,GAAG;AAC/C,UAAM,cAAc,OAAO,WAAW,YAAY;AAElD,QAAI,CAAC,OAAO,SAAS,SAAS,KAAK,CAAC,OAAO,SAAS,SAAS,KAAK,CAAC,OAAO,SAAS,WAAW,GAAG;AAC/F,aAAO,EAAE,QAAQ,MAAM;AAAA,IACzB;AACA,QAAI,CAAC,OAAO,SAAS,SAAS,GAAG,KAAK,CAAC,OAAO,SAAS,SAAS,GAAG,GAAG;AACpE,aAAO,EAAE,QAAQ,MAAM;AAAA,IACzB;AAEA,UAAM,aAAa,YAAY,WAAW,WAAW,SAAS,KAAK,SAAS,GAAG;AAC/E,UAAM,WAAW,cAAc;AAE/B,WAAO;AAAA,MACL,QAAQ,cAAc;AAAA,MACtB,UAAU;AAAA,IACZ;AAAA,EACF;AAEA,MAAI,aAAa,YAAY;AAC3B,UAAM,aAAa,OAAO;AAC1B,UAAM,UAAU,MAAM,QAAQ,UAAU,IACpC,WAAW,IAAI,CAAC,MAAM,gBAAgB,CAAC,CAAC,EAAE,OAAO,CAAC,MAA0B,MAAM,IAAI,IACtF,CAAC;AAEL,QAAI,QAAQ,SAAS,KAAK,CAAC,OAAO,SAAS,SAAS,GAAG,KAAK,CAAC,OAAO,SAAS,SAAS,GAAG,GAAG;AAC1F,aAAO,EAAE,QAAQ,MAAM;AAAA,IACzB;AAEA,WAAO;AAAA,MACL,QAAQ,eAAe,EAAE,KAAK,SAAS,KAAK,KAAK,SAAS,IAAI,GAAG,OAAO;AAAA,IAC1E;AAAA,EACF;AAEA,SAAO,EAAE,QAAQ,MAAM;AACzB;AA1DgB;;;AC9GhB;;;ACUA,IAAM,aAAa,wBAAC,UAAkB,KAAK,MAAM,OAAO,SAAS,KAAK,IAAI,QAAQ,CAAC,GAAhE;AAIZ,IAAM,kBAAkB,wBAACC,SAAoD;AAClF,MAAI,CAACA,KAAK,QAAO,CAAC;AAClB,MAAI;AACF,UAAM,SAAS,KAAK,MAAMA,IAAG;AAC7B,QAAI,CAAC,MAAM,QAAQ,MAAM,EAAG,QAAO,CAAC;AACpC,WAAO,OACJ,OAAO,CAAC,UAA4C,QAAQ,SAAS,OAAO,UAAU,YAAY,CAAC,MAAM,QAAQ,KAAK,CAAC,CAAC,EACxH,IAAI,CAAC,UAAU;AACd,YAAM,WAAW,OAAO,MAAM,aAAa,WAAW,MAAM,WAAW,OAAO,WAAW,OAAO,MAAM,YAAY,CAAC,CAAC,KAAK;AACzH,YAAM,OAAO,OAAO,MAAM,qBAAqB,WAC3C,MAAM,mBACN,OAAO,SAAS,OAAO,MAAM,oBAAoB,CAAC,GAAG,EAAE,KAAK;AAChE,YAAM,QAAQ,OAAO,MAAM,gBAAgB,WACvC,MAAM,cACN,KAAK,MAAM,WAAW,IAAI;AAC9B,YAAM,OAAQ,MAAM,SAAS,aAAa,MAAM,SAAS,cAAc,MAAM,SAAS,UAAU,MAAM,SAAS,WAC3G,MAAM,OACN;AACJ,aAAO;AAAA,QACL,IAAI,OAAO,MAAM,OAAO,YAAY,MAAM,GAAG,KAAK,IAAI,MAAM,KAAK,OAAO,WAAW;AAAA,QACnF,WAAW,OAAO,MAAM,cAAc,YAAY,MAAM,UAAU,KAAK,IAAI,MAAM,YAAY;AAAA,QAC7F;AAAA,QACA,aAAa,OAAO,MAAM,gBAAgB,YAAY,MAAM,YAAY,KAAK,IAAI,MAAM,YAAY,KAAK,IAAI;AAAA,QAC5G;AAAA,QACA,kBAAkB,WAAW,IAAI;AAAA,QACjC,aAAa,WAAW,KAAK;AAAA,QAC7B,WAAW,MAAM,YAAY,IAAI;AAAA,MACnC;AAAA,IACF,CAAC;AAAA,EACL,QAAQ;AACN,WAAO,CAAC;AAAA,EACV;AACF,GAhC+B;AAyCxB,IAAM,oBAAoB,wBAAC,UAA2B,MAAM,OAAO,CAAC,KAAK,SAAS,MAAM,KAAK,aAAa,CAAC,GAAjF;AAE1B,IAAM,gBAAgB,wBAAC,aAAqB,UAAkB,gBAAwB,MAAoB,UAAyB,cAAqC;AAAA,EAC7K,IAAI,OAAO,WAAW;AAAA,EACtB,WAAW;AAAA,EACX;AAAA,EACA,aAAa,YAAY,KAAK,KAAK;AAAA,EACnC,UAAU,OAAO,SAAS,QAAQ,KAAK,WAAW,IAAI,WAAW;AAAA,EACjE,kBAAkB,WAAW,cAAc;AAAA,EAC3C,aAAa,YAAY,OAAO,SAAS,QAAQ,KAAK,WAAW,IAAI,WAAW,KAAK,cAAc;AAAA,EACnG,WAAW,WAAW,IAAI;AAC5B,IAT6B;AAWtB,IAAM,uBAAuB,wBAAC,aAAqB,mBAA0C,cAAc,eAAe,WAAW,GAAG,gBAAgB,WAAW,MAAM,CAAC,GAA7I;AAI7B,IAAM,oBAAoB,wBAACC,SAAoD;AACpF,QAAM,SAASA,QAAO,IAAI,MAAM,OAAO,EAAE,IAAI,CAAC,SAAS,KAAK,KAAK,CAAC,EAAE,OAAO,OAAO;AAClF,QAAM,SAA0B,CAAC;AACjC,aAAW,QAAQ,OAAO;AACxB,UAAM,QAAQ,KAAK,MAAM,GAAG,EAAE,IAAI,CAAC,SAAS,KAAK,KAAK,CAAC;AACvD,QAAI,MAAM,SAAS,EAAG;AACtB,UAAM,cAAc,MAAM,CAAC,KAAK;AAChC,UAAM,WAAW,KAAK,IAAI,GAAG,OAAO,WAAW,MAAM,CAAC,CAAC,KAAK,CAAC;AAC7D,UAAM,YAAY,KAAK,IAAI,GAAG,KAAK,OAAO,OAAO,WAAW,MAAM,CAAC,EAAE,QAAQ,SAAS,EAAE,CAAC,KAAK,KAAK,GAAG,CAAC;AACvG,QAAI,CAAC,eAAe,YAAY,EAAG;AACnC,WAAO,KAAK,cAAc,aAAa,UAAU,WAAW,UAAU,MAAM,CAAC,CAAC;AAAA,EAChF;AACA,SAAO;AACT,GAbiC;;;ACzEjC,IAAI,OAAO,wBAAC,YAAY,WAAW;AACjC,QAAM,SAAS,CAAC,EAAE;AAClB,WAAS,IAAI,GAAG,MAAM,QAAQ,SAAS,GAAG,IAAI,KAAK,KAAK;AACtD,WAAO,CAAC,KAAK,QAAQ,CAAC;AACtB,UAAM,WAAW,MAAM,QAAQ,OAAO,CAAC,CAAC,IAAI,OAAO,CAAC,EAAE,KAAK,QAAQ,IAAI,CAAC,OAAO,CAAC,CAAC;AACjF,aAAS,KAAK,GAAG,OAAO,SAAS,QAAQ,KAAK,MAAM,MAAM;AACxD,YAAM,QAAQ,SAAS,EAAE;AACzB,UAAI,OAAO,UAAU,UAAU;AAC7B,uBAAe,OAAO,MAAM;AAAA,MAC9B,WAAW,OAAO,UAAU,UAAU;AACpC;AACA,eAAO,CAAC,KAAK;AAAA,MACf,WAAW,OAAO,UAAU,aAAa,UAAU,QAAQ,UAAU,QAAQ;AAC3E;AAAA,MACF,WAAW,OAAO,UAAU,YAAY,MAAM,WAAW;AACvD,YAAI,MAAM,WAAW;AACnB,iBAAO,QAAQ,IAAI,KAAK;AAAA,QAC1B,OAAO;AACL,gBAAM,MAAM,MAAM,SAAS;AAC3B,cAAI,eAAe,SAAS;AAC1B,mBAAO,QAAQ,IAAI,GAAG;AAAA,UACxB,OAAO;AACL,mBAAO,CAAC,KAAK;AAAA,UACf;AAAA,QACF;AAAA,MACF,WAAW,iBAAiB,SAAS;AACnC,eAAO,QAAQ,IAAI,KAAK;AAAA,MAC1B,OAAO;AACL,uBAAe,MAAM,SAAS,GAAG,MAAM;AAAA,MACzC;AAAA,IACF;AAAA,EACF;AACA,SAAO,CAAC,KAAK,QAAQ,GAAG,EAAE;AAC1B,SAAO,OAAO,WAAW,IAAI,eAAe,SAAS,IAAI,oBAAoB,IAAI,OAAO,CAAC,GAAG,OAAO,SAAS,CAAC,CAAC,IAAI,IAAI,OAAO,CAAC,CAAC,IAAI,qBAAqB,QAAQ,OAAO,SAAS;AAClL,GAlCW;;;ACDX,IAAI,eAA+B,uBAAO,UAAU;AACpD,IAAI,oBAAoC,uBAAO,eAAe;AAC9D,IAAI,YAA4B,uBAAO,OAAO;AAC9C,IAAI,mBAAmC,uBAAO,UAAU;AACxD,IAAI,WAA2B,uBAAO,MAAM;AAC5C,IAAI,YAA4B,uBAAO,WAAW;;;ACJlD,IAAI,qBAAqB,wBAAC,OAAO;AAC/B;AACA,KAAG,gBAAgB,IAAI;AACvB,SAAO;AACT,GAJyB;;;ACEzB,IAAI,gCAAgC,wBAAC,WAAW,CAAC,EAAE,OAAO,SAAS,MAAM;AACvE,MAAI,CAAC,UAAU;AACb,WAAO;AAAA,EACT;AACA,QAAM,QAAQ;AAAA,IACZ,UAAU;AAAA,MACR;AAAA,QACE,KAAK,mBAAmB,MAAM;AAC5B,iBAAO,KAAK,KAAK;AAAA,QACnB,CAAC;AAAA,QACD,OAAO,CAAC;AAAA,MACV;AAAA,IACF;AAAA,EACF;AACA,MAAI,MAAM,QAAQ,QAAQ,GAAG;AAC3B,UAAM,SAAS,KAAK,GAAG,SAAS,KAAK,CAAC;AAAA,EACxC,OAAO;AACL,UAAM,SAAS,KAAK,QAAQ;AAAA,EAC9B;AACA,QAAM,SAAS,KAAK;AAAA,IAClB,KAAK,mBAAmB,MAAM;AAC5B,aAAO,IAAI;AAAA,IACb,CAAC;AAAA,IACD,OAAO,CAAC;AAAA,EACV,CAAC;AACD,QAAM,MAAM,EAAE,KAAK,IAAI,OAAO,MAAM,GAAG;AACvC,MAAI,iBAAiB,IAAI,CAAC,QAAQ;AAChC,WAAO,IAAI;AACX,UAAM;AAAA,EACR;AACA,SAAO;AACT,GA/BoC;AAgCpC,IAAI,gBAAgB,wBAAC,iBAAiB;AACpC,QAAM,SAAS,CAAC,YAAY;AAC5B,QAAM,UAAU,8BAA8B,MAAM;AACpD,UAAQ,SAAS;AACjB,UAAQ,WAAW;AACnB,iBAAe,KAAK,OAAO;AAC3B,SAAO;AACT,GAPoB;;;AC/BpB,IAAI,iBAAiB,CAAC;AACtB,IAAIC,iBAAgB,wBAAC,iBAAiB;AACpC,QAAM,SAAS,CAAC,YAAY;AAC5B,QAAM,UAAW,yBAAC,UAAU;AAC1B,WAAO,KAAK,MAAM,KAAK;AACvB,QAAI;AACJ,QAAI;AACF,eAAS,MAAM,YAAY,MAAM,QAAQ,MAAM,QAAQ,IAAI,IAAI,gBAAgB,IAAI,CAAC,GAAG,MAAM,QAAQ,IAAI,MAAM,UAAU,SAAS,IAAI;AAAA,IACxI,SAAS,GAAG;AACV,aAAO,IAAI;AACX,YAAM;AAAA,IACR;AACA,QAAI,kBAAkB,SAAS;AAC7B,aAAO,OAAO,QAAQ,MAAM,OAAO,IAAI,CAAC,EAAE,KAAK,CAAC,cAAc,IAAI,WAAW,UAAU,SAAS,CAAC;AAAA,IACnG,OAAO;AACL,aAAO,IAAI;AACX,aAAO,IAAI,MAAM;AAAA,IACnB;AAAA,EACF,IAfiB;AAgBjB,UAAQ,SAAS;AACjB,UAAQ,WAAW;AACnB,UAAQ,YAAY,IAAI,8BAA8B,MAAM;AAC5D,iBAAe,KAAK,OAAO;AAC3B,SAAO;AACT,GAvBoB;AAwBpB,IAAI,aAAa,wBAAC,YAAY;AAC5B,SAAO,QAAQ,OAAO,GAAG,EAAE;AAC7B,GAFiB;;;AC7BjB,IAAI,eAAe;AAAA,EACjB,OAAO,CAAC;AAAA,EACR,QAAQ,CAAC,KAAK;AAAA,EACd,OAAO,CAAC,WAAW;AAAA,EACnB,MAAM,CAAC,MAAM;AAAA,EACb,MAAM,CAAC,QAAQ,aAAa,WAAW,UAAU;AACnD;AACA,IAAI,eAAe,CAAC;AACpB,IAAI,qBAAqB;;;ACTzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACCA,IAAI,UAAU,wBAAC,aAAa,MAAM,QAAQ,QAAQ,IAAI,WAAW,CAAC,QAAQ,GAA5D;;;ADMd,IAAI,aAA6B,oBAAI,QAAQ;AAC7C,IAAI,iBAAiB,wBAAC,SAAS,KAAK,OAAO,eAAe,CAAC,EAAE,QAAQ,QAAQ,MAAM;AACjF,MAAI,CAAC,QAAQ;AACX;AAAA,EACF;AACA,QAAM,MAAM,WAAW,IAAI,OAAO,KAAK,CAAC;AACxC,aAAW,IAAI,SAAS,GAAG;AAC3B,QAAM,OAAO,IAAI,OAAO,MAAM,CAAC;AAC/B,MAAI,QAAQ;AACZ,QAAM,aAAa,aAAa,OAAO;AACvC,MAAI,WAAW,SAAS,GAAG;AACzB,SAAM,YAAW,CAAC,EAAE,QAAQ,KAAK,MAAM;AACrC,iBAAW,OAAO,YAAY;AAC5B,aAAK,WAAW,GAAG,KAAK,UAAU,QAAQ,GAAG,GAAG;AAC9C,kBAAQ;AACR,gBAAM;AAAA,QACR;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACA,MAAI,OAAO;AACT,WAAO,CAAC,IAAI,OAAO,CAAC,EAAE,WAAW,KAAK,EAAE;AAAA,EAC1C,WAAW,WAAW,SAAS,GAAG;AAChC,SAAK,KAAK,CAAC,KAAK,OAAO,UAAU,CAAC;AAAA,EACpC,OAAO;AACL,SAAK,QAAQ,CAAC,KAAK,OAAO,UAAU,CAAC;AAAA,EACvC;AACA,MAAI,OAAO,CAAC,EAAE,QAAQ,SAAS,MAAM,IAAI;AACvC,QAAI;AACJ,QAAI,eAAe,QAAQ;AACzB,mBAAa,KAAK,IAAI,CAAC,CAAC,IAAI,MAAM,IAAI;AAAA,IACxC,OAAO;AACL,YAAM,cAAc,CAAC;AACrB,mBAAa,KAAK,IAAI,CAAC,CAAC,MAAM,EAAE,WAAW,MAAM;AAC/C,YAAI,QAAQ,YAAY,QAAQ,WAAW;AAC3C,YAAI,UAAU,IAAI;AAChB,sBAAY,KAAK,WAAW;AAC5B,kBAAQ,YAAY,SAAS;AAAA,QAC/B;AACA,eAAO,CAAC,MAAM,KAAK;AAAA,MACrB,CAAC,EAAE,KAAK,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,IAAI,MAAM,IAAI;AAAA,IACrD;AACA,eAAW,QAAQ,CAAC,SAAS;AAC3B,aAAO,CAAC,IAAI,OAAO,CAAC,EAAE,WAAW,MAAM,EAAE;AAAA,IAC3C,CAAC;AACD,WAAO,CAAC,IAAI,OAAO,CAAC,EAAE,QAAQ,gBAAgB,WAAW,KAAK,EAAE,CAAC;AAAA,EACnE;AACF,GA9CqB;AA+CrB,IAAI,+BAA+B,wBAAC,KAAK,UAAU,UAAU,IAAI,IAAI,QAAQ,KAAK,OAAO,QAAQ,YAAY,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,GAAzF;AACnC,IAAI,sBAAsB,wBAAC,KAAK,UAAU,OAAO,SAAS;AACxD,MAAI,cAAc,OAAO;AACvB,WAAO,6BAA6B,KAAK,UAAU,KAAK;AAAA,EAC1D;AACA,MAAI,EAAE,YAAY,UAAU,GAAG,UAAU,IAAI;AAC7C,eAAa,OAAO,cAAc,KAAK;AACvC,MAAI,MAAM;AACR,cAAU,kBAAkB,IAAI;AAAA,EAClC;AACA,QAAM,SAAS,IAAI,QAAQ,KAAK,WAAW,QAAQ,YAAY,CAAC,CAAC,CAAC,EAAE,SAAS;AAC7E,MAAI,kBAAkB,SAAS;AAC7B,WAAO,OAAO;AAAA,MACZ,CAAC,cAAc,IAAI,QAAQ;AAAA,QACzB,GAAG,UAAU,aAAa,CAAC;AAAA,QAC3B,eAAe,KAAK,WAAW,WAAW,UAAU;AAAA,MACtD,CAAC;AAAA,IACH;AAAA,EACF,OAAO;AACL,WAAO,IAAI,QAAQ,CAAC,eAAe,KAAK,QAAQ,WAAW,UAAU,CAAC,CAAC;AAAA,EACzE;AACF,GApB0B;AAqB1B,IAAI,QAAQ,wBAAC,EAAE,UAAU,GAAG,MAAM,MAAM;AACtC,QAAMC,oBAAmB,oBAAoB;AAC7C,MAAIA,mBAAkB;AACpB,UAAM,UAAU,WAAWA,iBAAgB;AAC3C,QAAI,YAAY,SAAS,YAAY,QAAQ;AAC3C,aAAO,IAAI;AAAA,QACT;AAAA,QACA;AAAA,QACA,QAAQ,YAAY,CAAC,CAAC;AAAA,MACxB;AAAA,IACF;AAAA,EACF;AACA,SAAO,oBAAoB,SAAS,UAAU,OAAO,KAAK;AAC5D,GAbY;AAcZ,IAAI,SAAS,wBAAC;AAAA,EACZ;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAMA,oBAAmB,oBAAoB;AAC7C,MAAI,CAAC,OAAO,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,KAAKA,qBAAoB,WAAWA,iBAAgB,MAAM,QAAQ;AAC1G,WAAO,6BAA6B,UAAU,UAAU,KAAK;AAAA,EAC/D;AACA,SAAO,oBAAoB,UAAU,UAAU,OAAO,KAAK;AAC7D,GATa;AAUb,IAAI,QAAQ,wBAAC;AAAA,EACX;AAAA,EACA,GAAG;AACL,MAAM;AACJ,MAAI,CAAC,CAAC,QAAQ,YAAY,EAAE,MAAM,CAAC,MAAM,KAAK,KAAK,GAAG;AACpD,WAAO,6BAA6B,SAAS,UAAU,KAAK;AAAA,EAC9D;AACA,QAAM,WAAW,IAAI,MAAM;AAC3B,SAAO,MAAM;AACb,SAAO,oBAAoB,SAAS,UAAU,OAAO,IAAI;AAC3D,GAVY;AAWZ,IAAI,OAAO,wBAAC,EAAE,UAAU,GAAG,MAAM,MAAM;AACrC,MAAI,CAAC,UAAU,SAAS,EAAE,KAAK,CAAC,MAAM,KAAK,KAAK,KAAK,MAAM,QAAQ,iBAAiB,EAAE,gBAAgB,UAAU,cAAc,QAAQ;AACpI,WAAO,6BAA6B,QAAQ,UAAU,KAAK;AAAA,EAC7D;AACA,SAAO,oBAAoB,QAAQ,UAAU,OAAO,gBAAgB,KAAK;AAC3E,GALW;AAMX,IAAI,OAAO,wBAAC,EAAE,UAAU,GAAG,MAAM,MAAM;AACrC,QAAMA,oBAAmB,oBAAoB;AAC7C,MAAIA,qBAAoB,WAAWA,iBAAgB,MAAM,QAAQ;AAC/D,WAAO,6BAA6B,QAAQ,UAAU,KAAK;AAAA,EAC7D;AACA,SAAO,oBAAoB,QAAQ,UAAU,OAAO,KAAK;AAC3D,GANW;AAOX,IAAI,aAAa,wBAAC,KAAK,EAAE,UAAU,GAAG,MAAM;AAAA;AAAA,EAE1C,IAAI,QAAQ,KAAK,OAAO,QAAQ,YAAY,CAAC,CAAC,CAAC;AAAA,GAFhC;AAIjB,IAAI,OAAO,wBAAC,UAAU;AACpB,MAAI,OAAO,MAAM,WAAW,YAAY;AACtC,UAAM,SAAS,aAAa,MAAM,SAAS,MAAM,OAAO,SAAS,IAAI;AAAA,EACvE;AACA,SAAO,WAAW,QAAQ,KAAK;AACjC,GALW;AAMX,IAAI,wBAAwB,wBAAC,KAAK,UAAU;AAC1C,MAAI,OAAO,MAAM,eAAe,YAAY;AAC1C,UAAM,aAAa,aAAa,MAAM,aAAa,MAAM,WAAW,SAAS,IAAI;AAAA,EACnF;AACA,SAAO,WAAW,KAAK,KAAK;AAC9B,GAL4B;AAM5B,IAAI,QAAQ,wBAAC,UAAU,sBAAsB,SAAS,KAAK,GAA/C;AACZ,IAAI,SAAS,wBAAC,UAAU,sBAAsB,UAAU,KAAK,GAAhD;;;AE7Ib,IAAI,yBAAyC,oBAAI,IAAI;AAAA,EACnD,CAAC,aAAa,OAAO;AAAA,EACrB,CAAC,WAAW,KAAK;AAAA,EACjB,CAAC,eAAe,aAAa;AAAA,EAC7B,CAAC,aAAa,YAAY;AAAA,EAC1B,CAAC,YAAY,UAAU;AAAA,EACvB,CAAC,iBAAiB,eAAe;AAAA,EACjC,CAAC,YAAY,UAAU;AAAA,EACvB,CAAC,cAAc,YAAY;AAC7B,CAAC;AACD,IAAI,+BAA+B,wBAAC,QAAQ,uBAAuB,IAAI,GAAG,KAAK,KAA5C;AACnC,IAAI,qBAAqB,wBAACC,QAAO,OAAO;AACtC,aAAW,CAAC,GAAG,CAAC,KAAK,OAAO,QAAQA,MAAK,GAAG;AAC1C,UAAM,MAAM,EAAE,CAAC,MAAM,OAAO,CAAC,QAAQ,KAAK,CAAC,IAAI,IAAI,EAAE,QAAQ,UAAU,CAAC,MAAM,IAAI,EAAE,YAAY,CAAC,EAAE;AACnG;AAAA,MACE;AAAA,MACA,KAAK,OAAO,OAAO,OAAO,MAAM,WAAW,CAAC,IAAI;AAAA,QAC9C;AAAA,MACF,IAAI,GAAG,CAAC,OAAO,GAAG,CAAC,KAAK;AAAA,IAC1B;AAAA,EACF;AACF,GAVyB;;;ACJzB,IAAI,mBAAmB;AACvB,IAAI,sBAAsB,6BAAM,kBAAN;AAC1B,IAAI,qBAAqB,wBAAC,QAAQ,QAAQ,KAAK,GAAG;AAAA;AAElD,IAAI;AAAA,EACF;AACF,IAAI,IAAI,QAAQ,YAAY,KAAK,EAAE,YAAY,IAAI,KAJ1B;AAKzB,IAAI,YAAY;AAAA,EACd;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AACA,IAAI,oBAAoB;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AACA,IAAI,2BAA2B,wBAAC,UAAU,WAAW;AACnD,WAAS,IAAI,GAAG,MAAM,SAAS,QAAQ,IAAI,KAAK,KAAK;AACnD,UAAM,QAAQ,SAAS,CAAC;AACxB,QAAI,OAAO,UAAU,UAAU;AAC7B,qBAAe,OAAO,MAAM;AAAA,IAC9B,WAAW,OAAO,UAAU,aAAa,UAAU,QAAQ,UAAU,QAAQ;AAC3E;AAAA,IACF,WAAW,iBAAiB,SAAS;AACnC,YAAM,iBAAiB,MAAM;AAAA,IAC/B,WAAW,OAAO,UAAU,YAAY,MAAM,WAAW;AACvD;AACA,aAAO,CAAC,KAAK;AAAA,IACf,WAAW,iBAAiB,SAAS;AACnC,aAAO,QAAQ,IAAI,KAAK;AAAA,IAC1B,OAAO;AACL,+BAAyB,OAAO,MAAM;AAAA,IACxC;AAAA,EACF;AACF,GAlB+B;AAmB/B,IAAI,UAAU,MAAM;AAAA,EA/EpB,OA+EoB;AAAA;AAAA;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ;AAAA,EACA,YAAY,KAAK,OAAO,UAAU;AAChC,SAAK,MAAM;AACX,SAAK,QAAQ;AACb,SAAK,WAAW;AAAA,EAClB;AAAA,EACA,IAAI,OAAO;AACT,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA,EAGA,IAAI,MAAM;AACR,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AAAA,EACA,WAAW;AACT,UAAM,SAAS,CAAC,EAAE;AAClB,SAAK,eAAe,QAAQ,CAAC,CAAC,SAAS,KAAK,MAAM;AAChD,cAAQ,OAAO,KAAK,KAAK;AAAA,IAC3B,CAAC;AACD,QAAI;AACF,WAAK,iBAAiB,MAAM;AAAA,IAC9B,UAAE;AACA,WAAK,eAAe,QAAQ,CAAC,CAAC,OAAO,MAAM;AACzC,gBAAQ,OAAO,IAAI;AAAA,MACrB,CAAC;AAAA,IACH;AACA,WAAO,OAAO,WAAW,IAAI,eAAe,SAAS,oBAAoB,IAAI,OAAO,CAAC,GAAG,OAAO,SAAS,CAAC,EAAE,SAAS,IAAI,OAAO,CAAC,IAAI,qBAAqB,QAAQ,OAAO,SAAS;AAAA,EACnL;AAAA,EACA,iBAAiB,QAAQ;AACvB,UAAM,MAAM,KAAK;AACjB,UAAM,QAAQ,KAAK;AACnB,QAAI,EAAE,SAAS,IAAI;AACnB,WAAO,CAAC,KAAK,IAAI,GAAG;AACpB,UAAM,eAAe,oBAAoB,WAAW,gBAAgB,MAAM,QAAQ,CAAC,QAAQ,mBAAmB,6BAA6B,GAAG,CAAC,IAAI,CAAC,QAAQ,6BAA6B,GAAG;AAC5L,aAAS,CAAC,KAAK,CAAC,KAAK,OAAO,QAAQ,KAAK,GAAG;AAC1C,YAAM,aAAa,GAAG;AACtB,UAAI,QAAQ,YAAY;AAAA,MACxB,WAAW,QAAQ,WAAW,OAAO,MAAM,UAAU;AACnD,YAAI,WAAW;AACf,2BAAmB,GAAG,CAAC,UAAU,UAAU;AACzC,cAAI,SAAS,MAAM;AACjB,wBAAY,GAAG,WAAW,MAAM,EAAE,GAAG,QAAQ,IAAI,KAAK;AAAA,UACxD;AAAA,QACF,CAAC;AACD,eAAO,CAAC,KAAK;AACb,uBAAe,UAAU,MAAM;AAC/B,eAAO,CAAC,KAAK;AAAA,MACf,WAAW,OAAO,MAAM,UAAU;AAChC,eAAO,CAAC,KAAK,IAAI,GAAG;AACpB,uBAAe,GAAG,MAAM;AACxB,eAAO,CAAC,KAAK;AAAA,MACf,WAAW,MAAM,QAAQ,MAAM,QAAQ;AAAA,MACvC,WAAW,OAAO,MAAM,YAAY,EAAE,WAAW;AAC/C,eAAO,CAAC,KAAK,IAAI,GAAG,KAAK,CAAC;AAAA,MAC5B,WAAW,OAAO,MAAM,aAAa,kBAAkB,SAAS,GAAG,GAAG;AACpE,YAAI,GAAG;AACL,iBAAO,CAAC,KAAK,IAAI,GAAG;AAAA,QACtB;AAAA,MACF,WAAW,QAAQ,2BAA2B;AAC5C,YAAI,SAAS,SAAS,GAAG;AACvB,gBAAM,IAAI,MAAM,oEAAoE;AAAA,QACtF;AACA,mBAAW,CAAC,IAAI,EAAE,MAAM,CAAC;AAAA,MAC3B,WAAW,aAAa,SAAS;AAC/B,eAAO,CAAC,KAAK,IAAI,GAAG;AACpB,eAAO,QAAQ,KAAK,CAAC;AAAA,MACvB,WAAW,OAAO,MAAM,YAAY;AAClC,YAAI,CAAC,IAAI,WAAW,IAAI,KAAK,QAAQ,OAAO;AAC1C,gBAAM,IAAI,MAAM,iBAAiB,GAAG,qCAAqC,GAAG,IAAI;AAAA,QAClF;AAAA,MACF,OAAO;AACL,eAAO,CAAC,KAAK,IAAI,GAAG;AACpB,uBAAe,EAAE,SAAS,GAAG,MAAM;AACnC,eAAO,CAAC,KAAK;AAAA,MACf;AAAA,IACF;AACA,QAAI,UAAU,SAAS,GAAG,KAAK,SAAS,WAAW,GAAG;AACpD,aAAO,CAAC,KAAK;AACb;AAAA,IACF;AACA,WAAO,CAAC,KAAK;AACb,6BAAyB,UAAU,MAAM;AACzC,WAAO,CAAC,KAAK,KAAK,GAAG;AAAA,EACvB;AACF;AACA,IAAI,kBAAkB,cAAc,QAAQ;AAAA,EA1K5C,OA0K4C;AAAA;AAAA;AAAA,EAC1C,iBAAiB,QAAQ;AACvB,UAAM,EAAE,SAAS,IAAI;AACrB,UAAM,QAAQ,EAAE,GAAG,KAAK,MAAM;AAC9B,QAAI,SAAS,QAAQ;AACnB,YAAM,WAAW,SAAS,WAAW,IAAI,SAAS,CAAC,IAAI;AAAA,IACzD;AACA,UAAM,MAAM,KAAK,IAAI,KAAK,MAAM,KAAK;AACrC,QAAI,OAAO,QAAQ,aAAa,OAAO,MAAM;AAC3C;AAAA,IACF,WAAW,eAAe,SAAS;AACjC,UAAI,eAAe,WAAW,GAAG;AAC/B,eAAO,QAAQ,IAAI,GAAG;AAAA,MACxB,OAAO;AACL,cAAM,kBAAkB,eAAe,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,GAAG,EAAE,CAAC,CAAC;AACtE,eAAO;AAAA,UACL;AAAA,UACA,IAAI,KAAK,CAAC,aAAa;AACrB,gBAAI,oBAAoB,SAAS;AAC/B,uBAAS,gBAAgB;AAAA,YAC3B;AACA,mBAAO;AAAA,UACT,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF,WAAW,eAAe,SAAS;AACjC,UAAI,iBAAiB,MAAM;AAAA,IAC7B,WAAW,OAAO,QAAQ,YAAY,IAAI,WAAW;AACnD,aAAO,CAAC,KAAK;AACb,UAAI,IAAI,WAAW;AACjB,eAAO,cAAc,CAAC;AACtB,eAAO,UAAU,KAAK,GAAG,IAAI,SAAS;AAAA,MACxC;AAAA,IACF,OAAO;AACL,qBAAe,KAAK,MAAM;AAAA,IAC5B;AAAA,EACF;AACF;AACA,IAAI,kBAAkB,cAAc,QAAQ;AAAA,EAhN5C,OAgN4C;AAAA;AAAA;AAAA,EAC1C,iBAAiB,QAAQ;AACvB,6BAAyB,KAAK,UAAU,MAAM;AAAA,EAChD;AACF;AACA,IAAI,MAAM,wBAAC,KAAK,UAAU,aAAa;AACrC,YAAU,CAAC;AACX,MAAI,SAAS,QAAQ;AACnB,UAAM,WAAW,SAAS,WAAW,IAAI,SAAS,CAAC,IAAI;AAAA,EACzD;AACA,QAAM,MAAM,MAAM;AAClB,SAAO,MAAM,KAAK;AAClB,QAAM,OAAO,MAAM,KAAK,OAAO,QAAQ;AACvC,OAAK,MAAM;AACX,SAAO;AACT,GAVU;AAWV,IAAI,kBAAkB;AACtB,IAAI,QAAQ,wBAAC,KAAK,OAAO,aAAa;AACpC,MAAI,CAAC,iBAAiB;AACpB,eAAW,KAAK,cAAc;AAC5B;AACA,yBAAqB,CAAC,EAAE,YAAY,IAAI,aAAa,CAAC;AAAA,IACxD;AACA,sBAAkB;AAAA,EACpB;AACA,MAAI,OAAO,QAAQ,YAAY;AAC7B,WAAO,IAAI,gBAAgB,KAAK,OAAO,QAAQ;AAAA,EACjD,WAAW,mBAAqB,GAAG,GAAG;AACpC,WAAO,IAAI;AAAA,MACT,mBAAqB,GAAG;AAAA,MACxB;AAAA,MACA;AAAA,IACF;AAAA,EACF,WAAW,QAAQ,SAAS,QAAQ,QAAQ;AAC1C,yBAAqBC,eAAc,EAAE;AACrC,WAAO,IAAI,QAAQ,KAAK,OAAO;AAAA,MAC7B,IAAI;AAAA,QACF;AAAA,QACA;AAAA,UACE,OAAO;AAAA,QACT;AAAA,QACA;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH,OAAO;AACL,WAAO,IAAI,QAAQ,KAAK,OAAO,QAAQ;AAAA,EACzC;AACF,GA9BY;AA+DZ,IAAI,WAAW,wBAAC;AAAA,EACd;AACF,MAAM;AACJ,SAAO,IAAI;AAAA,IACT;AAAA,IACA;AAAA,MACE;AAAA,IACF;AAAA,IACA,MAAM,QAAQ,QAAQ,IAAI,WAAW,WAAW,CAAC,QAAQ,IAAI,CAAC;AAAA,EAChE;AACF,GAVe;;;AC7Rf,SAAS,OAAO,KAAK,OAAO,KAAK;AAC/B,MAAI;AACJ,MAAI,CAAC,SAAS,EAAE,cAAc,QAAQ;AACpC,WAAO,MAAM,KAAK,OAAO,CAAC,CAAC;AAAA,EAC7B,OAAO;AACL,UAAM,WAAW,MAAM;AACvB,WAAO,MAAM,QAAQ,QAAQ,IAAI,MAAM,KAAK,OAAO,QAAQ,IAAI,MAAM,KAAK,OAAO,CAAC,QAAQ,CAAC;AAAA,EAC7F;AACA,OAAK,MAAM;AACX,SAAO;AACT;AAVS;;;ACHT;AAMO,IAAM,SAAS,wBAAC,EAAE,OAAAC,QAAO,SAAS,MAA4C;AACnF,SACE,uBAAC,UAAK,MAAK,MACT;AAAA,2BAAC,UACC;AAAA,6BAAC,UAAK,SAAQ,SAAQ;AAAA,MACtB,uBAAC,UAAK,MAAK,YAAW,SAAQ,kGAAiG;AAAA,MAC/H,uBAAC,WAAO;AAAA,QAAAA;AAAA,QAAM;AAAA,SAAgB;AAAA,MAC9B,uBAAC,UAAK,KAAI,YAAW,MAAK,+BAA8B;AAAA,MACxD,uBAAC,UAAK,MAAK,eAAc,SAAQ,WAAU,IAAG,oBAAmB;AAAA,MACjE,uBAAC,UAAK,MAAK,gCAA+B,SAAQ,OAAM;AAAA,MACxD,uBAAC,UAAK,MAAK,yCAAwC,SAAQ,qBAAoB;AAAA,MAC5E,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA+PP,uBAAC,YAAO,KAAI,qCAAoC;AAAA,MAChD,uBAAC,YAAO,KAAI,aAAY,OAAK,MAAC;AAAA,MAC9B,uBAAC,UAAK,KAAI,cAAa,MAAK,4DAA2D;AAAA,MACvF,uBAAC,YAAO,KAAI,2DAA0D;AAAA,MACtE,uBAAC,YAAO,KAAI,sCAAqC;AAAA,MAChD,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBL,uBAAC,UAAK,KAAI,cAAa,MAAK,oDAAmD;AAAA,MAC/E,uBAAC,YAAO,KAAI,mDAAkD;AAAA,MAC9D,uBAAC,UAAK,KAAI,cAAa,MAAK,mFAAkF;AAAA,MAC9G,uBAAC,YAAO,KAAI,kFAAiF;AAAA,MAC7F,uBAAC,WAAO,iGAAsF;AAAA,MAC7F,iBAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA0nBL,uBAAC,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA+4C1B,IAAM,uBAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA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",
  "names": ["raw", "id", "key", "form", "match", "raw", "match", "html", "html2", "app", "input", "Node", "_Node", "Node", "Hono", "isValid", "raw", "raw", "createContext", "nameSpaceContext", "style", "createContext", "title", "title", "input", "meta", "input", "money", "title", "raw", "components_exports", "button", "form", "input", "link", "meta", "script", "style", "title", "nameSpaceContext", "getNameSpaceContext", "match", "style", "errorHandler", "documentMetadataTag", "title", "nameSpaceContext", "getNameSpaceContext", "script", "style", "link", "meta", "form", "isDirty", "formActionableElement", "input", "button", "jsxDEV", "components_exports", "Fragment", "Fragment", "createContext", "Suspense", "html", "html2", "ErrorBoundary", "html", "html2", "_a", "money", "base64UrlDecode", "input", "title", "raw", "Hono", "c", "totalPriceCents", "existing", "customLines", "title", "meta", "app", "Hono", "app", "Hono", "app", "Hono", "app", "Hono", "normalizeEmail", "app", "Hono", "parseMoneyToCents", "nextInvoiceNumber", "app", "Hono", "asStringArray", "app", "Hono", "app", "Hono", "form", "value", "zValidator: typeof zValidatorFunction", "util", "objectUtil", "errorUtil", "errorMap", "input", "ctx", "result", "issues", "elements", "processed", "input", "result", "r", "ZodFirstPartyTypeKind", "toMinutes", "app", "Hono", "app", "Hono", "asArray", "app", "Hono", "app", "Hono", "asStringArray", "app", "Hono", "asArray", "app", "Hono", "app", "Hono", "title", "app", "Hono", "app", "Hono", "app", "Hono", "raw", "html", "sendJobSms", "isTwilioEnabled"]
}
