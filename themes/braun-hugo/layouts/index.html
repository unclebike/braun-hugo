{{ define "main" }}
<div class="content-area">
    <main class="site-main">
        {{/* Hero Section - Rich content from home-header page */}}
        {{ $heroPage := .Site.GetPage "/pages/home-header" }}
        {{ if $heroPage }}
        <div class="hero-wrapper container medium">
            <div class="hero-grid is-hero-image-{{ .Site.Params.hero_layout | urlize }}">
                {{ with $heroPage.Params.featured_image }}
                <figure class="hero-image">
                    <img src="{{ . }}" alt="{{ $heroPage.Title }}" loading="lazy">
                </figure>
                {{ end }}
                <div class="hero-content">
                    <h1 class="h1 hero-title">{{ $heroPage.Title }}</h1>
                    <section class="gh-content">{{ $heroPage.Content }}</section>
                </div>
            </div>
        </div>
        {{ else }}
        {{/* Fallback to yaml hero */}}
        {{ with .Site.Data.sections.hero }}
        <div class="hero-wrapper container medium">
            <div class="hero-grid is-hero-image-{{ $.Site.Params.hero_layout | urlize }}">
                {{ if .image }}
                <figure class="hero-image">
                    <img src="{{ .image }}" alt="{{ .title }}" loading="lazy">
                </figure>
                {{ end }}
                <div class="hero-content">
                    <h1 class="h1 hero-title">{{ .title }}</h1>
                    <section class="gh-content">{{ .content | markdownify }}</section>
                    {{ if .button_text }}
                    {{ $link := .button_link | default $.Site.Params.zenbooker_url }}
                    <a href="{{ $link }}" class="button button-primary">{{ .button_text }}</a>
                    {{ end }}
                </div>
            </div>
        </div>
        {{ end }}
        {{ end }}

        {{/* Newsletter signup */}}
        {{ partial "components/newsletter-signup" . }}

        {{/* Service Packages Section */}}
        {{ with .Site.Data.sections.services }}
            {{ if .enabled }}
                {{ $services := where site.RegularPages "Section" "services" }}
                {{ $services = $services | first (default 4 .limit) }}
                {{ partial "components/landing-content" (dict 
                    "type" "side-projects" 
                    "title" .title 
                    "view_all_url" (default "/services/" .view_all_url)
                    "content" $services
                    "background_color" .background_color
                ) }}
            {{ end }}
        {{ end }}

        {{/* Benefits Section */}}
        {{ with .Site.Data.sections.benefits }}
            {{ if .enabled }}
                {{ $benefits := where site.RegularPages "Section" "benefits" }}
                {{ $benefits = $benefits | first (default 3 .limit) }}
                {{ partial "components/landing-content" (dict 
                    "type" "side-projects" 
                    "title" .title 
                    "view_all_url" (default "/benefits/" .view_all_url)
                    "content" $benefits
                    "background_color" .background_color
                ) }}
            {{ end }}
        {{ end }}
        
        {{/* Side Projects Section */}}
        {{ with .Site.Data.sections.sideProjects }}
            {{ if .enabled }}
                {{ $projects := where site.RegularPages "Section" "projects" }}
                {{ $projects = $projects | first (default 4 .limit) }}
                {{ partial "components/landing-content" (dict 
                    "type" "side-projects" 
                    "title" .title 
                    "view_all_url" .view_all_url
                    "content" $projects
                    "background_color" .background_color
                ) }}
            {{ end }}
        {{ end }}
        
        {{/* Blog Section - Latest posts */}}
        {{ with .Site.Data.sections.blog }}
            {{ if .enabled }}
                {{ $posts := where site.RegularPages "Section" "posts" }}
                {{ $posts = $posts | first (default 6 .limit) }}
                {{ partial "components/landing-content" (dict 
                    "type" "blog" 
                    "title" .title 
                    "view_all_url" (default "/posts/" .view_all_url)
                    "content" $posts
                    "background_color" .background_color
                ) }}
            {{ end }}
        {{ end }}
    </main>
</div>
{{ end }}
